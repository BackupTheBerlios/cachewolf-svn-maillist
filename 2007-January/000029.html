<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Cachewolf-svn] r351 - trunk/src/CacheWolf
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/cachewolf-svn/2007-January/index.html" >
   <LINK REL="made" HREF="mailto:cachewolf-svn%40lists.berlios.de?Subject=Re%3A%20%5BCachewolf-svn%5D%20r351%20-%20trunk/src/CacheWolf&In-Reply-To=%3C200701071041.l07Afg3c009840%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000028.html">
   <LINK REL="Next"  HREF="000030.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Cachewolf-svn] r351 - trunk/src/CacheWolf</H1>
    <B>kalli at mail.berlios.de</B> 
    <A HREF="mailto:cachewolf-svn%40lists.berlios.de?Subject=Re%3A%20%5BCachewolf-svn%5D%20r351%20-%20trunk/src/CacheWolf&In-Reply-To=%3C200701071041.l07Afg3c009840%40sheep.berlios.de%3E"
       TITLE="[Cachewolf-svn] r351 - trunk/src/CacheWolf">kalli at mail.berlios.de
       </A><BR>
    <I>Sun Jan  7 11:41:42 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000028.html">[Cachewolf-svn] r350 - trunk/src/CacheWolf
</A></li>
        <LI>Next message: <A HREF="000030.html">[Cachewolf-svn] r352 - in trunk: resources src/CacheWolf
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29">[ date ]</a>
              <a href="thread.html#29">[ thread ]</a>
              <a href="subject.html#29">[ subject ]</a>
              <a href="author.html#29">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: kalli
Date: 2007-01-07 11:41:40 +0100 (Sun, 07 Jan 2007)
New Revision: 351

Modified:
   trunk/src/CacheWolf/Profile.java
   trunk/src/CacheWolf/SafeXML.java
Log:
Bugfix f?\195?\188r Behandlung des Endes der Zeile

Modified: trunk/src/CacheWolf/Profile.java
===================================================================
--- trunk/src/CacheWolf/Profile.java	2007-01-06 23:44:58 UTC (rev 350)
+++ trunk/src/CacheWolf/Profile.java	2007-01-07 10:41:40 UTC (rev 351)
@@ -91,11 +91,12 @@
 				ch = (CacheHolder)cacheDB.get(i);
 				////Vm.debug(&quot;Saving: &quot; + ch.CacheName);
 				if(ch.wayPoint.length()&gt;0 &amp;&amp; ch.LongDescription.equals(&quot;An Error Has Occured&quot;) == false){
-					detfile.print(&quot;    &lt;CACHE name = \&quot;&quot;+SafeXML.clean(ch.CacheName)+&quot;\&quot; owner = \&quot;&quot;+SafeXML.clean(ch.CacheOwner)+&quot;\&quot; latlon = \&quot;&quot;+ SafeXML.clean(ch.LatLon) +&quot;\&quot; hidden = \&quot;&quot;+ch.DateHidden+&quot;\&quot; wayp = \&quot;&quot;+SafeXML.clean(ch.wayPoint)+&quot;\&quot; status = \&quot;&quot;+ch.CacheStatus+&quot;\&quot; type = \&quot;&quot;+ch.type+&quot;\&quot; dif = \&quot;&quot;+ch.hard+&quot;\&quot; terrain = \&quot;&quot; + ch.terrain + &quot;\&quot; dirty = \&quot;&quot; + ch.dirty + &quot;\&quot; size = \&quot;&quot;+ch.CacheSize+&quot;\&quot; online = \&quot;&quot; + Convert.toString(ch.is_available) + &quot;\&quot; archived = \&quot;&quot; + Convert.toString(ch.is_archived) + &quot;\&quot; has_bug = \&quot;&quot; + Convert.toString(ch.has_bug) + &quot;\&quot; black = \&quot;&quot; + Convert.toString(ch.is_black) + &quot;\&quot; owned = \&quot;&quot; + Convert.toString(ch.is_owned) + &quot;\&quot; found = \&quot;&quot; + Convert.toString(ch.is_found) + &quot;\&quot; is_new = \&quot;&quot; + Convert.toString(ch.is_new) +&quot;\&quot; is_log_update = \&quot;&quot; + Convert.toString(ch.is_log_update) + &quot;\&quot; is_update = \&quot;&quot; + Convert.toString(ch.is_update) + &quot;\&quot; is_HTML = \&quot;&quot; + Convert.toString(ch.is_HTML) + &quot;\&quot; DNFLOGS = \&quot;&quot; + ch.noFindLogs + &quot;\&quot; ocCacheID = \&quot;&quot; + ch!
 .ocCacheID + &quot;\&quot;/&gt;\n&quot;);
+					detfile.print(&quot;    &lt;CACHE name = \&quot;&quot;+SafeXML.clean(ch.CacheName)+&quot;\&quot; owner = \&quot;&quot;+SafeXML.clean(ch.CacheOwner)+&quot;\&quot; latlon = \&quot;&quot;+ SafeXML.clean(ch.LatLon) +&quot;\&quot; hidden = \&quot;&quot;+ch.DateHidden+&quot;\&quot; wayp = \&quot;&quot;+SafeXML.clean(ch.wayPoint)+&quot;\&quot; status = \&quot;&quot;+ch.CacheStatus+&quot;\&quot; type = \&quot;&quot;+ch.type+&quot;\&quot; dif = \&quot;&quot;+ch.hard+&quot;\&quot; terrain = \&quot;&quot; + ch.terrain + &quot;\&quot; dirty = \&quot;&quot; + ch.dirty + &quot;\&quot; size = \&quot;&quot;+ch.CacheSize+&quot;\&quot; online = \&quot;&quot; + Convert.toString(ch.is_available) + &quot;\&quot; archived = \&quot;&quot; + Convert.toString(ch.is_archived) + &quot;\&quot; has_bug = \&quot;&quot; + Convert.toString(ch.has_bug) + &quot;\&quot; black = \&quot;&quot; + Convert.toString(ch.is_black) + &quot;\&quot; owned = \&quot;&quot; + Convert.toString(ch.is_owned) + &quot;\&quot; found = \&quot;&quot; + Convert.toString(ch.is_found) + &quot;\&quot; is_new = \&quot;&quot; + Convert.toString(ch.is_new) +&quot;\&quot; is_log_update = \&quot;&quot; + Convert.toString(ch.is_log_update) + &quot;\&quot; is_update = \&quot;&quot; + Convert.toString(ch.is_update) + &quot;\&quot; is_HTML = \&quot;&quot; + Convert.toString(ch.is_HTML) + &quot;\&quot; DNFLOGS = \&quot;&quot; + ch.noFindLogs + &quot;\&quot; ocCacheID = \&quot;&quot; + ch!
 .ocCacheID + &quot;\&quot; /&gt;\n&quot;);
 				}
 			}
 			detfile.print(&quot;&lt;/CACHELIST&gt;\n&quot;);
 			detfile.close();
+			CacheHolder.buildReferences(cacheDB);
 		}catch(Exception e){
 			Vm.debug(&quot;Problem writing to index file &quot;+e.toString());
 		}
@@ -145,6 +146,10 @@
 					ch.is_HTML = ex.findNext().equals(&quot;false&quot;) ? false : true;
 					ch.noFindLogs = Convert.toInt(ex.findNext());
 					ch.ocCacheID = ex.findNext();
+					// remove &quot;/&gt;
+					ch.ocCacheID = SafeXML.replace(ch.ocCacheID,&quot;\&quot;/&gt;&quot;, null);
+					// remove additional &quot; if present
+					ch.ocCacheID = SafeXML.replace(ch.ocCacheID,&quot;\&quot;&quot;, null);
 					cacheDB.add(ch);
 				} else if (text.indexOf(&quot;&lt;CENTRE&quot;)&gt;=0) { // lat=  lon=
 					int start=text.indexOf(&quot;lat=\&quot;&quot;)+5;
@@ -161,6 +166,9 @@
 				}
 			}
 			in.close();
+			// Build references between caches and addi wpts
+			CacheHolder.buildReferences(cacheDB);
+			
 		} catch (FileNotFoundException e) {
 			Vm.debug(&quot;index.xml not found&quot;); // Normal when profile is opened for first time
 			//e.printStackTrace();

Modified: trunk/src/CacheWolf/SafeXML.java
===================================================================
--- trunk/src/CacheWolf/SafeXML.java	2007-01-06 23:44:58 UTC (rev 350)
+++ trunk/src/CacheWolf/SafeXML.java	2007-01-07 10:41:40 UTC (rev 351)
@@ -435,7 +435,7 @@
 		 *   @param  f  String to look for.
 		 *   @param  r  String to replace it with, or null to just remove it.
 		 */ 
-		private static String replace( String s, String f, String r )
+		public static String replace( String s, String f, String r )
 		{
 		   if (s == null)  return s;
 		   if (f == null)  return s;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000028.html">[Cachewolf-svn] r350 - trunk/src/CacheWolf
</A></li>
	<LI>Next message: <A HREF="000030.html">[Cachewolf-svn] r352 - in trunk: resources src/CacheWolf
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29">[ date ]</a>
              <a href="thread.html#29">[ thread ]</a>
              <a href="subject.html#29">[ subject ]</a>
              <a href="author.html#29">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/cachewolf-svn">More information about the Cachewolf-svn
mailing list</a><br>
</body></html>

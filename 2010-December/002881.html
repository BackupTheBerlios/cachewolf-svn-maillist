<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Cachewolf-svn] r2892 - in trunk: res_noewe/languages	src/CacheWolf/imp
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/cachewolf-svn/2010-December/index.html" >
   <LINK REL="made" HREF="mailto:cachewolf-svn%40lists.berlios.de?Subject=Re%3A%20%5BCachewolf-svn%5D%20r2892%20-%20in%20trunk%3A%20res_noewe/languages%0A%09src/CacheWolf/imp&In-Reply-To=%3C20101227200038.727D0480587%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002880.html">
   <LINK REL="Next"  HREF="002882.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Cachewolf-svn] r2892 - in trunk: res_noewe/languages	src/CacheWolf/imp</H1>
    <B>araber95 at mail.berlios.de</B> 
    <A HREF="mailto:cachewolf-svn%40lists.berlios.de?Subject=Re%3A%20%5BCachewolf-svn%5D%20r2892%20-%20in%20trunk%3A%20res_noewe/languages%0A%09src/CacheWolf/imp&In-Reply-To=%3C20101227200038.727D0480587%40sheep.berlios.de%3E"
       TITLE="[Cachewolf-svn] r2892 - in trunk: res_noewe/languages	src/CacheWolf/imp">araber95 at mail.berlios.de
       </A><BR>
    <I>Mon Dec 27 09:00:38 CET 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002880.html">[Cachewolf-svn] r2891 - trunk/src/CacheWolf
</A></li>
        <LI>Next message: <A HREF="002882.html">[Cachewolf-svn] r2893 - in trunk/tools: . ImageDecode	ImageDecode/classes ImageDecode/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2881">[ date ]</a>
              <a href="thread.html#2881">[ thread ]</a>
              <a href="subject.html#2881">[ subject ]</a>
              <a href="author.html#2881">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: araber95
Date: 2010-12-27 21:00:38 +0100 (Mon, 27 Dec 2010)
New Revision: 2892

Modified:
   trunk/res_noewe/languages/DE.cfg
   trunk/res_noewe/languages/EN.cfg
   trunk/res_noewe/languages/FR.cfg
   trunk/res_noewe/languages/NL.cfg
   trunk/res_noewe/languages/PL.cfg
   trunk/res_noewe/languages/SV.cfg
   trunk/src/CacheWolf/imp/OCXMLImporterScreen.java
   trunk/src/CacheWolf/imp/SpiderGC.java
Log:
Changed direction selection (due to last gc change)

Modified: trunk/res_noewe/languages/DE.cfg
===================================================================
--- trunk/res_noewe/languages/DE.cfg	2010-12-27 16:55:42 UTC (rev 2891)
+++ trunk/res_noewe/languages/DE.cfg	2010-12-27 20:00:38 UTC (rev 2892)
@@ -514,8 +514,8 @@
 1626=Speichere bis zu x Logs:
 1627=Alle Caches
 1628=min. Abstand:
-1629=Richtung (leer/N/N*/N,NE,E):
-1630=z.B. leer oder N oder N* oder N,NE,E
+1629=Richtung (leer/von-bis(Grad)):
+1630=z.B. leer oder von-bis(Grad)
 1631=Aktualisiere h&#246;chstens:
 1700=Fehler in Zeile:
 1701=Spalte:

Modified: trunk/res_noewe/languages/EN.cfg
===================================================================
--- trunk/res_noewe/languages/EN.cfg	2010-12-27 16:55:42 UTC (rev 2891)
+++ trunk/res_noewe/languages/EN.cfg	2010-12-27 20:00:38 UTC (rev 2892)
@@ -514,8 +514,8 @@
 1626=Max. save logs:
 1627=All caches
 1628=min. Distance:
-1629=Direction (empty/N/N*/N,NE,E):
-1630=e.g. blank or N or N* or N,NE,E
+1629 = direction (empty / from-to (degrees)):
+1630 = e.g. empty or low-high (degree)
 1631=Update upto:
 1700=Error on line:
 1701=position:

Modified: trunk/res_noewe/languages/FR.cfg
===================================================================
--- trunk/res_noewe/languages/FR.cfg	2010-12-27 16:55:42 UTC (rev 2891)
+++ trunk/res_noewe/languages/FR.cfg	2010-12-27 20:00:38 UTC (rev 2892)
@@ -514,8 +514,8 @@
 1626=Max Activit&#233;:
 1627=Tous les caches
 1628=min. Distance:
-1629=Direction (vide/N/N*/N,NE,E):
-1630=par exemple nulle ou N ou N* ou N,NE,E
+1629 = direction (vide / &#224; partir de (degr&#233;s)):
+1630 = par exemple, vide ou bas-haut (degr&#233;)
 1631=max. Mises &#224; jour:
 1700=Erreur en lingne:
 1701=Colonne:

Modified: trunk/res_noewe/languages/NL.cfg
===================================================================
--- trunk/res_noewe/languages/NL.cfg	2010-12-27 16:55:42 UTC (rev 2891)
+++ trunk/res_noewe/languages/NL.cfg	2010-12-27 20:00:38 UTC (rev 2892)
@@ -514,8 +514,8 @@
 1626=Max Logs:
 1627=Alle caches
 1628=max. Afstand:
-1629=Richting (leeg/N/N*/N,NE,E):
-1630=bv. blanco of N of N* of N,NE,E
+1629 = richting (leeg / van-tot (graden)):
+1630 = bijvoorbeeld leeg of laag-hoog (graden)
 1631=Max. Updates:
 1700=Fout in lijn:
 1701=Positie:

Modified: trunk/res_noewe/languages/PL.cfg
===================================================================
--- trunk/res_noewe/languages/PL.cfg	2010-12-27 16:55:42 UTC (rev 2891)
+++ trunk/res_noewe/languages/PL.cfg	2010-12-27 20:00:38 UTC (rev 2892)
@@ -514,8 +514,8 @@
 1626=Max. logow:
 1627=Wszystkie skrzynki
 1628=min. Odleglosc:
-1629=Kierunek (pusty/N/N*/N,NE,E):
-1630=np. puste lub N lub N* lub N,S,E
+1629 = Kierunek (pusty / od-do (w stopniach)):
+1630 = np. puste lub niski-wysoki (w stopniach)
 1631=Max. Aktualizacje:
 1700=Blad on line:
 1701=pozycja:

Modified: trunk/res_noewe/languages/SV.cfg
===================================================================
--- trunk/res_noewe/languages/SV.cfg	2010-12-27 16:55:42 UTC (rev 2891)
+++ trunk/res_noewe/languages/SV.cfg	2010-12-27 20:00:38 UTC (rev 2892)
@@ -514,8 +514,8 @@
 1626=Max. spara loggar:
 1627=Alla cachar
 1628=min. Avst&#229;nd:
-1629=Direction (tom / N / N * / N, NE, E):
-1630=t.ex. tom eller N eller N * eller N, NE, E
+1629 = riktning (tom / fr&#229;n-till (grader)):
+1630 = t.ex. tom eller l&#229;g-h&#246;g (grad)
 1631=Uppdatera upto:
 1700=Fel p&#229; rad:
 1701=position:

Modified: trunk/src/CacheWolf/imp/OCXMLImporterScreen.java
===================================================================
--- trunk/src/CacheWolf/imp/OCXMLImporterScreen.java	2010-12-27 16:55:42 UTC (rev 2891)
+++ trunk/src/CacheWolf/imp/OCXMLImporterScreen.java	2010-12-27 20:00:38 UTC (rev 2892)
@@ -150,7 +150,7 @@
 			this.addNext(new mLabel(MyLocale.getMsg(1629,&quot;Richtung:&quot;)),CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.WEST));
 			directionInput = new mInput();
 			directionInput.setText(Global.getProfile().getDirectionGC());
-			directionInput.toolTip=MyLocale.getMsg(1630,&quot;z.B. leer oder N oder N* oder N,NE,E&quot;);
+			directionInput.toolTip=MyLocale.getMsg(1630,&quot;z.B. leer oder von-bis (Grad)&quot;);
 			this.addLast(directionInput,CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.WEST));
 		}
 

Modified: trunk/src/CacheWolf/imp/SpiderGC.java
===================================================================
--- trunk/src/CacheWolf/imp/SpiderGC.java	2010-12-27 16:55:42 UTC (rev 2891)
+++ trunk/src/CacheWolf/imp/SpiderGC.java	2010-12-27 20:00:38 UTC (rev 2892)
@@ -238,10 +238,7 @@
 
 			cachesToUpdate = fillDownloadLists(pref.maxSpiderNumber, maxUpdate,
 					maxDistance, minDistance, directions, cachesToUpdate);
-			if (cachesToUpdate == null) {
-				cachesToUpdate = new Hashtable();
-			}
-			;
+			if (cachesToUpdate == null) { cachesToUpdate = new Hashtable(); };
 			if (!infB.isClosed) {
 				infB.setInfo(MyLocale.getMsg(5511, &quot;Found &quot;)
 						+ cachesToLoad.size()
@@ -805,8 +802,6 @@
 			}
 			if (maxUpdate == -1)
 				maxUpdate = Integer.MAX_VALUE;
-			// TODO maxUpdate in preferences ?
-
 		}
 
 		// options for all
@@ -823,7 +818,7 @@
 			profile.setDistGC(Double.toString(maxDistance));
 		}
 
-		directions = mString.split(direction, ',');
+		directions = mString.split(direction, '-');
 		// works even if TYPE not in options
 		cacheTypeRestriction = options.getCacheTypeRestriction(p);
 		restrictedCacheType = options.getRestrictedCacheType(p);
@@ -952,14 +947,14 @@
 						Global.mainTab.statBar.updateDisplay(&quot;working &quot;
 								+ page_number + &quot; / &quot; + found_on_page);
 					String CacheDescriptionGC = RexPropLine.stringMatched(1);
-					double gotDistance = getDistGC(CacheDescriptionGC);
+					String DistanceAndDirection = getDistanceAndDirection(CacheDescriptionGC);
+					double gotDistance = getDistGC(DistanceAndDirection);
 					String chWaypoint = getWP(CacheDescriptionGC);
 					if (gotDistance &lt;= toDistance) {
 						CacheHolder ch = cacheDB.get(chWaypoint);
 						if (ch == null) { // not in DB
 							if (gotDistance &gt;= fromDistance
-									&amp;&amp; directionOK(directions,
-											getDirection(CacheDescriptionGC))
+									&amp;&amp; directionOK(directions, getDirection(DistanceAndDirection))
 									&amp;&amp; doPMCache(CacheDescriptionGC)
 									&amp;&amp; cachesToLoad.size() &lt; maxNew) {
 								if (CacheDescriptionGC.indexOf(propFound) != -1)
@@ -1731,7 +1726,15 @@
     }
 		return new String(ctmp);
   }
-
+	private String getDistanceAndDirection(String doc) {
+		RexPropDistanceCode.search(doc);
+		if (!RexPropDistanceCode.didMatch()) {
+			pref.log(&quot;check distRex&quot; + Preferences.NEWLINE + doc);
+			return &quot;&quot;;
+		}
+		String stmp = ewe.net.URL.decodeURL(RexPropDistanceCode.stringMatched(1));
+		return decodeXor( stmp, DistanceCodeKey);
+	}
 	/**
 	 * Get the Distance to the centre
 	 * 
@@ -1740,15 +1743,7 @@
 	 * @return Distance
 	 */
 	private double getDistGC(String doc) throws Exception {
-		RexPropDistanceCode.search(doc);
-		if (!RexPropDistanceCode.didMatch()) {
-			pref.log(&quot;check distRex&quot; + Preferences.NEWLINE + doc);
-			return 0;
-		}
-		String stmp = ewe.net.URL.decodeURL(RexPropDistanceCode.stringMatched(1));
-		stmp = decodeXor( stmp, DistanceCodeKey);
-		RexPropDistance.search(stmp); // km oder mi
-		pref.log(RexPropDistanceCode.stringMatched(1)+&quot; : &quot;+stmp,null);
+		RexPropDistance.search(doc); // km oder mi
 		if (RexPropDistance.didMatch()) {
 			if (MyLocale.getDigSeparator().equals(&quot;,&quot;))
 				return Convert.toDouble(RexPropDistance.stringMatched(1)
@@ -1863,18 +1858,13 @@
 	 * @return direction String
 	 */
 	private String getDirection(String doc) throws Exception {
-	  //TODO decode direction from image cache code
-	  return &quot;&quot;;
-	  
-	  /*
 		RexPropDirection.search(doc);
 		if (!RexPropDirection.didMatch()) {
-			pref.log(&quot;check directionRex in spider.def&quot; 
-					+ Preferences.NEWLINE + doc);
+			pref.log(&quot;check directionRex in spider.def&quot; + Preferences.NEWLINE + doc);
 			return &quot;&quot;;
 		}
-		return RexPropDirection.stringMatched(1);
-		*/
+		String s=RexPropDirection.stringMatched(1);
+		return s;
 	}
 
 	/*
@@ -1883,18 +1873,19 @@
 	private boolean directionOK(String[] directions, String gotDirection) {
 		if (directions.length == 0)
 			return true; // nothing means all
-		for (int i = 0; i &lt; directions.length; i++) {
-			if (directions[i].equals(gotDirection)) {
-				return true;
-			}
-			int j = directions[i].indexOf(&quot;*&quot;);
-			if (j &gt; 0) {
-				if (gotDirection.indexOf(directions[i].substring(0, 1)) &gt; -1) {
-					return true;
-				}
-			}
+		int lowerLimit = Common.parseInt(directions[0]);
+		int upperLimit = Common.parseInt(directions[1]);
+		int toCheck = Common.parseInt(gotDirection);
+		if (lowerLimit &lt;= upperLimit) {
+			if ((toCheck&gt;=lowerLimit) &amp;&amp; (toCheck&lt;=upperLimit))
+			{return true;}
+			else {return false;}
 		}
-		return false;
+		else {
+			if ((toCheck&gt;=lowerLimit) || (toCheck&lt;=upperLimit))
+			{return true;}
+			else {return false;}
+		}
 	}
 
 	/*


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002880.html">[Cachewolf-svn] r2891 - trunk/src/CacheWolf
</A></li>
	<LI>Next message: <A HREF="002882.html">[Cachewolf-svn] r2893 - in trunk/tools: . ImageDecode	ImageDecode/classes ImageDecode/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2881">[ date ]</a>
              <a href="thread.html#2881">[ thread ]</a>
              <a href="subject.html#2881">[ subject ]</a>
              <a href="author.html#2881">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/cachewolf-svn">More information about the Cachewolf-svn
mailing list</a><br>
</body></html>

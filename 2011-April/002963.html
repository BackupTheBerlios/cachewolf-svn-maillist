<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Cachewolf-svn] r2972 - in trunk/tools/MakeWMSFile: . capxml2wms	capxml2wms/My Project capxml2wms/bin/Debug
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/cachewolf-svn/2011-April/index.html" >
   <LINK REL="made" HREF="mailto:cachewolf-svn%40lists.berlios.de?Subject=Re%3A%20%5BCachewolf-svn%5D%20r2972%20-%20in%20trunk/tools/MakeWMSFile%3A%20.%20capxml2wms%0A%09capxml2wms/My%20Project%20capxml2wms/bin/Debug&In-Reply-To=%3C20110405160448.A0E02480EA9%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002962.html">
   <LINK REL="Next"  HREF="002964.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Cachewolf-svn] r2972 - in trunk/tools/MakeWMSFile: . capxml2wms	capxml2wms/My Project capxml2wms/bin/Debug</H1>
    <B>araber95 at mail.berlios.de</B> 
    <A HREF="mailto:cachewolf-svn%40lists.berlios.de?Subject=Re%3A%20%5BCachewolf-svn%5D%20r2972%20-%20in%20trunk/tools/MakeWMSFile%3A%20.%20capxml2wms%0A%09capxml2wms/My%20Project%20capxml2wms/bin/Debug&In-Reply-To=%3C20110405160448.A0E02480EA9%40sheep.berlios.de%3E"
       TITLE="[Cachewolf-svn] r2972 - in trunk/tools/MakeWMSFile: . capxml2wms	capxml2wms/My Project capxml2wms/bin/Debug">araber95 at mail.berlios.de
       </A><BR>
    <I>Tue Apr  5 06:04:48 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="002962.html">[Cachewolf-svn] r2971 - in trunk/src/CacheWolf: . navi
</A></li>
        <LI>Next message: <A HREF="002964.html">[Cachewolf-svn] r2973 - trunk/src/CacheWolf/navi
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2963">[ date ]</a>
              <a href="thread.html#2963">[ thread ]</a>
              <a href="subject.html#2963">[ subject ]</a>
              <a href="author.html#2963">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: araber95
Date: 2011-04-05 18:04:48 +0200 (Tue, 05 Apr 2011)
New Revision: 2972

Modified:
   trunk/tools/MakeWMSFile/capxml2wms.sln
   trunk/tools/MakeWMSFile/capxml2wms/My Project/Application.Designer.vb
   trunk/tools/MakeWMSFile/capxml2wms/My Project/Resources.Designer.vb
   trunk/tools/MakeWMSFile/capxml2wms/My Project/Settings.Designer.vb
   trunk/tools/MakeWMSFile/capxml2wms/bin/Debug/capxml2wms.exe
   trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.Designer.vb
   trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.resx
   trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.vb
   trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.vbproj
   trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.vbproj.user
Log:
doing with vb 2010 Express:
A bit more robust and usable.
Typo Bottom for Buttom.


Modified: trunk/tools/MakeWMSFile/capxml2wms/My Project/Application.Designer.vb
===================================================================
--- trunk/tools/MakeWMSFile/capxml2wms/My Project/Application.Designer.vb	2011-04-03 14:26:55 UTC (rev 2971)
+++ trunk/tools/MakeWMSFile/capxml2wms/My Project/Application.Designer.vb	2011-04-05 16:04:48 UTC (rev 2972)
@@ -1,7 +1,7 @@
 &#239;&#187;&#191;'------------------------------------------------------------------------------
 ' &lt;auto-generated&gt;
 '     Dieser Code wurde von einem Tool generiert.
-'     Laufzeitversion:2.0.50727.3082
+'     Laufzeitversion:4.0.30319.1
 '
 '     &#195;&#132;nderungen an dieser Datei k&#195;&#182;nnen falsches Verhalten verursachen und gehen verloren, wenn
 '     der Code erneut generiert wird.
@@ -16,7 +16,7 @@
     
     'HINWEIS: Diese Datei wird automatisch generiert. &#195;&#132;ndern Sie sie nicht direkt. Zum &#195;&#132;ndern
     ' oder bei in dieser Datei auftretenden Buildfehlern wechseln Sie zum Projekt-Designer.
-    ' (Wechseln Sie dazu zu den Projekteigenschaften, oder doppelklicken Sie auf den Knoten &quot;Eigenes Projekt&quot; im
+    ' (Wechseln Sie dazu zu den Projekteigenschaften, oder doppelklicken Sie auf den Knoten &quot;Mein Projekt&quot; im
     ' Projektmappen-Explorer). Nehmen Sie auf der Registerkarte &quot;Anwendung&quot; entsprechende &#195;&#132;nderungen vor.
     '
     Partial Friend Class MyApplication

Modified: trunk/tools/MakeWMSFile/capxml2wms/My Project/Resources.Designer.vb
===================================================================
--- trunk/tools/MakeWMSFile/capxml2wms/My Project/Resources.Designer.vb	2011-04-03 14:26:55 UTC (rev 2971)
+++ trunk/tools/MakeWMSFile/capxml2wms/My Project/Resources.Designer.vb	2011-04-05 16:04:48 UTC (rev 2972)
@@ -1,7 +1,7 @@
 &#239;&#187;&#191;'------------------------------------------------------------------------------
 ' &lt;auto-generated&gt;
 '     Dieser Code wurde von einem Tool generiert.
-'     Laufzeitversion:2.0.50727.3082
+'     Laufzeitversion:4.0.30319.1
 '
 '     &#195;&#132;nderungen an dieser Datei k&#195;&#182;nnen falsches Verhalten verursachen und gehen verloren, wenn
 '     der Code erneut generiert wird.
@@ -22,7 +22,7 @@
     '''&lt;summary&gt;
     '''  Eine stark typisierte Ressourcenklasse zum Suchen von lokalisierten Zeichenfolgen usw.
     '''&lt;/summary&gt;
-    &lt;Global.System.CodeDom.Compiler.GeneratedCodeAttribute(&quot;System.Resources.Tools.StronglyTypedResourceBuilder&quot;, &quot;2.0.0.0&quot;),  _
+    &lt;Global.System.CodeDom.Compiler.GeneratedCodeAttribute(&quot;System.Resources.Tools.StronglyTypedResourceBuilder&quot;, &quot;4.0.0.0&quot;),  _
      Global.System.Diagnostics.DebuggerNonUserCodeAttribute(),  _
      Global.System.Runtime.CompilerServices.CompilerGeneratedAttribute(),  _
      Global.Microsoft.VisualBasic.HideModuleNameAttribute()&gt;  _

Modified: trunk/tools/MakeWMSFile/capxml2wms/My Project/Settings.Designer.vb
===================================================================
--- trunk/tools/MakeWMSFile/capxml2wms/My Project/Settings.Designer.vb	2011-04-03 14:26:55 UTC (rev 2971)
+++ trunk/tools/MakeWMSFile/capxml2wms/My Project/Settings.Designer.vb	2011-04-05 16:04:48 UTC (rev 2972)
@@ -1,7 +1,7 @@
 &#239;&#187;&#191;'------------------------------------------------------------------------------
 ' &lt;auto-generated&gt;
 '     Dieser Code wurde von einem Tool generiert.
-'     Laufzeitversion:2.0.50727.3082
+'     Laufzeitversion:4.0.30319.1
 '
 '     &#195;&#132;nderungen an dieser Datei k&#195;&#182;nnen falsches Verhalten verursachen und gehen verloren, wenn
 '     der Code erneut generiert wird.
@@ -15,12 +15,12 @@
 Namespace My
     
     &lt;Global.System.Runtime.CompilerServices.CompilerGeneratedAttribute(),  _
-     Global.System.CodeDom.Compiler.GeneratedCodeAttribute(&quot;Microsoft.VisualStudio.Editors.SettingsDesigner.SettingsSingleFileGenerator&quot;, &quot;9.0.0.0&quot;),  _
+     Global.System.CodeDom.Compiler.GeneratedCodeAttribute(&quot;Microsoft.VisualStudio.Editors.SettingsDesigner.SettingsSingleFileGenerator&quot;, &quot;10.0.0.0&quot;),  _
      Global.System.ComponentModel.EditorBrowsableAttribute(Global.System.ComponentModel.EditorBrowsableState.Advanced)&gt;  _
     Partial Friend NotInheritable Class MySettings
         Inherits Global.System.Configuration.ApplicationSettingsBase
         
-        Private Shared defaultInstance As MySettings = CType(Global.System.Configuration.ApplicationSettingsBase.Synchronized(New MySettings),MySettings)
+        Private Shared defaultInstance As MySettings = CType(Global.System.Configuration.ApplicationSettingsBase.Synchronized(New MySettings()),MySettings)
         
 #Region &quot;Funktion zum automatischen Speichern von My.Settings&quot;
 #If _MyType = &quot;WindowsForms&quot; Then

Modified: trunk/tools/MakeWMSFile/capxml2wms/bin/Debug/capxml2wms.exe
===================================================================
(Binary files differ)

Modified: trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.Designer.vb
===================================================================
--- trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.Designer.vb	2011-04-03 14:26:55 UTC (rev 2971)
+++ trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.Designer.vb	2011-04-05 16:04:48 UTC (rev 2972)
@@ -23,298 +23,297 @@
     &lt;System.Diagnostics.DebuggerStepThrough()&gt; _
     Private Sub InitializeComponent()
         Dim resources As System.ComponentModel.ComponentResourceManager = New System.ComponentModel.ComponentResourceManager(GetType(capxml2wms))
-        Me.ButtonErstellen = New System.Windows.Forms.Button
-        Me.TextBoxUrl = New System.Windows.Forms.TextBox
-        Me.Label1 = New System.Windows.Forms.Label
-        Me.TextBoxXML = New System.Windows.Forms.TextBox
-        Me.Label2 = New System.Windows.Forms.Label
-        Me.ComboBoxVersion = New System.Windows.Forms.ComboBox
-        Me.ButtonGetCapabilities = New System.Windows.Forms.Button
-        Me.ButtonShowMap = New System.Windows.Forms.Button
-        Me.CheckedListBoxLayers = New System.Windows.Forms.CheckedListBox
-        Me.Label3 = New System.Windows.Forms.Label
-        Me.ButtonCheckNone = New System.Windows.Forms.Button
-        Me.ButtonCheckAll = New System.Windows.Forms.Button
-        Me.ComboBoxEPSG = New System.Windows.Forms.ComboBox
-        Me.Label4 = New System.Windows.Forms.Label
-        Me.HScrollBar1 = New System.Windows.Forms.HScrollBar
-        Me.Label5 = New System.Windows.Forms.Label
-        Me.ComboBoxFormat = New System.Windows.Forms.ComboBox
-        Me.ComboBoxBBox = New System.Windows.Forms.ComboBox
-        Me.Label6 = New System.Windows.Forms.Label
-        Me.ComboBoxBBoxI = New System.Windows.Forms.ComboBox
-        Me.ButtonFindScale = New System.Windows.Forms.Button
+        Me.ButtonErstellen = New System.Windows.Forms.Button()
+        Me.Panel1 = New System.Windows.Forms.Panel()
+        Me.ComboBoxBBoxI = New System.Windows.Forms.ComboBox()
+        Me.Label6 = New System.Windows.Forms.Label()
+        Me.ComboBoxBBox = New System.Windows.Forms.ComboBox()
+        Me.ComboBoxFormat = New System.Windows.Forms.ComboBox()
+        Me.Label5 = New System.Windows.Forms.Label()
+        Me.Label4 = New System.Windows.Forms.Label()
+        Me.ComboBoxEPSG = New System.Windows.Forms.ComboBox()
+        Me.ButtonFindScale = New System.Windows.Forms.Button()
+        Me.ButtonCheckAll = New System.Windows.Forms.Button()
+        Me.ButtonCheckNone = New System.Windows.Forms.Button()
+        Me.Label3 = New System.Windows.Forms.Label()
+        Me.CheckedListBoxLayers = New System.Windows.Forms.CheckedListBox()
+        Me.Panel2 = New System.Windows.Forms.Panel()
+        Me.TextBoxXML = New System.Windows.Forms.TextBox()
+        Me.ButtonGetCapabilities = New System.Windows.Forms.Button()
+        Me.ComboBoxVersion = New System.Windows.Forms.ComboBox()
+        Me.Label2 = New System.Windows.Forms.Label()
+        Me.Label1 = New System.Windows.Forms.Label()
+        Me.TextBoxUrl = New System.Windows.Forms.TextBox()
+        Me.Panel1.SuspendLayout()
+        Me.Panel2.SuspendLayout()
         Me.SuspendLayout()
         '
         'ButtonErstellen
         '
         Me.ButtonErstellen.Anchor = CType((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
-        Me.ButtonErstellen.Location = New System.Drawing.Point(540, 552)
+        Me.ButtonErstellen.Location = New System.Drawing.Point(537, 553)
         Me.ButtonErstellen.Name = &quot;ButtonErstellen&quot;
         Me.ButtonErstellen.Size = New System.Drawing.Size(123, 36)
         Me.ButtonErstellen.TabIndex = 1
-        Me.ButtonErstellen.Text = &quot;WMS-Datei erstellen&quot;
+        Me.ButtonErstellen.Text = &quot;3. WMS-Datei erstellen&quot;
         Me.ButtonErstellen.UseVisualStyleBackColor = True
         '
-        'TextBoxUrl
+        'Panel1
         '
-        Me.TextBoxUrl.Anchor = CType(((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Left) _
+        Me.Panel1.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
+                    Or System.Windows.Forms.AnchorStyles.Left) _
                     Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
-        Me.TextBoxUrl.Location = New System.Drawing.Point(20, 57)
-        Me.TextBoxUrl.Name = &quot;TextBoxUrl&quot;
-        Me.TextBoxUrl.Size = New System.Drawing.Size(496, 20)
-        Me.TextBoxUrl.TabIndex = 0
+        Me.Panel1.Controls.Add(Me.ComboBoxBBoxI)
+        Me.Panel1.Controls.Add(Me.Label6)
+        Me.Panel1.Controls.Add(Me.ComboBoxBBox)
+        Me.Panel1.Controls.Add(Me.ComboBoxFormat)
+        Me.Panel1.Controls.Add(Me.Label5)
+        Me.Panel1.Controls.Add(Me.Label4)
+        Me.Panel1.Controls.Add(Me.ComboBoxEPSG)
+        Me.Panel1.Controls.Add(Me.ButtonFindScale)
+        Me.Panel1.Controls.Add(Me.ButtonCheckAll)
+        Me.Panel1.Controls.Add(Me.ButtonCheckNone)
+        Me.Panel1.Controls.Add(Me.Label3)
+        Me.Panel1.Controls.Add(Me.CheckedListBoxLayers)
+        Me.Panel1.Location = New System.Drawing.Point(20, 240)
+        Me.Panel1.Name = &quot;Panel1&quot;
+        Me.Panel1.Size = New System.Drawing.Size(643, 306)
+        Me.Panel1.TabIndex = 24
         '
-        'Label1
+        'ComboBoxBBoxI
         '
-        Me.Label1.Anchor = CType(((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Left) _
-                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
-        Me.Label1.AutoSize = True
-        Me.Label1.Location = New System.Drawing.Point(21, 27)
-        Me.Label1.Name = &quot;Label1&quot;
-        Me.Label1.Size = New System.Drawing.Size(205, 13)
-        Me.Label1.TabIndex = 2
-        Me.Label1.Text = &quot;http Adresse des WMS-Servers eingeben:&quot;
+        Me.ComboBoxBBoxI.FormattingEnabled = True
+        Me.ComboBoxBBoxI.Location = New System.Drawing.Point(190, 36)
+        Me.ComboBoxBBoxI.Name = &quot;ComboBoxBBoxI&quot;
+        Me.ComboBoxBBoxI.Size = New System.Drawing.Size(252, 21)
+        Me.ComboBoxBBoxI.TabIndex = 35
+        Me.ComboBoxBBoxI.Visible = False
         '
-        'TextBoxXML
+        'Label6
         '
-        Me.TextBoxXML.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
-                    Or System.Windows.Forms.AnchorStyles.Left) _
+        Me.Label6.AutoSize = True
+        Me.Label6.Location = New System.Drawing.Point(141, 6)
+        Me.Label6.Name = &quot;Label6&quot;
+        Me.Label6.Size = New System.Drawing.Size(35, 13)
+        Me.Label6.TabIndex = 34
+        Me.Label6.Text = &quot;BBox:&quot;
+        '
+        'ComboBoxBBox
+        '
+        Me.ComboBoxBBox.Anchor = CType(((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Left) _
                     Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
-        Me.TextBoxXML.Location = New System.Drawing.Point(20, 83)
-        Me.TextBoxXML.Multiline = True
-        Me.TextBoxXML.Name = &quot;TextBoxXML&quot;
-        Me.TextBoxXML.ReadOnly = True
-        Me.TextBoxXML.ScrollBars = System.Windows.Forms.ScrollBars.Both
-        Me.TextBoxXML.Size = New System.Drawing.Size(643, 288)
-        Me.TextBoxXML.TabIndex = 4
-        Me.TextBoxXML.WordWrap = False
+        Me.ComboBoxBBox.FormattingEnabled = True
+        Me.ComboBoxBBox.Location = New System.Drawing.Point(144, 23)
+        Me.ComboBoxBBox.Name = &quot;ComboBoxBBox&quot;
+        Me.ComboBoxBBox.Size = New System.Drawing.Size(489, 21)
+        Me.ComboBoxBBox.TabIndex = 33
         '
-        'Label2
+        'ComboBoxFormat
         '
-        Me.Label2.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
-        Me.Label2.AutoSize = True
-        Me.Label2.Location = New System.Drawing.Point(511, 27)
-        Me.Label2.Name = &quot;Label2&quot;
-        Me.Label2.Size = New System.Drawing.Size(75, 13)
-        Me.Label2.TabIndex = 5
-        Me.Label2.Text = &quot;WMS-Version:&quot;
-        Me.Label2.Visible = False
+        Me.ComboBoxFormat.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
+        Me.ComboBoxFormat.FormattingEnabled = True
+        Me.ComboBoxFormat.Location = New System.Drawing.Point(512, 104)
+        Me.ComboBoxFormat.Name = &quot;ComboBoxFormat&quot;
+        Me.ComboBoxFormat.Size = New System.Drawing.Size(121, 21)
+        Me.ComboBoxFormat.TabIndex = 32
         '
-        'ComboBoxVersion
+        'Label5
         '
-        Me.ComboBoxVersion.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
-        Me.ComboBoxVersion.FormattingEnabled = True
-        Me.ComboBoxVersion.Items.AddRange(New Object() {&quot;1.0.0&quot;, &quot;1.1.0&quot;, &quot;1.1.1&quot;})
-        Me.ComboBoxVersion.Location = New System.Drawing.Point(588, 24)
-        Me.ComboBoxVersion.MaxDropDownItems = 3
-        Me.ComboBoxVersion.Name = &quot;ComboBoxVersion&quot;
-        Me.ComboBoxVersion.Size = New System.Drawing.Size(75, 21)
-        Me.ComboBoxVersion.TabIndex = 6
+        Me.Label5.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
+        Me.Label5.AutoSize = True
+        Me.Label5.Location = New System.Drawing.Point(514, 88)
+        Me.Label5.Name = &quot;Label5&quot;
+        Me.Label5.Size = New System.Drawing.Size(42, 13)
+        Me.Label5.TabIndex = 31
+        Me.Label5.Text = &quot;Format:&quot;
         '
-        'ButtonGetCapabilities
+        'Label4
         '
-        Me.ButtonGetCapabilities.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
-        Me.ButtonGetCapabilities.Location = New System.Drawing.Point(540, 43)
-        Me.ButtonGetCapabilities.Name = &quot;ButtonGetCapabilities&quot;
-        Me.ButtonGetCapabilities.Size = New System.Drawing.Size(123, 36)
-        Me.ButtonGetCapabilities.TabIndex = 7
-        Me.ButtonGetCapabilities.Text = &quot;M&#195;&#182;glichkeiten abfragen&quot;
-        Me.ButtonGetCapabilities.UseVisualStyleBackColor = True
+        Me.Label4.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
+        Me.Label4.AutoSize = True
+        Me.Label4.Location = New System.Drawing.Point(514, 47)
+        Me.Label4.Name = &quot;Label4&quot;
+        Me.Label4.Size = New System.Drawing.Size(39, 13)
+        Me.Label4.TabIndex = 30
+        Me.Label4.Text = &quot;EPSG:&quot;
         '
-        'ButtonShowMap
+        'ComboBoxEPSG
         '
-        Me.ButtonShowMap.Anchor = CType((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
-        Me.ButtonShowMap.Location = New System.Drawing.Point(540, 397)
-        Me.ButtonShowMap.Name = &quot;ButtonShowMap&quot;
-        Me.ButtonShowMap.Size = New System.Drawing.Size(123, 36)
-        Me.ButtonShowMap.TabIndex = 8
-        Me.ButtonShowMap.Text = &quot;Test Karte anzeigen&quot;
-        Me.ButtonShowMap.UseVisualStyleBackColor = True
+        Me.ComboBoxEPSG.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
+        Me.ComboBoxEPSG.FormattingEnabled = True
+        Me.ComboBoxEPSG.Location = New System.Drawing.Point(512, 64)
+        Me.ComboBoxEPSG.Name = &quot;ComboBoxEPSG&quot;
+        Me.ComboBoxEPSG.Size = New System.Drawing.Size(121, 21)
+        Me.ComboBoxEPSG.TabIndex = 29
         '
-        'CheckedListBoxLayers
+        'ButtonFindScale
         '
-        Me.CheckedListBoxLayers.Anchor = CType(((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Left) _
-                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
-        Me.CheckedListBoxLayers.CheckOnClick = True
-        Me.CheckedListBoxLayers.FormattingEnabled = True
-        Me.CheckedListBoxLayers.HorizontalScrollbar = True
-        Me.CheckedListBoxLayers.Location = New System.Drawing.Point(20, 397)
-        Me.CheckedListBoxLayers.Name = &quot;CheckedListBoxLayers&quot;
-        Me.CheckedListBoxLayers.Size = New System.Drawing.Size(496, 109)
-        Me.CheckedListBoxLayers.TabIndex = 9
+        Me.ButtonFindScale.Anchor = CType((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
+        Me.ButtonFindScale.Location = New System.Drawing.Point(517, 265)
+        Me.ButtonFindScale.Name = &quot;ButtonFindScale&quot;
+        Me.ButtonFindScale.Size = New System.Drawing.Size(123, 36)
+        Me.ButtonFindScale.TabIndex = 28
+        Me.ButtonFindScale.Text = &quot;2. Optimale Scale finden&quot;
+        Me.ButtonFindScale.UseVisualStyleBackColor = True
         '
-        'Label3
+        'ButtonCheckAll
         '
-        Me.Label3.Anchor = CType((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Left), System.Windows.Forms.AnchorStyles)
-        Me.Label3.AutoSize = True
-        Me.Label3.Location = New System.Drawing.Point(21, 381)
-        Me.Label3.Name = &quot;Label3&quot;
-        Me.Label3.Size = New System.Drawing.Size(36, 13)
-        Me.Label3.TabIndex = 10
-        Me.Label3.Text = &quot;Layer:&quot;
+        Me.ButtonCheckAll.Location = New System.Drawing.Point(6, 24)
+        Me.ButtonCheckAll.Name = &quot;ButtonCheckAll&quot;
+        Me.ButtonCheckAll.Size = New System.Drawing.Size(60, 20)
+        Me.ButtonCheckAll.TabIndex = 27
+        Me.ButtonCheckAll.Text = &quot;alle  x&quot;
+        Me.ButtonCheckAll.UseVisualStyleBackColor = True
         '
         'ButtonCheckNone
         '
-        Me.ButtonCheckNone.Anchor = CType((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Left), System.Windows.Forms.AnchorStyles)
-        Me.ButtonCheckNone.Location = New System.Drawing.Point(212, 377)
+        Me.ButtonCheckNone.Location = New System.Drawing.Point(72, 23)
         Me.ButtonCheckNone.Name = &quot;ButtonCheckNone&quot;
         Me.ButtonCheckNone.Size = New System.Drawing.Size(60, 20)
-        Me.ButtonCheckNone.TabIndex = 13
+        Me.ButtonCheckNone.TabIndex = 26
         Me.ButtonCheckNone.Text = &quot;kein x&quot;
         Me.ButtonCheckNone.UseVisualStyleBackColor = True
         '
-        'ButtonCheckAll
+        'Label3
         '
-        Me.ButtonCheckAll.Anchor = CType((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Left), System.Windows.Forms.AnchorStyles)
-        Me.ButtonCheckAll.Location = New System.Drawing.Point(149, 377)
-        Me.ButtonCheckAll.Name = &quot;ButtonCheckAll&quot;
-        Me.ButtonCheckAll.Size = New System.Drawing.Size(60, 20)
-        Me.ButtonCheckAll.TabIndex = 14
-        Me.ButtonCheckAll.Text = &quot;alle  x&quot;
-        Me.ButtonCheckAll.UseVisualStyleBackColor = True
+        Me.Label3.AutoSize = True
+        Me.Label3.Location = New System.Drawing.Point(3, 6)
+        Me.Label3.Name = &quot;Label3&quot;
+        Me.Label3.Size = New System.Drawing.Size(36, 13)
+        Me.Label3.TabIndex = 25
+        Me.Label3.Text = &quot;Layer:&quot;
         '
-        'ComboBoxEPSG
+        'CheckedListBoxLayers
         '
-        Me.ComboBoxEPSG.Anchor = CType((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Left), System.Windows.Forms.AnchorStyles)
-        Me.ComboBoxEPSG.FormattingEnabled = True
-        Me.ComboBoxEPSG.Location = New System.Drawing.Point(20, 526)
-        Me.ComboBoxEPSG.Name = &quot;ComboBoxEPSG&quot;
-        Me.ComboBoxEPSG.Size = New System.Drawing.Size(121, 21)
-        Me.ComboBoxEPSG.TabIndex = 15
+        Me.CheckedListBoxLayers.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
+                    Or System.Windows.Forms.AnchorStyles.Left) _
+                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
+        Me.CheckedListBoxLayers.CheckOnClick = True
+        Me.CheckedListBoxLayers.FormattingEnabled = True
+        Me.CheckedListBoxLayers.HorizontalScrollbar = True
+        Me.CheckedListBoxLayers.Location = New System.Drawing.Point(6, 72)
+        Me.CheckedListBoxLayers.Name = &quot;CheckedListBoxLayers&quot;
+        Me.CheckedListBoxLayers.Size = New System.Drawing.Size(496, 229)
+        Me.CheckedListBoxLayers.TabIndex = 24
         '
-        'Label4
+        'Panel2
         '
-        Me.Label4.Anchor = CType((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Left), System.Windows.Forms.AnchorStyles)
-        Me.Label4.AutoSize = True
-        Me.Label4.Location = New System.Drawing.Point(22, 509)
-        Me.Label4.Name = &quot;Label4&quot;
-        Me.Label4.Size = New System.Drawing.Size(39, 13)
-        Me.Label4.TabIndex = 16
-        Me.Label4.Text = &quot;EPSG:&quot;
+        Me.Panel2.Anchor = CType(((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Left) _
+                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
+        Me.Panel2.Controls.Add(Me.TextBoxXML)
+        Me.Panel2.Controls.Add(Me.ButtonGetCapabilities)
+        Me.Panel2.Controls.Add(Me.ComboBoxVersion)
+        Me.Panel2.Controls.Add(Me.Label2)
+        Me.Panel2.Controls.Add(Me.Label1)
+        Me.Panel2.Controls.Add(Me.TextBoxUrl)
+        Me.Panel2.Location = New System.Drawing.Point(20, 12)
+        Me.Panel2.Name = &quot;Panel2&quot;
+        Me.Panel2.Size = New System.Drawing.Size(643, 222)
+        Me.Panel2.TabIndex = 25
         '
-        'HScrollBar1
+        'TextBoxXML
         '
-        Me.HScrollBar1.Anchor = CType((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
-        Me.HScrollBar1.Location = New System.Drawing.Point(540, 377)
-        Me.HScrollBar1.Minimum = 1
-        Me.HScrollBar1.Name = &quot;HScrollBar1&quot;
-        Me.HScrollBar1.Size = New System.Drawing.Size(123, 17)
-        Me.HScrollBar1.TabIndex = 17
-        Me.HScrollBar1.Value = 1
+        Me.TextBoxXML.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
+                    Or System.Windows.Forms.AnchorStyles.Left) _
+                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
+        Me.TextBoxXML.Location = New System.Drawing.Point(6, 52)
+        Me.TextBoxXML.Multiline = True
+        Me.TextBoxXML.Name = &quot;TextBoxXML&quot;
+        Me.TextBoxXML.ReadOnly = True
+        Me.TextBoxXML.ScrollBars = System.Windows.Forms.ScrollBars.Both
+        Me.TextBoxXML.Size = New System.Drawing.Size(627, 167)
+        Me.TextBoxXML.TabIndex = 13
+        Me.TextBoxXML.WordWrap = False
         '
-        'Label5
+        'ButtonGetCapabilities
         '
-        Me.Label5.Anchor = CType((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Left), System.Windows.Forms.AnchorStyles)
-        Me.Label5.AutoSize = True
-        Me.Label5.Location = New System.Drawing.Point(148, 509)
-        Me.Label5.Name = &quot;Label5&quot;
-        Me.Label5.Size = New System.Drawing.Size(42, 13)
-        Me.Label5.TabIndex = 18
-        Me.Label5.Text = &quot;Format:&quot;
+        Me.ButtonGetCapabilities.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
+        Me.ButtonGetCapabilities.Location = New System.Drawing.Point(517, 9)
+        Me.ButtonGetCapabilities.Name = &quot;ButtonGetCapabilities&quot;
+        Me.ButtonGetCapabilities.Size = New System.Drawing.Size(123, 36)
+        Me.ButtonGetCapabilities.TabIndex = 12
+        Me.ButtonGetCapabilities.Text = &quot;1. M&#195;&#182;glichkeiten abfragen&quot;
+        Me.ButtonGetCapabilities.UseVisualStyleBackColor = True
         '
-        'ComboBoxFormat
+        'ComboBoxVersion
         '
-        Me.ComboBoxFormat.Anchor = CType((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Left), System.Windows.Forms.AnchorStyles)
-        Me.ComboBoxFormat.FormattingEnabled = True
-        Me.ComboBoxFormat.Location = New System.Drawing.Point(151, 526)
-        Me.ComboBoxFormat.Name = &quot;ComboBoxFormat&quot;
-        Me.ComboBoxFormat.Size = New System.Drawing.Size(121, 21)
-        Me.ComboBoxFormat.TabIndex = 19
+        Me.ComboBoxVersion.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
+        Me.ComboBoxVersion.FormattingEnabled = True
+        Me.ComboBoxVersion.Items.AddRange(New Object() {&quot;1.0.0&quot;, &quot;1.1.0&quot;, &quot;1.1.1&quot;, &quot;1.3.0&quot;})
+        Me.ComboBoxVersion.Location = New System.Drawing.Point(412, 25)
+        Me.ComboBoxVersion.MaxDropDownItems = 3
+        Me.ComboBoxVersion.Name = &quot;ComboBoxVersion&quot;
+        Me.ComboBoxVersion.Size = New System.Drawing.Size(84, 21)
+        Me.ComboBoxVersion.TabIndex = 11
         '
-        'ComboBoxBBox
+        'Label2
         '
-        Me.ComboBoxBBox.Anchor = CType(((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Left) _
-                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
-        Me.ComboBoxBBox.FormattingEnabled = True
-        Me.ComboBoxBBox.Location = New System.Drawing.Point(20, 567)
-        Me.ComboBoxBBox.Name = &quot;ComboBoxBBox&quot;
-        Me.ComboBoxBBox.Size = New System.Drawing.Size(496, 21)
-        Me.ComboBoxBBox.TabIndex = 20
+        Me.Label2.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
+        Me.Label2.AutoSize = True
+        Me.Label2.Location = New System.Drawing.Point(409, 9)
+        Me.Label2.Name = &quot;Label2&quot;
+        Me.Label2.Size = New System.Drawing.Size(75, 13)
+        Me.Label2.TabIndex = 10
+        Me.Label2.Text = &quot;WMS-Version:&quot;
         '
-        'Label6
+        'Label1
         '
-        Me.Label6.Anchor = CType((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Left), System.Windows.Forms.AnchorStyles)
-        Me.Label6.AutoSize = True
-        Me.Label6.Location = New System.Drawing.Point(22, 550)
-        Me.Label6.Name = &quot;Label6&quot;
-        Me.Label6.Size = New System.Drawing.Size(35, 13)
-        Me.Label6.TabIndex = 21
-        Me.Label6.Text = &quot;BBox:&quot;
+        Me.Label1.Anchor = CType(((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Left) _
+                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
+        Me.Label1.AutoSize = True
+        Me.Label1.Location = New System.Drawing.Point(3, 9)
+        Me.Label1.Name = &quot;Label1&quot;
+        Me.Label1.Size = New System.Drawing.Size(205, 13)
+        Me.Label1.TabIndex = 9
+        Me.Label1.Text = &quot;http Adresse des WMS-Servers eingeben:&quot;
         '
-        'ComboBoxBBoxI
+        'TextBoxUrl
         '
-        Me.ComboBoxBBoxI.Anchor = CType((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Left), System.Windows.Forms.AnchorStyles)
-        Me.ComboBoxBBoxI.FormattingEnabled = True
-        Me.ComboBoxBBoxI.Location = New System.Drawing.Point(20, 580)
-        Me.ComboBoxBBoxI.Name = &quot;ComboBoxBBoxI&quot;
-        Me.ComboBoxBBoxI.Size = New System.Drawing.Size(252, 21)
-        Me.ComboBoxBBoxI.TabIndex = 22
-        Me.ComboBoxBBoxI.Visible = False
+        Me.TextBoxUrl.Anchor = CType(((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Left) _
+                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
+        Me.TextBoxUrl.Location = New System.Drawing.Point(6, 25)
+        Me.TextBoxUrl.Name = &quot;TextBoxUrl&quot;
+        Me.TextBoxUrl.Size = New System.Drawing.Size(400, 20)
+        Me.TextBoxUrl.TabIndex = 8
         '
-        'ButtonFindScale
-        '
-        Me.ButtonFindScale.Anchor = CType((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
-        Me.ButtonFindScale.Location = New System.Drawing.Point(540, 439)
-        Me.ButtonFindScale.Name = &quot;ButtonFindScale&quot;
-        Me.ButtonFindScale.Size = New System.Drawing.Size(123, 36)
-        Me.ButtonFindScale.TabIndex = 23
-        Me.ButtonFindScale.Text = &quot;Optimale Scale finden&quot;
-        Me.ButtonFindScale.UseVisualStyleBackColor = True
-        '
         'capxml2wms
         '
         Me.AutoScaleDimensions = New System.Drawing.SizeF(6.0!, 13.0!)
         Me.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font
         Me.ClientSize = New System.Drawing.Size(675, 601)
-        Me.Controls.Add(Me.ButtonFindScale)
-        Me.Controls.Add(Me.ComboBoxBBoxI)
-        Me.Controls.Add(Me.Label6)
-        Me.Controls.Add(Me.ComboBoxBBox)
-        Me.Controls.Add(Me.ComboBoxFormat)
-        Me.Controls.Add(Me.Label5)
-        Me.Controls.Add(Me.HScrollBar1)
-        Me.Controls.Add(Me.Label4)
-        Me.Controls.Add(Me.ComboBoxEPSG)
-        Me.Controls.Add(Me.ButtonCheckAll)
-        Me.Controls.Add(Me.ButtonCheckNone)
-        Me.Controls.Add(Me.Label3)
-        Me.Controls.Add(Me.CheckedListBoxLayers)
-        Me.Controls.Add(Me.ButtonShowMap)
-        Me.Controls.Add(Me.ButtonGetCapabilities)
-        Me.Controls.Add(Me.ComboBoxVersion)
-        Me.Controls.Add(Me.Label2)
-        Me.Controls.Add(Me.TextBoxXML)
-        Me.Controls.Add(Me.Label1)
-        Me.Controls.Add(Me.TextBoxUrl)
+        Me.Controls.Add(Me.Panel2)
+        Me.Controls.Add(Me.Panel1)
         Me.Controls.Add(Me.ButtonErstellen)
         Me.Icon = CType(resources.GetObject(&quot;$this.Icon&quot;), System.Drawing.Icon)
         Me.Name = &quot;capxml2wms&quot;
         Me.Text = &quot;capxml2wms&quot;
+        Me.Panel1.ResumeLayout(False)
+        Me.Panel1.PerformLayout()
+        Me.Panel2.ResumeLayout(False)
+        Me.Panel2.PerformLayout()
         Me.ResumeLayout(False)
-        Me.PerformLayout()
 
     End Sub
     Private WithEvents ButtonErstellen As System.Windows.Forms.Button
-    Private WithEvents TextBoxUrl As System.Windows.Forms.TextBox
-    Private WithEvents Label1 As System.Windows.Forms.Label
-    Private WithEvents TextBoxXML As System.Windows.Forms.TextBox
-    Private WithEvents ComboBoxVersion As System.Windows.Forms.ComboBox
-    Private WithEvents Label2 As System.Windows.Forms.Label
-    Private WithEvents ButtonGetCapabilities As System.Windows.Forms.Button
-    Private WithEvents ButtonShowMap As System.Windows.Forms.Button
-    Private WithEvents CheckedListBoxLayers As System.Windows.Forms.CheckedListBox
-    Private WithEvents Label3 As System.Windows.Forms.Label
-    Private WithEvents ButtonCheckNone As System.Windows.Forms.Button
+    Friend WithEvents Panel1 As System.Windows.Forms.Panel
+    Private WithEvents ButtonFindScale As System.Windows.Forms.Button
     Private WithEvents ButtonCheckAll As System.Windows.Forms.Button
+    Private WithEvents ButtonCheckNone As System.Windows.Forms.Button
+    Private WithEvents Label3 As System.Windows.Forms.Label
+    Private WithEvents CheckedListBoxLayers As System.Windows.Forms.CheckedListBox
+    Private WithEvents ComboBoxBBoxI As System.Windows.Forms.ComboBox
+    Private WithEvents Label6 As System.Windows.Forms.Label
+    Private WithEvents ComboBoxBBox As System.Windows.Forms.ComboBox
+    Private WithEvents ComboBoxFormat As System.Windows.Forms.ComboBox
+    Private WithEvents Label5 As System.Windows.Forms.Label
     Private WithEvents Label4 As System.Windows.Forms.Label
     Private WithEvents ComboBoxEPSG As System.Windows.Forms.ComboBox
-    Private WithEvents HScrollBar1 As System.Windows.Forms.HScrollBar
-    Private WithEvents Label5 As System.Windows.Forms.Label
-    Private WithEvents ComboBoxFormat As System.Windows.Forms.ComboBox
-    Private WithEvents ComboBoxBBox As System.Windows.Forms.ComboBox
-    Private WithEvents Label6 As System.Windows.Forms.Label
-    Private WithEvents ComboBoxBBoxI As System.Windows.Forms.ComboBox
-    Private WithEvents ButtonFindScale As System.Windows.Forms.Button
+    Friend WithEvents Panel2 As System.Windows.Forms.Panel
+    Private WithEvents TextBoxXML As System.Windows.Forms.TextBox
+    Private WithEvents ButtonGetCapabilities As System.Windows.Forms.Button
+    Private WithEvents ComboBoxVersion As System.Windows.Forms.ComboBox
+    Private WithEvents Label2 As System.Windows.Forms.Label
+    Private WithEvents Label1 As System.Windows.Forms.Label
+    Private WithEvents TextBoxUrl As System.Windows.Forms.TextBox
 
 End Class

Modified: trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.resx
===================================================================
--- trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.resx	2011-04-03 14:26:55 UTC (rev 2971)
+++ trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.resx	2011-04-05 16:04:48 UTC (rev 2972)
@@ -112,12 +112,12 @@
     &lt;value&gt;2.0&lt;/value&gt;
   &lt;/resheader&gt;
   &lt;resheader name=&quot;reader&quot;&gt;
-    &lt;value&gt;System.Resources.ResXResourceReader, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/value&gt;
+    &lt;value&gt;System.Resources.ResXResourceReader, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/value&gt;
   &lt;/resheader&gt;
   &lt;resheader name=&quot;writer&quot;&gt;
-    &lt;value&gt;System.Resources.ResXResourceWriter, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/value&gt;
+    &lt;value&gt;System.Resources.ResXResourceWriter, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/value&gt;
   &lt;/resheader&gt;
-  &lt;assembly alias=&quot;System.Drawing&quot; name=&quot;System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&quot; /&gt;
+  &lt;assembly alias=&quot;System.Drawing&quot; name=&quot;System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&quot; /&gt;
   &lt;data name=&quot;$this.Icon&quot; type=&quot;System.Drawing.Icon, System.Drawing&quot; mimetype=&quot;application/x-microsoft.net.object.bytearray.base64&quot;&gt;
     &lt;value&gt;
         AAABAAEAMC8AAAEAGAAQHAAAFgAAACgAAAAwAAAAXgAAAAEAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

Modified: trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.vb
===================================================================
--- trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.vb	2011-04-03 14:26:55 UTC (rev 2971)
+++ trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.vb	2011-04-05 16:04:48 UTC (rev 2972)
@@ -85,39 +85,13 @@
         End If
         CheckedListBoxLayers.Items.Add(Layername, False)
     End Sub
-
-    Private Sub ButtonGetCapabilities_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ButtonGetCapabilities.Click
-        GotCapabilities = GetCapabilities()
-        maxScale = 1000
-        minScale = 0
-        If Not recScale Is Nothing Then
-            recScale.Clear()
-        End If
-    End Sub
-
-    Private Sub ButtonShowMap_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ButtonShowMap.Click
-        Dim MeineSkalierung As Double
-        MeineSkalierung = 2.0 * Me.HScrollBar1.Value
-        mapUrl = makeGetMapUrl(MeineSkalierung)
-        Dim center As point
-        center.x = 0
-        center.y = 0
-        Dim SM As New Map(mapUrl, 0, 0, 0, center)
-        'MsgBox(&quot;Noch nicht vorhanden!&quot;, MsgBoxStyle.Information, &quot;Hinweis!&quot;)
-        SM.ButtonAddToRecommendedScale.Visible = False
-        SM.ButtonHelp.Visible = False
-        SM.ButtonScaleDown.Visible = False
-        SM.ButtonScaleUp.Visible = False
-        SM.ButtonUseAsMaxScale.Visible = False
-        SM.ButtonUseAsMinScale.Visible = False
-        SM.LabelScaleDiagonal.Visible = False
-        SM.LabelScaleVertical.Visible = False
-        SM.ShowDialog()
-    End Sub
     Friend _srs As Integer
     Friend _pixelwidth As Integer
     Private Sub ButtonFindScale_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ButtonFindScale.Click
         Dim BBoxString As String
+        If Me.ComboBoxEPSG.Items.Count = 0 Then
+            Return
+        End If
 
         _srs = Me.ComboBoxEPSG.SelectedItem
 
@@ -199,75 +173,7 @@
         mapUrl += &quot;&amp;FORMAT=&quot; &amp; Me.ComboBoxFormat.SelectedItem.ToString
         makeGetMapUrlFromBBox = mapUrl
     End Function
-    Private Function makeGetMapUrl(ByVal scale As Double) As String
-        '<A HREF="http://">http://</A> www.lv-bw.de/dv/service/getrds2.asp?login=dv&amp;pw=anonymous
-        '&amp;SERVICE=WMS&amp;VERSION=1.1.1&amp;REQUEST=GetMap
-        '&amp;SRS=EPSG:31467
-        '&amp;BBOX=3500394.51 , 5371405.09 , 3520394.51 , 5391405.09 
-        '&amp;WIDTH=1000
-        '&amp;HEIGHT=1000
-        '&amp;LAYERS=DVTK50K
-        '&amp;STYLES=
-        '&amp;FORMAT=image/png
-
-
-        mapUrl = wmsUrl &amp; &quot;SERVICE=WMS&amp;VERSION=&quot; &amp; Version &amp; &quot;&amp;REQUEST=GetMap&quot;
-
-        mapUrl += &quot;&amp;SRS=EPSG:&quot; &amp; Me.ComboBoxEPSG.SelectedItem
-
-        Dim rxmin As Double
-        Dim rxmax As Double
-        Dim rymin As Double
-        Dim rymax As Double
-
-        If Me.ComboBoxEPSG.SelectedItem = &quot;4326&quot; Then
-            Me.ComboBoxBBoxI.SelectedIndex = Me.ComboBoxBBox.SelectedIndex
-            GetBBoxValues(Me.ComboBoxBBoxI.SelectedItem)
-        Else
-            Try
-                GetBBoxValues(Me.OBBoxes.Item(&quot;EPSG:&quot; &amp; Me.ComboBoxEPSG.SelectedItem))
-            Catch ex As Exception
-                'todo: und jetzt umrechnen !
-                'das spar ich mir wohl, oder !
-                Me.ComboBoxBBoxI.SelectedIndex = Me.ComboBoxBBox.SelectedIndex
-                GetBBoxValues(Me.ComboBoxBBoxI.SelectedItem)
-                ' jetzt haben wir die BBox zum WGS84
-                MsgBox(&quot;Kartenansicht f&#252;r diese Auswahl nicht implementiert&quot;, MsgBoxStyle.Exclamation)
-                Exit Function
-            End Try
-        End If
-
-        Dim HalbeKantenlaengex As Double = (rmaxx - rminx) / scale
-        Dim HalbeKantenlaengey As Double = (rmaxy - rminy) / scale
-        Dim HalbeKantenlaenge As Double = HalbeKantenlaengex
-        If HalbeKantenlaengex &gt; HalbeKantenlaengey Then
-            HalbeKantenlaenge = HalbeKantenlaengey
-        End If
-        ' is in x und y die gleiche Einheit?
-        rxmin = rxmitte - HalbeKantenlaenge
-        rxmax = rxmitte + HalbeKantenlaenge
-        rymin = rymitte - HalbeKantenlaenge
-        rymax = rymitte + HalbeKantenlaenge
-
-        Dim BBox As String = &quot;&amp;BBox=&quot; &amp; rxmin.ToString(DPunkt) &amp; &quot;,&quot; &amp; rymin.ToString(DPunkt) &amp; &quot;,&quot;
-        BBox += rxmax.ToString(DPunkt) &amp; &quot;,&quot; &amp; rymax.ToString(DPunkt)
-
-        mapUrl += BBox
-        mapUrl += &quot;&amp;WIDTH=500&quot;
-        mapUrl += &quot;&amp;HEIGHT=500&quot;
-        ' und die gew&#228;hlten Layer durch Komma getrennt
-        Dim SelectedLayers As String = &quot;&quot;
-        For Each s As String In CheckedListBoxLayers.CheckedItems
-            SelectedLayers += &quot;,&quot; &amp; s.Split(&quot;|&quot;)(0)
-        Next
-        If SelectedLayers &lt;&gt; &quot;&quot; Then
-            mapUrl += &quot;&amp;LAYERS=&quot; &amp; SelectedLayers.Substring(1).Replace(&quot; &quot;, &quot;%20&quot;)
-        End If
-        mapUrl += &quot;&amp;STYLES=&quot;
-        mapUrl += &quot;&amp;FORMAT=&quot; &amp; Me.ComboBoxFormat.SelectedItem.ToString
-        makeGetMapUrl = mapUrl
-    End Function
-
+    
     Friend Function metersToBBoxVertical(ByVal epsg As Integer) As Double
         If epsg = 4326 Then
             metersToBBoxVertical = 360 / (WGS84.a * Math.PI * 2)
@@ -297,15 +203,19 @@
     End Function
     Private Sub ButtonErstellen_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ButtonErstellen.Click
 
+        If Not GotCapabilities Then
+            GotCapabilities = GetCapabilities()
+        End If
+        If Not GotCapabilities Then
+            Return
+        End If
+
+
         Dim wmsFileName As String = IO.Path.ChangeExtension(xmlFileName, &quot;.wms&quot;)
         IO.File.Delete(wmsFileName) 'vorsichtshalber
         Dim encoding As System.Text.Encoding = New System.Text.UTF8Encoding(False)
         Dim F As New System.IO.StreamWriter(wmsFileName, False, encoding)
 
-        If Not GotCapabilities Then
-            GotCapabilities = GetCapabilities()
-        End If
-
         Me.ComboBoxBBoxI.SelectedIndex = Me.ComboBoxBBox.SelectedIndex
         GetBBoxValues(Me.ComboBoxBBoxI.SelectedItem)
 
@@ -337,7 +247,7 @@
         F.WriteLine(&quot;StylesUrlPart:     STYLES=&quot;)
         F.WriteLine(&quot;ImageFormatUrlPart:FORMAT=&quot; &amp; Me.ComboBoxFormat.SelectedItem.ToString)
         F.WriteLine(&quot;BoundingBoxTopLeftWGS84: &quot; &amp; maxy &amp; &quot; &quot; &amp; minx)
-        F.WriteLine(&quot;BoundingBoxButtomRightWGS84: &quot; &amp; miny &amp; &quot; &quot; &amp; maxx)
+        F.WriteLine(&quot;BoundingBoxBottomRightWGS84: &quot; &amp; miny &amp; &quot; &quot; &amp; maxx)
         F.WriteLine(&quot;#BBox_Mitte: &quot; &amp; mittey &amp; &quot; &quot; &amp; mittex)
         F.WriteLine(&quot;MinScale:   &quot; &amp; (Math.Ceiling(minScale * 10000) / 10000).ToString(DPunkt))
         F.WriteLine(&quot;MaxScale:   &quot; &amp; (Math.Floor(maxScale * 10000) / 10000).ToString(DPunkt))
@@ -425,7 +335,6 @@
 
     Private Sub TextBoxUrl_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBoxUrl.TextChanged
         GotCapabilities = False
-        Me.ButtonShowMap.Enabled = False
         wmsUrl = Me.TextBoxUrl.Text
         capsUrl = Me.TextBoxUrl.Text
     End Sub
@@ -500,8 +409,6 @@
         Me.TextBoxXML.Text = System.Text.Encoding.UTF8.GetString(ms.GetBuffer())
         ms.Close()
 
-        Me.ButtonShowMap.Enabled = True
-
         '1. Version aus WMT_MS_Capabilities
         For Each nl As XmlNode In xd.GetElementsByTagName(&quot;WMT_MS_Capabilities&quot;)
             If nl.NodeType = XmlNodeType.Element Then
@@ -522,16 +429,22 @@
             End If
         Next
 
+        If Caps Is Nothing Then
+            Return False
+        End If
+
         '2. OnlineResource  aus Service
-        For Each nl As XmlNode In Service
-            If nl.NodeType = XmlNodeType.Element Then
-                If nl.Name = &quot;OnlineResource&quot; Then
-                    Dim ne As XmlElement = nl
-                    OnlineResource = ne.GetAttribute(&quot;xlink:href&quot;)
-                    Exit For
+        If Not Service Is Nothing Then
+            For Each nl As XmlNode In Service
+                If nl.NodeType = XmlNodeType.Element Then
+                    If nl.Name = &quot;OnlineResource&quot; Then
+                        Dim ne As XmlElement = nl
+                        OnlineResource = ne.GetAttribute(&quot;xlink:href&quot;)
+                        Exit For
+                    End If
                 End If
-            End If
-        Next
+            Next
+        End If
 
         Dim Request As XmlElement = Nothing
         Dim Exception As XmlElement = Nothing
@@ -558,7 +471,7 @@
             End If
         Next
         If Layer Is Nothing Then
-            Exit Function
+            Return False
         End If
 
         Dim ltmp() As String
@@ -589,16 +502,6 @@
                 End If
             Next
         Next
-        Me.ComboBoxEPSG.SelectedIndex = -1
-        For i As Integer = 0 To Me.ComboBoxEPSG.Items.Count - 1
-            If Me.ComboBoxEPSG.Items.Item(i) = &quot;4326&quot; Then
-                Me.ComboBoxEPSG.SelectedIndex = i
-                Exit For
-            Else
-                'falls &#252;berhaupt was drin steht
-                Me.ComboBoxEPSG.SelectedIndex = 0
-            End If
-        Next
 
         '11.
         Me.ComboBoxFormat.Items.Clear()
@@ -676,23 +579,45 @@
             If n.NodeType = XmlNodeType.Element Then
                 Dim e As XmlElement = n
                 Dim stmp As String = e.GetAttribute(&quot;SRS&quot;)
-                If Not OBBoxes.ContainsKey(stmp) Then
-                    OBBoxes.Add(stmp, e)
+                If Not stmp = &quot;EPSG:4326&quot; Then
+                    If Not OBBoxes.ContainsKey(stmp) Then
+                        OBBoxes.Add(stmp, e)
+                    End If
                 End If
             End If
         Next
+        '&lt;LatLonBoundingBox minx=&quot;8.334125&quot; miny=&quot;44.552846&quot; maxx=&quot;11.658327&quot; maxy=&quot;46.739748&quot; /&gt;
         If Not OBBoxes.ContainsKey(&quot;EPSG:4326&quot;) Then
             For Each n As XmlNode In Layer.GetElementsByTagName(&quot;LatLonBoundingBox&quot;)
                 If n.NodeType = XmlNodeType.Element Then
                     Dim e As XmlElement = n
-                    Dim stmp As String = e.GetAttribute(&quot;SRS&quot;)
-                    If Not stmp = &quot;&quot; And Not OBBoxes.ContainsKey(stmp) Then
+                    If Not OBBoxes.ContainsKey(&quot;EPSG:4326&quot;) Then
                         OBBoxes.Add(&quot;EPSG:4326&quot;, e)
+                        If Me.ComboBoxEPSG.Items.Count = 0 Then
+                            Dim s As String = &quot;4326&quot;
+                            SRSD.Add(&quot;SRS=EPSG:&quot; &amp; s, &quot; &quot;)
+                            SRS = SRS &amp; &quot;SRS=EPSG:&quot; &amp; s &amp; &quot; &quot;
+                            SRSCW = SRSCW &amp; &quot; &quot; &amp; s
+                            ComboBoxEPSG.Items.Add(s)
+                        End If
                     End If
                 End If
             Next
         End If
 
+        ' 14 Nacharbeiten
+        Me.ComboBoxEPSG.SelectedIndex = -1
+        For i As Integer = 0 To Me.ComboBoxEPSG.Items.Count - 1
+            If Me.ComboBoxEPSG.Items.Item(i) = &quot;4326&quot; Then
+                Me.ComboBoxEPSG.SelectedIndex = i
+                Exit For
+            Else
+                'falls &#252;berhaupt was drin steht
+                Me.ComboBoxEPSG.SelectedIndex = 0
+            End If
+        Next
+
+
         ButtonCheckAll_Click(Nothing, Nothing)
         Return True
 
@@ -709,6 +634,9 @@
         'Dim rminy As Double
         'Dim rmaxx As Double
         'Dim rmaxy As Double
+        If e Is Nothing Then
+            Return
+        End If
         minx = e.GetAttribute(&quot;minx&quot;)
         rminx = Double.Parse(minx, DPunkt.NumberFormat)
         minx = Format(rminx, &quot;0.0000&quot;).Replace(&quot;,&quot;, &quot;.&quot;)
@@ -798,4 +726,12 @@
 
     End Function
 
+    Private Sub ButtonGetCapabilities_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ButtonGetCapabilities.Click
+        GotCapabilities = GetCapabilities()
+        maxScale = 1000
+        minScale = 0
+        If Not recScale Is Nothing Then
+            recScale.Clear()
+        End If
+    End Sub
 End Class

Modified: trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.vbproj
===================================================================
--- trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.vbproj	2011-04-03 14:26:55 UTC (rev 2971)
+++ trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.vbproj	2011-04-05 16:04:48 UTC (rev 2972)
@@ -1,5 +1,5 @@
 &#239;&#187;&#191;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
-&lt;Project DefaultTargets=&quot;Build&quot; xmlns=&quot;<A HREF="http://schemas.microsoft.com/developer/msbuild/2003">http://schemas.microsoft.com/developer/msbuild/2003</A>&quot; ToolsVersion=&quot;3.5&quot;&gt;
+&lt;Project DefaultTargets=&quot;Build&quot; xmlns=&quot;<A HREF="http://schemas.microsoft.com/developer/msbuild/2003">http://schemas.microsoft.com/developer/msbuild/2003</A>&quot; ToolsVersion=&quot;4.0&quot;&gt;
   &lt;PropertyGroup&gt;
     &lt;Configuration Condition=&quot; '$(Configuration)' == '' &quot;&gt;Debug&lt;/Configuration&gt;
     &lt;Platform Condition=&quot; '$(Platform)' == '' &quot;&gt;AnyCPU&lt;/Platform&gt;
@@ -14,10 +14,11 @@
     &lt;ApplicationIcon&gt;gc.ico&lt;/ApplicationIcon&gt;
     &lt;FileUpgradeFlags&gt;
     &lt;/FileUpgradeFlags&gt;
-    &lt;OldToolsVersion&gt;2.0&lt;/OldToolsVersion&gt;
-    &lt;TargetFrameworkVersion&gt;v3.5&lt;/TargetFrameworkVersion&gt;
+    &lt;OldToolsVersion&gt;3.5&lt;/OldToolsVersion&gt;
+    &lt;TargetFrameworkVersion&gt;v4.0&lt;/TargetFrameworkVersion&gt;
     &lt;UpgradeBackupLocation&gt;
     &lt;/UpgradeBackupLocation&gt;
+    &lt;IsWebBootstrapper&gt;false&lt;/IsWebBootstrapper&gt;
     &lt;PublishUrl&gt;publish\&lt;/PublishUrl&gt;
     &lt;Install&gt;true&lt;/Install&gt;
     &lt;InstallFrom&gt;Disk&lt;/InstallFrom&gt;
@@ -30,7 +31,6 @@
     &lt;MapFileExtensions&gt;true&lt;/MapFileExtensions&gt;
     &lt;ApplicationRevision&gt;0&lt;/ApplicationRevision&gt;
     &lt;ApplicationVersion&gt;1.0.0.%2a&lt;/ApplicationVersion&gt;
-    &lt;IsWebBootstrapper&gt;false&lt;/IsWebBootstrapper&gt;
     &lt;UseApplicationTrust&gt;false&lt;/UseApplicationTrust&gt;
     &lt;BootstrapperEnabled&gt;true&lt;/BootstrapperEnabled&gt;
   &lt;/PropertyGroup&gt;
@@ -41,7 +41,7 @@
     &lt;DefineTrace&gt;true&lt;/DefineTrace&gt;
     &lt;OutputPath&gt;bin\Debug\&lt;/OutputPath&gt;
     &lt;DocumentationFile&gt;capxml2wms.xml&lt;/DocumentationFile&gt;
-    &lt;NoWarn&gt;42016,41999,42017,42018,42019,42032,42036,42020,42021,42022&lt;/NoWarn&gt;
+    &lt;NoWarn&gt;42016,41999,42017,42018,42019,42032,42036,42020,42021,42022,42353,42354,42355&lt;/NoWarn&gt;
   &lt;/PropertyGroup&gt;
   &lt;PropertyGroup Condition=&quot; '$(Configuration)|$(Platform)' == 'Release|AnyCPU' &quot;&gt;
     &lt;DebugType&gt;pdbonly&lt;/DebugType&gt;
@@ -50,7 +50,7 @@
     &lt;Optimize&gt;true&lt;/Optimize&gt;
     &lt;OutputPath&gt;bin\Release\&lt;/OutputPath&gt;
     &lt;DocumentationFile&gt;capxml2wms.xml&lt;/DocumentationFile&gt;
-    &lt;NoWarn&gt;42016,41999,42017,42018,42019,42032,42036,42020,42021,42022&lt;/NoWarn&gt;
+    &lt;NoWarn&gt;42016,41999,42017,42018,42019,42032,42036,42020,42021,42022,42353,42354,42355&lt;/NoWarn&gt;
   &lt;/PropertyGroup&gt;
   &lt;ItemGroup&gt;
     &lt;Reference Include=&quot;System&quot; /&gt;
@@ -133,7 +133,7 @@
   &lt;ItemGroup&gt;
     &lt;BootstrapperPackage Include=&quot;Microsoft.Net.Client.3.5&quot;&gt;
       &lt;Visible&gt;False&lt;/Visible&gt;
-      &lt;ProductName&gt;.NET Framework Client Profile&lt;/ProductName&gt;
+      &lt;ProductName&gt;.NET Framework 3.5 SP1 Client Profile&lt;/ProductName&gt;
       &lt;Install&gt;false&lt;/Install&gt;
     &lt;/BootstrapperPackage&gt;
     &lt;BootstrapperPackage Include=&quot;Microsoft.Net.Framework.2.0&quot;&gt;

Modified: trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.vbproj.user
===================================================================
--- trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.vbproj.user	2011-04-03 14:26:55 UTC (rev 2971)
+++ trunk/tools/MakeWMSFile/capxml2wms/capxml2wms.vbproj.user	2011-04-05 16:04:48 UTC (rev 2972)
@@ -1,4 +1,5 @@
-&#239;&#187;&#191;&lt;Project xmlns=&quot;<A HREF="http://schemas.microsoft.com/developer/msbuild/2003">http://schemas.microsoft.com/developer/msbuild/2003</A>&quot;&gt;
+&#239;&#187;&#191;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
+&lt;Project xmlns=&quot;<A HREF="http://schemas.microsoft.com/developer/msbuild/2003">http://schemas.microsoft.com/developer/msbuild/2003</A>&quot;&gt;
   &lt;PropertyGroup&gt;
     &lt;PublishUrlHistory&gt;<A HREF="http://localhost/capxml2wms/&lt;/PublishUrlHistory">http://localhost/capxml2wms/&lt;/PublishUrlHistory</A>&gt;
     &lt;InstallUrlHistory&gt;

Modified: trunk/tools/MakeWMSFile/capxml2wms.sln
===================================================================
--- trunk/tools/MakeWMSFile/capxml2wms.sln	2011-04-03 14:26:55 UTC (rev 2971)
+++ trunk/tools/MakeWMSFile/capxml2wms.sln	2011-04-05 16:04:48 UTC (rev 2972)
@@ -1,6 +1,6 @@
 &#239;&#187;&#191;
-Microsoft Visual Studio Solution File, Format Version 10.00
-# Visual Basic Express 2008
+Microsoft Visual Studio Solution File, Format Version 11.00
+# Visual Basic Express 2010
 Project(&quot;{F184B08F-C81C-45F6-A57F-5ABD9991F28F}&quot;) = &quot;capxml2wms&quot;, &quot;capxml2wms\capxml2wms.vbproj&quot;, &quot;{623B1E12-B5BF-4835-A982-AE5500BFADC8}&quot;
 EndProject
 Global


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002962.html">[Cachewolf-svn] r2971 - in trunk/src/CacheWolf: . navi
</A></li>
	<LI>Next message: <A HREF="002964.html">[Cachewolf-svn] r2973 - trunk/src/CacheWolf/navi
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2963">[ date ]</a>
              <a href="thread.html#2963">[ thread ]</a>
              <a href="subject.html#2963">[ subject ]</a>
              <a href="author.html#2963">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/cachewolf-svn">More information about the Cachewolf-svn
mailing list</a><br>
</body></html>

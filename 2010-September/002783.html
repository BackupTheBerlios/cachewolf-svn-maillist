<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Cachewolf-svn] r2795 - in trunk/src/CacheWolf: . imp navi
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/cachewolf-svn/2010-September/index.html" >
   <LINK REL="made" HREF="mailto:cachewolf-svn%40lists.berlios.de?Subject=Re%3A%20%5BCachewolf-svn%5D%20r2795%20-%20in%20trunk/src/CacheWolf%3A%20.%20imp%20navi&In-Reply-To=%3C20100927100203.C05F848103A%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002786.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Cachewolf-svn] r2795 - in trunk/src/CacheWolf: . imp navi</H1>
    <B>araber95 at mail.berlios.de</B> 
    <A HREF="mailto:cachewolf-svn%40lists.berlios.de?Subject=Re%3A%20%5BCachewolf-svn%5D%20r2795%20-%20in%20trunk/src/CacheWolf%3A%20.%20imp%20navi&In-Reply-To=%3C20100927100203.C05F848103A%40sheep.berlios.de%3E"
       TITLE="[Cachewolf-svn] r2795 - in trunk/src/CacheWolf: . imp navi">araber95 at mail.berlios.de
       </A><BR>
    <I>Mon Sep 27 12:02:03 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002786.html">[Cachewolf-svn] r2798 - trunk/src/CacheWolf/imp
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2783">[ date ]</a>
              <a href="thread.html#2783">[ thread ]</a>
              <a href="subject.html#2783">[ subject ]</a>
              <a href="author.html#2783">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: araber95
Date: 2010-09-27 12:02:03 +0200 (Mon, 27 Sep 2010)
New Revision: 2795

Modified:
   trunk/src/CacheWolf/MainMenu.java
   trunk/src/CacheWolf/MainTab.java
   trunk/src/CacheWolf/Preferences.java
   trunk/src/CacheWolf/PreferencesScreen.java
   trunk/src/CacheWolf/imp/OCXMLImporterScreen.java
   trunk/src/CacheWolf/imp/SpiderGC.java
   trunk/src/CacheWolf/navi/MovingMap.java
   trunk/src/CacheWolf/navi/Navigate.java
Log:
import of track or route gpx with quick or detailed import of caches and showing the track on map. (Sorry for the unwanted reformatting of the sourcefile)

Modified: trunk/src/CacheWolf/MainMenu.java
===================================================================
--- trunk/src/CacheWolf/MainMenu.java	2010-09-25 17:26:01 UTC (rev 2794)
+++ trunk/src/CacheWolf/MainMenu.java	2010-09-27 10:02:03 UTC (rev 2795)
@@ -405,18 +405,7 @@
 					dir = fc.getChosenDirectory().toString();
 					pref.setImporterPath(&quot;LocGpxImporter&quot;, dir);
 					String files[] = fc.getAllChosen();
-					/*
 					int how = GPXImporter.DOIT_ASK;
-					if (files.length &gt; 0){
-							InfoBox iB = new InfoBox(&quot;Spider?&quot;, &quot;Spider Images?&quot;, InfoBox.CHECKBOX);
-							iB.execute();
-							boolean doSpider = iB.mCB_state;
-							if (doSpider) how = GPXImporter.DOIT_WITHSPOILER;
-							else how = GPXImporter.DOIT_NOSPOILER;
-					}
-					 */
-
-					int how = GPXImporter.DOIT_ASK;
 					for (int i = 0; i &lt; files.length; i++){
 						String file = dir + &quot;/&quot; + files[i];
 						if (file.endsWith(&quot;txt&quot;)||file.endsWith(&quot;log&quot;)){

Modified: trunk/src/CacheWolf/MainTab.java
===================================================================
--- trunk/src/CacheWolf/MainTab.java	2010-09-25 17:26:01 UTC (rev 2794)
+++ trunk/src/CacheWolf/MainTab.java	2010-09-27 10:02:03 UTC (rev 2795)
@@ -66,7 +66,7 @@
 	MainMenu mnuMain;
 	public StatusBar statBar;
 	public MovingMap mm;
-	Navigate nav;
+	public Navigate nav;
 	public String mainCache=&quot;&quot;;
 	int oldCard=0;
 	boolean cacheDirty=false;

Modified: trunk/src/CacheWolf/Preferences.java
===================================================================
--- trunk/src/CacheWolf/Preferences.java	2010-09-25 17:26:01 UTC (rev 2794)
+++ trunk/src/CacheWolf/Preferences.java	2010-09-27 10:02:03 UTC (rev 2795)
@@ -25,7 +25,6 @@
     */
 package CacheWolf;
 
-import CacheWolf.imp.SpiderGC;
 import CacheWolf.navi.Metrics;
 import CacheWolf.navi.TransformCoordinates;
 import CacheWolf.utils.FileBugfix;
@@ -445,7 +444,6 @@
 			myAlias = SafeXML.cleanback(atts.getValue(&quot;name&quot;));
 			tmp = SafeXML.cleanback(atts.getValue(&quot;password&quot;));
 			if (tmp != null) password=tmp;
-			SpiderGC.passwort=password;
 		}
 		else if(name.equals(&quot;alias2&quot;)) myAlias2 = SafeXML.cleanback(atts.getValue(&quot;name&quot;));
 		else if(name.equals(&quot;gcmemberid&quot;)) {

Modified: trunk/src/CacheWolf/PreferencesScreen.java
===================================================================
--- trunk/src/CacheWolf/PreferencesScreen.java	2010-09-25 17:26:01 UTC (rev 2794)
+++ trunk/src/CacheWolf/PreferencesScreen.java	2010-09-27 10:02:03 UTC (rev 2795)
@@ -25,7 +25,6 @@
     */
 package CacheWolf;
 
-import CacheWolf.imp.SpiderGC;
 import CacheWolf.navi.Metrics;
 import CacheWolf.utils.FileBugfix;
 import ewe.filechooser.FileChooser;
@@ -356,7 +355,7 @@
 				mApp.mainApp.font = newGuiFont;
 				
 				pref.myAlias = Alias.getText().trim();
-				SpiderGC.passwort=pref.password= inpPassword.getText().trim();
+				pref.password= inpPassword.getText().trim();
 				pref.gcMemberId=inpGcMemberID.getText().trim();
 				MyLocale.saveLanguage(MyLocale.language=inpLanguage.getText().toUpperCase().trim());
 				pref.browser = Browser.getText();

Modified: trunk/src/CacheWolf/imp/OCXMLImporterScreen.java
===================================================================
--- trunk/src/CacheWolf/imp/OCXMLImporterScreen.java	2010-09-25 17:26:01 UTC (rev 2794)
+++ trunk/src/CacheWolf/imp/OCXMLImporterScreen.java	2010-09-27 10:02:03 UTC (rev 2795)
@@ -32,6 +32,8 @@
 import CacheWolf.OC;
 import CacheWolf.Preferences;
 import CacheWolf.imp.SpiderGC.SpiderProperties;
+import ewe.filechooser.FileChooser;
+import ewe.filechooser.FileChooserBase;
 import ewe.sys.Convert;
 import ewe.ui.CellConstants;
 import ewe.ui.ControlEvent;
@@ -63,6 +65,7 @@
 	mInput maxLogsInput;
 	mCheckBox imagesCheckBox, /*mapsCheckBox, */ missingCheckBox, foundCheckBox, travelbugsCheckBox;
 	ewe.ui.mChoice domains;
+	String fileName;
 
 	mLabel distLbl;
 	mLabel maxNumberLbl;
@@ -81,6 +84,7 @@
 	public static final int MINDIST = 1024;
 	public static final int DIRECTION = 2048;
 	public static final int MAXUPDATE = 4096;
+	public static final int FILENAME = 8192; // track or route gpx
 
 
 	public OCXMLImporterScreen(String title, int options) {
@@ -205,6 +209,22 @@
 			this.addLast(missingCheckBox, CellConstants.DONTSTRETCH, CellConstants.DONTFILL|CellConstants.WEST);
 		}
 
+		if ((options &amp; FILENAME) &gt; 0) {
+			String dir = pref.getImporterPath(&quot;LocGpxImporter&quot;);
+			FileChooser fc = new FileChooser(FileChooserBase.OPEN, dir);
+			fc.addMask(&quot;*.gpx&quot;);
+			fc.setTitle(MyLocale.getMsg(909,&quot;Select file(s)&quot;));
+			if(fc.execute() != FormBase.IDCANCEL){
+				dir = fc.getChosenDirectory().toString();
+				pref.setImporterPath(&quot;LocGpxImporter&quot;, dir);
+				//String files[] = fc.getAllChosen();
+				fileName=fc.file;
+			}
+			else {
+				fileName=&quot;&quot;;
+			}
+		}
+
 		cancelB = new mButton(MyLocale.getMsg(1604,&quot;Cancel&quot;));
 		cancelB.setHotKey(0, IKeys.ESCAPE);
 		this.addNext(cancelB,CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.WEST));

Modified: trunk/src/CacheWolf/imp/SpiderGC.java
===================================================================
--- trunk/src/CacheWolf/imp/SpiderGC.java	2010-09-25 17:26:01 UTC (rev 2794)
+++ trunk/src/CacheWolf/imp/SpiderGC.java	2010-09-27 10:02:03 UTC (rev 2795)
@@ -1,29 +1,30 @@
-    /*
-    GNU General Public License
-    CacheWolf is a software for PocketPC, Win and Linux that
-    enables paperless caching.
-    It supports the sites geocaching.com and opencaching.de
+/*
+GNU General Public License
+CacheWolf is a software for PocketPC, Win and Linux that
+enables paperless caching.
+It supports the sites geocaching.com and opencaching.de
 
-    Copyright (C) 2006  CacheWolf development team
-    See <A HREF="http://developer.berlios.de/projects/cachewolf/">http://developer.berlios.de/projects/cachewolf/</A>
-    for more information.
-    Contact: 	<A HREF="https://lists.berlios.de/mailman/listinfo/cachewolf-svn">bilbowolf at users.berlios.de</A>
-    			<A HREF="https://lists.berlios.de/mailman/listinfo/cachewolf-svn">kalli at users.berlios.de</A>
+Copyright (C) 2006  CacheWolf development team
+See <A HREF="http://developer.berlios.de/projects/cachewolf/">http://developer.berlios.de/projects/cachewolf/</A>
+for more information.
+Contact: 	<A HREF="https://lists.berlios.de/mailman/listinfo/cachewolf-svn">bilbowolf at users.berlios.de</A>
+			<A HREF="https://lists.berlios.de/mailman/listinfo/cachewolf-svn">kalli at users.berlios.de</A>
 
-    This program is free software; you can redistribute it and/or modify
-    it under the terms of the GNU General Public License as published by
-    the Free Software Foundation; version 2 of the License.
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; version 2 of the License.
 
-    This program is distributed in the hope that it will be useful,
-    but WITHOUT ANY WARRANTY; without even the implied warranty of
-    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-    GNU General Public License for more details.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
 
-    You should have received a copy of the GNU General Public License
-    along with this program; if not, write to the Free Software
-    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
-    */
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
+ */
 package CacheWolf.imp;
+
 import CacheWolf.CWPoint;
 import CacheWolf.CacheDB;
 import CacheWolf.CacheHolder;
@@ -49,6 +50,10 @@
 import CacheWolf.Travelbug;
 import CacheWolf.navi.Area;
 import CacheWolf.navi.Metrics;
+import CacheWolf.navi.MovingMap;
+import CacheWolf.navi.Navigate;
+import CacheWolf.navi.Track;
+import CacheWolf.navi.TrackPoint;
 import CacheWolf.navi.TransformCoordinates;
 
 import com.stevesoft.ewe_pat.Regex;
@@ -60,6 +65,7 @@
 import ewe.io.FileInputStream;
 import ewe.io.FileOutputStream;
 import ewe.io.IOException;
+import ewe.io.InputStreamReader;
 import ewe.io.JavaUtf8Codec;
 import ewe.net.Socket;
 import ewe.net.URL;
@@ -77,20 +83,23 @@
 import ewe.util.Utils;
 import ewe.util.Vector;
 import ewe.util.mString;
+import ewesoft.xml.MinML;
+import ewesoft.xml.sax.AttributeList;
 
 /**
-*	Class to spider caches from gc.com
-*/
-public class SpiderGC{
+ * Class to spider caches from gc.com
+ */
+public class SpiderGC {
 
 	/**
 	 * The maximum number of logs that will be stored
 	 */
-	public static String passwort = &quot;&quot;; // Can be pre-set from preferences
-	public static boolean loggedIn = false;
+	private static boolean loggedIn = false;
 
 	// Return values for spider action
-	/** Ignoring a premium member cache when spidering from a non premium account */
+	/**
+	 * Ignoring a premium member cache when spidering from a non premium account
+	 */
 	public static int SPIDER_IGNORE_PREMIUM = -2;
 	/** Canceling spider process */
 	public static int SPIDER_CANCEL = -1;
@@ -98,7 +107,7 @@
 	public static int SPIDER_ERROR = 0;
 	/** Cache was spidered without problems */
 	public static int SPIDER_OK = 1;
-	/** no probs, but exmpl found und not want this*/
+	/** no probs, but exmpl found und not want this */
 	public static int SPIDER_IGNORE = 2;
 
 	private static int ERR_LOGIN = -10;
@@ -111,10 +120,11 @@
 	private static double maxDistance = 0;
 	private static String direction = &quot;&quot;;
 	private static String[] directions;
+
 	private CacheDB cacheDB;
 	private Vector cachesToLoad = new Vector();
 	private InfoBox infB;
-	private static SpiderProperties p=null;
+	private static SpiderProperties p = null;
 	// following filled at doit
 	private CWPoint origin;
 	private boolean doNotgetFound;
@@ -123,14 +133,15 @@
 	private String htmlListPage;
 	private int maxUpdate;
 	private boolean maxNumberAbort;
-	private byte restrictedCacheType=0;
+	private byte restrictedCacheType = 0;
+	private String fileName = &quot;&quot;;
 
 	private static String propFirstPage;
 	private static String propFirstPage2;
 	private static String propFirstPageFinds;
 	private static String gotoNextPage = &quot;ctl00$ContentBody$pgrTop$ctl08&quot;;
-	private static String gotoNextBlock = &quot;ctl00$ContentBody$pgrTop$ctl06&quot;; // change to the block (10pages) of the wanted page
-	private static String gotoPage = &quot;ctl00$ContentBody$pgrTop$lbGoToPage_&quot;; // add pagenumber 
+	private static String gotoNextBlock = &quot;ctl00$ContentBody$pgrTop$ctl06&quot;;  // change to the block (10pages) of the wanted page
+	private static String gotoPage = &quot;ctl00$ContentBody$pgrTop$lbGoToPage_&quot;; // add pagenumber
 	private static String propMaxDistance;
 	private static String propShowOnlyFound;
 	private static Regex RexPropListBlock;
@@ -147,7 +158,7 @@
 	private static Regex RexPropType;
 	private static Regex RexPropSize;
 	private static Regex RexPropDandT;
-	private static Regex RexPropOwn;	
+	private static Regex RexPropOwn;
 	private static Regex RexLogBlock;
 	private static Extractor exSingleLog;
 	private static Extractor exIcon;
@@ -160,84 +171,93 @@
 	private static String icon_camera;
 	private static String icon_attended;
 	private static Regex RexCacheType;
-	
-	private int numFoundUpdates=0;
-	private int numArchivedUpdates=0;
-	private int numAvailableUpdates=0;
-	private int numLogUpdates=0;
-	private int numPrivate=0;
-	private int page_number=1;
-	private int num_added=0;
 
-	public SpiderGC(Preferences prf, Profile profile, boolean bypass){
-		this.profile=profile;
+	private int numFoundUpdates = 0;
+	private int numArchivedUpdates = 0;
+	private int numAvailableUpdates = 0;
+	private int numLogUpdates = 0;
+	private int numPrivate = 0;
+	private int page_number = 1;
+	private int num_added = 0;
+
+	public SpiderGC(Preferences prf, Profile profile, boolean bypass) {
+		this.profile = profile;
 		this.cacheDB = profile.cacheDB;
 		pref = prf;
-		if (p == null) {p=new SpiderProperties();}
+		if (p == null) {
+			p = new SpiderProperties();
+		}
 		initialiseProperties();
 	}
 
 	/**
-	*	Method to start the spider for a search around the centre coordinates
-	*/
-	public void doIt(){
+	 * Method to start the spider for a search around the centre coordinates
+	 */
+	public void doIt() {
 		doIt(false);
 	}
 
-	public void doIt(boolean _spiderAllFinds){
+	public void doIt(boolean _spiderAllFinds) {
 		cachesToLoad.clear();
-		spiderAllFinds=_spiderAllFinds;
+		spiderAllFinds = _spiderAllFinds;
 		origin = pref.getCurCentrePt(); // No need to copy curCentrePt as it is only read and not written
-		if ( !spiderAllFinds &amp;&amp; !origin.isValid()) {
+		if (!spiderAllFinds &amp;&amp; !origin.isValid()) {
 			(new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;), MyLocale.getMsg(5509,&quot;Coordinates for centre must be set&quot;), FormBase.OKB)).execute();
 			return;
 		}
-		
+
 		// Reset states for all caches when spidering (<A HREF="http://tinyurl.com/dzjh7p">http://tinyurl.com/dzjh7p</A>)
-		for(int i = 0; i&lt;cacheDB.size();i++){
+		for (int i = 0; i &lt; cacheDB.size(); i++) {
 			CacheHolder ch = cacheDB.get(i);
-			if (ch.mainCache == null) ch.initStates(false);
+			if (ch.mainCache == null)
+				ch.initStates(false);
 		}
-		
+
 		if (doDownloadGui(0)) {
 
 			Vm.showWait(true);
-			infB = new InfoBox(&quot;Status&quot;, MyLocale.getMsg(5502,&quot;Fetching first page...&quot;));
+			infB = new InfoBox(&quot;Status&quot;, MyLocale.getMsg(5502, &quot;Fetching first page...&quot;));
 			infB.exec();
-			
-			pref.log(&quot;ListPages Properties : &quot;+Preferences.NEWLINE
-					+ &quot;minDistance: &quot; + minDistance+Preferences.NEWLINE
-					+ &quot;maxDistance: &quot; + maxDistance+Preferences.NEWLINE
-					+ &quot;directions: &quot; + direction+Preferences.NEWLINE
-					+ &quot;maxNew: &quot; + pref.maxSpiderNumber +Preferences.NEWLINE
-					+ &quot;maxUpdate: &quot; + maxUpdate+Preferences.NEWLINE
-					+ &quot;with Founds       : &quot; + (doNotgetFound ? &quot;no&quot; : &quot;yes&quot;)+Preferences.NEWLINE
-					+ &quot;alias is premium m: &quot; + (!pref.isPremium ? &quot;no&quot; : &quot;yes&quot;)+Preferences.NEWLINE
-					+ &quot;Update if new Logs: &quot; + (!pref.checkLog ? &quot;no&quot; : &quot;yes&quot;)+Preferences.NEWLINE
-					,null);
-			
-			
+
+			pref.log(&quot;ListPages Properties : &quot; + Preferences.NEWLINE
+					+ &quot;minDistance: &quot; + minDistance + Preferences.NEWLINE
+					+ &quot;maxDistance: &quot; + maxDistance + Preferences.NEWLINE
+					+ &quot;directions: &quot; + direction + Preferences.NEWLINE
+					+ &quot;maxNew: &quot; + pref.maxSpiderNumber + Preferences.NEWLINE
+					+ &quot;maxUpdate: &quot; + maxUpdate + Preferences.NEWLINE
+					+ &quot;with Founds       : &quot; + (doNotgetFound ? &quot;no&quot; : &quot;yes&quot;)
+					+ Preferences.NEWLINE + &quot;alias is premium m: &quot;
+					+ (!pref.isPremium ? &quot;no&quot; : &quot;yes&quot;) + Preferences.NEWLINE
+					+ &quot;Update if new Logs: &quot; + (!pref.checkLog ? &quot;no&quot; : &quot;yes&quot;)
+					+ Preferences.NEWLINE, null);
+
 			Hashtable cachesToUpdate = new Hashtable(cacheDB.size());
-			
-			cachesToUpdate=fillDownloadLists(pref.maxSpiderNumber , maxUpdate, maxDistance, minDistance, directions, cachesToUpdate);
-			if (cachesToUpdate == null) {cachesToUpdate = new Hashtable();};
-			if (!infB.isClosed){
-				infB.setInfo(MyLocale.getMsg(5511,&quot;Found &quot;) + cachesToLoad.size() + MyLocale.getMsg(5512,&quot; caches&quot;));
+
+			cachesToUpdate = fillDownloadLists(pref.maxSpiderNumber, maxUpdate,
+					maxDistance, minDistance, directions, cachesToUpdate);
+			if (cachesToUpdate == null) {
+				cachesToUpdate = new Hashtable();
 			}
+			;
+			if (!infB.isClosed) {
+				infB.setInfo(MyLocale.getMsg(5511, &quot;Found &quot;)
+						+ cachesToLoad.size()
+						+ MyLocale.getMsg(5512, &quot; caches&quot;));
+			}
 			// continue to update index to changed cache.xml things (size,terrain,difficulty,...?) 
 
-			//=======
+			// =======
 			// Now ready to spider each cache in the lists
-			//=======
+			// =======
 
-			if ( cachesToUpdate.size() &gt; 0 ) {
+			if (cachesToUpdate.size() &gt; 0) {
 				switch (pref.spiderUpdates) {
 				case Preferences.NO:
 					cachesToUpdate.clear();
 					break;
 				case Preferences.ASK:
 					MessageBox mBox = new MessageBox(MyLocale.getMsg(5517,&quot;Spider Updates?&quot;), cachesToUpdate.size() + MyLocale.getMsg(5518,&quot; caches in database need an update. Update now?&quot;) , FormBase.IDYES |FormBase.IDNO);
-					if (mBox.execute() != FormBase.IDOK){
+					if (mBox.execute() != FormBase.IDOK) {
 						cachesToUpdate.clear();
 					}
 					break;
@@ -247,389 +267,513 @@
 			int spiderErrors = 0;
 			int totalCachesToLoad = cachesToLoad.size() + cachesToUpdate.size();
 			boolean loadAllLogs = (pref.maxLogsToSpider &gt; 5) || spiderAllFinds;
-			pref.log(&quot;Download properties : &quot;+Preferences.NEWLINE
-					+ &quot;maxLogs: &quot; + (loadAllLogs ? &quot;completepage &quot; : &quot;shortpage&quot;) + &quot;nr.:&quot; + pref.maxLogsToSpider+Preferences.NEWLINE
-					+ &quot;with pictures     : &quot; + (!pref.downloadPics ? &quot;no&quot; : &quot;yes&quot;)+Preferences.NEWLINE
-					+ &quot;with tb           : &quot; + (!pref.downloadTBs ? &quot;no&quot; : &quot;yes&quot;)+Preferences.NEWLINE
-					,null);
+			pref.log(&quot;Download properties : &quot; + Preferences.NEWLINE
+					+ &quot;maxLogs: &quot;
+					+ (loadAllLogs ? &quot;completepage &quot; : &quot;shortpage&quot;) + &quot;nr.:&quot;
+					+ pref.maxLogsToSpider + Preferences.NEWLINE
+					+ &quot;with pictures     : &quot;
+					+ (!pref.downloadPics ? &quot;no&quot; : &quot;yes&quot;) + Preferences.NEWLINE
+					+ &quot;with tb           : &quot;
+					+ (!pref.downloadTBs ? &quot;no&quot; : &quot;yes&quot;) + Preferences.NEWLINE,
+					null);
 
-			if (Global.mainTab.statBar!=null) Global.mainTab.statBar.updateDisplay(&quot;&quot;);
+			if (Global.mainTab.statBar != null)
+				Global.mainTab.statBar.updateDisplay(&quot;&quot;);
 
 			if (!infB.isClosed) {
-				spiderErrors=downloadCaches(cachesToLoad, spiderErrors, totalCachesToLoad, loadAllLogs);
-				spiderErrors=updateCaches(cachesToUpdate, spiderErrors, totalCachesToLoad, loadAllLogs);
+				spiderErrors = downloadCaches(cachesToLoad, spiderErrors,
+						totalCachesToLoad, loadAllLogs);
+				spiderErrors = updateCaches(cachesToUpdate, spiderErrors,
+						totalCachesToLoad, loadAllLogs);
 			}
 
-			if ( spiderErrors &gt; 0) {
-				new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;),spiderErrors + MyLocale.getMsg(5516,&quot; cache descriptions%0acould not be loaded.&quot;),FormBase.DEFOKB).execute();
+			if (spiderErrors &gt; 0) {
+				new MessageBox(MyLocale.getMsg(5500, &quot;Error&quot;),
+						spiderErrors + MyLocale.getMsg(5516,&quot; cache descriptions%0acould not be loaded.&quot;),
+						FormBase.DEFOKB).execute();
 			}
-			if ( maxNumberAbort ) {
-				new MessageBox(MyLocale.getMsg(5519,&quot;Information&quot;),MyLocale.getMsg(5520,&quot;Only the given maximum of caches were loaded.%0aRepeat spidering later to load more caches.%0aNo already existing caches were updated.&quot;),FormBase.DEFOKB).execute();
+			if (maxNumberAbort) {
+				new MessageBox(MyLocale.getMsg(5519, &quot;Information&quot;),
+						MyLocale.getMsg(5520,&quot;Only the given maximum of caches were loaded.%0aRepeat spidering later to load more caches.%0aNo already existing caches were updated.&quot;),
+						FormBase.DEFOKB).execute();
 			}
 			Global.getProfile().restoreFilter();
-			Global.getProfile().saveIndex(Global.getPref(),true);
+			Global.getProfile().saveIndex(Global.getPref(), true);
 
-			if (!infB.isClosed) {infB.close(0);}			
-			Vm.showWait(false);			
+			if (!infB.isClosed) {
+				infB.close(0);
+			}
+			Vm.showWait(false);
 		}
 	} // End of DoIt
-	
+
 	public void doItAlongARoute() {
 		Area sq;
+		Vector points = null;
+		Navigate nav=Global.mainTab.nav;
+		MovingMap mm=Global.mainTab.mm;
 
+		if (!doDownloadGui(1))
+			return;
+
 		CWPoint startPos = pref.getCurCentrePt();
-		if (!startPos.isValid()) {
-			(new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;), MyLocale.getMsg(5509,&quot;Coordinates for centre must be set&quot;), FormBase.OKB)).execute();
+		if (!fileName.equals(&quot;&quot;)) {
+			RouteImporter ri = new RouteImporter(fileName);
+			points = ri.doIt();			
+			if (points.size() &gt; 0) {
+				if (nav!=null) {
+					if (mm==null) {
+						Global.mainTab.mm = new MovingMap(nav, profile.cacheDB);
+						mm=Global.mainTab.mm;
+						nav.setMovingMap(Global.mainTab.mm);
+					}
+					if (nav.curTrack == null) {
+						nav.curTrack=new Track(nav.trackColor);
+						mm.addTrack(nav.curTrack);
+					}
+					for (int i = 0; i &lt; points.size(); i++) {
+						try {
+							nav.curTrack.add((TrackPoint) points.get(i));
+						} catch (IndexOutOfBoundsException e) { // track full -&gt; create a new one
+							nav.curTrack=new Track(nav.trackColor);
+							nav.curTrack.add((TrackPoint) points.get(i));
+							if (mm != null) mm.addTrack(nav.curTrack);
+						}
+
+					}
+				}
+				TrackPoint tp = (TrackPoint) points.get(0);
+				startPos = new CWPoint(tp.latDec, tp.lonDec);
+			} else
+				startPos = null;
+		}
+
+		if (startPos != null &amp;&amp; !startPos.isValid()) {
+			(new MessageBox(MyLocale.getMsg(5500, &quot;Error&quot;),
+					MyLocale.getMsg(5509, &quot;Coordinates for centre must be set&quot;), FormBase.OKB))
+					.execute();
 			return; //
 		}
-		if (!doDownloadGui(1)) return;
 
 		Vm.showWait(true);
 		infB = new InfoBox(&quot;Status&quot;, MyLocale.getMsg(5502,&quot;Fetching first page...&quot;));
 		infB.exec();
 
 		if (!loggedIn || pref.forceLogin) {
-			if(login() != FormBase.IDOK) return;
+			if (login() != FormBase.IDOK)
+				return;
 		}
 
-		// Reset states for all caches when spidering (<A HREF="http://tinyurl.com/dzjh7p">http://tinyurl.com/dzjh7p</A>)
-		for(int i = 0; i&lt;cacheDB.size();i++){
+		// Reset states for all caches when spidering
+		// (<A HREF="http://tinyurl.com/dzjh7p">http://tinyurl.com/dzjh7p</A>)
+		for (int i = 0; i &lt; cacheDB.size(); i++) {
 			CacheHolder ch = cacheDB.get(i);
-			if (ch.mainCache == null) ch.initStates(false);
+			if (ch.mainCache == null)
+				ch.initStates(false);
 		}
 
-		double lateralDistance=maxDistance; // Seitenabstand in km
-		if ( pref.metricSystem == Metrics.IMPERIAL ) {
-			lateralDistance = Metrics.convertUnit(maxDistance, Metrics.MILES, Metrics.KILOMETER);
-		}			
+		double lateralDistance = maxDistance; // Seitenabstand in km
+		if (pref.metricSystem == Metrics.IMPERIAL) {
+			lateralDistance = Metrics.convertUnit(maxDistance, Metrics.MILES,
+					Metrics.KILOMETER);
+		}
 		cachesToLoad.clear();
-		origin=startPos;
-		// Hashtable cachesToUpdate = new Hashtable(); //dummy , won't update
-		CacheHolder nextCache=null;
-		int n;
-		while ((n=nextRoutePoint(startPos, lateralDistance)) &gt; -1) {
-			// spider around startPos			
-			// cachesToUpdate=fillDownloadLists(Integer.MAX_VALUE, 0, lateralDistance, 0.0, directions, cachesToUpdate);			
-			sq=getSquare(origin, lateralDistance);
-			getCaches(sq.topleft.latDec,sq.topleft.lonDec,sq.buttomright.latDec,sq.buttomright.lonDec, true);
 
-			nextCache=cacheDB.get(n);
-			double degrees = startPos.getBearing(nextCache.pos);
-			double distanceToNextCache=startPos.getDistance(nextCache.pos);
-			double anzCheckPoints=distanceToNextCache / lateralDistance;
-			for (int i = 1; i &lt; anzCheckPoints; i++) {
-				CWPoint nextCheckPoint = startPos.project(degrees, lateralDistance);
-				startPos=nextCheckPoint;
-				// spider around nextCheckPoint
-				origin=nextCheckPoint;
-				// cachesToUpdate=fillDownloadLists(Integer.MAX_VALUE, 0, lateralDistance, 0.0, directions, cachesToUpdate);
-				sq=getSquare(origin, lateralDistance);
-				getCaches(sq.topleft.latDec,sq.topleft.lonDec,sq.buttomright.latDec,sq.buttomright.lonDec, true);
-				// pref.log(&quot;next CP = &quot;+nextCheckPoint.toString(),null);
-				if (infB.isClosed) { break; }
+		origin = startPos;
+		CWPoint nextPos = startPos;
+		int pointsIndex = 1;
+		while (nextPos != null) {
+			if (fileName.equals(&quot;&quot;)) {
+				nextPos = nextRoutePoint(startPos, lateralDistance);
+			} else {
+				double tmpDistance = 0;
+				while (tmpDistance &lt; lateralDistance
+						&amp;&amp; pointsIndex &lt; points.size()) {
+					TrackPoint tp = (TrackPoint) points.get(pointsIndex);
+					nextPos = new CWPoint(tp.latDec, tp.lonDec);
+					tmpDistance = nextPos.getDistance(startPos);
+					pointsIndex++;
+				}
+				if (pointsIndex == points.size())
+					nextPos = null;
 			}
-			startPos=nextCache.pos;
-			// pref.log(&quot;next WP = &quot;+nextCache.getWayPoint()+&quot; : &quot;+CWPoint.getDirection(degrees),null);
-			if (infB.isClosed) { break; }
+			if (nextPos != null) {
+				sq = getSquare(startPos, lateralDistance);
+				getCaches(sq.topleft.latDec, sq.topleft.lonDec,
+						sq.buttomright.latDec, sq.buttomright.lonDec, false);
+				// pref.log(&quot;next WP = &quot; + startPos.toString(), null);
+
+				double degrees = startPos.getBearing(nextPos);
+				double distanceToNextCache = startPos.getDistance(nextPos);
+				double anzCheckPoints = distanceToNextCache / lateralDistance;
+				for (int i = 1; i &lt; anzCheckPoints; i++) {
+					CWPoint nextCheckPoint = startPos.project(degrees,
+							lateralDistance);
+					startPos = nextCheckPoint;
+					origin = nextCheckPoint;
+					sq = getSquare(origin, lateralDistance);
+					getCaches(sq.topleft.latDec, sq.topleft.lonDec,
+							sq.buttomright.latDec, sq.buttomright.lonDec, false);
+					// pref.log(&quot;next CP = &quot; + origin.toString(), null);
+					if (infB.isClosed) {
+						break;
+					}
+				}
+				startPos = nextPos;
+			}
+			if (infB.isClosed) {
+				break;
+			}
 		}
-		// spider around startpos (means endpos)
-		origin=startPos;
-		// cachesToUpdate=fillDownloadLists(Integer.MAX_VALUE, 0, lateralDistance, 0.0, directions, cachesToUpdate);
-		sq=getSquare(origin, lateralDistance);
-		getCaches(sq.topleft.latDec,sq.topleft.lonDec,sq.buttomright.latDec,sq.buttomright.lonDec, true);
-		int spiderErrors=0;
-		if (infB.isClosed) { Vm.showWait(false); return; } // or ask for download of intermediate result 
+		sq = getSquare(startPos, lateralDistance);
+		getCaches(sq.topleft.latDec, sq.topleft.lonDec, sq.buttomright.latDec,
+				sq.buttomright.lonDec, false);
+		// pref.log(&quot;last WP = &quot; + startPos.toString(), null);
+		if (infB.isClosed) {
+			Vm.showWait(false);
+			return;
+		} // or ask for download of intermediate result
 		
-		for (int i = 0; i &lt; cachesToLoad.size(); i++) {
-			String wpt = (String)cachesToLoad.get(i);
-			boolean is_found = wpt.indexOf(&quot;found&quot;)!=-1;
-			if (is_found) wpt=wpt.substring(0,wpt.indexOf(&quot;found&quot;));
-			int j = cacheDB.getIndex(wpt);
-			if (j!=-1) cacheDB.removeElementAt(j);			
+		int spiderErrors = 0;
+		if (new MessageBox(&quot;Question&quot;,
+				&quot;Update caches with all details?&quot;,
+				MessageBox.YESB | MessageBox.NOB).execute() == MessageBox.IDYES) {
+
+			for (int i = 0; i &lt; cachesToLoad.size(); i++) {
+				String wpt = (String) cachesToLoad.get(i);
+				boolean is_found = wpt.indexOf(&quot;found&quot;) != -1;
+				if (is_found)
+					wpt = wpt.substring(0, wpt.indexOf(&quot;found&quot;));
+				int j = cacheDB.getIndex(wpt);
+				if (j != -1)
+					cacheDB.removeElementAt(j);
+			}
+			spiderErrors = downloadCaches(cachesToLoad, spiderErrors, cachesToLoad.size(), true);
+
 		}
-		spiderErrors=downloadCaches(cachesToLoad, spiderErrors, cachesToLoad.size(), true);
+		else {
+		}
 
 		infB.close(0);
 		Vm.showWait(false);
-		if ( spiderErrors &gt; 0) {
-			new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;),spiderErrors + MyLocale.getMsg(5516,&quot; cache descriptions%0acould not be loaded.&quot;),FormBase.DEFOKB).execute();
+		if (spiderErrors &gt; 0) {
+			new MessageBox(MyLocale.getMsg(5500, &quot;Error&quot;),
+					spiderErrors + MyLocale.getMsg(5516,&quot; cache descriptions%0acould not be loaded.&quot;),
+					FormBase.DEFOKB).execute();
 		}
-		if ( maxNumberAbort ) {
-			new MessageBox(MyLocale.getMsg(5519,&quot;Information&quot;),MyLocale.getMsg(5520,&quot;Only the given maximum of caches were loaded.%0aRepeat spidering later to load more caches.%0aNo already existing caches were updated.&quot;),FormBase.DEFOKB).execute();
+		if (maxNumberAbort) {
+			new MessageBox(
+					MyLocale.getMsg(5519,&quot;Information&quot;),
+					MyLocale.getMsg(5520,&quot;Only the given maximum of caches were loaded.\nRepeat spidering later to load more caches.\nNo already existing caches were updated.&quot;),
+					FormBase.DEFOKB).execute();
 		}
 		Global.getProfile().restoreFilter();
-		Global.getProfile().saveIndex(Global.getPref(),true);
+		Global.getProfile().saveIndex(Global.getPref(), true);
 	}
-	
-	
-	private int nextRoutePoint(CWPoint startPos, double lateralDistance) {
+
+	private CWPoint nextRoutePoint(CWPoint startPos, double lateralDistance) {
 		// get next Destination
 		double nextDistance = 0;
-		int index=-1;
-		CacheHolder nextCache=null;
-		CacheHolder ch=null;
+		int index = -1;
+		CacheHolder nextCache = null;
+		CacheHolder ch = null;
 		for (int i = 0; i &lt; cacheDB.size(); i++) {
-			ch=cacheDB.get(i);
+			ch = cacheDB.get(i);
 			if (ch.is_Checked &amp;&amp; ch.pos.isValid()) {
 				CWPoint tmpPos = ch.pos;
-				double tmpDistance=tmpPos.getDistance(startPos);
-				if (nextDistance==0) {
+				double tmpDistance = tmpPos.getDistance(startPos);
+				if (nextDistance == 0) {
 					// Startwert
-					index=i;
-					nextDistance=tmpDistance;
-					nextCache=ch;
-					nextCache.is_Checked=false;
-				}
-				else {
+					index = i;
+					nextDistance = tmpDistance;
+					nextCache = ch;
+					nextCache.is_Checked = false;
+				} else {
 					if (tmpDistance &gt; lateralDistance) {
 						if (tmpDistance &lt; nextDistance) {
-							index=i;
-							nextDistance=tmpDistance;
-							nextCache=ch;
-							nextCache.is_Checked=false;
+							index = i;
+							nextDistance = tmpDistance;
+							nextCache = ch;
+							nextCache.is_Checked = false;
 						}
+					} else {
+						ch.is_Checked = false;
 					}
-					else {
-						ch.is_Checked=false;
-					}
 				}
 			}
 		}
-		return index;
+		if (index &gt; -1) {
+			return cacheDB.get(index).pos;
+		} else
+			return null;
 	}
 
-	private Area getSquare(CWPoint centre, double halfSideLengthKm) {		
+	private Area getSquare(CWPoint centre, double halfSideLengthKm) {
 		int north = 0;
 		int east = 1;
 		int south = 2;
 		int west = 3;
-		double halfSideLength=halfSideLengthKm * 1000.0; // in meters
+		double halfSideLength = halfSideLengthKm * 1000.0; // in meters
 		Area ret = new Area();
-		ret.topleft.latDec=centre.latDec;
-		ret.topleft.lonDec=centre.lonDec;
+		ret.topleft.latDec = centre.latDec;
+		ret.topleft.lonDec = centre.lonDec;
 		ret.topleft.shift(halfSideLength, north);
 		ret.topleft.shift(halfSideLength, west);
 
-		ret.buttomright.latDec=centre.latDec;
-		ret.buttomright.lonDec=centre.lonDec;
+		ret.buttomright.latDec = centre.latDec;
+		ret.buttomright.lonDec = centre.lonDec;
 		ret.buttomright.shift(halfSideLength, south);
 		ret.buttomright.shift(halfSideLength, east);
-		
+
 		return ret;
 	}
-	
+
 	public void doItQuickFillFromMapList() {
 
 		CWPoint origin = pref.getCurCentrePt();
 		if (!origin.isValid()) {
-			(new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;), MyLocale.getMsg(5509,&quot;Coordinates for centre must be set&quot;), FormBase.OKB)).execute();
+			(new MessageBox(MyLocale.getMsg(5500, &quot;Error&quot;),
+					MyLocale.getMsg(5509, &quot;Coordinates for centre must be set&quot;),
+					FormBase.OKB)).execute();
 			return; //
 		}
-		if (!doDownloadGui(2)) return;
+		if (!doDownloadGui(2))
+			return;
 
 		Vm.showWait(true);
-		infB = new InfoBox(&quot;Status&quot;, MyLocale.getMsg(1609,&quot;getting the caches.&quot;));
+		infB = new InfoBox(&quot;Status&quot;, MyLocale.getMsg(1609, &quot;getting the caches.&quot;));
 		infB.exec();
 
-		// Reset states for all caches when spidering (<A HREF="http://tinyurl.com/dzjh7p">http://tinyurl.com/dzjh7p</A>)
-		for(int i = 0; i&lt;cacheDB.size();i++){
+		// Reset states for all caches when spidering
+		// (<A HREF="http://tinyurl.com/dzjh7p">http://tinyurl.com/dzjh7p</A>)
+		for (int i = 0; i &lt; cacheDB.size(); i++) {
 			CacheHolder ch = cacheDB.get(i);
-			if (ch.mainCache == null) ch.initStates(false);
+			if (ch.mainCache == null)
+				ch.initStates(false);
 		}
 
-		double halfSideLength=maxDistance; // halbe Seitenl&#228;nge eines Quadrats ums Zentrum in km
-		if ( pref.metricSystem == Metrics.IMPERIAL ) {
-			halfSideLength = Metrics.convertUnit(maxDistance, Metrics.MILES, Metrics.KILOMETER);
+		double halfSideLength = maxDistance; // halbe Seitenl&#228;nge eines Quadrats ums Zentrum in km
+		if (pref.metricSystem == Metrics.IMPERIAL) {
+			halfSideLength = Metrics.convertUnit(maxDistance, Metrics.MILES,
+					Metrics.KILOMETER);
 		}
 
 		if (!loggedIn || pref.forceLogin) {
-			if(login() != FormBase.IDOK) return;
+			if (login() != FormBase.IDOK)
+				return;
 		}
 
 		page_number = 0;
 		num_added = 0;
-		
-		Area sq=getSquare(origin, halfSideLength);
-		getCaches(sq.topleft.latDec,sq.topleft.lonDec,sq.buttomright.latDec,sq.buttomright.lonDec, false);
-				
-		if (!infB.isClosed) infB.close(0);
+
+		Area sq = getSquare(origin, halfSideLength);
+		getCaches(sq.topleft.latDec, sq.topleft.lonDec, sq.buttomright.latDec,
+				sq.buttomright.lonDec, false);
+
+		if (!infB.isClosed)
+			infB.close(0);
 		Vm.showWait(false);
 
 		Global.getProfile().restoreFilter();
-		Global.getProfile().saveIndex(Global.getPref(),true);
-				
+		Global.getProfile().saveIndex(Global.getPref(), true);
+
 	}
-	
-	private void getCaches(double north, double west, double south, double east, boolean setCachesToLoad) {
-		if (infB.isClosed) return;
-		double lm = (north+south)/2.0;
-		CWPoint middle = new CWPoint(lm,(west+east)/2.0);
+
+	private void getCaches(double north, double west, double south,
+			double east, boolean setCachesToLoad) {
+		if (infB.isClosed)
+			return;
+		double lm = (north + south) / 2.0;
+		CWPoint middle = new CWPoint(lm, (west + east) / 2.0);
 		CWPoint rm = new CWPoint(lm, east);
 		double len = middle.getDistance(rm) * 2.0;
 		page_number++;
-		String listPage=getMapListPage(middle, north, west, south, east);
+		String listPage = getMapListPage(middle, north, west, south, east);
 		int i = listPage.indexOf(&quot;\&quot;count\&quot;:&quot;);
-		pref.log(&quot;&quot;+north+&quot; &quot;+west+&quot; &quot;+south+&quot; &quot;+east+&quot; &quot;+listPage.substring(i, i+12)+&quot; len=&quot;+len);
-		if ((listPage.indexOf(&quot;\&quot;count\&quot;: 501&quot;)&gt;-1) || (listPage.indexOf(&quot;\&quot;count\&quot;: 0&quot;)&gt;-1 &amp;&amp; len &gt; 30)) {
-			double northsouthmiddle = (north+south)/2.0;
-			double westeastmiddle = (west+east)/2.0;
-			getCaches(north, west, northsouthmiddle, westeastmiddle, setCachesToLoad);
-			getCaches(north, westeastmiddle, northsouthmiddle, east, setCachesToLoad);
-			getCaches(northsouthmiddle, west, south, westeastmiddle, setCachesToLoad);
-			getCaches(northsouthmiddle, westeastmiddle, south, east, setCachesToLoad);		
-		}
-		else {
+		pref.log(&quot;&quot; + north + &quot; &quot; + west + &quot; &quot; + south + &quot; &quot; + east + &quot; &quot;
+				+ listPage.substring(i, i + 12) + &quot; len=&quot; + len);
+		if ((listPage.indexOf(&quot;\&quot;count\&quot;: 501&quot;) &gt; -1)
+				|| (listPage.indexOf(&quot;\&quot;count\&quot;: 0&quot;) &gt; -1 &amp;&amp; len &gt; 30)) {
+			double northsouthmiddle = (north + south) / 2.0;
+			double westeastmiddle = (west + east) / 2.0;
+			getCaches(north, west, northsouthmiddle, westeastmiddle,
+					setCachesToLoad);
+			getCaches(north, westeastmiddle, northsouthmiddle, east,
+					setCachesToLoad);
+			getCaches(northsouthmiddle, west, south, westeastmiddle,
+					setCachesToLoad);
+			getCaches(northsouthmiddle, westeastmiddle, south, east,
+					setCachesToLoad);
+		} else {
 			addCaches(listPage, setCachesToLoad);
 		}
 	}
-	
+
 	private void addCaches(String listPage, boolean setCachesToLoad) {
 		String[] caches = mString.split(listPage, '{');
 		for (int i = 0; i &lt; caches.length; i++) {
-			if (infB.isClosed) return;
-			String elements[] = mString.split(caches[i],',');
-			String e1[]= mString.split(elements[0],' '); //.indexOf(&quot;\&quot;lat\&quot;: &quot;);
-			if ( e1[0].indexOf(&quot;lat&quot;) &gt; -1) {
-				boolean found=mString.split(elements[5],' ')[1].equals(&quot;true&quot;);
-				if (found &amp;&amp; doNotgetFound) continue;
-				byte cacheType=CacheType.gcSpider2CwType(mString.split(elements[4],' ')[1]);
-				if (restrictedCacheType != CacheType.CW_TYPE_ERROR ) {
-					if (restrictedCacheType!=cacheType) continue;
+			if (infB.isClosed)
+				return;
+			String elements[] = mString.split(caches[i], ',');
+			String e1[] = mString.split(elements[0], ' '); // .indexOf(&quot;\&quot;lat\&quot;: &quot;);
+			if (e1[0].indexOf(&quot;lat&quot;) &gt; -1) {
+				boolean found = mString.split(elements[5], ' ')[1]
+						.equals(&quot;true&quot;);
+				if (found &amp;&amp; doNotgetFound)
+					continue;
+				byte cacheType = CacheType.gcSpider2CwType(mString.split(
+						elements[4], ' ')[1]);
+				if (restrictedCacheType != CacheType.CW_TYPE_ERROR) {
+					if (restrictedCacheType != cacheType)
+						continue;
 				}
-				String lat=e1[1];
-				String lon=mString.split(elements[2],' ')[1];
-				String wp=mString.split(elements[3],'\&quot;')[3];
-				String own=mString.split(elements[6],' ')[1];
-				String available=mString.split(elements[7],' ')[1];
-				String cacheName=mString.split(elements[8],'\&quot;')[3];;
-				CacheHolder ch=cacheDB.get(wp);
-				if (ch==null) {
+				String lat = e1[1];
+				String lon = mString.split(elements[2], ' ')[1];
+				String wp = mString.split(elements[3], '\&quot;')[3];
+				String own = mString.split(elements[6], ' ')[1];
+				String available = mString.split(elements[7], ' ')[1];
+				String cacheName = mString.split(elements[8], '\&quot;')[3];
+				;
+				CacheHolder ch = cacheDB.get(wp);
+				if (ch == null) {
 					ch = new CacheHolder();
 					ch.setWayPoint(wp);
-					ch.setLatLon(lat+&quot; &quot;+lon);
+					ch.setLatLon(lat + &quot; &quot; + lon);
 					ch.setType(cacheType);
 					if (own.equals(&quot;true&quot;)) {
 						ch.setOwned(true);
-					}
-					else {
+					} else {
 						if (found) {
 							ch.setFound(true);
 							ch.setCacheStatus(ch.getFoundText());
 						}
 					}
-					ch.setAvailable(available.equals(&quot;true&quot;)? true : false);
+					ch.setAvailable(available.equals(&quot;true&quot;) ? true : false);
 					ch.setCacheName(cacheName);
 					num_added++;
-					cacheDB.add(ch); 
+					cacheDB.add(ch);
 					if (setCachesToLoad) {
-						cachesToLoad.add(wp+&quot;found&quot;);}
-					else {
+						cachesToLoad.add(wp + &quot;found&quot;);
+					} else {
 						ch.save();
 					}
-					if (Global.mainTab.statBar!=null) Global.mainTab.statBar.updateDisplay(&quot;GC pages: &quot;+page_number+&quot; Caches added to CW: &quot;+num_added);
+					if (Global.mainTab.statBar != null)
+						Global.mainTab.statBar.updateDisplay(&quot;GC pages: &quot;
+								+ page_number + &quot; Caches added to CW: &quot;
+								+ num_added);
+				} else {
 				}
-				else {
-				}
-			}			
+			}
 		}
 	}
-	
-	private boolean doDownloadGui(int menu){
 
+	private boolean doDownloadGui(int menu) {
+
 		OCXMLImporterScreen options;
-		if (menu==0 &amp;&amp; spiderAllFinds) {
-			options = new OCXMLImporterScreen(MyLocale.getMsg(217,&quot;Spider all finds from geocaching.com&quot;),
-					OCXMLImporterScreen.ISGC|
-					OCXMLImporterScreen.MAXNUMBER|
-					OCXMLImporterScreen.MAXUPDATE|
-					OCXMLImporterScreen.IMAGES|
-					OCXMLImporterScreen.TRAVELBUGS|
-					OCXMLImporterScreen.MAXLOGS
-					);
-			// setting defaults for input 
+		if (menu == 0 &amp;&amp; spiderAllFinds) {
+			options = new OCXMLImporterScreen(MyLocale.getMsg(217,
+					&quot;Spider all finds from geocaching.com&quot;),
+					OCXMLImporterScreen.ISGC | OCXMLImporterScreen.MAXNUMBER
+							| OCXMLImporterScreen.MAXUPDATE
+							| OCXMLImporterScreen.IMAGES
+							| OCXMLImporterScreen.TRAVELBUGS
+							| OCXMLImporterScreen.MAXLOGS);
+			// setting defaults for input
 			options.maxNumberUpdates.setText(&quot;0&quot;);
 			// doing the input
-			if (options.execute() == FormBase.IDCANCEL) {return false; }
+			if (options.execute() == FormBase.IDCANCEL) {
+				return false;
+			}
 			// setting default values for options not used (if necessary)
 			maxDistance = 1.0;
 			minDistance = 0.0;
-			direction=&quot;&quot;;
-		} else if (menu==0) {
-			options = new OCXMLImporterScreen(MyLocale.getMsg(131,&quot;Download from geocaching.com&quot;),
-					OCXMLImporterScreen.ISGC|
-					OCXMLImporterScreen.MAXNUMBER|
-					OCXMLImporterScreen.MAXUPDATE|
-					OCXMLImporterScreen.MINDIST|
-					OCXMLImporterScreen.DIST|
-					OCXMLImporterScreen.DIRECTION|
-					OCXMLImporterScreen.INCLUDEFOUND|
-					OCXMLImporterScreen.IMAGES|
-					OCXMLImporterScreen.TRAVELBUGS|
-					OCXMLImporterScreen.MAXLOGS|
-					OCXMLImporterScreen.TYPE);
-			// setting defaults for input 
-			if (pref.spiderUpdates == Preferences.NO) {options.maxNumberUpdates.setText(&quot;0&quot;);}
+			direction = &quot;&quot;;
+		} else if (menu == 0) {
+			options = new OCXMLImporterScreen(MyLocale.getMsg(131,
+					&quot;Download from geocaching.com&quot;), OCXMLImporterScreen.ISGC
+					| OCXMLImporterScreen.MAXNUMBER
+					| OCXMLImporterScreen.MAXUPDATE
+					| OCXMLImporterScreen.MINDIST | OCXMLImporterScreen.DIST
+					| OCXMLImporterScreen.DIRECTION
+					| OCXMLImporterScreen.INCLUDEFOUND
+					| OCXMLImporterScreen.IMAGES
+					| OCXMLImporterScreen.TRAVELBUGS
+					| OCXMLImporterScreen.MAXLOGS | OCXMLImporterScreen.TYPE);
+			// setting defaults for input
+			if (pref.spiderUpdates == Preferences.NO) {
+				options.maxNumberUpdates.setText(&quot;0&quot;);
+			}
 			// doing the input
-			if (options.execute() == FormBase.IDCANCEL) {return false; }
+			if (options.execute() == FormBase.IDCANCEL) {
+				return false;
+			}
 			// setting default values for options not used (if necessary)
 
 			String minDist = options.minDistanceInput.getText();
-			if (minDist.length() == 0) minDist=&quot;0&quot;;
+			if (minDist.length() == 0)
+				minDist = &quot;0&quot;;
 			minDistance = Common.parseDouble(minDist);
-			profile.setMinDistGC(Double.toString(minDistance).replace(',', '.'));
+			profile
+					.setMinDistGC(Double.toString(minDistance)
+							.replace(',', '.'));
 
-			direction=options.directionInput.getText().toUpperCase();
-			direction=direction.replace(' ',','); // separator blank to ,
-			direction=direction.replace(';',','); // separator ; to ,
+			direction = options.directionInput.getText().toUpperCase();
+			direction = direction.replace(' ', ','); // separator blank to ,
+			direction = direction.replace(';', ','); // separator ; to ,
 			profile.setDirectionGC(direction);
-			direction=direction.replace('O', 'E'); // synonym for East
-			direction=direction.replace('Z', 'S'); // synonym for South
-			direction=direction.replace('P', 'S'); // synonym for South
+			direction = direction.replace('O', 'E'); // synonym for East
+			direction = direction.replace('Z', 'S'); // synonym for South
+			direction = direction.replace('P', 'S'); // synonym for South
 
 			doNotgetFound = options.foundCheckBox.getState();
 
-		}
-		else if (menu == 1) { // menu = 1 input values for get Caches along a route
-			options = new OCXMLImporterScreen(MyLocale.getMsg(137,&quot;Download along a Route from geocaching.com&quot;),
-					OCXMLImporterScreen.ISGC|
-					OCXMLImporterScreen.DIST|
-					OCXMLImporterScreen.INCLUDEFOUND|
-					OCXMLImporterScreen.TRAVELBUGS|
-					OCXMLImporterScreen.IMAGES|
-					OCXMLImporterScreen.MAXLOGS|
-					OCXMLImporterScreen.TYPE);
-			// setting defaults for input 
+		} else if (menu == 1) { // menu = 1 input values for get Caches along a
+								// route
+			options = new OCXMLImporterScreen(MyLocale.getMsg(137,
+					&quot;Download along a Route from geocaching.com&quot;),
+					OCXMLImporterScreen.ISGC | OCXMLImporterScreen.DIST
+							| OCXMLImporterScreen.INCLUDEFOUND
+							| OCXMLImporterScreen.TRAVELBUGS
+							| OCXMLImporterScreen.IMAGES
+							| OCXMLImporterScreen.MAXLOGS
+							| OCXMLImporterScreen.FILENAME
+							| OCXMLImporterScreen.TYPE);
+			// setting defaults for input
 			// doing the input
-			if (options.execute() == FormBase.IDCANCEL) {return false; }
+			if (options.execute() == FormBase.IDCANCEL) {
+				return false;
+			}
 			// setting default values for options not used (if necessary)
 			minDistance = 0.0;
 			doNotgetFound = options.foundCheckBox.getState();
-			direction=&quot;&quot;;
-			maxUpdate=0;
-		}
-		else { // if (menu == 2) {
-			options = new OCXMLImporterScreen(MyLocale.getMsg(138,&quot;Qick Import&quot;),
-					OCXMLImporterScreen.ISGC|
-					OCXMLImporterScreen.DIST|
-					OCXMLImporterScreen.INCLUDEFOUND|
-					OCXMLImporterScreen.TYPE);
-			// setting defaults for input 
-			// doing the input
-			if (options.execute() == FormBase.IDCANCEL) {return false; }
+			direction = &quot;&quot;;
+			maxUpdate = 0;
+			fileName = options.fileName;
+		} else { // if (menu == 2) {
+			options = new OCXMLImporterScreen(MyLocale.getMsg(138,
+					&quot;Qick Import&quot;), OCXMLImporterScreen.ISGC
+					| OCXMLImporterScreen.DIST
+					| OCXMLImporterScreen.INCLUDEFOUND
+					| OCXMLImporterScreen.TYPE);
+			// setting defaults for input doing the input
+			if (options.execute() == FormBase.IDCANCEL) {
+				return false;
+			}
 			doNotgetFound = options.foundCheckBox.getState();
 		}
 
-		if (menu==0) {
-			
+		if (menu == 0) {
+
 			// handling input of common options
 
 			int maxNew = -1;
 			String maxNumberString = options.maxNumberInput.getText();
-			if (maxNumberString.length()!= 0) {
+			if (maxNumberString.length() != 0) {
 				maxNew = Common.parseInt(maxNumberString);
 			}
 			// if (maxNew == 0) return false;
-			if(maxNew == -1) maxNew=Integer.MAX_VALUE;
+			if (maxNew == -1)
+				maxNew = Integer.MAX_VALUE;
 			if (maxNew != pref.maxSpiderNumber) {
 				pref.maxSpiderNumber = maxNew;
 				pref.savePreferences();
@@ -637,196 +781,232 @@
 
 			maxUpdate = -1;
 			String maxUpdateString = options.maxNumberUpdates.getText();
-			if (maxUpdateString.length()!= 0) {
+			if (maxUpdateString.length() != 0) {
 				maxUpdate = Common.parseInt(maxUpdateString);
 			}
-			if(maxUpdate == -1) maxUpdate=Integer.MAX_VALUE;
+			if (maxUpdate == -1)
+				maxUpdate = Integer.MAX_VALUE;
 			// TODO maxUpdate in preferences ?
 
 		}
-		
+
 		// options for all
 
-		if (options.maxDistanceInput != null){
+		if (options.maxDistanceInput != null) {
 			String maxDist = options.maxDistanceInput.getText();
-			if (maxDist.length() ==  0) return false;
+			if (maxDist.length() == 0)
+				return false;
 			maxDistance = Common.parseDouble(maxDist);
-			if (maxDistance ==  0) return false;
-			if (maxDistance&lt;0.5) maxDistance=0.5; // zur Sicherheit mindenstens 500 meter Umkreis
+			if (maxDistance == 0)
+				return false;
+			if (maxDistance &lt; 0.5)
+				maxDistance = 0.5; // zur Sicherheit mindenstens 500 meter Umkreis
 			profile.setDistGC(Double.toString(maxDistance));
 		}
 
-		directions=mString.split(direction, ',');
+		directions = mString.split(direction, ',');
 		// works even if TYPE not in options
 		cacheTypeRestriction = options.getCacheTypeRestriction(p);
 		restrictedCacheType = options.getRestrictedCacheType(p);
-		
+
 		options.close(0);
-		
+
 		return true;
 
 	}
 
-	private Hashtable fillDownloadLists(int maxNew, int maxUpdate, double toDistance, double fromDistance, String[] directions, Hashtable cExpectedForUpdate) {
+	private Hashtable fillDownloadLists(int maxNew, int maxUpdate,
+			double toDistance, double fromDistance, String[] directions,
+			Hashtable cExpectedForUpdate) {
 		if (!loggedIn || pref.forceLogin) {
-			if(login() != FormBase.IDOK) return null;
+			if (login() != FormBase.IDOK)
+				return null;
 		}
-		
+
 		int numFinds;
-		int startPage=1;
-		// get pagenumber of page with fromDistance , to skip reading of pages &lt; fromDistance 
-		if (fromDistance&gt;0) {
+		int startPage = 1;
+		// get pagenumber of page with fromDistance , to skip reading of pages &lt; fromDistance
+		if (fromDistance &gt; 0) {
 			// distance in miles for URL
 			int fromDistanceInMiles = (int) java.lang.Math.ceil(fromDistance);
-			if ( pref.metricSystem != Metrics.IMPERIAL ) {
-				fromDistanceInMiles =(int) java.lang.Math.ceil(Metrics.convertUnit(fromDistance, Metrics.KILOMETER, Metrics.MILES));
+			if (pref.metricSystem != Metrics.IMPERIAL) {
+				fromDistanceInMiles = (int) java.lang.Math.ceil(Metrics
+						.convertUnit(fromDistance, Metrics.KILOMETER,
+								Metrics.MILES));
 			}
 			// - a mile to be save to get a page with fromDistance
-			getFirstListPage(java.lang.Math.max(fromDistanceInMiles-1, 1));		
-			numFinds=getNumFound(htmlListPage); // Number of caches from gc Listpage
+			getFirstListPage(java.lang.Math.max(fromDistanceInMiles - 1, 1));
+			numFinds = getNumFound(htmlListPage); // Number of caches from gc Listpage
 			// calc the number of the startpage
-			startPage = (int) java.lang.Math.ceil(numFinds / 20);			
+			startPage = (int) java.lang.Math.ceil(numFinds / 20);
 		}
-		
-		//max distance in miles for URL, so we can get more than 80km
+
+		// max distance in miles for URL, so we can get more than 80km
 		int toDistanceInMiles = (int) java.lang.Math.ceil(toDistance);
-		if ( pref.metricSystem != Metrics.IMPERIAL ) {
-			toDistanceInMiles = (int) java.lang.Math.ceil(Metrics.convertUnit(toDistance, Metrics.KILOMETER, Metrics.MILES));
+		if (pref.metricSystem != Metrics.IMPERIAL) {
+			toDistanceInMiles = (int) java.lang.Math.ceil(Metrics.convertUnit(
+					toDistance, Metrics.KILOMETER, Metrics.MILES));
 		}
 		// add a mile to be save from different distance calculations in CW and at GC
 		toDistanceInMiles++;
-		getFirstListPage(toDistanceInMiles);		
-		numFinds=getNumFound(htmlListPage); // Number of caches from gc first Listpage
+		getFirstListPage(toDistanceInMiles);
+		numFinds = getNumFound(htmlListPage); // Number of caches from gc first Listpage
 
-		if (fromDistance&gt;0) {
+		if (fromDistance &gt; 0) {
 			// skip (most of) the pages with distance &lt; fromDistance
 			for (int i = 0; i &lt; (startPage / 10); i++) {
-				getAListPage(toDistanceInMiles,gotoNextBlock);			
+				getAListPage(toDistanceInMiles, gotoNextBlock);
 			}
-			if (startPage&gt;1) getAListPage(toDistanceInMiles,gotoPage+startPage);			
+			if (startPage &gt; 1)
+				getAListPage(toDistanceInMiles, gotoPage + startPage);
 		}
-		
-		int numFoundInDB=0; // Number of GC-founds already in this profile
+
+		int numFoundInDB = 0; // Number of GC-founds already in this profile
 		if (spiderAllFinds) {
-			numFoundInDB=getFoundInDB();
-			pref.log((spiderAllFinds ? &quot;all Finds (DB/GC)&quot;+ numFoundInDB+&quot;/&quot;+numFinds : &quot;new and update Caches&quot;)+Preferences.NEWLINE,null);
-			maxNew=java.lang.Math.min(numFinds-numFoundInDB,maxNew);
-			if (maxUpdate == 0 &amp;&amp; maxNew == 0) { Vm.showWait(false); infB.close(0); return null; }
+			numFoundInDB = getFoundInDB();
+			pref.log((spiderAllFinds ? &quot;all Finds (DB/GC)&quot; + numFoundInDB + &quot;/&quot;
+					+ numFinds : &quot;new and update Caches&quot;)
+					+ Preferences.NEWLINE, null);
+			maxNew = java.lang.Math.min(numFinds - numFoundInDB, maxNew);
+			if (maxUpdate == 0 &amp;&amp; maxNew == 0) {
+				Vm.showWait(false);
+				infB.close(0);
+				return null;
+			}
 		}
 
-		if (maxUpdate&gt;0) {
-			double distanceInKm=toDistance;
-			if ( pref.metricSystem == Metrics.IMPERIAL ) {
-				distanceInKm = Metrics.convertUnit(toDistance, Metrics.MILES, Metrics.KILOMETER);
+		if (maxUpdate &gt; 0) {
+			double distanceInKm = toDistance;
+			if (pref.metricSystem == Metrics.IMPERIAL) {
+				distanceInKm = Metrics.convertUnit(toDistance, Metrics.MILES,
+						Metrics.KILOMETER);
 			}
-			// expecting all are changed (archived caches remain always) 
-			for(int i = 0; i&lt;cacheDB.size();i++){
+			// expecting all are changed (archived caches remain always)
+			for (int i = 0; i &lt; cacheDB.size(); i++) {
 				CacheHolder ch = cacheDB.get(i);
 				if (spiderAllFinds) {
-					if ( (ch.getWayPoint().substring(0,2).equalsIgnoreCase(&quot;GC&quot;))
-							&amp;&amp; !ch.is_black() ) {
+					if ((ch.getWayPoint().substring(0, 2)
+							.equalsIgnoreCase(&quot;GC&quot;))
+							&amp;&amp; !ch.is_black()) {
 						cExpectedForUpdate.put(ch.getWayPoint(), ch);
 					}
 				} else {
-					if ( (!ch.is_archived())
+					if ((!ch.is_archived())
 							&amp;&amp; (ch.kilom &lt;= distanceInKm)
-							&amp;&amp; !(doNotgetFound &amp;&amp; (ch.is_found() || ch.is_owned()))
-							&amp;&amp; (ch.getWayPoint().substring(0,2).equalsIgnoreCase(&quot;GC&quot;))
-							&amp;&amp; ( (restrictedCacheType == CacheType.CW_TYPE_ERROR) || (ch.getType() == restrictedCacheType) )
-							&amp;&amp; !ch.is_black() ) {
+							&amp;&amp; !(doNotgetFound &amp;&amp; (ch.is_found() || ch
+									.is_owned()))
+							&amp;&amp; (ch.getWayPoint().substring(0, 2)
+									.equalsIgnoreCase(&quot;GC&quot;))
+							&amp;&amp; ((restrictedCacheType == CacheType.CW_TYPE_ERROR) || (ch
+									.getType() == restrictedCacheType))
+							&amp;&amp; !ch.is_black()) {
 						cExpectedForUpdate.put(ch.getWayPoint(), ch);
 					}
 				}
 			}
 		}
-		int startSize=cExpectedForUpdate.size(); //for save reasons
+		int startSize = cExpectedForUpdate.size(); // for save reasons
 
 		Hashtable cFoundForUpdate = new Hashtable(cacheDB.size()); // for don't loose the already done work
 		page_number = 1;
 		int found_on_page = 0;
 		try {
-			//Loop pages till maximum distance has been found or no more caches are in the list
-			while(toDistance &gt; 0){
+			// Loop pages till maximum distance has been found or no more caches are in the list
+			while (toDistance &gt; 0) {
 				RexPropListBlock.search(htmlListPage);
 				String tableOfHtmlListPage;
 				if (RexPropListBlock.didMatch()) {
 					tableOfHtmlListPage = RexPropListBlock.stringMatched(1);
-				}
-				else {
-					pref.log(&quot;check listBlockRex in spider.def&quot;+Preferences.NEWLINE+htmlListPage);
+				} else {
+					pref.log(&quot;check listBlockRex in spider.def&quot; + Preferences.NEWLINE + htmlListPage);
 					tableOfHtmlListPage = &quot;&quot;;
 				}
 				RexPropLine.search(tableOfHtmlListPage);
-				while (toDistance &gt; 0){
+				while (toDistance &gt; 0) {
 					if (!RexPropLine.didMatch()) {
-						if (page_number==1 &amp;&amp; found_on_page==0) pref.log(&quot;check lineRex in spider.def&quot;);
+						if (page_number == 1 &amp;&amp; found_on_page == 0)
+							pref.log(&quot;check lineRex in spider.def&quot;);
 						break;
 					}
 					found_on_page++;
-					if (Global.mainTab.statBar!=null) Global.mainTab.statBar.updateDisplay(&quot;working &quot;+page_number+&quot; / &quot;+found_on_page);
-					String CacheDescriptionGC=RexPropLine.stringMatched(1);
-					double gotDistance=getDistGC(CacheDescriptionGC);
-					String chWaypoint=getWP(CacheDescriptionGC);
-					if(gotDistance &lt;= toDistance){
-						CacheHolder ch=cacheDB.get(chWaypoint);
-						if(ch == null){ // not in DB
-							if ( gotDistance &gt;= fromDistance &amp;&amp;
-									 directionOK(directions,getDirection(CacheDescriptionGC))  &amp;&amp;
-									 doPMCache(CacheDescriptionGC) &amp;&amp;
-									 cachesToLoad.size() &lt; maxNew){
-								if (CacheDescriptionGC.indexOf(propFound)!=-1) chWaypoint=chWaypoint+&quot;found&quot;;
+					if (Global.mainTab.statBar != null)
+						Global.mainTab.statBar.updateDisplay(&quot;working &quot;
+								+ page_number + &quot; / &quot; + found_on_page);
+					String CacheDescriptionGC = RexPropLine.stringMatched(1);
+					double gotDistance = getDistGC(CacheDescriptionGC);
+					String chWaypoint = getWP(CacheDescriptionGC);
+					if (gotDistance &lt;= toDistance) {
+						CacheHolder ch = cacheDB.get(chWaypoint);
+						if (ch == null) { // not in DB
+							if (gotDistance &gt;= fromDistance
+									&amp;&amp; directionOK(directions,
+											getDirection(CacheDescriptionGC))
+									&amp;&amp; doPMCache(CacheDescriptionGC)
+									&amp;&amp; cachesToLoad.size() &lt; maxNew) {
+								if (CacheDescriptionGC.indexOf(propFound) != -1)
+									chWaypoint = chWaypoint + &quot;found&quot;;
 								if (!cachesToLoad.contains(chWaypoint)) {
 									cachesToLoad.add(chWaypoint);
 								}
+							} else {
+								// pref.log(&quot;no load of (Premium Cache/other direction/short Distance ?) &quot; + chWaypoint);
+								cExpectedForUpdate.remove(chWaypoint);
 							}
-							else {
-								// pref.log(&quot;no load of (Premium Cache/other direction/short Distance ?) &quot; + chWaypoint);
-								cExpectedForUpdate.remove( chWaypoint );
-								}
-						}
-						else {
-							if (maxUpdate&gt;0) { // regardless of fromDistance
+						} else {
+							if (maxUpdate &gt; 0) { // regardless of fromDistance
 								if (!ch.is_black()) {
-									if (doPMCache(CacheDescriptionGC) &amp;&amp; updateExists(ch,CacheDescriptionGC)) {
-										if (cFoundForUpdate.size()&lt;maxUpdate) {
-											cFoundForUpdate.put(chWaypoint, ch); }
-										else cExpectedForUpdate.remove( chWaypoint );
-									}
-									else cExpectedForUpdate.remove( chWaypoint );
-								}
-								else cExpectedForUpdate.remove( chWaypoint );
+									if (doPMCache(CacheDescriptionGC)
+											&amp;&amp; updateExists(ch,
+													CacheDescriptionGC)) {
+										if (cFoundForUpdate.size() &lt; maxUpdate) {
+											cFoundForUpdate.put(chWaypoint, ch);
+										} else
+											cExpectedForUpdate
+													.remove(chWaypoint);
+									} else
+										cExpectedForUpdate.remove(chWaypoint);
+								} else
+									cExpectedForUpdate.remove(chWaypoint);
 							}
 						}
-						if(cachesToLoad.size() &gt;= maxNew) {
-							if(cFoundForUpdate.size() &gt;= maxUpdate) {
-								toDistance=0;
+						if (cachesToLoad.size() &gt;= maxNew) {
+							if (cFoundForUpdate.size() &gt;= maxUpdate) {
+								toDistance = 0;
 								cExpectedForUpdate.clear();
 							} else {
-								if ( cExpectedForUpdate.size() &lt;= cFoundForUpdate.size() ) {
-									toDistance=0;
+								if (cExpectedForUpdate.size() &lt;= cFoundForUpdate
+										.size()) {
+									toDistance = 0;
 								}
 							}
 						}
-					} else toDistance = 0; // finish listing
+					} else
+						toDistance = 0; // finish listing
 					// get next row of table (next Cache Description) of this htmlListPage
-					RexPropLine.searchFrom(tableOfHtmlListPage, RexPropLine.matchedTo());
+					RexPropLine.searchFrom(tableOfHtmlListPage, RexPropLine
+							.matchedTo());
 					if (infB.isClosed) {
-						toDistance=0; break; }
+						toDistance = 0;
+						break;
+					}
 				} // next Cache
-				 infB.setInfo(MyLocale.getMsg(5511,&quot;Found &quot;)+
-						 cachesToLoad.size()+&quot; / &quot;+
-						 cFoundForUpdate.size()+
-						 MyLocale.getMsg(5512,&quot; caches&quot;));
-				if(found_on_page &lt; 20) {
+				infB.setInfo(MyLocale.getMsg(5511, &quot;Found &quot;)
+						+ cachesToLoad.size() + &quot; / &quot; + cFoundForUpdate.size()
+						+ MyLocale.getMsg(5512, &quot; caches&quot;));
+				if (found_on_page &lt; 20) {
 					if (spiderAllFinds) {
 						// check all pages ( seen a gc-account with found_on_page less 20 and not on end )
-						if (((page_number-1)*20+found_on_page) &gt;= numFinds) {
+						if (((page_number - 1) * 20 + found_on_page) &gt;= numFinds) {
 							toDistance = 0;
 						}
-					}
-					else toDistance = 0; // last page (has less than 20 entries!?) to check reached
+					} else
+						toDistance = 0; // last page (has less than 20 entries!?) to check reached
 				}
-				if(toDistance &gt; 0){getAListPage(toDistanceInMiles, gotoNextPage); page_number++; found_on_page = 0;}
+				if (toDistance &gt; 0) {
+					getAListPage(toDistanceInMiles, gotoNextPage);
+					page_number++;
+					found_on_page = 0;
+				}
 			} // loop pages
 		} // try
 		catch (Exception ex) {
@@ -834,7 +1014,6 @@
 			infB.close(0);
 			Vm.showWait(false);
 		}
-
 		pref.log(&quot;Checked &quot; + page_number + &quot; pages&quot;+Preferences.NEWLINE+
 				&quot;with &quot; + ((page_number-1)*20+found_on_page) + &quot; caches&quot;+Preferences.NEWLINE+
 				&quot;Found &quot; + cachesToLoad.size() + &quot; new caches&quot;+Preferences.NEWLINE+
@@ -849,83 +1028,108 @@
 			&quot;Found &quot; + numArchivedUpdates + &quot; caches with changed archived status.&quot;+Preferences.NEWLINE,null);
 		}
 
-		if (cExpectedForUpdate.size() == startSize) cExpectedForUpdate.clear(); // there must be something wrong
-		if (cExpectedForUpdate.size() == 0 || cExpectedForUpdate.size() &gt; maxUpdate)
-			cExpectedForUpdate=cFoundForUpdate;
+		if (cExpectedForUpdate.size() == startSize)
+			cExpectedForUpdate.clear(); // there must be something wrong
+		if (cExpectedForUpdate.size() == 0
+				|| cExpectedForUpdate.size() &gt; maxUpdate)
+			cExpectedForUpdate = cFoundForUpdate;
 		return cExpectedForUpdate;
-		
+
 	}
 
-	private int downloadCaches(Vector cachesToLoad, int spiderErrors, int totalCachesToLoad, boolean loadAllLogs) {
-		for(int i = 0; i&lt;cachesToLoad.size(); i++){
-			if (infB.isClosed) break;
-			String wpt = (String)cachesToLoad.get(i);
-			boolean is_found = wpt.indexOf(&quot;found&quot;)!=-1;
-			if (is_found) wpt=wpt.substring(0,wpt.indexOf(&quot;found&quot;));
+	private int downloadCaches(Vector cachesToLoad, int spiderErrors,
+			int totalCachesToLoad, boolean loadAllLogs) {
+		for (int i = 0; i &lt; cachesToLoad.size(); i++) {
+			if (infB.isClosed)
+				break;
+			String wpt = (String) cachesToLoad.get(i);
+			boolean is_found = wpt.indexOf(&quot;found&quot;) != -1;
+			if (is_found)
+				wpt = wpt.substring(0, wpt.indexOf(&quot;found&quot;));
 			// Get only caches not already available in the DB
-			if(cacheDB.getIndex(wpt) == -1){
-				infB.setInfo(MyLocale.getMsg(5513,&quot;Loading: &quot;) + wpt +&quot; (&quot; + (i+1) + &quot; / &quot; + totalCachesToLoad + &quot;)&quot;);
+			if (cacheDB.getIndex(wpt) == -1) {
+				infB.setInfo(MyLocale.getMsg(5513, &quot;Loading: &quot;) + wpt + &quot; (&quot;
+						+ (i + 1) + &quot; / &quot; + totalCachesToLoad + &quot;)&quot;);
 				CacheHolder holder = new CacheHolder();
 				holder.setWayPoint(wpt);
-				int test = getCacheByWaypointName(holder,false,pref.downloadPics,pref.downloadTBs,doNotgetFound,loadAllLogs||is_found);
+				int test = getCacheByWaypointName(holder, false,
+						pref.downloadPics, pref.downloadTBs, doNotgetFound,
+						loadAllLogs || is_found);
 				if (test == SPIDER_CANCEL) {
 					infB.close(0);
 					break;
 				} else if (test == SPIDER_ERROR) {
 					spiderErrors++;
-				} else if (test == SPIDER_OK){
+				} else if (test == SPIDER_OK) {
 					cacheDB.add(holder);
 					holder.save();
-				} // For test == SPIDER_IGNORE_PREMIUM and SPIDER_IGNORE there is nothing to do
+				} // For test == SPIDER_IGNORE_PREMIUM and SPIDER_IGNORE there
+					// is nothing to do
 			}
 		}
 		return spiderErrors;
 	}
-	private int updateCaches(Hashtable cachesToUpdate, int spiderErrors, int totalCachesToLoad, boolean loadAllLogs) {
+
+	private int updateCaches(Hashtable cachesToUpdate, int spiderErrors,
+			int totalCachesToLoad, boolean loadAllLogs) {
 		int j = 1;
-		for (Enumeration e = cachesToUpdate.elements() ; e.hasMoreElements() ; j++) {
-			if (infB.isClosed) break;
-			CacheHolder ch = (CacheHolder)e.nextElement();
-			infB.setInfo(MyLocale.getMsg(5513,&quot;Loading: &quot;) + ch.getWayPoint() +&quot; (&quot; + (cachesToLoad.size()+j) + &quot; / &quot; + totalCachesToLoad + &quot;)&quot;);
-			int test = spiderSingle(cacheDB.getIndex(ch), infB,false,loadAllLogs);
+		for (Enumeration e = cachesToUpdate.elements(); e.hasMoreElements(); j++) {
+			if (infB.isClosed)
+				break;
+			CacheHolder ch = (CacheHolder) e.nextElement();
+			infB.setInfo(MyLocale.getMsg(5513, &quot;Loading: &quot;) + ch.getWayPoint()
+					+ &quot; (&quot; + (cachesToLoad.size() + j) + &quot; / &quot;
+					+ totalCachesToLoad + &quot;)&quot;);
+			int test = spiderSingle(cacheDB.getIndex(ch), infB, false,
+					loadAllLogs);
 			if (test == SPIDER_CANCEL) {
 				break;
 			} else if (test == SPIDER_ERROR) {
 				spiderErrors++;
-				pref.log(&quot;[updateCaches] could not spider &quot;+ch.getWayPoint(),null);
+				pref.log(&quot;[updateCaches] could not spider &quot; + ch.getWayPoint(), null);
 			} else {
-				//profile.hasUnsavedChanges=true;
+				// profile.hasUnsavedChanges=true;
 			}
 		}
 		return spiderErrors;
 	}
+
 	/**
-	 * Method to spider a single cache.
-	 * It assumes a login has already been performed!
-	 * @return 1 if spider was successful, -1 if spider was cancelled by closing the infobox, 0 error, but continue with next cache
+	 * Method to spider a single cache. It assumes a login has already been
+	 * performed!
+	 * 
+	 * @return 1 if spider was successful, -1 if spider was cancelled by closing
+	 *         the infobox, 0 error, but continue with next cache
 	 */
-	public int spiderSingle(int number, InfoBox pInfB, boolean forceLogin, boolean loadAllLogs){
-		int ret=-1;
+	public int spiderSingle(int number, InfoBox pInfB, boolean forceLogin,
+			boolean loadAllLogs) {
+		int ret = -1;
 		this.infB = pInfB;
 		CacheHolder ch = new CacheHolder(); // cacheDB.get(number);
 		ch.setWayPoint(cacheDB.get(number).getWayPoint());
-		if (ch.isAddiWpt()) return -1;  // No point re-spidering an addi waypoint, comes with parent
+		if (ch.isAddiWpt())
+			return -1; // No point re-spidering an addi waypoint, comes with
+						// parent
 
 		// check if we need to login
-		if (!loggedIn || forceLogin){
-			if (this.login()!=FormBase.IDOK) return -1;
+		if (!loggedIn || forceLogin) {
+			if (this.login() != FormBase.IDOK)
+				return -1;
 			// loggedIn is already set by this.login()
 		}
-		try{
+		try {
 			// Read the cache data from GC.COM and compare to old data
-			ret=getCacheByWaypointName(ch,true,pref.downloadPics,pref.downloadTBs,false,loadAllLogs);
+			ret = getCacheByWaypointName(ch, true, pref.downloadPics,
+					pref.downloadTBs, false, loadAllLogs);
 			// Save the spidered data
 			if (ret == SPIDER_OK) {
 				CacheHolder cacheInDB = cacheDB.get(number);
 				cacheInDB.initStates(false);
-				if (cacheInDB.is_found() &amp;&amp; !ch.is_found() &amp;&amp; ! loadAllLogs) {
-					// If the number of logs to spider is 5 or less, then the &quot;not found&quot; information
-					// of the spidered cache is not credible. In this case it should not overwrite
+				if (cacheInDB.is_found() &amp;&amp; !ch.is_found() &amp;&amp; !loadAllLogs) {
+					// If the number of logs to spider is 5 or less, then the
+					// &quot;not found&quot; information
+					// of the spidered cache is not credible. In this case it
+					// should not overwrite
 					// the &quot;found&quot; state of an existing cache.
 					ch.setFound(true);
 				}
@@ -933,43 +1137,49 @@
 				ch.setNumRecommended(cacheInDB.getNumRecommended());
 				if (pref.downloadPics) {
 					// delete obsolete images when we have current set
-					CacheImages.cleanupOldImages(cacheInDB.getCacheDetails(true).images, ch.getCacheDetails(false).images);
+					CacheImages.cleanupOldImages(cacheInDB
+							.getCacheDetails(true).images, ch
+							.getCacheDetails(false).images);
 				} else {
 					// preserve images if not downloaded
-					ch.getCacheDetails(false).images = cacheInDB.getCacheDetails(true).images;
+					ch.getCacheDetails(false).images = cacheInDB
+							.getCacheDetails(true).images;
 				}
 				cacheInDB.update(ch);
 				cacheInDB.save();
 			}
-		}catch(Exception ex){
-			pref.log(&quot;[spiderSingle] Error spidering &quot; + ch.getWayPoint() + &quot; in spiderSingle&quot;,ex);
+		} catch (Exception ex) {
+			pref.log(&quot;[spiderSingle] Error spidering &quot; + ch.getWayPoint() + &quot; in spiderSingle&quot;, ex);
 		}
 		return ret;
 	} // spiderSingle
 
 	/**
 	 * Fetch the coordinates of a waypoint from GC
-	 * @param wayPoint the name of the waypoint
+	 * 
+	 * @param wayPoint
+	 *            the name of the waypoint
 	 * @return the cache coordinates
 	 */
 	public String getCacheCoordinates(String wayPoint) {
 		String completeWebPage;
-		// Check whether spider definitions could be loaded, if not issue appropriate message and terminate
+		// Check whether spider definitions could be loaded, if not issue
+		// appropriate message and terminate
 		// Try to login. If login fails, issue appropriate message and terminate
 		if (!loggedIn || pref.forceLogin) {
-			if (login()!=FormBase.IDOK) {
+			if (login() != FormBase.IDOK) {
 				return &quot;&quot;;
 			}
 		}
 		InfoBox localInfB = new InfoBox(&quot;Info&quot;, &quot;Loading&quot;, InfoBox.PROGRESS_WITH_WARNINGS);
 		localInfB.exec();
-		try{
+		try {
 			String doc = p.getProp(&quot;waypoint&quot;) + wayPoint;
-			completeWebPage = fetch(doc,false);
+			completeWebPage = fetch(doc, false);
 			pref.log(&quot;Fetched &quot; + wayPoint);
-		}catch(Exception ex){
+		} catch (Exception ex) {
 			localInfB.close(0);
-			pref.log(&quot;[getCacheCoordinates] Could not fetch &quot; + wayPoint,ex);
+			pref.log(&quot;[getCacheCoordinates] Could not fetch &quot; + wayPoint, ex);
 			return &quot;&quot;;
 		}
 		localInfB.close(0);
@@ -981,160 +1191,195 @@
 	} // getCacheCoordinates
 
 	/**
-	 * Method to login the user to gc.com
-	 * It will request a password and use the alias defined in preferences
-	 * If the login page cannot be fetched, the password is cleared.
-	 * If the login fails, an appropriate message is displayed.
+	 * Method to login the user to gc.com It will request a password and use the
+	 * alias defined in preferences If the login page cannot be fetched, the
+	 * password is cleared. If the login fails, an appropriate message is
+	 * displayed.
 	 */
-	private int login(){
+	private int login() {
+		String passwort = pref.password;
 		loggedIn = false;
-		String loginPage,loginPageUrl,loginSuccess,nextPage;
+		String loginPage, loginPageUrl, loginSuccess, nextPage;
 		try {
-			loginPageUrl=p.getProp(&quot;loginPage&quot;);
-			loginSuccess=p.getProp(&quot;loginSuccess&quot;);
-			nextPage=p.getProp(&quot;nextPage&quot;);
+			loginPageUrl = p.getProp(&quot;loginPage&quot;);
+			loginSuccess = p.getProp(&quot;loginSuccess&quot;);
+			nextPage = p.getProp(&quot;nextPage&quot;);
 		} catch (Exception ex) { // Tag not found in spider.def
 			return ERR_LOGIN;
 		}
-		//Get password
-		InfoBox localInfB = new InfoBox(MyLocale.getMsg(5506,&quot;Password&quot;), MyLocale.getMsg(5505,&quot;Enter Password&quot;), InfoBox.INPUT);
-		localInfB.feedback.setText(passwort); // Remember the PWD for next time
-		localInfB.feedback.isPassword=true;
-		int code=FormBase.IDOK;
+		// Get password
+		InfoBox localInfB = new InfoBox(MyLocale.getMsg(5506, &quot;Password&quot;),
+				MyLocale.getMsg(5505, &quot;Enter Password&quot;), InfoBox.INPUT);
+		localInfB.feedback.setText(passwort);
+		localInfB.feedback.isPassword = true;
+		int code = FormBase.IDOK;
 		if (passwort.equals(&quot;&quot;)) {
 			code = localInfB.execute();
 			passwort = localInfB.getInput();
 		}
 		localInfB.close(0);
-		if(code != FormBase.IDOK) return code;
+		if (code != FormBase.IDOK)
+			return code;
 		// Now start the login proper
-		localInfB = new InfoBox(MyLocale.getMsg(5507,&quot;Status&quot;), MyLocale.getMsg(5508,&quot;Logging in...&quot;));
+		localInfB = new InfoBox(MyLocale.getMsg(5507, &quot;Status&quot;), MyLocale.getMsg(5508, &quot;Logging in...&quot;));
 		localInfB.exec();
-		try{
-			//Access the page once to get a viewstate
-			loginPage = fetch(loginPageUrl,true);   //<A HREF="http://www.geocaching.com/login/Default.aspx">http://www.geocaching.com/login/Default.aspx</A>
-			pref.log(&quot;[login]:Fetched login page &quot;+loginPageUrl);
+		try {
+			// Access the page once to get a viewstate
+			loginPage = fetch(loginPageUrl, true); // <A HREF="http://www.geocaching.com/login/Default.aspx">http://www.geocaching.com/login/Default.aspx</A>
+			pref.log(&quot;[login]:Fetched login page &quot; + loginPageUrl);
 			if (loginPage.equals(&quot;&quot;)) {
 				localInfB.close(0);
-				(new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;), MyLocale.getMsg(5499,&quot;Error loading login page.%0aPlease check your internet connection.&quot;), FormBase.OKB)).execute();
-				pref.log(&quot;[login]:Could not fetch: gc.com login page &quot;+loginPageUrl,null);
+				(new MessageBox(MyLocale.getMsg(5500, &quot;Error&quot;),
+						MyLocale.getMsg(5499,&quot;Error loading login page.%0aPlease check your internet connection.&quot;),
+						FormBase.OKB)).execute();
+				pref.log(&quot;[login]:Could not fetch: gc.com login page &quot; + loginPageUrl, null);
 				return ERR_LOGIN;
 			}
-		} catch(Exception ex){
+		} catch (Exception ex) {
 			localInfB.close(0);
-			(new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;), MyLocale.getMsg(5499,&quot;Error loading login page.%0aPlease check your internet connection.&quot;), FormBase.OKB)).execute();
-			pref.log(&quot;[login]:Could not fetch: gc.com login page&quot;,ex);
+			(new MessageBox(MyLocale.getMsg(5500, &quot;Error&quot;),
+					MyLocale.getMsg(5499, &quot;Error loading login page.%0aPlease check your internet connection.&quot;),
+					FormBase.OKB)).execute();
+			pref.log(&quot;[login]:Could not fetch: gc.com login page&quot;, ex);
 			return ERR_LOGIN;
 		}
 		if (!localInfB.isClosed) { // If user has not aborted, we continue
 			Regex rexCookieID = new Regex(&quot;(?i)Set-Cookie: userid=(.*?);.*&quot;);
-			Regex rexViewstate = new Regex(&quot;id=\&quot;__VIEWSTATE\&quot; value=\&quot;(.*?)\&quot; /&gt;&quot;);
-			// Regex rexViewstate1 = new Regex(&quot;id=\&quot;__VIEWSTATE1\&quot; value=\&quot;(.*?)\&quot; /&gt;&quot;);
-			// Regex rexEventvalidation = new Regex(&quot;id=\&quot;__EVENTVALIDATION\&quot; value=\&quot;(.*?)\&quot; /&gt;&quot;);
-			Regex rexCookieSession = new Regex(&quot;(?i)Set-Cookie: ASP.NET_SessionId=(.*?);.*&quot;);
-			String viewstate=&quot;&quot;;
+			Regex rexViewstate = new Regex(
+					&quot;id=\&quot;__VIEWSTATE\&quot; value=\&quot;(.*?)\&quot; /&gt;&quot;);
+			// Regex rexViewstate1 = new
+			// Regex(&quot;id=\&quot;__VIEWSTATE1\&quot; value=\&quot;(.*?)\&quot; /&gt;&quot;);
+			// Regex rexEventvalidation = new
+			// Regex(&quot;id=\&quot;__EVENTVALIDATION\&quot; value=\&quot;(.*?)\&quot; /&gt;&quot;);
+			Regex rexCookieSession = new Regex(
+					&quot;(?i)Set-Cookie: ASP.NET_SessionId=(.*?);.*&quot;);
+			String viewstate = &quot;&quot;;
 			rexViewstate.search(loginPage);
-			if(rexViewstate.didMatch()){
+			if (rexViewstate.didMatch()) {
 				viewstate = rexViewstate.stringMatched(1);
 			} else {
-				pref.log(&quot;[login]:rexViewstate not found before login&quot;,null);
+				pref.log(&quot;[login]:rexViewstate not found before login&quot;, null);
 			}
 
-			if(loginPage.indexOf(loginSuccess) &gt; 0)
-				pref.log(&quot;[login]:Already logged in&quot;+pref.myAlias);
+			if (loginPage.indexOf(loginSuccess) &gt; 0)
+				pref.log(&quot;[login]:Already logged in&quot; + pref.myAlias);
 			else {
 				/*
-				rexEventvalidation.search(loginPage);
-				if(rexEventvalidation.didMatch()){
-					// eventvalidation = rexEventvalidation.stringMatched(1);
-				} else
-					pref.log(&quot;[login]:rexEventvalidation not found before login&quot;,null);
-				//Ok now login!
+				 * rexEventvalidation.search(loginPage);
+				 * if(rexEventvalidation.didMatch()){ // eventvalidation =
+				 * rexEventvalidation.stringMatched(1); } else
+				 * pref.log(&quot;[login]:rexEventvalidation not found before login&quot;
+				 * ,null); //Ok now login!
 				 */
-				try{
-					StringBuffer sb=new StringBuffer(1000);
-					sb.append(URL.encodeURL(&quot;__VIEWSTATE&quot;,false));	sb.append(&quot;=&quot;); sb.append(URL.encodeURL(viewstate,false));
-					sb.append(&quot;&amp;ctl00%24ContentBody%24&quot;); sb.append(URL.encodeURL(&quot;myUsername&quot;,false));
-					sb.append(&quot;=&quot;); sb.append(encodeUTF8URL(Utils.encodeJavaUtf8String(pref.myAlias)));
-					sb.append(&quot;&amp;ctl00%24ContentBody%24&quot;); sb.append(URL.encodeURL(&quot;myPassword&quot;,false));
-					sb.append(&quot;=&quot;); sb.append(encodeUTF8URL(Utils.encodeJavaUtf8String(passwort)));
-					sb.append(&quot;&amp;ctl00%24ContentBody%24&quot;); sb.append(URL.encodeURL(&quot;cookie&quot;,false));
-					sb.append(&quot;=&quot;); sb.append(URL.encodeURL(&quot;on&quot;,false));
-					sb.append(&quot;&amp;ctl00%24ContentBody%24&quot;); sb.append(URL.encodeURL(&quot;Button1&quot;,false));
-					sb.append(&quot;=&quot;); sb.append(URL.encodeURL(&quot;Login&quot;,false));
-//					sb.append(&quot;&amp;&quot;); sb.append(URL.encodeURL(&quot;__EVENTVALIDATION&quot;,false));
-//					sb.append(&quot;=&quot;); sb.append(URL.encodeURL(eventvalidation,false));
-					loginPage = fetch_post(loginPageUrl, sb.toString(), nextPage, true);  // /login/default.aspx
-					if(loginPage.indexOf(loginSuccess) &gt; 0)
-						pref.log(&quot;Login successful: &quot;+pref.myAlias);
+				try {
+					StringBuffer sb = new StringBuffer(1000);
+					sb.append(URL.encodeURL(&quot;__VIEWSTATE&quot;, false));
+					sb.append(&quot;=&quot;);
+					sb.append(URL.encodeURL(viewstate, false));
+					sb.append(&quot;&amp;ctl00%24ContentBody%24&quot;);
+					sb.append(URL.encodeURL(&quot;myUsername&quot;, false));
+					sb.append(&quot;=&quot;);
+					sb.append(encodeUTF8URL(Utils
+							.encodeJavaUtf8String(pref.myAlias)));
+					sb.append(&quot;&amp;ctl00%24ContentBody%24&quot;);
+					sb.append(URL.encodeURL(&quot;myPassword&quot;, false));
+					sb.append(&quot;=&quot;);
+					sb.append(encodeUTF8URL(Utils
+							.encodeJavaUtf8String(passwort)));
+					sb.append(&quot;&amp;ctl00%24ContentBody%24&quot;);
+					sb.append(URL.encodeURL(&quot;cookie&quot;, false));
+					sb.append(&quot;=&quot;);
+					sb.append(URL.encodeURL(&quot;on&quot;, false));
+					sb.append(&quot;&amp;ctl00%24ContentBody%24&quot;);
+					sb.append(URL.encodeURL(&quot;Button1&quot;, false));
+					sb.append(&quot;=&quot;);
+					sb.append(URL.encodeURL(&quot;Login&quot;, false));
+					// sb.append(&quot;&amp;&quot;);
+					// sb.append(URL.encodeURL(&quot;__EVENTVALIDATION&quot;,false));
+					// sb.append(&quot;=&quot;);
+					// sb.append(URL.encodeURL(eventvalidation,false));
+					loginPage = fetch_post(loginPageUrl, sb.toString(),
+							nextPage, true); // /login/default.aspx
+					if (loginPage.indexOf(loginSuccess) &gt; 0)
+						pref.log(&quot;Login successful: &quot; + pref.myAlias);
 					else {
-						pref.log(&quot;Login failed. Wrong Account or Password? &quot;+pref.myAlias,null);
-						pref.log(&quot;[login.LoginUrl]:&quot;+sb.toString(),null);
-						pref.log(&quot;[login.Answer]:&quot;+loginPage,null);
+						pref.log(&quot;Login failed. Wrong Account or Password? &quot; + pref.myAlias, null);
+						pref.log(&quot;[login.LoginUrl]:&quot; + sb.toString(), null);
+						pref.log(&quot;[login.Answer]:&quot; + loginPage, null);
 						localInfB.close(0);
-						(new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;), MyLocale.getMsg(5501,&quot;Login failed! Wrong account or password?&quot;), FormBase.OKB)).execute();
+						(new MessageBox(MyLocale.getMsg(5500, &quot;Error&quot;),
+								MyLocale.getMsg(5501,&quot;Login failed! Wrong account or password?&quot;),
+								FormBase.OKB)).execute();
 						return ERR_LOGIN;
 					}
-				}catch(Exception ex){
+				} catch (Exception ex) {
 					pref.log(&quot;[login]:Login failed with exception.&quot;, ex);
 					localInfB.close(0);
-					(new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;), MyLocale.getMsg(5501,&quot;Login failed. Error loading page after login.&quot;), FormBase.OKB)).execute();
+					(new MessageBox(MyLocale.getMsg(5500, &quot;Error&quot;),
+							MyLocale.getMsg(5501,&quot;Login failed. Error loading page after login.&quot;),
+							FormBase.OKB)).execute();
 					return ERR_LOGIN;
 				}
 			}
 
 			rexViewstate.search(loginPage);
 			if (!rexViewstate.didMatch()) {
-				pref.log(&quot;[login]:check rexViewstate in SpiderGC.java --&gt; not found after login&quot;+Preferences.NEWLINE+loginPage,null);
+				pref.log(&quot;[login]:check rexViewstate in SpiderGC.java --&gt; not found after login&quot;
+						+ Preferences.NEWLINE + loginPage, null);
 			}
 			viewstate = rexViewstate.stringMatched(1);
-			
+
 			rexCookieID.search(loginPage);
 			if (!rexCookieID.didMatch()) {
-				pref.log(&quot;[login]:check rexCookieID in SpiderGC.java --&gt; CookieID not found. Using old one.&quot;+Preferences.NEWLINE+loginPage,null);
+				pref.log(&quot;[login]:check rexCookieID in SpiderGC.java --&gt; CookieID not found. Using old one.&quot;
+						 + Preferences.NEWLINE + loginPage, null);
 			} else
 				cookieID = rexCookieID.stringMatched(1);
 			rexCookieSession.search(loginPage);
 			if (!rexCookieSession.didMatch()) {
-				pref.log(&quot;[login]:check rexCookieSession in SpiderGC.java --&gt; CookieSession not found. Using old one.&quot;+Preferences.NEWLINE+loginPage);
+				pref.log(&quot;[login]:check rexCookieSession in SpiderGC.java --&gt; CookieSession not found. Using old one.&quot;
+						+ Preferences.NEWLINE + loginPage);
 			} else
 				cookieSession = rexCookieSession.stringMatched(1);
 
 			/*
-			String viewstate1;
-			rexViewstate1.search(loginPage);
-			if(rexViewstate1.didMatch()){
-				viewstate1 = rexViewstate1.stringMatched(1);
-			} else {
-				viewstate1 = &quot;&quot;;
-				pref.log(&quot;[login]:check rexViewstate1 in SpiderGC.java --&gt; not found after login&quot;+Preferences.NEWLINE+loginPage);
-			}
-			*/
-						
+			 * String viewstate1; rexViewstate1.search(loginPage);
+			 * if(rexViewstate1.didMatch()){ viewstate1 =
+			 * rexViewstate1.stringMatched(1); } else { viewstate1 = &quot;&quot;;
+			 * pref.log(
+			 * &quot;[login]:check rexViewstate1 in SpiderGC.java --&gt; not found after login&quot;
+			 * +Preferences.NEWLINE+loginPage); }
+			 */
+
 			/*
-			rexEventvalidation.search(htmlPage);
-			if(rexEventvalidation.didMatch()){
-				eventvalidation = rexEventvalidation.stringMatched(1);
-			} else {
-				eventvalidation = &quot;&quot;;
-			}
-			*/
+			 * rexEventvalidation.search(htmlPage);
+			 * if(rexEventvalidation.didMatch()){ eventvalidation =
+			 * rexEventvalidation.stringMatched(1); } else { eventvalidation =
+			 * &quot;&quot;; }
+			 */
 
 			String strEnglishPage = &quot;ctl00$uxLocaleList$uxLocaleList$ctl01$uxLocaleItem&quot;;
-			String postStr = URL.encodeURL(&quot;__EVENTTARGET&quot;,false) +&quot;=&quot;+ URL.encodeURL(strEnglishPage,false)
-		    + &quot;&amp;&quot; + URL.encodeURL(&quot;__EVENTARGUMENT&quot;,false) +&quot;=&quot;+ URL.encodeURL(&quot;&quot;,false)
-//		    + &quot;&amp;&quot; + URL.encodeURL(&quot;__VIEWSTATEFIELDCOUNT&quot;,false) +&quot;=2&quot;
-		    + &quot;&amp;&quot; + URL.encodeURL(&quot;__VIEWSTATE&quot;,false) +&quot;=&quot;+ URL.encodeURL(viewstate,false);
-//		    + &quot;&amp;&quot; + URL.encodeURL(&quot;__VIEWSTATE1&quot;,false) +&quot;=&quot;+ URL.encodeURL(viewstate1,false);
-//		    + &quot;&amp;&quot; + URL.encodeURL(&quot;__EVENTVALIDATION&quot;,false) +&quot;=&quot;+ URL.encodeURL(eventvalidation,false);
-			try{
+			String postStr = URL.encodeURL(&quot;__EVENTTARGET&quot;, false) + &quot;=&quot;
+					+ URL.encodeURL(strEnglishPage, false) + &quot;&amp;&quot;
+					+ URL.encodeURL(&quot;__EVENTARGUMENT&quot;, false) + &quot;=&quot;
+					+ URL.encodeURL(&quot;&quot;, false)
+					// + &quot;&amp;&quot; + URL.encodeURL(&quot;__VIEWSTATEFIELDCOUNT&quot;,false)
+					// +&quot;=2&quot;
+					+ &quot;&amp;&quot; + URL.encodeURL(&quot;__VIEWSTATE&quot;, false) + &quot;=&quot;
+					+ URL.encodeURL(viewstate, false);
+			// + &quot;&amp;&quot; + URL.encodeURL(&quot;__VIEWSTATE1&quot;,false) +&quot;=&quot;+
+			// URL.encodeURL(viewstate1,false);
+			// + &quot;&amp;&quot; + URL.encodeURL(&quot;__EVENTVALIDATION&quot;,false) +&quot;=&quot;+
+			// URL.encodeURL(eventvalidation,false);
+			try {
 				loginPage = fetch_post(loginPageUrl, postStr, nextPage, true);
 				pref.log(&quot;Switched to English&quot;);
-			}catch(Exception ex){
-				pref.log(&quot;Error switching to English: check/n&quot; + loginPageUrl + &quot;/n&quot; + postStr + &quot;/n&quot; + nextPage + &quot;/n&quot;,ex);
+			} catch (Exception ex) {
+				pref.log(&quot;Error switching to English: check/n&quot; + loginPageUrl
+						+ &quot;/n&quot; + postStr + &quot;/n&quot; + nextPage + &quot;/n&quot;, ex);
 			}
 		}
-		boolean loginAborted=localInfB.isClosed;
+		boolean loginAborted = localInfB.isClosed;
 		localInfB.close(0);
 		if (loginAborted)
 			return FormBase.IDCANCEL;
@@ -1143,25 +1388,26 @@
 			return FormBase.IDOK;
 		}
 	}
+
 	/*
 	 *
 	 */
 	private void initialiseProperties() {
 		try {
-			propFirstPage=p.getProp(&quot;firstPage&quot;);
-			propFirstPage2=p.getProp(&quot;firstPage2&quot;);
-			propFirstPageFinds=p.getProp(&quot;firstPageFinds&quot;);
-			propMaxDistance=p.getProp(&quot;maxDistance&quot;);
-			propShowOnlyFound=p.getProp(&quot;showOnlyFound&quot;);
+			propFirstPage = p.getProp(&quot;firstPage&quot;);
+			propFirstPage2 = p.getProp(&quot;firstPage2&quot;);
+			propFirstPageFinds = p.getProp(&quot;firstPageFinds&quot;);
+			propMaxDistance = p.getProp(&quot;maxDistance&quot;);
+			propShowOnlyFound = p.getProp(&quot;showOnlyFound&quot;);
 			RexPropListBlock = new Regex(p.getProp(&quot;listBlockRex&quot;));
 			RexPropLine = new Regex(p.getProp(&quot;lineRex&quot;));
 			RexNumFinds = new Regex(&quot;Total Records: &lt;b&gt;(.*?)&lt;/b&gt;&quot;);
 			RexPropLogDate = new Regex(p.getProp(&quot;logDateRex&quot;));
-			propAvailable=p.getProp(&quot;availableRex&quot;);
-			propArchived=p.getProp(&quot;archivedRex&quot;);
-			propFound=p.getProp(&quot;found&quot;);		
-			propPM=p.getProp(&quot;PMRex&quot;);
-			RexPropDirection=new Regex(p.getProp(&quot;directionRex&quot;));
+			propAvailable = p.getProp(&quot;availableRex&quot;);
+			propArchived = p.getProp(&quot;archivedRex&quot;);
+			propFound = p.getProp(&quot;found&quot;);
+			propPM = p.getProp(&quot;PMRex&quot;);
+			RexPropDirection = new Regex(p.getProp(&quot;directionRex&quot;));
 			RexPropDistance = new Regex(p.getProp(&quot;distRex&quot;));
 			RexPropWaypoint = new Regex(p.getProp(&quot;waypointRex&quot;));
 			RexPropType = new Regex(p.getProp(&quot;TypeRex&quot;));
@@ -1169,19 +1415,19 @@
 			RexPropDandT = new Regex(p.getProp(&quot;DandTRex&quot;));
 			RexPropOwn = new Regex(p.getProp(&quot;own&quot;));
 			RexLogBlock = new Regex(p.getProp(&quot;blockRex&quot;));
-			exSingleLog = new Extractor(&quot;&quot;,p.getProp(&quot;singleLogExStart&quot;), p.getProp(&quot;singleLogExEnd&quot;), 0, false); 
-			exIcon = new Extractor(&quot;&quot;,p.getProp(&quot;iconExStart&quot;), p.getProp(&quot;iconExEnd&quot;), 0, true);
-			exNameTemp = new Extractor(&quot;&quot;,p.getProp(&quot;nameTempExStart&quot;), p.getProp(&quot;nameTempExEnd&quot;), 0 , true);
-			exName = new Extractor(&quot;&quot;, p.getProp(&quot;nameExStart&quot;), p.getProp(&quot;nameExEnd&quot;), 0 , true);
-			exDate = new Extractor(&quot;&quot;,p.getProp(&quot;dateExStart&quot;), p.getProp(&quot;dateExEnd&quot;), 0 , true);
+			exSingleLog = new Extractor(&quot;&quot;, p.getProp(&quot;singleLogExStart&quot;), p.getProp(&quot;singleLogExEnd&quot;), 0, false);
+			exIcon = new Extractor(&quot;&quot;, p.getProp(&quot;iconExStart&quot;), p.getProp(&quot;iconExEnd&quot;), 0, true);
+			exNameTemp = new Extractor(&quot;&quot;, p.getProp(&quot;nameTempExStart&quot;), p.getProp(&quot;nameTempExEnd&quot;), 0, true);
+			exName = new Extractor(&quot;&quot;, p.getProp(&quot;nameExStart&quot;), p.getProp(&quot;nameExEnd&quot;), 0, true);
+			exDate = new Extractor(&quot;&quot;, p.getProp(&quot;dateExStart&quot;), p.getProp(&quot;dateExEnd&quot;), 0, true);
 			exLog = new Extractor(&quot;&quot;, p.getProp(&quot;logExStart&quot;), p.getProp(&quot;logExEnd&quot;), 0, true);
 			exLogId = new Extractor(&quot;&quot;, p.getProp(&quot;logIdExStart&quot;), p.getProp(&quot;logIdExEnd&quot;), 0, true);
-			icon_smile=p.getProp(&quot;icon_smile&quot;);
-			icon_camera=p.getProp(&quot;icon_camera&quot;);
-			icon_attended=p.getProp(&quot;icon_attended&quot;);
+			icon_smile = p.getProp(&quot;icon_smile&quot;);
+			icon_camera = p.getProp(&quot;icon_camera&quot;);
+			icon_attended = p.getProp(&quot;icon_attended&quot;);
 			RexCacheType = new Regex(p.getProp(&quot;cacheTypeRex&quot;));
-		}catch(Exception ex){
-			pref.log(&quot;Error fetching Properties.&quot;,ex);
+		} catch (Exception ex) {
+			pref.log(&quot;Error fetching Properties.&quot;, ex);
 		}
 	}
 
@@ -1189,299 +1435,381 @@
 	 *
 	 */
 	private void getFirstListPage(int distance) {
-		//Get first page
+		// Get first page
 
 		String url;
 		if (spiderAllFinds) {
-			url = propFirstPageFinds + encodeUTF8URL(Utils.encodeJavaUtf8String(pref.myAlias));
+			url = propFirstPageFinds
+					+ encodeUTF8URL(Utils.encodeJavaUtf8String(pref.myAlias));
 		} else {
-			url = propFirstPage + origin.getLatDeg(TransformCoordinates.DD) + propFirstPage2 + origin.getLonDeg(TransformCoordinates.DD)
-		                              + propMaxDistance + Integer.toString(distance);
-			if(doNotgetFound) url = url + propShowOnlyFound;
+			url = propFirstPage + origin.getLatDeg(TransformCoordinates.DD)
+					+ propFirstPage2
+					+ origin.getLonDeg(TransformCoordinates.DD)
+					+ propMaxDistance + Integer.toString(distance);
+			if (doNotgetFound)
+				url = url + propShowOnlyFound;
 		}
 		url = url + cacheTypeRestriction;
-		try{
-			htmlListPage = fetch(url,false);
-			pref.log(&quot;[getFirstListPage] Got first page &quot;+url);
-		}catch(Exception ex){
-			pref.log(&quot;[getFirstListPage] Error fetching first list page &quot;+url,ex,true);
+		try {
+			htmlListPage = fetch(url, false);
+			pref.log(&quot;[getFirstListPage] Got first page &quot; + url);
+		} catch (Exception ex) {
+			pref.log(&quot;[getFirstListPage] Error fetching first list page &quot; + url, ex, true);
 			Vm.showWait(false);
 			infB.close(0);
-			(new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;), MyLocale.getMsg(5503,&quot;Error fetching first list page.&quot;), FormBase.OKB)).execute();
+			(new MessageBox(MyLocale.getMsg(5500, &quot;Error&quot;), 
+					MyLocale.getMsg(5503, &quot;Error fetching first list page.&quot;),
+					FormBase.OKB)).execute();
 			return;
 		}
 	}
 
 	/**
-	 * in: ...
-	 * out: page_number,htmlPage
+	 * in: ... out: page_number,htmlPage
 	 */
 	private void getAListPage(int distance, String whatPage) {
 		String postStr;
 		if (spiderAllFinds) {
 			postStr = propFirstPage;
 		} else {
-			postStr = propFirstPage + origin.getLatDeg(TransformCoordinates.DD) + propFirstPage2 + origin.getLonDeg(TransformCoordinates.DD)
-					                             + propMaxDistance + Integer.toString(distance);
-			if(doNotgetFound) postStr = postStr + propShowOnlyFound;
+			postStr = propFirstPage + origin.getLatDeg(TransformCoordinates.DD)
+					+ propFirstPage2
+					+ origin.getLonDeg(TransformCoordinates.DD)
+					+ propMaxDistance + Integer.toString(distance);
+			if (doNotgetFound)
+				postStr = postStr + propShowOnlyFound;
 		}
 		postStr = postStr + cacheTypeRestriction;
-		
+
 		Regex rexViewstate = new Regex(&quot;id=\&quot;__VIEWSTATE\&quot; value=\&quot;(.*?)\&quot; /&gt;&quot;);
 		String viewstate;
 		rexViewstate.search(htmlListPage);
-		if(rexViewstate.didMatch()){
+		if (rexViewstate.didMatch()) {
 			viewstate = rexViewstate.stringMatched(1);
 		} else {
 			viewstate = &quot;&quot;;
-			pref.log(&quot;[getAListPage] check rexViewstate in SpiderGC.java&quot;+Preferences.NEWLINE+htmlListPage);
+			pref.log(&quot;[getAListPage] check rexViewstate in SpiderGC.java&quot;
+					+ Preferences.NEWLINE + htmlListPage);
 		}
-		
-		Regex rexViewstate1 = new Regex(&quot;id=\&quot;__VIEWSTATE1\&quot; value=\&quot;(.*?)\&quot; /&gt;&quot;);
+
+		Regex rexViewstate1 = new Regex(
+				&quot;id=\&quot;__VIEWSTATE1\&quot; value=\&quot;(.*?)\&quot; /&gt;&quot;);
 		String viewstate1;
 		rexViewstate1.search(htmlListPage);
-		if(rexViewstate1.didMatch()){
+		if (rexViewstate1.didMatch()) {
 			viewstate1 = rexViewstate1.stringMatched(1);
 		} else {
 			viewstate1 = &quot;&quot;;
-			pref.log(&quot;[getAListPage] check rexViewstate1 in SpiderGC.java&quot;+Preferences.NEWLINE+htmlListPage);
+			pref.log(&quot;[getAListPage] check rexViewstate1 in SpiderGC.java&quot;
+					+ Preferences.NEWLINE + htmlListPage);
 		}
 
 		/*
-		rexEventvalidation.search(htmlPage);
-		if(rexEventvalidation.didMatch()){
-			eventvalidation = rexEventvalidation.stringMatched(1);
-		} else {
-			eventvalidation = &quot;&quot;;
-		}
-		*/
+		 * rexEventvalidation.search(htmlPage);
+		 * if(rexEventvalidation.didMatch()){ eventvalidation =
+		 * rexEventvalidation.stringMatched(1); } else { eventvalidation = &quot;&quot;; }
+		 */
 
-		String url = URL.encodeURL(&quot;__EVENTTARGET&quot;,false) + &quot;=&quot; + URL.encodeURL(whatPage,false)
-	    + &quot;&amp;&quot; + URL.encodeURL(&quot;__EVENTARGUMENT&quot;,false) + &quot;=&quot; + URL.encodeURL(&quot;&quot;,false)
-	    + &quot;&amp;&quot; + URL.encodeURL(&quot;__VIEWSTATEFIELDCOUNT&quot;,false) + &quot;=2&quot;
-	    + &quot;&amp;&quot; + URL.encodeURL(&quot;__VIEWSTATE&quot;,false) + &quot;=&quot; + URL.encodeURL(viewstate,false)
-	    + &quot;&amp;&quot; + URL.encodeURL(&quot;__VIEWSTATE1&quot;,false) + &quot;=&quot; + URL.encodeURL(viewstate1,false);
-//	    + &quot;&amp;&quot; + URL.encodeURL(&quot;__EVENTVALIDATION&quot;,false) + &quot;=&quot; + URL.encodeURL(eventvalidation,false);
-		try{
-			htmlListPage = fetch_post(postStr, url, p.getProp(&quot;nextListPage&quot;), true);
-			pref.log(&quot;[getAListPage] Got list page: &quot;+URL.encodeURL(whatPage,false));
-		}catch(Exception ex){
-			pref.log(&quot;[getAListPage] Error getting a list page&quot;+url,ex);
+		String url = URL.encodeURL(&quot;__EVENTTARGET&quot;, false) + &quot;=&quot;
+				+ URL.encodeURL(whatPage, false) + &quot;&amp;&quot;
+				+ URL.encodeURL(&quot;__EVENTARGUMENT&quot;, false) + &quot;=&quot;
+				+ URL.encodeURL(&quot;&quot;, false) + &quot;&amp;&quot;
+				+ URL.encodeURL(&quot;__VIEWSTATEFIELDCOUNT&quot;, false) + &quot;=2&quot; + &quot;&amp;&quot;
+				+ URL.encodeURL(&quot;__VIEWSTATE&quot;, false) + &quot;=&quot;
+				+ URL.encodeURL(viewstate, false) + &quot;&amp;&quot;
+				+ URL.encodeURL(&quot;__VIEWSTATE1&quot;, false) + &quot;=&quot;
+				+ URL.encodeURL(viewstate1, false);
+		// + &quot;&amp;&quot; + URL.encodeURL(&quot;__EVENTVALIDATION&quot;,false) + &quot;=&quot; +
+		// URL.encodeURL(eventvalidation,false);
+		try {
+			htmlListPage = fetch_post(postStr, url, p.getProp(&quot;nextListPage&quot;),
+					true);
+			pref.log(&quot;[getAListPage] Got list page: &quot;
+					+ URL.encodeURL(whatPage, false));
+		} catch (Exception ex) {
+			pref.log(&quot;[getAListPage] Error getting a list page&quot; + url, ex);
 		}
 	}
+
 	/* */
-	private String getMapListPage(CWPoint middle, double north, double west, double south, double east) {
+	private String getMapListPage(CWPoint middle, double north, double west,
+			double south, double east) {
 
-		String url=&quot;<A HREF="http://www.geocaching.com/map/default.aspx">http://www.geocaching.com/map/default.aspx</A>&quot;+
-			&quot;?lat=&quot;+middle.getLatDeg(TransformCoordinates.DD)+
-			&quot;&amp;lng=&quot;+middle.getLonDeg(TransformCoordinates.DD);
-				
-		String strLeft=MyLocale.formatDouble(west, &quot;00.00000&quot;).replace(',','.');
-		String strUp=MyLocale.formatDouble(north, &quot;00.00000&quot;).replace(',','.');
-		String strRight=MyLocale.formatDouble(east, &quot;00.00000&quot;).replace(',','.');
-		String strDown=MyLocale.formatDouble(south, &quot;00.00000&quot;).replace(',','.');
+		String url = &quot;<A HREF="http://www.geocaching.com/map/default.aspx">http://www.geocaching.com/map/default.aspx</A>&quot; + &quot;?lat=&quot;
+				+ middle.getLatDeg(TransformCoordinates.DD) + &quot;&amp;lng=&quot;
+				+ middle.getLonDeg(TransformCoordinates.DD);
 
+		String strLeft = MyLocale.formatDouble(west, &quot;00.00000&quot;).replace(',',
+				'.');
+		String strUp = MyLocale.formatDouble(north, &quot;00.00000&quot;).replace(',',
+				'.');
+		String strRight = MyLocale.formatDouble(east, &quot;00.00000&quot;).replace(',',
+				'.');
+		String strDown = MyLocale.formatDouble(south, &quot;00.00000&quot;).replace(',',
+				'.');
+
 		String eo_cb_param1 = &quot;eo_cb_param=%7B%22c%22%3A%201%2C%20%22m%22%3A%20%22%22%2C%20%22d%22%3A%20%22&quot;;
-		String eo_cb_param2 = strUp+&quot;|&quot;+strDown+&quot;|&quot;+strRight+&quot;|&quot;+strLeft+&quot;%22%7D&quot;;
+		String eo_cb_param2 = strUp + &quot;|&quot; + strDown + &quot;|&quot; + strRight + &quot;|&quot;
+				+ strLeft + &quot;%22%7D&quot;;
 		String ret;
-		String doc=&quot;&quot;;
-		try{
+		String doc = &quot;&quot;;
+		try {
 
-			doc=&quot;eo_cb_id=ctl00_ContentBody_cbAjax&quot; +
-			&quot;&amp;&quot;+eo_cb_param1 + eo_cb_param2 +
-			&quot;&amp;__eo_obj_states=&quot;+
-			//&quot;&amp;__VIEWSTATE=&quot;+viewstate+
-			&quot;&amp;__VIEWSTATE=%2FwEPDwULLTEyOTYyNjYwNjkPZBYCZg9kFgZmD2QWAgIODxYCHgdWaXNpYmxlaGQCAQ9kFhICBQ8WAh4EVGV4dGRkAgkPFgIfAQUWWW91IGFyZSBub3QgbG9nZ2VkIGluLmQCCw8PFgQeC05hdmlnYXRlVXJsBZEBaHR0cDovL3d3dy5nZW9jYWNoaW5nLmNvbS9sb2dpbi9kZWZhdWx0LmFzcHg%2FUkVTRVQ9WSZyZWRpcj1odHRwJTNhJTJmJTJmd3d3Lmdlb2NhY2hpbmcuY29tJTJmbWFwJTJmZGVmYXVsdC5hc3B4JTNmbGF0JTNkNDYuNjE1OTclMjZsbmclM2QxMy44NDg3Mx8BBQZMb2cgaW5kZAIPD2QWAgIBDw8WAh8BZGRkAhEPZBYCAgEPD2QPZAUMRFFJQkFBQUFBQUE9ZAIfDxYCHwBnZAInDw8WBB8CBQwvcmV2aWV3cy9ncHMfAQULR1BTIFJldmlld3NkZAIrD2QWAgIBDw8WAh8BBZcCPGlmcmFtZSBzcmM9Imh0dHA6Ly9iYW5tYW41Lmdyb3VuZHNwZWFrLmNvbS9iYW5tYW41L2FkLmFzcHg%2FWm9uZUlEPTkmVGFzaz1HZXQmU2l0ZUlEPTEmWD0nMzdlYWVjMTQzODVjNDc1Y2JiZjFhODk0YTgzOTNiMGMnIiB3aWR0aD0iMTIwIiBoZWlnaHQ9IjI0MCIgTWFyZ2lud2lkdGg9IjAiIE1hcmdpbmhlaWdodD0iMCIgSHNwYWNlPSIwIiBWc3BhY2U9IjAiIEZyYW1lYm9yZGVyPSIwIiBTY3JvbGxpbmc9Im5vIiBzdHlsZT0id2lkdGg6MTIwcHg7SGVpZ2h0OjI0MHB4OyI%2BPC9pZnJhbWU%2BZGQCLQ9kFgJmD2QWAmYPFgIeC18hSXRlbUNvdW50AgYWDAIBD2QWAgIBDw8WCB4PQ29tbWFuZE
 FyZ3VtZW50BQVlbi1VUx4LQ29tbWFuZE5hbWUFDVNldFRlbXBMb2NhbGUfAQUHRW5nbGlzaB4QQ2F1c2VzVmFsaWRhdGlvbmhkZAICD2QWAgIBDw8WCB8EBQVkZS1ERR8FBQ1TZXRUZW1wTG9jYWxlHwEFB0RldXRzY2gfBmhkZAIDD2QWAgIBDw8WCB8EBQVmci1GUh8FBQ1TZXRUZW1wTG9jYWxlHwEFCUZyYW7Dp2Fpcx8GaGRkAgQPZBYCAgEPDxYIHwQFBXB0LVBUHwUFDVNldFRlbXBMb2NhbGUfAQUKUG9ydHVndcOqcx8GaGRkAgUPZBYCAgEPDxYIHwQFBWNzLUNaHwUFDVNldFRlbXBMb2NhbGUfAQUJxIxlxaF0aW5hHwZoZGQCBg9kFgICAQ8PFggfBAUFc3YtU0UfBQUNU2V0VGVtcExvY2FsZR8BBQdTdmVuc2thHwZoZGQCAw8WAh8BBSxTZXJ2ZXI6IFdFQjA4OyBCdWlsZDogVEZTLlJlbGVhc2VfMjAxMDA4MzAuMWRkkWJYA8UHbJ38zIk7cJhELr1nbU4%3D&quot;+
-			&quot;&amp;eo_version=5.0.51.2&quot;+
-			&quot;&amp;=on&amp;=&amp;=&amp;=2&amp;=3&amp;=4&amp;=5&amp;=1858&amp;=6&amp;=8&amp;=11&amp;=137&amp;=13&amp;=453&amp;=3653&amp;=on&amp;=&quot; +
-			&quot;&amp;__EVENTVALIDATION=&quot;+
-			&quot;&amp;__EVENTTARGET=&quot;+
-			&quot;&amp;__EVENTARGUMENT=&quot;;
+			doc = &quot;eo_cb_id=ctl00_ContentBody_cbAjax&quot;
+					+ &quot;&amp;&quot;
+					+ eo_cb_param1
+					+ eo_cb_param2
+					+ &quot;&amp;__eo_obj_states=&quot;
+					+
+					// &quot;&amp;__VIEWSTATE=&quot;+viewstate+
+					&quot;&amp;__VIEWSTATE=%2FwEPDwULLTEyOTYyNjYwNjkPZBYCZg9kFgZmD2QWAgIODxYCHgdWaXNpYmxlaGQCAQ9kFhICBQ8WAh4EVGV4dGRkAgkPFgIfAQUWWW91IGFyZSBub3QgbG9nZ2VkIGluLmQCCw8PFgQeC05hdmlnYXRlVXJsBZEBaHR0cDovL3d3dy5nZW9jYWNoaW5nLmNvbS9sb2dpbi9kZWZhdWx0LmFzcHg%2FUkVTRVQ9WSZyZWRpcj1odHRwJTNhJTJmJTJmd3d3Lmdlb2NhY2hpbmcuY29tJTJmbWFwJTJmZGVmYXVsdC5hc3B4JTNmbGF0JTNkNDYuNjE1OTclMjZsbmclM2QxMy44NDg3Mx8BBQZMb2cgaW5kZAIPD2QWAgIBDw8WAh8BZGRkAhEPZBYCAgEPD2QPZAUMRFFJQkFBQUFBQUE9ZAIfDxYCHwBnZAInDw8WBB8CBQwvcmV2aWV3cy9ncHMfAQULR1BTIFJldmlld3NkZAIrD2QWAgIBDw8WAh8BBZcCPGlmcmFtZSBzcmM9Imh0dHA6Ly9iYW5tYW41Lmdyb3VuZHNwZWFrLmNvbS9iYW5tYW41L2FkLmFzcHg%2FWm9uZUlEPTkmVGFzaz1HZXQmU2l0ZUlEPTEmWD0nMzdlYWVjMTQzODVjNDc1Y2JiZjFhODk0YTgzOTNiMGMnIiB3aWR0aD0iMTIwIiBoZWlnaHQ9IjI0MCIgTWFyZ2lud2lkdGg9IjAiIE1hcmdpbmhlaWdodD0iMCIgSHNwYWNlPSIwIiBWc3BhY2U9IjAiIEZyYW1lYm9yZGVyPSIwIiBTY3JvbGxpbmc9Im5vIiBzdHlsZT0id2lkdGg6MTIwcHg7SGVpZ2h0OjI0MHB4OyI%2BPC9pZnJhbWU%2BZGQCLQ9kFgJmD2QWAmYPFgIeC18hSXRlbUNvdW50AgYWDAIBD2QWAgIBDw8WCB4PQ29tbWFu
 ZEFyZ3VtZW50BQVlbi1VUx4LQ29tbWFuZE5hbWUFDVNldFRlbXBMb2NhbGUfAQUHRW5nbGlzaB4QQ2F1c2VzVmFsaWRhdGlvbmhkZAICD2QWAgIBDw8WCB8EBQVkZS1ERR8FBQ1TZXRUZW1wTG9jYWxlHwEFB0RldXRzY2gfBmhkZAIDD2QWAgIBDw8WCB8EBQVmci1GUh8FBQ1TZXRUZW1wTG9jYWxlHwEFCUZyYW7Dp2Fpcx8GaGRkAgQPZBYCAgEPDxYIHwQFBXB0LVBUHwUFDVNldFRlbXBMb2NhbGUfAQUKUG9ydHVndcOqcx8GaGRkAgUPZBYCAgEPDxYIHwQFBWNzLUNaHwUFDVNldFRlbXBMb2NhbGUfAQUJxIxlxaF0aW5hHwZoZGQCBg9kFgICAQ8PFggfBAUFc3YtU0UfBQUNU2V0VGVtcExvY2FsZR8BBQdTdmVuc2thHwZoZGQCAw8WAh8BBSxTZXJ2ZXI6IFdFQjA4OyBCdWlsZDogVEZTLlJlbGVhc2VfMjAxMDA4MzAuMWRkkWJYA8UHbJ38zIk7cJhELr1nbU4%3D&quot;
+					+ &quot;&amp;eo_version=5.0.51.2&quot;
+					+ &quot;&amp;=on&amp;=&amp;=&amp;=2&amp;=3&amp;=4&amp;=5&amp;=1858&amp;=6&amp;=8&amp;=11&amp;=137&amp;=13&amp;=453&amp;=3653&amp;=on&amp;=&quot;
+					+ &quot;&amp;__EVENTVALIDATION=&quot; + &quot;&amp;__EVENTTARGET=&quot;
+					+ &quot;&amp;__EVENTARGUMENT=&quot;;
 
 			ret = fetch_post(url, doc, &quot;/map/default.aspx&quot;, false);
 			pref.log(&quot;[getAListPage] Got map Cachepage: &quot;);
-		}catch(Exception ex){
-			ret=&quot;&quot;;
-			pref.log(&quot;[getAListPage] Error getting map Cachepage&quot;+url+doc,ex);
+		} catch (Exception ex) {
+			ret = &quot;&quot;;
+			pref.log(&quot;[getAListPage] Error getting map Cachepage&quot; + url + doc, ex);
 		}
 		return ret;
 	}
-	 /* */
 
+	/* */
+
 	/**
 	 * check if new Update exists
-	 * @param ch CacheHolder
-	 * @param CacheDescription A previously fetched cachepage
+	 * 
+	 * @param ch
+	 *            CacheHolder
+	 * @param CacheDescription
+	 *            A previously fetched cachepage
 	 * @return true if new Update exists else false
 	 */
 	private boolean updateExists(CacheHolder ch, String CacheDescription) {
 		boolean ret = false;
 		boolean save = false;
-		boolean is_archived_GC=false;
-		boolean is_found_GC=false;
+		boolean is_archived_GC = false;
+		boolean is_found_GC = false;
 		CacheHolderDetail chd = ch.getCacheDetails(false);
 		if (spiderAllFinds) {
-			if(!ch.is_found()) { ch.setFound(true); save=true; numFoundUpdates+=1; ret=true;}
-			is_archived_GC=CacheDescription.indexOf(propArchived) != -1;
-			if (is_archived_GC!=ch.is_archived()) { ch.setArchived(is_archived_GC); save=true; numArchivedUpdates+=1; ret=true;}
-		} else if (!doNotgetFound){ // there could be a found or own ...
-			is_found_GC=CacheDescription.indexOf(propFound)!=-1;
-			if (is_found_GC!=ch.is_found()) {ch.setFound(is_found_GC); save=true; ret=true;}
+			if (!ch.is_found()) {
+				ch.setFound(true);
+				save = true;
+				numFoundUpdates += 1;
+				ret = true;
+			}
+			is_archived_GC = CacheDescription.indexOf(propArchived) != -1;
+			if (is_archived_GC != ch.is_archived()) {
+				ch.setArchived(is_archived_GC);
+				save = true;
+				numArchivedUpdates += 1;
+				ret = true;
+			}
+		} else if (!doNotgetFound) { // there could be a found or own ...
+			is_found_GC = CacheDescription.indexOf(propFound) != -1;
+			if (is_found_GC != ch.is_found()) {
+				ch.setFound(is_found_GC);
+				save = true;
+				ret = true;
+			}
 		}
-		if (ch.is_found() &amp;&amp; chd.OwnLogId.equals(&quot;&quot;)) {ret=true;} //missing ownLogID
-		boolean is_available_GC=!is_archived_GC &amp;&amp; CacheDescription.indexOf(propAvailable) == -1;
+		if (ch.is_found() &amp;&amp; chd.OwnLogId.equals(&quot;&quot;)) {
+			ret = true;
+		} // missing ownLogID
+		boolean is_available_GC = !is_archived_GC
+				&amp;&amp; CacheDescription.indexOf(propAvailable) == -1;
 		if (is_available_GC != ch.is_available()) {
-			ch.setAvailable(is_available_GC); save=true; numAvailableUpdates+=1; ret=true;}
-		if (typeChanged(ch,CacheDescription)) { save=true; ret=true;}
-		if (sizeChanged(ch,CacheDescription)) { save=true; ret=true;}
-		if (difficultyOrTerrainChanged(ch,CacheDescription)) {save=true; ret=true;}
-		if (newFoundExists(ch,CacheDescription)) {
-			numLogUpdates++; ret=true;
-			}
-		if (save) ch.save();
+			ch.setAvailable(is_available_GC);
+			save = true;
+			numAvailableUpdates += 1;
+			ret = true;
+		}
+		if (typeChanged(ch, CacheDescription)) {
+			save = true;
+			ret = true;
+		}
+		if (sizeChanged(ch, CacheDescription)) {
+			save = true;
+			ret = true;
+		}
+		if (difficultyOrTerrainChanged(ch, CacheDescription)) {
+			save = true;
+			ret = true;
+		}
+		if (newFoundExists(ch, CacheDescription)) {
+			numLogUpdates++;
+			ret = true;
+		}
+		if (save)
+			ch.save();
 		return ret;
 	}
+
 	/**
 	 * Get num found
-	 * @param doc A previously fetched cachepage
+	 * 
+	 * @param doc
+	 *            A previously fetched cachepage
 	 * @return numFound
 	 */
 	private int getNumFound(String doc) {
 		RexNumFinds.search(doc);
 		if (RexNumFinds.didMatch()) {
-			 return Common.parseInt(RexNumFinds.stringMatched(1));}
-		else {
-			pref.log(&quot;check RexNumFinds in SpiderGC.java / initialiseProperties&quot;+Preferences.NEWLINE+doc);
+			return Common.parseInt(RexNumFinds.stringMatched(1));
+		} else {
+			pref.log(&quot;check RexNumFinds in SpiderGC.java / initialiseProperties&quot; 
+					+ Preferences.NEWLINE + doc);
 			return 0;
 		}
 	}
+
 	private int getFoundInDB() {
 		CacheHolder ch;
 		int counter = 0;
-		for(int i = 0; i&lt;cacheDB.size();i++){
+		for (int i = 0; i &lt; cacheDB.size(); i++) {
 			ch = cacheDB.get(i);
-			if(ch.is_found()) {
-				if(ch.getWayPoint().startsWith(&quot;GC&quot;) ) counter++;
+			if (ch.is_found()) {
+				if (ch.getWayPoint().startsWith(&quot;GC&quot;))
+					counter++;
 			}
 		}
 		return counter;
 	}
+
 	/**
 	 * Get the Distance to the centre
-	 * @param doc A previously fetched cachepage
+	 * 
+	 * @param doc
+	 *            A previously fetched cachepage
 	 * @return Distance
 	 */
 	private double getDistGC(String doc) throws Exception {
-		if(doc.indexOf(&quot;Here&quot;) &gt;= 0) {
-			return(0);
-		}
-		else {
+		if (doc.indexOf(&quot;Here&quot;) &gt;= 0) {
+			return (0);
+		} else {
 			RexPropDistance.search(doc);
 			if (!RexPropDistance.didMatch()) {
-				pref.log(&quot;check distRex in spider.def&quot;+Preferences.NEWLINE+doc);
+				pref.log(&quot;check distRex in spider.def&quot; 
+						+ Preferences.NEWLINE + doc);
 				return 0;
 			}
-			if(MyLocale.getDigSeparator().equals(&quot;,&quot;)) return Convert.toDouble(RexPropDistance.stringMatched(1).replace('.',','));
+			if (MyLocale.getDigSeparator().equals(&quot;,&quot;))
+				return Convert.toDouble(RexPropDistance.stringMatched(1)
+						.replace('.', ','));
 			return Convert.toDouble(RexPropDistance.stringMatched(1));
 		}
 	}
+
 	/**
 	 * Get the waypoint name
-	 * @param doc A previously fetched cachepage
+	 * 
+	 * @param doc
+	 *            A previously fetched cachepage
 	 * @return Name of waypoint to add to list
 	 */
 	private String getWP(String doc) throws Exception {
 		RexPropWaypoint.search(doc);
 		if (!RexPropWaypoint.didMatch()) {
-			pref.log(&quot;check waypointRex in spider.def&quot;+Preferences.NEWLINE+doc);
+			pref.log(&quot;check waypointRex in spider.def&quot; 
+					+ Preferences.NEWLINE + doc);
 			return &quot;???&quot;;
 		}
-		return &quot;GC&quot;+RexPropWaypoint.stringMatched(1);
+		return &quot;GC&quot; + RexPropWaypoint.stringMatched(1);
 	}
 
 	/**
 	 * check for Premium Member Cache
 	 */
 	private boolean doPMCache(String toCheck) {
-		if (pref.isPremium) return true;
+		if (pref.isPremium)
+			return true;
 		if (toCheck.indexOf(propPM) &lt;= 0) {
 			return true;
+		} else {
+			numPrivate = numPrivate + 1;
+			return false;
 		}
-		else {
-			numPrivate=numPrivate+1;
-			return false;			
-		}
 	}
+
 	/*
 	 * check for changed Cachetype
 	 */
-	private boolean typeChanged(CacheHolder ch, String toCheck){
+	private boolean typeChanged(CacheHolder ch, String toCheck) {
 		RexPropType.search(toCheck);
-		if(RexPropType.didMatch()) {
-			String stmp=RexPropType.stringMatched(1);
-			if (Common.parseInt(stmp) == 0){
-				if (stmp.equalsIgnoreCase(&quot;EarthCache&quot;)) stmp=&quot;137&quot;;
+		if (RexPropType.didMatch()) {
+			String stmp = RexPropType.stringMatched(1);
+			if (Common.parseInt(stmp) == 0) {
+				if (stmp.equalsIgnoreCase(&quot;EarthCache&quot;))
+					stmp = &quot;137&quot;;
 			}
-			if(ch.getType() == CacheType.gcSpider2CwType(stmp))
+			if (ch.getType() == CacheType.gcSpider2CwType(stmp))
 				return false;
-				else {
-					ch.setType(CacheType.gcSpider2CwType(stmp));
-					return true;
-				}
+			else {
+				ch.setType(CacheType.gcSpider2CwType(stmp));
+				return true;
+			}
 		}
-		pref.log(&quot;check TypeRex in spider.def&quot;+Preferences.NEWLINE+toCheck);
+		pref.log(&quot;check TypeRex in spider.def&quot; + Preferences.NEWLINE + toCheck);
 		return false;
 	}
+
 	/*
 	 * check for changed CacheSize
 	 */
 	private boolean sizeChanged(CacheHolder ch, String toCheck) {
 		RexPropSize.search(toCheck);
-		if(RexPropSize.didMatch()){
-			String stmp=RexPropSize.stringMatched(1);
-			if(ch.getCacheSize() == CacheSize.gcSpiderString2Cw(stmp))
+		if (RexPropSize.didMatch()) {
+			String stmp = RexPropSize.stringMatched(1);
+			if (ch.getCacheSize() == CacheSize.gcSpiderString2Cw(stmp))
 				return false;
-				else {
-					ch.setCacheSize(CacheSize.gcSpiderString2Cw(stmp));
-					return true;
-				}
+			else {
+				ch.setCacheSize(CacheSize.gcSpiderString2Cw(stmp));
+				return true;
+			}
 		}
-		pref.log(&quot;check SizeRex in spider.def&quot;+Preferences.NEWLINE+toCheck);
+		pref.log(&quot;check SizeRex in spider.def&quot; + Preferences.NEWLINE + toCheck);
 		return false;
 	}
+
 	/*
 	 * check for changed Difficulty or Terrain
 	 */
 	private boolean difficultyOrTerrainChanged(CacheHolder ch, String toCheck) {
 		boolean ret = false;
-		RexPropDandT.search(toCheck);	
-		if(RexPropDandT.didMatch()){
-			String stmp=RexPropDandT.stringMatched(1);
-			if(!(ch.getHard() == CacheTerrDiff.v1Converter(stmp))) {
+		RexPropDandT.search(toCheck);
+		if (RexPropDandT.didMatch()) {
+			String stmp = RexPropDandT.stringMatched(1);
+			if (!(ch.getHard() == CacheTerrDiff.v1Converter(stmp))) {
 				ch.setHard(CacheTerrDiff.v1Converter(stmp));
-				ret=true;
+				ret = true;
 			}
-			stmp=RexPropDandT.stringMatched(2);
-			if(!(ch.getTerrain() == CacheTerrDiff.v1Converter(stmp))) {
+			stmp = RexPropDandT.stringMatched(2);
+			if (!(ch.getTerrain() == CacheTerrDiff.v1Converter(stmp))) {
 				ch.setTerrain(CacheTerrDiff.v1Converter(stmp));
-				ret=true;
+				ret = true;
 			}
+		} else {
+			pref.log(&quot;check DandTRex in spider.def&quot; 
+					+ Preferences.NEWLINE + toCheck);
 		}
-		else {
-			pref.log(&quot;check DandTRex in spider.def&quot;+Preferences.NEWLINE+toCheck);
-		}
 		return ret;
 	}
-	
+
 	/**
 	 * Get the direction
-	 * @param doc A previously fetched cachepage
+	 * 
+	 * @param doc
+	 *            A previously fetched cachepage
 	 * @return direction String
 	 */
 	private String getDirection(String doc) throws Exception {
 		RexPropDirection.search(doc);
 		if (!RexPropDirection.didMatch()) {
-			pref.log(&quot;check directionRex in spider.def&quot;+Preferences.NEWLINE+doc);
+			pref.log(&quot;check directionRex in spider.def&quot; 
+					+ Preferences.NEWLINE + doc);
 			return &quot;&quot;;
 		}
 		return RexPropDirection.stringMatched(1);
@@ -1491,14 +1819,15 @@
 	 * if cache lies in the desired direction
 	 */
 	private boolean directionOK(String[] directions, String gotDirection) {
-		if (directions.length == 0) return true; // nothing means all
+		if (directions.length == 0)
+			return true; // nothing means all
 		for (int i = 0; i &lt; directions.length; i++) {
 			if (directions[i].equals(gotDirection)) {
 				return true;
 			}
-			int j=directions[i].indexOf(&quot;*&quot;);
-			if (j&gt;0){
-				if (gotDirection.indexOf(directions[i].substring(0, 1))&gt;-1) {
+			int j = directions[i].indexOf(&quot;*&quot;);
+			if (j &gt; 0) {
+				if (gotDirection.indexOf(directions[i].substring(0, 1)) &gt; -1) {
 					return true;
 				}
 			}
@@ -1508,88 +1837,108 @@
 
 	/*
 	 * @param CacheHolder ch
+	 * 
 	 * @param String cacheDescGC
+	 * 
 	 * @return boolean newLogExists
 	 */
 	private boolean newFoundExists(CacheHolder ch, String cacheDescrition) {
-		if(!pref.checkLog) return false;
+		if (!pref.checkLog)
+			return false;
 		Time lastLogCW = new Time();
 		Log lastLog = ch.getCacheDetails(true).CacheLogs.getLog(0);
-		if (lastLog == null) return true;
-		String slastLogCW=lastLog.getDate();
-		if (slastLogCW.equals(&quot;&quot;)) return true; // or check cacheDescGC also no log?
-		lastLogCW.parse(slastLogCW,&quot;yyyy-MM-dd&quot;);
+		if (lastLog == null)
+			return true;
+		String slastLogCW = lastLog.getDate();
+		if (slastLogCW.equals(&quot;&quot;))
+			return true; // or check cacheDescGC also no log?
+		lastLogCW.parse(slastLogCW, &quot;yyyy-MM-dd&quot;);
 
 		Time lastLogGC = new Time(); // is current time
-		lastLogGC.hour=0;
-		lastLogGC.minute=0;
-		lastLogGC.second=0;
-		lastLogGC.millis=0;
+		lastLogGC.hour = 0;
+		lastLogGC.minute = 0;
+		lastLogGC.second = 0;
+		lastLogGC.millis = 0;
 		String[] SDate;
-		String stmp=&quot;&quot;;
+		String stmp = &quot;&quot;;
 		RexPropLogDate.search(cacheDescrition);
 		if (RexPropLogDate.didMatch()) {
-			stmp=RexPropLogDate.stringMatched(1);
-		}
-		else {
-			pref.log(&quot;check logDateRex in spider.def&quot;+Preferences.NEWLINE+cacheDescrition);
+			stmp = RexPropLogDate.stringMatched(1);
+		} else {
+			pref.log(&quot;check logDateRex in spider.def&quot; 
+					+ Preferences.NEWLINE + cacheDescrition);
 			return false;
 		}
-		if (stmp.indexOf(&quot;day&quot;)&gt;0) {
-			lastLogGC.setTime(lastLogGC.getTime()-691200000L); // simplyfied (update if not newer than last week)
-		}
-		else if (stmp.equals(&quot;&quot;)) {
+		if (stmp.indexOf(&quot;day&quot;) &gt; 0) {
+			lastLogGC.setTime(lastLogGC.getTime() - 691200000L); // simplyfied
+																	// (update
+																	// if not
+																	// newer
+																	// than last
+																	// week)
+		} else if (stmp.equals(&quot;&quot;)) {
 			return false; // no log yet
-		}
-		else {
-			final String monthNames[] = { &quot;January&quot;, &quot;February&quot;, &quot;March&quot;, &quot;April&quot;, &quot;May&quot;,
-					&quot;June&quot;, &quot;July&quot;, &quot;August&quot;, &quot;September&quot;, &quot;October&quot;, &quot;November&quot;,
-					&quot;December&quot; };
-			SDate=mString.split(stmp,' ');
-			lastLogGC.day=Common.parseInt(SDate[0]);
+		} else {
+			final String monthNames[] = { &quot;January&quot;, &quot;February&quot;, &quot;March&quot;,
+					&quot;April&quot;, &quot;May&quot;, &quot;June&quot;, &quot;July&quot;, &quot;August&quot;, &quot;September&quot;,
+					&quot;October&quot;, &quot;November&quot;, &quot;December&quot; };
+			SDate = mString.split(stmp, ' ');
+			lastLogGC.day = Common.parseInt(SDate[0]);
 			for (int m = 0; m &lt; 12; m++) {
 				if (monthNames[m].startsWith(SDate[1])) {
-					lastLogGC.month=m+1;
-					m=12;
+					lastLogGC.month = m + 1;
+					m = 12;
 				}
 			}
-			lastLogGC.year=2000+Common.parseInt(SDate[2].substring(0,2));
+			lastLogGC.year = 2000 + Common.parseInt(SDate[2].substring(0, 2));
 		}
 		boolean ret = lastLogCW.compareTo(lastLogGC) &lt; 0;
 		return ret;
 	}
 
 	/**
-	 * Read a complete cachepage from geocaching.com including all logs. This is used both when
-	 * updating already existing caches (via spiderSingle) and when spidering around a centre. It
-	 * is also used when reading a GPX file and fetching the images.
-	 *
+	 * Read a complete cachepage from geocaching.com including all logs. This is
+	 * used both when updating already existing caches (via spiderSingle) and
+	 * when spidering around a centre. It is also used when reading a GPX file
+	 * and fetching the images.
+	 * 
 	 * This is the workhorse function of the spider.
-	 *
-	 * @param CacheHolderDetail chD The element wayPoint must be set to the name of a waypoint
-	 * @param boolean isUpdate True if an existing cache is being updated, false if it is a new cache
+	 * 
+	 * @param CacheHolderDetail
+	 *            chD The element wayPoint must be set to the name of a waypoint
+	 * @param boolean isUpdate True if an existing cache is being updated, false
+	 *        if it is a new cache
 	 * @param boolean fetchImages True if the pictures are to be fetched
 	 * @param boolean fetchTBs True if the TBs are to be fetched
-	 * @param boolean doNotGetFound True if the cache is not to be spidered if it has already been found
-	 * @param boolean fetchAllLogs True if all logs are to be fetched (by adding option '&amp;logs=y' to command line).
-	 *     This is normally false when spidering from GPXImport as the logs are part of the GPX file, and true otherwise
-	 * @return -1 if the infoBox was closed (cancel spidering), 0 if there was an error (continue with next cache), 1 if everything ok
+	 * @param boolean doNotGetFound True if the cache is not to be spidered if
+	 *        it has already been found
+	 * @param boolean fetchAllLogs True if all logs are to be fetched (by adding
+	 *        option '&amp;logs=y' to command line). This is normally false when
+	 *        spidering from GPXImport as the logs are part of the GPX file, and
+	 *        true otherwise
+	 * @return -1 if the infoBox was closed (cancel spidering), 0 if there was
+	 *         an error (continue with next cache), 1 if everything ok
 	 */
-	private int getCacheByWaypointName(CacheHolder ch, boolean isUpdate, boolean fetchImages, boolean fetchTBs, boolean doNotGetFound, boolean fetchAllLogs) {
+	private int getCacheByWaypointName(CacheHolder ch, boolean isUpdate,
+			boolean fetchImages, boolean fetchTBs, boolean doNotGetFound,
+			boolean fetchAllLogs) {
 		int ret = SPIDER_OK; // initialize value;
 		while (true) { // retry even if failure
 			pref.log(&quot;&quot;); // new line for more overview
 			String completeWebPage;
-			int spiderTrys=0;
-			int MAX_SPIDER_TRYS=3;
-			while (spiderTrys++&lt;MAX_SPIDER_TRYS) {
+			int spiderTrys = 0;
+			int MAX_SPIDER_TRYS = 3;
+			while (spiderTrys++ &lt; MAX_SPIDER_TRYS) {
 				ret = SPIDER_OK; // initialize value;
-				try{
-					String doc = p.getProp(&quot;getPageByName&quot;) + ch.getWayPoint() +((fetchAllLogs||ch.is_found())?p.getProp(&quot;fetchAllLogs&quot;):&quot;&quot;);
-					completeWebPage = fetch(doc,false);
+				try {
+					String doc = p.getProp(&quot;getPageByName&quot;)
+							+ ch.getWayPoint()
+							+ ((fetchAllLogs || ch.is_found()) ? p
+									.getProp(&quot;fetchAllLogs&quot;) : &quot;&quot;);
+					completeWebPage = fetch(doc, false);
 					pref.log(&quot;Fetched: &quot; + ch.getWayPoint());
-					if	( completeWebPage.equals(&quot;&quot;)) {
-						pref.log(&quot;Could not fetch &quot; + ch.getWayPoint(),null);
+					if (completeWebPage.equals(&quot;&quot;)) {
+						pref.log(&quot;Could not fetch &quot; + ch.getWayPoint(), null);
 						if (!infB.isClosed) {
 							continue;
 						} else {
@@ -1597,8 +1946,8 @@
 							return SPIDER_CANCEL;
 						}
 					}
-				}catch(Exception ex){
-					pref.log(&quot;Could not fetch &quot; + ch.getWayPoint(),ex);
+				} catch (Exception ex) {
+					pref.log(&quot;Could not fetch &quot; + ch.getWayPoint(), ex);
 					if (!infB.isClosed) {
 						continue;
 					} else {
@@ -1606,23 +1955,26 @@
 						return SPIDER_CANCEL;
 					}
 				}
-				// Only analyse the cache data and fetch pictures if user has not closed the progress window
+				// Only analyse the cache data and fetch pictures if user has
+				// not closed the progress window
 				if (!infB.isClosed) {
-					try{
+					try {
 						ch.initStates(!isUpdate);
 
-						//first check if coordinates are available to prevent deleting existing coordinates
+						// first check if coordinates are available to prevent
+						// deleting existing coordinates
 						String latLon = getLatLon(completeWebPage);
 						if (latLon.equals(&quot;???&quot;)) {
-							if (completeWebPage.indexOf(p.getProp(&quot;premiumCachepage&quot;))&gt;0) {
+							if (completeWebPage.indexOf(p
+									.getProp(&quot;premiumCachepage&quot;)) &gt; 0) {
 								// Premium cache spidered by non premium member
-								pref.log(&quot;Ignoring premium member cache: &quot;+ch.getWayPoint());
+								pref.log(&quot;Ignoring premium member cache: &quot; + ch.getWayPoint());
 								spiderTrys = MAX_SPIDER_TRYS;
 								ret = SPIDER_IGNORE_PREMIUM;
 								continue;
 							} else {
 								if (spiderTrys == MAX_SPIDER_TRYS)
-									pref.log(&quot;&gt;&gt;&gt;&gt; Failed to spider Cache. Retry.&quot;+completeWebPage,null);
+									pref.log(&quot;&gt;&gt;&gt;&gt; Failed to spider Cache. Retry.&quot; + completeWebPage, null);
 								ret = SPIDER_ERROR;
 								continue; // Restart the spider
 							}
@@ -1630,20 +1982,24 @@
 
 						ch.setHTML(true);
 						ch.setIncomplete(true);
-						// Save size of logs to be able to check whether any new logs were added
+						// Save size of logs to be able to check whether any new
+						// logs were added
 						// int logsz = chD.CacheLogs.size();
-						//chD.CacheLogs.clear();
+						// chD.CacheLogs.clear();
 						ch.addiWpts.clear();
 						ch.getCacheDetails(false).images.clear();
 
-						ch.setAvailable(!(completeWebPage.indexOf(p.getProp(&quot;cacheUnavailable&quot;)) &gt;= 0));
-						ch.setArchived(completeWebPage.indexOf(p.getProp(&quot;cacheArchived&quot;)) &gt;= 0);
-						//==========
+						ch.setAvailable(!(completeWebPage.indexOf(p
+								.getProp(&quot;cacheUnavailable&quot;)) &gt;= 0));
+						ch.setArchived(completeWebPage.indexOf(p
+								.getProp(&quot;cacheArchived&quot;)) &gt;= 0);
+						// ==========
 						// Logs first (for check early for break)
-						//==========
+						// ==========
 						getLogs(completeWebPage, ch.getCacheDetails(false));
 						pref.log(&quot;Got logs&quot;);
-						// If the switch is set to not store found caches and we found the cache =&gt; return
+						// If the switch is set to not store found caches and we
+						// found the cache =&gt; return
 						if (ch.is_found() &amp;&amp; doNotGetFound) {
 							if (infB.isClosed) {
 								return SPIDER_CANCEL;
@@ -1651,27 +2007,33 @@
 								return SPIDER_IGNORE;
 							}
 						}
-						//==========
+						// ==========
 						// General Cache Data
-						//==========
+						// ==========
 						ch.setLatLon(latLon);
 						pref.log(&quot;LatLon: &quot; + ch.getLatLon());
-						
-						String longDesc=getLongDesc(completeWebPage);
+
+						String longDesc = getLongDesc(completeWebPage);
 						ch.getCacheDetails(false).setLongDescription(longDesc);
 						pref.log(&quot;Got description&quot;);
 
-						ch.setCacheName(SafeXML.cleanback(getName(completeWebPage)));
+						ch.setCacheName(SafeXML
+								.cleanback(getName(completeWebPage)));
 						pref.log(&quot;Name: &quot; + ch.getCacheName());
 
 						String location = getLocation(completeWebPage);
 						if (location.length() != 0) {
 							int countryStart = location.indexOf(&quot;,&quot;);
 							if (countryStart &gt; -1) {
-								ch.getCacheDetails(false).Country = SafeXML.cleanback(location.substring(countryStart + 1).trim());
-								ch.getCacheDetails(false).State = SafeXML.cleanback(location.substring(0, countryStart).trim());
+								ch.getCacheDetails(false).Country = SafeXML
+										.cleanback(location.substring(
+												countryStart + 1).trim());
+								ch.getCacheDetails(false).State = SafeXML
+										.cleanback(location.substring(0,
+												countryStart).trim());
 							} else {
-								ch.getCacheDetails(false).Country = location.trim();
+								ch.getCacheDetails(false).Country = location
+										.trim();
 								ch.getCacheDetails(false).State = &quot;&quot;;
 							}
 							pref.log(&quot;Got location (country/state)&quot;);
@@ -1681,142 +2043,174 @@
 							pref.log(&quot;No location (country/state) found&quot;);
 						}
 
-						ch.setCacheOwner(SafeXML.cleanback(getOwner(completeWebPage)).trim());
-						if(ch.getCacheOwner().equals(pref.myAlias) || (pref.myAlias2.length()&gt;0 &amp;&amp; ch.getCacheOwner().equals(pref.myAlias2))) ch.setOwned(true);
-						pref.log(&quot;Owner: &quot; + ch.getCacheOwner() +&quot;; is_owned = &quot;+ch.is_owned()+&quot;;  alias1,2 = [&quot;+pref.myAlias+&quot;|&quot;+pref.myAlias2+&quot;]&quot;);
+						ch.setCacheOwner(SafeXML.cleanback(
+								getOwner(completeWebPage)).trim());
+						if (ch.getCacheOwner().equals(pref.myAlias)
+								|| (pref.myAlias2.length() &gt; 0 &amp;&amp; ch
+										.getCacheOwner().equals(pref.myAlias2)))
+							ch.setOwned(true);
+						pref.log(&quot;Owner: &quot; + ch.getCacheOwner()
+								+ &quot;; is_owned = &quot; + ch.is_owned()
+								+ &quot;;  alias1,2 = [&quot; + pref.myAlias + &quot;|&quot;
+								+ pref.myAlias2 + &quot;]&quot;);
 
-						ch.setDateHidden(DateFormat.MDY2YMD(getDateHidden(completeWebPage)));
+						ch.setDateHidden(DateFormat
+								.MDY2YMD(getDateHidden(completeWebPage)));
 						pref.log(&quot;Hidden: &quot; + ch.getDateHidden());
 
-						ch.getCacheDetails(false).setHints(getHints(completeWebPage));
+						ch.getCacheDetails(false).setHints(
+								getHints(completeWebPage));
 						pref.log(&quot;Hints: &quot; + ch.getCacheDetails(false).Hints);
 
-						ch.setCacheSize(CacheSize.gcSpiderString2Cw(getSize(completeWebPage)));
+						ch.setCacheSize(CacheSize
+								.gcSpiderString2Cw(getSize(completeWebPage)));
 						pref.log(&quot;Size: &quot; + ch.getCacheSize());
 
-						ch.setHard(CacheTerrDiff.v1Converter(getDiff(completeWebPage)));
+						ch.setHard(CacheTerrDiff
+								.v1Converter(getDiff(completeWebPage)));
 						pref.log(&quot;Hard: &quot; + ch.getHard());
 
-						ch.setTerrain(CacheTerrDiff.v1Converter(getTerr(completeWebPage)));
+						ch.setTerrain(CacheTerrDiff
+								.v1Converter(getTerr(completeWebPage)));
 						pref.log(&quot;Terr: &quot; + ch.getTerrain());
 
 						ch.setType(getType(completeWebPage));
 						pref.log(&quot;Type: &quot; + ch.getType());
-						//==========
+						// ==========
 						// Bugs
-						//==========
-						if (fetchTBs) getBugs(ch.getCacheDetails(false),completeWebPage);
-						ch.setHas_bugs(ch.getCacheDetails(false).Travelbugs.size()&gt;0);
+						// ==========
+						if (fetchTBs)
+							getBugs(ch.getCacheDetails(false), completeWebPage);
+						ch.setHas_bugs(ch.getCacheDetails(false).Travelbugs
+								.size() &gt; 0);
 						pref.log(&quot;Got TBs&quot;);
-						//==========
+						// ==========
 						// Images
-						//==========
-						if(fetchImages){
-							getImages(completeWebPage, ch.getCacheDetails(false));
+						// ==========
+						if (fetchImages) {
+							getImages(completeWebPage, ch
+									.getCacheDetails(false));
 							pref.log(&quot;Got images&quot;);
 						}
-						//==========
+						// ==========
 						// Addi waypoints
-						//==========
-						getAddWaypoints(completeWebPage, ch.getWayPoint(), ch.is_found());
+						// ==========
+						getAddWaypoints(completeWebPage, ch.getWayPoint(), ch
+								.is_found());
 						pref.log(&quot;Got additional waypoints&quot;);
-						//==========
+						// ==========
 						// Attributes
-						//==========
-						getAttributes(completeWebPage, ch.getCacheDetails(false));
+						// ==========
+						getAttributes(completeWebPage, ch
+								.getCacheDetails(false));
 						pref.log(&quot;Got attributes&quot;);
-						//==========
+						// ==========
 						// Last sync date
-						//==========
+						// ==========
 						ch.setLastSync((new Time()).format(&quot;yyyyMMddHHmmss&quot;));
 						ch.setIncomplete(false);
-						pref.log(&quot;ready &quot; + ch.getWayPoint() + &quot; : &quot;+ ch.getLastSync());
+						pref.log(&quot;ready &quot; + ch.getWayPoint() + &quot; : &quot; + ch.getLastSync());
 						break;
-					}catch(Exception ex){
-						pref.log(&quot;[getCacheByWaypointName: ]Error reading cache: &quot;+ch.getWayPoint(),ex);
+					} catch (Exception ex) {
+						pref.log(&quot;[getCacheByWaypointName: ]Error reading cache: &quot; + ch.getWayPoint(), ex);
 					}
 				} else {
 					break;
 				}
 			} // spiderTrys
-			if ( ( spiderTrys &gt;= MAX_SPIDER_TRYS ) &amp;&amp; ( ret == SPIDER_OK ) ) {
-				pref.log(&quot;&gt;&gt;&gt; Failed to spider cache. Number of retrys exhausted.&quot;,null);
-				int decision = (new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;),MyLocale.getMsg(5515,&quot;Failed to load cache.%0aPleas check your internet connection.%0aRetry?&quot;),FormBase.DEFOKB|FormBase.NOB|FormBase.CANCELB)).execute();
-				if ( decision == FormBase.IDOK ) {
+			if ((spiderTrys &gt;= MAX_SPIDER_TRYS) &amp;&amp; (ret == SPIDER_OK)) {
+				pref.log(&quot;&gt;&gt;&gt; Failed to spider cache. Number of retrys exhausted.&quot;, null);
+				int decision = (new MessageBox(MyLocale.getMsg(5500, &quot;Error&quot;),
+						MyLocale.getMsg(5515,&quot;Failed to load cache.%0aPleas check your internet connection.%0aRetry?&quot;),
+						FormBase.DEFOKB | FormBase.NOB | FormBase.CANCELB))
+						.execute();
+				if (decision == FormBase.IDOK) {
 					continue; // retry even if failure
-				} else if ( decision == FormBase.IDNO ){
+				} else if (decision == FormBase.IDNO) {
 					ret = SPIDER_ERROR;
 				} else {
 					ret = SPIDER_CANCEL;
 				}
 			}
 			break;
-		}//while(true) // retry even if failure
-		if (infB.isClosed) {// If the infoBox was closed before getting here, we return -1
+		}// while(true) // retry even if failure
+		if (infB.isClosed) {// If the infoBox was closed before getting here, we
+							// return -1
 			return SPIDER_CANCEL;
 		}
 		return ret;
 	} // getCacheByWaypointName
 
-
 	/**
 	 * Get the coordinates of the cache
-	 * @param doc A previously fetched cachepage
+	 * 
+	 * @param doc
+	 *            A previously fetched cachepage
 	 * @return Cache coordinates
 	 */
-	private String getLatLon(String doc) throws Exception{
+	private String getLatLon(String doc) throws Exception {
 		Regex inRex = new Regex(p.getProp(&quot;latLonRex&quot;));
 		inRex.search(doc);
 		if (!inRex.didMatch()) {
-			pref.log(&quot;check latLonRex in spider.def&quot;+Preferences.NEWLINE+doc);
+			pref.log(&quot;check latLonRex in spider.def&quot; 
+					+ Preferences.NEWLINE + doc);
 			return &quot;???&quot;;
 		}
 		return inRex.stringMatched(1);
 	}
 
-	boolean shortDescRex_not_yet_found=true;
+	boolean shortDescRex_not_yet_found = true;
+
 	/**
 	 * Get the long description
-	 * @param doc A previously fetched cachepage
+	 * 
+	 * @param doc
+	 *            A previously fetched cachepage
 	 * @return the long description
 	 */
-	private String getLongDesc(String doc) throws Exception{
+	private String getLongDesc(String doc) throws Exception {
 		String res = &quot;&quot;;
 		Regex shortDescRex = new Regex(p.getProp(&quot;shortDescRex&quot;));
 		Regex longDescRex = new Regex(p.getProp(&quot;longDescRex&quot;));
 		shortDescRex.search(doc);
 		if (!shortDescRex.didMatch()) {
-			if (shortDescRex_not_yet_found) pref.log(&quot;no shortDesc or check shortDescRex in spider.def&quot;+Preferences.NEWLINE+doc);
-		}
-		else {
+			if (shortDescRex_not_yet_found)
+				pref.log(&quot;no shortDesc or check shortDescRex in spider.def&quot;
+						+ Preferences.NEWLINE + doc);
+		} else {
 			res = shortDescRex.stringMatched(1);
-			shortDescRex_not_yet_found=false;
+			shortDescRex_not_yet_found = false;
 		}
 		res += &quot;&lt;br&gt;&quot;;
 		longDescRex.search(doc);
 		if (!longDescRex.didMatch()) {
-			pref.log(&quot;check longDescRex in spider.def&quot;+Preferences.NEWLINE+doc);
-		}
-		else {
+			pref.log(&quot;check longDescRex in spider.def&quot; 
+					+ Preferences.NEWLINE + doc);
+		} else {
 			res += longDescRex.stringMatched(1);
 		}
 		int spanEnd = res.lastIndexOf(&quot;&lt;/span&gt;&quot;);
 		if (spanEnd &gt;= 0) {
 			res = res.substring(0, spanEnd);
 		}
-		return SafeXML.cleanback(res); // since internal viewer doesn't show html-entities that are now in cacheDescription
+		return SafeXML.cleanback(res); // since internal viewer doesn't show
+										// html-entities that are now in
+										// cacheDescription
 	}
 
 	/**
 	 * Get the cache location (country and state)
-	 * @param doc A previously fetched cachepage
+	 * 
+	 * @param doc
+	 *            A previously fetched cachepage
 	 * @return the location (country and state) of the cache
 	 */
-	private String getLocation(String doc) throws Exception{
+	private String getLocation(String doc) throws Exception {
 		Regex inRex = new Regex(p.getProp(&quot;cacheLocationRex&quot;));
 		inRex.search(doc);
 		if (!inRex.didMatch()) {
-			pref.log(&quot;check cacheLocationRex in spider.def&quot;+Preferences.NEWLINE+doc);
+			pref.log(&quot;check cacheLocationRex in spider.def&quot;
+					+ Preferences.NEWLINE + doc);
 			return &quot;&quot;;
 		}
 		return inRex.stringMatched(1);
@@ -1824,14 +2218,17 @@
 
 	/**
 	 * Get the cache name
-	 * @param doc A previously fetched cachepage
+	 * 
+	 * @param doc
+	 *            A previously fetched cachepage
 	 * @return the name of the cache
 	 */
-	private String getName(String doc) throws Exception{
+	private String getName(String doc) throws Exception {
 		Regex inRex = new Regex(p.getProp(&quot;cacheNameRex&quot;));
 		inRex.search(doc);
 		if (!inRex.didMatch()) {
-			pref.log(&quot;check cacheNameRex in spider.def&quot;+Preferences.NEWLINE+doc);
+			pref.log(&quot;check cacheNameRex in spider.def&quot; 
+					+ Preferences.NEWLINE + doc);
 			return &quot;???&quot;;
 		}
 		return inRex.stringMatched(1);
@@ -1839,14 +2236,17 @@
 
 	/**
 	 * Get the cache owner
-	 * @param doc A previously fetched cachepage
+	 * 
+	 * @param doc
+	 *            A previously fetched cachepage
 	 * @return the cache owner
 	 */
-	private String getOwner(String doc) throws Exception{
+	private String getOwner(String doc) throws Exception {
 		Regex inRex = new Regex(p.getProp(&quot;cacheOwnerRex&quot;));
 		inRex.search(doc);
 		if (!inRex.didMatch()) {
-			pref.log(&quot;check cacheOwnerRex in spider.def&quot;+Preferences.NEWLINE+doc);
+			pref.log(&quot;check cacheOwnerRex in spider.def&quot; 
+					+ Preferences.NEWLINE + doc);
 			return &quot;???&quot;;
 		}
 		return inRex.stringMatched(1);
@@ -1854,14 +2254,17 @@
 
 	/**
 	 * Get the date when the cache was hidden
-	 * @param doc A previously fetched cachepage
+	 * 
+	 * @param doc
+	 *            A previously fetched cachepage
 	 * @return Hidden date
 	 */
-	private String getDateHidden(String doc) throws Exception{
+	private String getDateHidden(String doc) throws Exception {
 		Regex inRex = new Regex(p.getProp(&quot;dateHiddenRex&quot;));
 		inRex.search(doc);
 		if (!inRex.didMatch()) {
-			pref.log(&quot;check dateHiddenRex in spider.def&quot;+Preferences.NEWLINE+doc);
+			pref.log(&quot;check dateHiddenRex in spider.def&quot; 
+					+ Preferences.NEWLINE + doc);
 			return &quot;???&quot;;
 		}
 		return inRex.stringMatched(1);
@@ -1869,14 +2272,17 @@
 
 	/**
 	 * Get the hints
-	 * @param doc A previously fetched cachepage
+	 * 
+	 * @param doc
+	 *            A previously fetched cachepage
 	 * @return Cachehints
 	 */
-	private String getHints(String doc) throws Exception{
+	private String getHints(String doc) throws Exception {
 		Regex inRex = new Regex(p.getProp(&quot;hintsRex&quot;));
 		inRex.search(doc);
 		if (!inRex.didMatch()) {
-			pref.log(&quot;check hintsRex in spider.def&quot;+Preferences.NEWLINE+doc);
+			pref.log(&quot;check hintsRex in spider.def&quot;
+					+ Preferences.NEWLINE + doc);
 			return &quot;&quot;;
 		}
 		return inRex.stringMatched(1);
@@ -1884,70 +2290,90 @@
 
 	/**
 	 * Get the cache size
-	 * @param doc A previously fetched cachepage
+	 * 
+	 * @param doc
+	 *            A previously fetched cachepage
 	 * @return Cache size
 	 */
-	private String getSize(String doc) throws Exception{
+	private String getSize(String doc) throws Exception {
 		Regex inRex = new Regex(p.getProp(&quot;sizeRex&quot;));
 		inRex.search(doc);
-		if(inRex.didMatch()) return inRex.stringMatched(1);
+		if (inRex.didMatch())
+			return inRex.stringMatched(1);
 		else {
-			pref.log(&quot;check sizeRex in spider.def&quot;+Preferences.NEWLINE+doc);
+			pref.log(&quot;check sizeRex in spider.def&quot;
+					+ Preferences.NEWLINE + doc);
 			return &quot;None&quot;;
 		}
 	}
 
 	/**
 	 * Get the Difficulty
-	 * @param doc A previously fetched cachepage
+	 * 
+	 * @param doc
+	 *            A previously fetched cachepage
 	 * @return The cache difficulty
 	 */
-	private String getDiff(String doc) throws Exception{
+	private String getDiff(String doc) throws Exception {
 		Regex inRex = new Regex(p.getProp(&quot;difficultyRex&quot;));
 		inRex.search(doc);
-		if(inRex.didMatch()) return inRex.stringMatched(1);
+		if (inRex.didMatch())
+			return inRex.stringMatched(1);
 		else {
-			pref.log(&quot;check difficultyRex in spider.def&quot;+Preferences.NEWLINE+doc);
+			pref.log(&quot;check difficultyRex in spider.def&quot; 
+					+ Preferences.NEWLINE + doc);
 			return &quot;-1&quot;;
 		}
 	}
 
 	/**
 	 * Get the terrain rating
-	 * @param doc A previously fetched cachepage
+	 * 
+	 * @param doc
+	 *            A previously fetched cachepage
 	 * @return Terrain rating
 	 */
-	private String getTerr(String doc) throws Exception{
+	private String getTerr(String doc) throws Exception {
 		Regex inRex = new Regex(p.getProp(&quot;terrainRex&quot;));
 		inRex.search(doc);
-		if(inRex.didMatch()) return inRex.stringMatched(1);
+		if (inRex.didMatch())
+			return inRex.stringMatched(1);
 		else {
-			pref.log(&quot;check terrainRex in spider.def&quot;+Preferences.NEWLINE+doc);
+			pref.log(&quot;check terrainRex in spider.def&quot; 
+					+ Preferences.NEWLINE + doc);
 			return &quot;-1&quot;;
 		}
 	}
 
 	/**
 	 * Get the waypoint type
-	 * @param doc A previously fetched cachepage
+	 * 
+	 * @param doc
+	 *            A previously fetched cachepage
 	 * @return the waypoint type (Tradi, Multi, etc.)
 	 */
-	private byte getType(String doc){
+	private byte getType(String doc) {
 		RexCacheType.search(doc);
-		if(RexCacheType.didMatch()) return CacheType.gcSpider2CwType(RexCacheType.stringMatched(1));
+		if (RexCacheType.didMatch())
+			return CacheType.gcSpider2CwType(RexCacheType.stringMatched(1));
 		else {
-			pref.log(&quot;check cacheTypeRex in spider.def&quot;+Preferences.NEWLINE+doc);
+			pref.log(&quot;check cacheTypeRex in spider.def&quot; 
+					+ Preferences.NEWLINE + doc);
 			return 0;
 		}
 	}
 
 	/**
 	 * Get the logs
-	 * @param doc A previously fetched cachepage
-	 * @param chD Cache Details
+	 * 
+	 * @param doc
+	 *            A previously fetched cachepage
+	 * @param chD
+	 *            Cache Details
 	 * @return A HTML string containing the logs
 	 */
-	private void getLogs(String completeWebPage, CacheHolderDetail chD) throws Exception {
+	private void getLogs(String completeWebPage, CacheHolderDetail chD)
+			throws Exception {
 		String icon = &quot;&quot;;
 		String name = &quot;&quot;;
 		String logText = &quot;&quot;;
@@ -1956,7 +2382,8 @@
 		LogList reslts = chD.CacheLogs;
 		RexLogBlock.search(completeWebPage);
 		if (!RexLogBlock.didMatch()) {
-			pref.log(&quot;check blockRex in spider.def&quot;+Preferences.NEWLINE+completeWebPage);			
+			pref.log(&quot;check blockRex in spider.def&quot; 
+					+ Preferences.NEWLINE + completeWebPage);
 		}
 		String LogBlock = RexLogBlock.stringMatched(1);
 		exSingleLog.setSource(LogBlock);
@@ -1967,30 +2394,37 @@
 		exDate.setSource(singleLog);
 		exLog.setSource(singleLog);
 		exLogId.setSource(singleLog);
-		int nLogs=0;
+		int nLogs = 0;
 		boolean foundown = false;
-		while(!exSingleLog.endOfSearch()){
-			//pref.log(singleLog);
+		while (!exSingleLog.endOfSearch()) {
+			// pref.log(singleLog);
 			nLogs++;
 			icon = exIcon.findNext();
 			name = exName.findNext();
 			logText = exLog.findNext();
 			logId = exLogId.findNext();
-			String d=DateFormat.logdate2YMD(exDate.findNext());
-			//pref.log(Integer.toString(nLogs)+&quot;:&quot;+icon+&quot;|logger:&quot;+name+&quot;|id:&quot;+logId+&quot;|&quot;+d);
+			String d = DateFormat.logdate2YMD(exDate.findNext());
+			// pref.log(Integer.toString(nLogs)+&quot;:&quot;+icon+&quot;|logger:&quot;+name+&quot;|id:&quot;+logId+&quot;|&quot;+d);
 			// if this log says this Cache is found by me
-			if((icon.equals(icon_smile) || icon.equals(icon_camera) || icon.equals(icon_attended)) &amp;&amp;
-				(name.equalsIgnoreCase(SafeXML.clean(pref.myAlias)) || 
-				(pref.myAlias2.length()&gt;0 &amp;&amp; name.equalsIgnoreCase(SafeXML.clean(pref.myAlias2)))) )  {
+			if ((icon.equals(icon_smile) || icon.equals(icon_camera) || icon
+					.equals(icon_attended))
+					&amp;&amp; (name.equalsIgnoreCase(SafeXML.clean(pref.myAlias)) || (pref.myAlias2
+							.length() &gt; 0 &amp;&amp; name.equalsIgnoreCase(SafeXML
+							.clean(pref.myAlias2))))) {
 				chD.getParent().setFound(true);
 				chD.getParent().setCacheStatus(d);
 				chD.OwnLogId = logId;
-				chD.OwnLog = new Log(icon,d,name,logText);
-				foundown=true;
-				//pref.log(&quot;own log detected!&quot;);
+				chD.OwnLog = new Log(icon, d, name, logText);
+				foundown = true;
+				// pref.log(&quot;own log detected!&quot;);
 			}
-			if (nLogs&lt;=pref.maxLogsToSpider) {reslts.add(new Log(icon,d,name,logText));}
-			else {if (foundown){break;}}
+			if (nLogs &lt;= pref.maxLogsToSpider) {
+				reslts.add(new Log(icon, d, name, logText));
+			} else {
+				if (foundown) {
+					break;
+				}
+			}
 			singleLog = exSingleLog.findNext();
 			exIcon.setSource(singleLog);
 			exNameTemp.setSource(singleLog);
@@ -1999,48 +2433,69 @@
 			exLog.setSource(singleLog);
 			exLogId.setSource(singleLog);
 		}
-		if (nLogs&gt;pref.maxLogsToSpider) {
+		if (nLogs &gt; pref.maxLogsToSpider) {
 			reslts.add(Log.maxLog());
-			//pref.log(&quot;MAXLOGS reached (&quot;+pref.maxLogsToSpider+&quot;)&quot;);
-		} 
-		//pref.log(nLogs+&quot; checked!&quot;);
+			// pref.log(&quot;MAXLOGS reached (&quot;+pref.maxLogsToSpider+&quot;)&quot;);
+		}
+		// pref.log(nLogs+&quot; checked!&quot;);
 		// return reslts;
 	}
 
 	/**
 	 * Read the travelbug names from a previously fetched Cache page and then
 	 * read the travelbug purpose for each travelbug
-	 * @param doc The previously fetched cachepage
+	 * 
+	 * @param doc
+	 *            The previously fetched cachepage
 	 * @return A HTML formatted string with bug names and there purpose
 	 */
-	public void getBugs(CacheHolderDetail chD, String doc) throws Exception{
-		Extractor exBlock = new Extractor(doc,p.getProp(&quot;blockExStart&quot;),p.getProp(&quot;blockExEnd&quot;) ,0,Extractor.EXCLUDESTARTEND);
+	public void getBugs(CacheHolderDetail chD, String doc) throws Exception {
+		Extractor exBlock = new Extractor(doc, 
+				p.getProp(&quot;blockExStart&quot;), 
+				p.getProp(&quot;blockExEnd&quot;), 
+				0, Extractor.EXCLUDESTARTEND);
 		String bugBlock = exBlock.findNext();
-		Extractor exBug = new Extractor(bugBlock,p.getProp(&quot;bugExStart&quot;),p.getProp(&quot;bugExEnd&quot;),0,Extractor.EXCLUDESTARTEND);
-		String link,bug,linkPlusBug,bugDetails;
-		String oldInfoBox=infB.getInfo();
+		Extractor exBug = new Extractor(bugBlock, 
+				p.getProp(&quot;bugExStart&quot;), 
+				p.getProp(&quot;bugExEnd&quot;), 
+				0, Extractor.EXCLUDESTARTEND);
+		String link, bug, linkPlusBug, bugDetails;
+		String oldInfoBox = infB.getInfo();
 		chD.Travelbugs.clear();
-		while(!exBug.endOfSearch()){
-			if (infB.isClosed) break; // Allow user to cancel by closing progress form
-			linkPlusBug= exBug.findNext();
-			int idx=linkPlusBug.indexOf(p.getProp(&quot;bugLinkEnd&quot;));
-			if (idx&lt;0) break; // No link/bug pair found
-			link=linkPlusBug.substring(0,idx);
-			Extractor exBugName = new Extractor(linkPlusBug,p.getProp(&quot;bugNameExStart&quot;),p.getProp(&quot;bugNameExEnd&quot;),0,Extractor.EXCLUDESTARTEND);
-			bug=exBugName.findNext();
-			if(bug.length()&gt;0) { // Found a bug, get its details
-				Travelbug tb=new Travelbug(bug);
-				try{
-					infB.setInfo(oldInfoBox+MyLocale.getMsg(5514,&quot;\nGetting bug: &quot;)+SafeXML.cleanback(bug));
-					bugDetails = fetch(link,false);
-					pref.log(&quot;[getBugs] Fetched TB details: &quot;+bug);
-					Extractor exDetails = new Extractor(bugDetails,p.getProp(&quot;bugDetailsStart&quot;),p.getProp(&quot;bugDetailsEnd&quot;),0,Extractor.EXCLUDESTARTEND);
+		while (!exBug.endOfSearch()) {
+			if (infB.isClosed)
+				break; // Allow user to cancel by closing progress form
+			linkPlusBug = exBug.findNext();
+			int idx = linkPlusBug.indexOf(p.getProp(&quot;bugLinkEnd&quot;));
+			if (idx &lt; 0)
+				break; // No link/bug pair found
+			link = linkPlusBug.substring(0, idx);
+			Extractor exBugName = new Extractor(linkPlusBug, 
+					p.getProp(&quot;bugNameExStart&quot;), 
+					p.getProp(&quot;bugNameExEnd&quot;), 
+					0, Extractor.EXCLUDESTARTEND);
+			bug = exBugName.findNext();
+			if (bug.length() &gt; 0) { // Found a bug, get its details
+				Travelbug tb = new Travelbug(bug);
+				try {
+					infB.setInfo(oldInfoBox
+							+ MyLocale.getMsg(5514, &quot;\nGetting bug: &quot;)
+							+ SafeXML.cleanback(bug));
+					bugDetails = fetch(link, false);
+					pref.log(&quot;[getBugs] Fetched TB details: &quot; + bug);
+					Extractor exDetails = new Extractor(bugDetails, p
+							.getProp(&quot;bugDetailsStart&quot;), p
+							.getProp(&quot;bugDetailsEnd&quot;),
+							0, Extractor.EXCLUDESTARTEND);
 					tb.setMission(exDetails.findNext());
-					Extractor exGuid = new Extractor(bugDetails,&quot;action=\&quot;details.aspx?guid=&quot;,&quot;\&quot; id=\&quot;aspnetForm&quot;,0,Extractor.EXCLUDESTARTEND); // TODO Replace with spider.def see also further down
+					Extractor exGuid = new Extractor(bugDetails,
+							&quot;action=\&quot;details.aspx?guid=&quot;,
+							&quot;\&quot; id=\&quot;aspnetForm&quot;,
+							0, Extractor.EXCLUDESTARTEND);
 					tb.setGuid(exGuid.findNext());
 					chD.Travelbugs.add(tb);
-				}catch(Exception ex){
-					pref.log(&quot;[getBugs] Could not fetch bug details&quot;,ex);
+				} catch (Exception ex) {
+					pref.log(&quot;[getBugs] Could not fetch bug details&quot;, ex);
 				}
 			}
 		}
@@ -2051,77 +2506,96 @@
 	 * Get the images for a previously fetched cache page. Images are extracted
 	 * from two areas: The long description and the pictures section (including
 	 * the spoiler)
-	 * @param doc The previously fetched cachepage
-	 * @param chD The Cachedetails
+	 * 
+	 * @param doc
+	 *            The previously fetched cachepage
+	 * @param chD
+	 *            The Cachedetails
 	 */
-	public void getImages(String doc, CacheHolderDetail chD){
+	public void getImages(String doc, CacheHolderDetail chD) {
 		int imgCounter = 0;
 		int spiderCounter = 0;
 		String fileName, imgName, imgType, imgUrl, imgComment;
-		Vector spideredUrls=new Vector(15);
-		ImageInfo imageInfo=null;
-		Extractor exImgBlock,exImgComment;
+		Vector spideredUrls = new Vector(15);
+		ImageInfo imageInfo = null;
+		Extractor exImgBlock, exImgComment;
 		int idxUrl; // Index of already spidered Url in list of spideredUrls
-		CacheImages lastImages=null;
+		CacheImages lastImages = null;
 
 		// First: Get current image object of waypoint before spidering images.
-		CacheHolder oldCh = Global.getProfile().cacheDB.get(chD.getParent().getWayPoint());
+		CacheHolder oldCh = Global.getProfile().cacheDB.get(chD.getParent()
+				.getWayPoint());
 		if (oldCh != null) {
 			lastImages = oldCh.getCacheDetails(false).images;
 		}
 
-		//========
-		//In the long description
-		//========
+		// ========
+		// In the long description
+		// ========
 		String longDesc = &quot;&quot;;
 		try {
-			if (chD.getParent().getWayPoint().startsWith(&quot;TC&quot;)) longDesc = doc;
+			if (chD.getParent().getWayPoint().startsWith(&quot;TC&quot;))
+				longDesc = doc;
 			else
 				longDesc = getLongDesc(doc);
 			longDesc = STRreplace.replace(longDesc, &quot;&lt;img&quot;, &quot;&lt;IMG&quot;);
 			longDesc = STRreplace.replace(longDesc, &quot;src=&quot;, &quot;SRC=&quot;);
 			longDesc = STRreplace.replace(longDesc, &quot;'&quot;, &quot;\&quot;&quot;);
-			exImgBlock = new Extractor(longDesc,p.getProp(&quot;imgBlockExStart&quot;),p.getProp(&quot;imgBlockExEnd&quot;), 0, false);
-		} catch (Exception ex) {//Missing property in spider.def
+			exImgBlock = new Extractor(longDesc, 
+					p.getProp(&quot;imgBlockExStart&quot;),
+					p.getProp(&quot;imgBlockExEnd&quot;), 
+					0, false);
+		} catch (Exception ex) {// Missing property in spider.def
 			return;
 		}
 		String tst;
 		tst = exImgBlock.findNext();
 		Extractor exImgSrc = new Extractor(tst, &quot;<A HREF="http://">http://</A>&quot;, &quot;\&quot;&quot;, 0, true);
-		while(exImgBlock.endOfSearch() == false){
+		while (exImgBlock.endOfSearch() == false) {
 			imgUrl = exImgSrc.findNext();
-			if(imgUrl.length()&gt;0){
-				// Optimize: img.groundspeak.com -&gt; img.geocaching.com (for better caching purposes)
+			if (imgUrl.length() &gt; 0) {
+				// Optimize: img.groundspeak.com -&gt; img.geocaching.com (for
+				// better caching purposes)
 				imgUrl = CacheImages.optimizeLink(&quot;<A HREF="http://">http://</A>&quot; + imgUrl);
-				try{
-					imgType = (imgUrl.substring(imgUrl.lastIndexOf('.')).toLowerCase()+&quot;    &quot;).substring(0,4).trim();
+				try {
+					imgType = (imgUrl.substring(imgUrl.lastIndexOf('.'))
+							.toLowerCase() + &quot;    &quot;).substring(0, 4).trim();
 					// imgType is now max 4 chars, starting with .
-					if(imgType.startsWith(&quot;.png&quot;) || imgType.startsWith(&quot;.jpg&quot;) || imgType.startsWith(&quot;.gif&quot;)){
-						// Check whether image was already spidered for this cache
-						idxUrl=spideredUrls.find(imgUrl);
-						imgName = chD.getParent().getWayPoint() + &quot;_&quot; + Convert.toString(imgCounter);
+					if (imgType.startsWith(&quot;.png&quot;)
+							|| imgType.startsWith(&quot;.jpg&quot;)
+							|| imgType.startsWith(&quot;.gif&quot;)) {
+						// Check whether image was already spidered for this
+						// cache
+						idxUrl = spideredUrls.find(imgUrl);
+						imgName = chD.getParent().getWayPoint() + &quot;_&quot;
+								+ Convert.toString(imgCounter);
 						imageInfo = null;
-						if (idxUrl&lt;0) { // New image
-							fileName = chD.getParent().getWayPoint().toLowerCase() + &quot;_&quot; + Convert.toString(spiderCounter);
+						if (idxUrl &lt; 0) { // New image
+							fileName = chD.getParent().getWayPoint()
+									.toLowerCase()
+									+ &quot;_&quot; + Convert.toString(spiderCounter);
 							if (lastImages != null) {
-								imageInfo = lastImages.needsSpidering(imgUrl, fileName+imgType);
+								imageInfo = lastImages.needsSpidering(imgUrl,
+										fileName + imgType);
 							}
 							if (imageInfo == null) {
 								imageInfo = new ImageInfo();
-								pref.log(&quot;[getImages] Loading image: &quot; + imgUrl+&quot; as &quot;+fileName+imgType);
-								spiderImage(imgUrl, fileName+imgType);
-								imageInfo.setFilename(fileName+imgType);
+								pref.log(&quot;[getImages] Loading image: &quot; + imgUrl + &quot; as &quot; + fileName + imgType);
+								spiderImage(imgUrl, fileName + imgType);
+								imageInfo.setFilename(fileName + imgType);
 								imageInfo.setURL(imgUrl);
 							} else {
-								pref.log(&quot;[getImages] Already exising image: &quot; + imgUrl+&quot; as &quot;+imageInfo.getFilename());
+								pref.log(&quot;[getImages] Already exising image: &quot; + imgUrl + &quot; as &quot; + imageInfo.getFilename());
 							}
 							spideredUrls.add(imgUrl);
 							spiderCounter++;
 						} else { // Image already spidered as wayPoint_'idxUrl'
-							fileName = chD.getParent().getWayPoint().toLowerCase() + &quot;_&quot; + Convert.toString(idxUrl);
-							pref.log(&quot;[getImages] Already loaded image: &quot; + imgUrl+&quot; as &quot;+fileName+imgType);
+							fileName = chD.getParent().getWayPoint()
+									.toLowerCase()
+									+ &quot;_&quot; + Convert.toString(idxUrl);
+							pref.log(&quot;[getImages] Already loaded image: &quot; + imgUrl + &quot; as &quot; + fileName + imgType);
 							imageInfo = new ImageInfo();
-							imageInfo.setFilename(fileName+imgType);
+							imageInfo.setFilename(fileName + imgType);
 							imageInfo.setURL(imgUrl);
 						}
 						imageInfo.setTitle(imgName);
@@ -2130,101 +2604,123 @@
 						chD.images.add(imageInfo);
 					}
 				} catch (IndexOutOfBoundsException e) {
-					pref.log(&quot;[getImages] Problem loading image. imgURL:&quot;+imgUrl,e);
+					pref.log(&quot;[getImages] Problem loading image. imgURL:&quot; + imgUrl, e);
 				}
-				}
+			}
 			exImgSrc.setSource(exImgBlock.findNext());
 		}
-		//========
-		//In the image span
-		//========
-		Extractor spanBlock,exImgName;
+		// ========
+		// In the image span
+		// ========
+		Extractor spanBlock, exImgName;
 		try {
-			spanBlock = new Extractor(doc,p.getProp(&quot;imgSpanExStart&quot;),p.getProp(&quot;imgSpanExEnd&quot;), 0 , true);
+			spanBlock = new Extractor(doc, p.getProp(&quot;imgSpanExStart&quot;), 
+					p.getProp(&quot;imgSpanExEnd&quot;), 0, true);
 			tst = spanBlock.findNext();
-			exImgName = new Extractor(tst,p.getProp(&quot;imgNameExStart&quot;),p.getProp(&quot;imgNameExEnd&quot;), 0 , true);
-			exImgSrc = new Extractor(tst,p.getProp(&quot;imgSrcExStart&quot;),p.getProp(&quot;imgSrcExEnd&quot;), 0, true);
-			exImgComment = new Extractor(tst,p.getProp(&quot;imgCommentExStart&quot;),p.getProp(&quot;imgCommentExEnd&quot;), 0, true);
+			exImgName = new Extractor(tst, p.getProp(&quot;imgNameExStart&quot;), 
+					p.getProp(&quot;imgNameExEnd&quot;), 0, true);
+			exImgSrc = new Extractor(tst, p.getProp(&quot;imgSrcExStart&quot;), 
+					p.getProp(&quot;imgSrcExEnd&quot;), 0, true);
+			exImgComment = new Extractor(tst, p.getProp(&quot;imgCommentExStart&quot;), 
+					p.getProp(&quot;imgCommentExEnd&quot;), 0, true);
 		} catch (Exception ex) {
 			return;
 		}
-		while(!exImgSrc.endOfSearch()){
+		while (!exImgSrc.endOfSearch()) {
 			imgUrl = exImgSrc.findNext();
 			imgComment = exImgComment.findNext();
-			if(imgUrl.length()&gt;0){
+			if (imgUrl.length() &gt; 0) {
 				imgUrl = &quot;<A HREF="http://">http://</A>&quot; + imgUrl;
-				try{
-					imgType = (imgUrl.substring(imgUrl.lastIndexOf('.')).toLowerCase()+&quot;    &quot;).substring(0,4).trim();
+				try {
+					imgType = (imgUrl.substring(imgUrl.lastIndexOf('.'))
+							.toLowerCase() + &quot;    &quot;).substring(0, 4).trim();
 					// imgType is now max 4 chars, starting with .
-					if(imgType.startsWith(&quot;.png&quot;) || imgType.startsWith(&quot;.jpg&quot;) || imgType.startsWith(&quot;.gif&quot;)){
-						// Check whether image was already spidered for this cache
-						idxUrl=spideredUrls.find(imgUrl);
-						imgName = chD.getParent().getWayPoint() + &quot;_&quot; + Convert.toString(imgCounter);
+					if (imgType.startsWith(&quot;.png&quot;)
+							|| imgType.startsWith(&quot;.jpg&quot;)
+							|| imgType.startsWith(&quot;.gif&quot;)) {
+						// Check whether image was already spidered for this
+						// cache
+						idxUrl = spideredUrls.find(imgUrl);
+						imgName = chD.getParent().getWayPoint() + &quot;_&quot;
+								+ Convert.toString(imgCounter);
 						imageInfo = null;
-						if (idxUrl&lt;0) { // New image
-							fileName = chD.getParent().getWayPoint().toLowerCase() + &quot;_&quot; + Convert.toString(spiderCounter);
+						if (idxUrl &lt; 0) { // New image
+							fileName = chD.getParent().getWayPoint()
+									.toLowerCase()
+									+ &quot;_&quot; + Convert.toString(spiderCounter);
 							if (lastImages != null) {
-								imageInfo = lastImages.needsSpidering(imgUrl, fileName+imgType);
+								imageInfo = lastImages.needsSpidering(imgUrl,
+										fileName + imgType);
 							}
 							if (imageInfo == null) {
 								imageInfo = new ImageInfo();
-								pref.log(&quot;[getImages] Loading image: &quot; + imgUrl+&quot; as &quot;+fileName+imgType);
-								spiderImage(imgUrl, fileName+imgType);
-								imageInfo.setFilename(fileName+imgType);
+								pref.log(&quot;[getImages] Loading image: &quot; + imgUrl + &quot; as &quot; + fileName + imgType);
+								spiderImage(imgUrl, fileName + imgType);
+								imageInfo.setFilename(fileName + imgType);
 								imageInfo.setURL(imgUrl);
 							} else {
-								pref.log(&quot;[getImages] Already exising image: &quot; + imgUrl+&quot; as &quot;+imageInfo.getFilename());
+								pref.log(&quot;[getImages] Already exising image: &quot; + imgUrl + &quot; as &quot; + imageInfo.getFilename());
 							}
 							spideredUrls.add(imgUrl);
 							spiderCounter++;
 						} else { // Image already spidered as wayPoint_'idxUrl'
 							fileName = chD.getParent().getWayPoint().toLowerCase() + &quot;_&quot; + Convert.toString(idxUrl);
-							pref.log(&quot;[getImages] Already loaded image: &quot; + imgUrl+&quot; as &quot;+fileName+imgType);
+							pref.log(&quot;[getImages] Already loaded image: &quot; + imgUrl + &quot; as &quot; + fileName + imgType);
 							imageInfo = new ImageInfo();
-							imageInfo.setFilename(fileName+imgType);
+							imageInfo.setFilename(fileName + imgType);
 							imageInfo.setURL(imgUrl);
 						}
 						imageInfo.setTitle(exImgName.findNext());
-						while (imgComment.startsWith(&quot;&lt;br /&gt;&quot;)) imgComment=imgComment.substring(6);
-						while (imgComment.endsWith(&quot;&lt;br /&gt;&quot;)) imgComment=imgComment.substring(0,imgComment.length()-6);
+						while (imgComment.startsWith(&quot;&lt;br /&gt;&quot;))
+							imgComment = imgComment.substring(6);
+						while (imgComment.endsWith(&quot;&lt;br /&gt;&quot;))
+							imgComment = imgComment.substring(0, imgComment.length() - 6);
 						imageInfo.setComment(imgComment);
 						chD.images.add(imageInfo);
 					}
 				} catch (IndexOutOfBoundsException e) {
-					pref.log(&quot;[getImages] IndexOutOfBoundsException in image span. imgURL:&quot;+imgUrl,e);
+					pref.log(&quot;[getImages] IndexOutOfBoundsException in image span. imgURL:&quot; + imgUrl, e);
 				}
 			}
 		}
-		//========
-		//Final sweep to check for images in hrefs
-		//========
+		// ========
+		// Final sweep to check for images in hrefs
+		// ========
 		Extractor exFinal = new Extractor(longDesc, &quot;<A HREF="http://">http://</A>&quot;, &quot;\&quot;&quot;, 0, true);
-		while(!exFinal.endOfSearch()){
+		while (!exFinal.endOfSearch()) {
 			imgUrl = exFinal.findNext();
-			if(imgUrl.length()&gt;0){
-				// Optimize: img.groundspeak.com -&gt; img.geocaching.com (for better caching purposes)
+			if (imgUrl.length() &gt; 0) {
+				// Optimize: img.groundspeak.com -&gt; img.geocaching.com (for
+				// better caching purposes)
 				imgUrl = CacheImages.optimizeLink(&quot;<A HREF="http://">http://</A>&quot; + imgUrl);
-				try{
-					imgType = (imgUrl.substring(imgUrl.lastIndexOf('.')).toLowerCase()+&quot;    &quot;).substring(0,4).trim();
-					// imgType is now max 4 chars, starting with . Delete characters in URL after the image extension
-					imgUrl=imgUrl.substring(0,imgUrl.lastIndexOf('.')+imgType.length());
-					if( imgType.startsWith(&quot;.jpg&quot;) || imgType.startsWith(&quot;.bmp&quot;) || imgType.startsWith(&quot;.png&quot;) || imgType.startsWith(&quot;.gif&quot;)){
-						// Check whether image was already spidered for this cache
-						idxUrl=spideredUrls.find(imgUrl);
-						if (idxUrl&lt;0) { // New image
+				try {
+					imgType = (imgUrl.substring(imgUrl.lastIndexOf('.'))
+							.toLowerCase() + &quot;    &quot;).substring(0, 4).trim();
+					// imgType is now max 4 chars, starting with . Delete
+					// characters in URL after the image extension
+					imgUrl = imgUrl.substring(0, imgUrl.lastIndexOf('.')
+							+ imgType.length());
+					if (imgType.startsWith(&quot;.jpg&quot;)
+							|| imgType.startsWith(&quot;.bmp&quot;)
+							|| imgType.startsWith(&quot;.png&quot;)
+							|| imgType.startsWith(&quot;.gif&quot;)) {
+						// Check whether image was already spidered for this
+						// cache
+						idxUrl = spideredUrls.find(imgUrl);
+						if (idxUrl &lt; 0) { // New image
 							imgName = chD.getParent().getWayPoint() + &quot;_&quot; + Convert.toString(imgCounter);
 							fileName = chD.getParent().getWayPoint().toLowerCase() + &quot;_&quot; + Convert.toString(spiderCounter);
 							if (lastImages != null) {
-								imageInfo = lastImages.needsSpidering(imgUrl, fileName+imgType);
+								imageInfo = lastImages.needsSpidering(imgUrl, fileName + imgType);
 							}
-							if (imageInfo==null) {
+							if (imageInfo == null) {
 								imageInfo = new ImageInfo();
-								pref.log(&quot;[getImages] Loading image: &quot; + imgUrl+&quot; as &quot;+fileName+imgType);
-								spiderImage(imgUrl, fileName+imgType);
-								imageInfo.setFilename(fileName+imgType);
+								pref.log(&quot;[getImages] Loading image: &quot; + imgUrl + &quot; as &quot; + fileName + imgType);
+								spiderImage(imgUrl, fileName + imgType);
+								imageInfo.setFilename(fileName + imgType);
 								imageInfo.setURL(imgUrl);
 							} else {
-								pref.log(&quot;[getImages] Already exising image: &quot; + imgUrl+&quot; as &quot;+imageInfo.getFilename());
+								pref.log(&quot;[getImages] Already exising image: &quot; + imgUrl + &quot; as &quot; + imageInfo.getFilename());
 							}
 							spideredUrls.add(imgUrl);
 							spiderCounter++;
@@ -2234,69 +2730,84 @@
 						}
 					}
 				} catch (IndexOutOfBoundsException e) {
-					pref.log(&quot;[getImages] Problem loading image. imgURL:&quot;+imgUrl,e);
+					pref.log(&quot;[getImages] Problem loading image. imgURL:&quot; + imgUrl, e);
 				}
 			}
 		}
 	}
 
-
 	/**
 	 * Read an image from the server
-	 * @param imgUrl The Url of the image
-	 * @param target The bytes of the image
+	 * 
+	 * @param imgUrl
+	 *            The Url of the image
+	 * @param target
+	 *            The bytes of the image
 	 */
-	private void spiderImage(String imgUrl, String target){ // TODO implement a fetch(URL, filename) in HttpConnection and use that one
+	private void spiderImage(String imgUrl, String target) {
+		 // TODO implement a fetch(URL, filename) in HttpConnection and use that one
 		HttpConnection connImg;
 		Socket sockImg;
-		//InputStream is;
+		// InputStream is;
 		FileOutputStream fos;
-		//int bytes_read;
-		//byte[] buffer = new byte[9000];
+		// int bytes_read;
+		// byte[] buffer = new byte[9000];
 		ByteArray daten;
 		String datei = &quot;&quot;;
 		datei = profile.dataDir + target;
 		connImg = new HttpConnection(imgUrl);
-		if (imgUrl.indexOf('%')&gt;=0) connImg.documentIsEncoded=true;
+		if (imgUrl.indexOf('%') &gt;= 0)
+			connImg.documentIsEncoded = true;
 		connImg.setRequestorProperty(&quot;Connection&quot;, &quot;close&quot;);
-		//connImg.setRequestorProperty(&quot;User-Agent&quot;,&quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.12) Gecko/20080201 Firefox/2.0.0.12&quot;);
-		//connImg.setRequestorProperty(&quot;Accept&quot;,&quot;text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5&quot;);
-		try{
+		// connImg.setRequestorProperty(&quot;User-Agent&quot;,&quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.12) Gecko/20080201 Firefox/2.0.0.12&quot;);
+		// connImg.setRequestorProperty(&quot;Accept&quot;,&quot;text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5&quot;);
+		try {
 			pref.log(&quot;[spiderImage] Trying to fetch image from: &quot; + imgUrl);
-			String redirect=null;
+			String redirect = null;
 			do {
 				sockImg = connImg.connect();
-				redirect=connImg.getRedirectTo();
-				if (redirect!=null) {
-					connImg=connImg.getRedirectedConnection(redirect);
-					pref.log(&quot;[spiderImage] Redirect to &quot;+redirect);
+				redirect = connImg.getRedirectTo();
+				if (redirect != null) {
+					connImg = connImg.getRedirectedConnection(redirect);
+					pref.log(&quot;[spiderImage] Redirect to &quot; + redirect);
 				}
-			} while(redirect!=null); // TODO this can end up in an endless loop if trying to load from a malicous site
+			} while (redirect != null); 
+			// TODO this can end up in an endless loop if trying to load from a malicous site
 			daten = connImg.readData(sockImg);
 			fos = new FileOutputStream(new File(datei));
 			fos.write(daten.toBytes());
 			fos.close();
 			sockImg.close();
 		} catch (UnknownHostException e) {
-			pref.log(&quot;[spiderImage] Host not there...&quot;,e);
-		} catch(IOException ioex){
-			pref.log(&quot;[spiderImage] File not found!&quot;,ioex);
-		} catch (Exception ex){
-			pref.log(&quot;[spiderImage] Some other problem while fetching image&quot;,ex);
+			pref.log(&quot;[spiderImage] Host not there...&quot;, e);
+		} catch (IOException ioex) {
+			pref.log(&quot;[spiderImage] File not found!&quot;, ioex);
+		} catch (Exception ex) {
+			pref.log(&quot;[spiderImage] Some other problem while fetching image&quot;, ex);
 		} finally {
-			//Continue with the spider
+			// Continue with the spider
 		}
 	}
 
 	/**
 	 * Read all additional waypoints from a previously fetched cachepage.
-	 * @param doc The previously fetched cachepage
-	 * @param wayPoint The name of the cache
-	 * @param is_found Found status of the cached (is inherited by the additional waypoints)
+	 * 
+	 * @param doc
+	 *            The previously fetched cachepage
+	 * @param wayPoint
+	 *            The name of the cache
+	 * @param is_found
+	 *            Found status of the cached (is inherited by the additional
+	 *            waypoints)
 	 */
-	boolean koords_not_yet_found = true; 
-	private void getAddWaypoints(String doc, String wayPoint, boolean is_found) throws Exception{
-		Extractor exWayBlock = new Extractor(doc,p.getProp(&quot;wayBlockExStart&quot;),p.getProp(&quot;wayBlockExEnd&quot;), 0, false);
+	boolean koords_not_yet_found = true;
+
+	private void getAddWaypoints(String doc, String wayPoint, boolean is_found)
+			throws Exception {
+		Extractor exWayBlock = new Extractor(doc, 
+				p.getProp(&quot;wayBlockExStart&quot;),
+				p.getProp(&quot;wayBlockExEnd&quot;), 
+				0, false);
 		String wayBlock = &quot;&quot;;
 		String rowBlock = &quot;&quot;;
 		wayBlock = exWayBlock.findNext();
@@ -2305,90 +2816,104 @@
 		Regex descRex = new Regex(p.getProp(&quot;descRex&quot;));
 		Regex typeRex = new Regex(p.getProp(&quot;typeRex&quot;));
 		int counter = 0;
-		if(!exWayBlock.endOfSearch() &amp;&amp; wayBlock.indexOf(&quot;No additional waypoints to display.&quot;)&lt;0){
-			Extractor exRowBlock = new Extractor(wayBlock,p.getProp(&quot;rowBlockExStart&quot;),p.getProp(&quot;rowBlockExEnd&quot;), 0, false);
+		if (!exWayBlock.endOfSearch()
+				&amp;&amp; wayBlock.indexOf(&quot;No additional waypoints to display.&quot;) &lt; 0) {
+			Extractor exRowBlock = new Extractor(wayBlock, 
+					p.getProp(&quot;rowBlockExStart&quot;), 
+					p.getProp(&quot;rowBlockExEnd&quot;),
+					0, false);
 			rowBlock = exRowBlock.findNext();
 			rowBlock = exRowBlock.findNext();
-			while(!exRowBlock.endOfSearch()){
+			while (!exRowBlock.endOfSearch()) {
 				CacheHolder hd = null;
 
-/*
-				String[] AddiBlock=mString.split(rowBlock,'\n');
-				int linePrefix=8;
-				if(AddiBlock.length &lt; linePrefix + 1) {
-					(new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;), &quot;GC changed table output \nCW must be changed too!&quot;, FormBase.OKB)).execute();
-					break;
-				}				
-				String prefix=AddiBlock[linePrefix].trim();
-*/
+				/*
+				 * String[] AddiBlock=mString.split(rowBlock,'\n'); int
+				 * linePrefix=8; if(AddiBlock.length &lt; linePrefix + 1) { (new
+				 * MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;),
+				 * &quot;GC changed table output \nCW must be changed too!&quot;,
+				 * FormBase.OKB)).execute(); break; } String
+				 * prefix=AddiBlock[linePrefix].trim();
+				 */
 
-//				Extractor exPrefix=new Extractor(AddiBlock[linePrefix].trim(),p.getProp(&quot;prefixExStart&quot;),p.getProp(&quot;prefixExEnd&quot;),0,true);
+				// Extractor exPrefix=new
+				// Extractor(AddiBlock[linePrefix].trim(),p.getProp(&quot;prefixExStart&quot;),p.getProp(&quot;prefixExEnd&quot;),0,true);
+				Extractor exPrefix = new Extractor(rowBlock, 
+						p.getProp(&quot;prefixExStart&quot;),
+						p.getProp(&quot;prefixExEnd&quot;), 
+						0, true);
+				String prefix = exPrefix.findNext();
 
-				Extractor exPrefix=new Extractor(rowBlock,p.getProp(&quot;prefixExStart&quot;),p.getProp(&quot;prefixExEnd&quot;),0,true);
-				String prefix=exPrefix.findNext();
-
 				String adWayPoint;
 				if (prefix.length() == 2)
-					adWayPoint=prefix+wayPoint.substring(2);
+					adWayPoint = prefix + wayPoint.substring(2);
 				else
-				    adWayPoint = MyLocale.formatLong(counter, &quot;00&quot;) + wayPoint.substring(2);
+					adWayPoint = MyLocale.formatLong(counter, &quot;00&quot;)
+							+ wayPoint.substring(2);
 				counter++;
-				int idx=profile.getCacheIndex(adWayPoint);
-				if (idx&gt;=0) {
-					// Creating new CacheHolder, but accessing old cache.xml file
-					hd=new CacheHolder();
+				int idx = profile.getCacheIndex(adWayPoint);
+				if (idx &gt;= 0) {
+					// Creating new CacheHolder, but accessing old cache.xml
+					// file
+					hd = new CacheHolder();
 					hd.setWayPoint(adWayPoint);
-					hd.getCacheDetails(true); // Accessing Details reads file if not yet done
+					hd.getCacheDetails(true); // Accessing Details reads file if
+												// not yet done
 				} else {
-					hd=new CacheHolder();
+					hd = new CacheHolder();
 					hd.setWayPoint(adWayPoint);
 				}
-				hd.initStates(idx&lt;0);
+				hd.initStates(idx &lt; 0);
 				nameRex.search(rowBlock);
 				if (nameRex.didMatch()) {
 					hd.setCacheName(nameRex.stringMatched(1));
+				} else {
+					pref.log(&quot;check nameRex in spider.def&quot;
+							+ Preferences.NEWLINE + rowBlock);
 				}
-				else {
-					pref.log(&quot;check nameRex in spider.def&quot;+Preferences.NEWLINE+rowBlock);			
-				}
 				koordRex.search(rowBlock);
 				typeRex.search(rowBlock);
-				if(koordRex.didMatch()) {
+				if (koordRex.didMatch()) {
 					hd.setLatLon(koordRex.stringMatched(1));
 					koords_not_yet_found = false;
+				} else {
+					if (koords_not_yet_found)
+						pref.log(&quot;check koordRex in spider.def&quot;
+								+ Preferences.NEWLINE + rowBlock);
 				}
-				else {
-					if (koords_not_yet_found) pref.log(&quot;check koordRex in spider.def&quot;+Preferences.NEWLINE+rowBlock);			
+				if (typeRex.didMatch()) {
+					hd.setType(CacheType.gpxType2CwType(&quot;Waypoint|&quot;
+							+ typeRex.stringMatched(1)));
+				} else {
+					pref.log(&quot;check typeRex in spider.def&quot;
+							+ Preferences.NEWLINE + rowBlock);
 				}
-				if(typeRex.didMatch()) {
-					hd.setType(CacheType.gpxType2CwType(&quot;Waypoint|&quot;+typeRex.stringMatched(1)));
-				}
-				else {
-					pref.log(&quot;check typeRex in spider.def&quot;+Preferences.NEWLINE+rowBlock);			
-				}
 				rowBlock = exRowBlock.findNext();
 				descRex.search(rowBlock);
 				if (descRex.didMatch()) {
-					hd.getCacheDetails(false).setLongDescription(descRex.stringMatched(1).trim());
+					hd.getCacheDetails(false).setLongDescription(
+							descRex.stringMatched(1).trim());
+				} else {
+					pref.log(&quot;check descRex in spider.def&quot;
+							+ Preferences.NEWLINE + rowBlock);
 				}
-				else {
-					pref.log(&quot;check descRex in spider.def&quot;+Preferences.NEWLINE+rowBlock);			
-				}
 				hd.setFound(is_found);
 				hd.setCacheSize(CacheSize.CW_SIZE_NOTCHOSEN);
 				hd.setHard(CacheTerrDiff.CW_DT_UNSET);
 				hd.setTerrain(CacheTerrDiff.CW_DT_UNSET);
-				if (idx&lt;0){
+				if (idx &lt; 0) {
 					cacheDB.add(hd);
 					hd.save();
-				}else {
-					CacheHolder cx=cacheDB.get(idx);
-					if (cx.is_Checked &amp;&amp; // Only re-spider existing addi waypoints that are ticked
-				 	   cx.isVisible()) { // and are visible (i.e.  not filtered)
-					   cx.initStates(false);
-					   cx.update(hd);
-					   cx.is_Checked=true;
-					   cx.save();
+				} else {
+					CacheHolder cx = cacheDB.get(idx);
+					if (cx.is_Checked &amp;&amp; // Only re-spider existing addi
+											// waypoints that are ticked
+							cx.isVisible()) { // and are visible (i.e. not
+												// filtered)
+						cx.initStates(false);
+						cx.update(hd);
+						cx.is_Checked = true;
+						cx.save();
 					}
 				}
 				rowBlock = exRowBlock.findNext();
@@ -2397,92 +2922,105 @@
 		}
 	}
 
-	public void getAttributes(String doc, CacheHolderDetail chD) throws Exception {
-		Extractor attBlock = new Extractor(doc,p.getProp(&quot;attBlockExStart&quot;),p.getProp(&quot;attBlockExEnd&quot;), 0 , true);
+	public void getAttributes(String doc, CacheHolderDetail chD)
+			throws Exception {
+		Extractor attBlock = new Extractor(doc, p.getProp(&quot;attBlockExStart&quot;), 
+				p.getProp(&quot;attBlockExEnd&quot;), 0, true);
 		String atts = attBlock.findNext();
-		Extractor attEx = new Extractor(atts,p.getProp(&quot;attExStart&quot;),p.getProp(&quot;attExEnd&quot;), 0 , true);
-		String attribute=attEx.findNext();
+		Extractor attEx = new Extractor(atts, p.getProp(&quot;attExStart&quot;), 
+				p.getProp(&quot;attExEnd&quot;), 0, true);
+		String attribute = attEx.findNext();
 		chD.attributes.clear();
 		while (!attEx.endOfSearch()) {
 			chD.attributes.add(attribute);
-			attribute=attEx.findNext();
+			attribute = attEx.findNext();
 		}
 		chD.getParent().setAttribsAsBits(chD.attributes.getAttribsAsBits());
 	}
 
-
 	/**
-	*	Performs an initial fetch to a given address. In this case
-	*	it will be a gc.com address. This method is used to obtain
-	*	the result of a search for caches screen.
-	*/
+	 * Performs an initial fetch to a given address. In this case it will be a
+	 * gc.com address. This method is used to obtain the result of a search for
+	 * caches screen.
+	 */
 	public static String fetch(String address, boolean withResponseHeaders) {
 		CharArray c_data;
-		try{
+		try {
 			HttpConnection conn;
-			if(pref.myproxy.length() &gt; 0 &amp;&amp; pref.proxyActive){
-				pref.log(&quot;[fetch]:Using proxy: &quot; + pref.myproxy + &quot; / &quot; +pref.myproxyport);
+			if (pref.myproxy.length() &gt; 0 &amp;&amp; pref.proxyActive) {
+				pref.log(&quot;[fetch]:Using proxy: &quot; + pref.myproxy + &quot; / &quot;
+						+ pref.myproxyport);
 			}
 			conn = new HttpConnection(address);
-			conn.setRequestorProperty(&quot;User-Agent&quot;, &quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.5) Gecko/20041107 Firefox/1.0&quot;);
-			if(cookieSession.length()&gt;0){
-				conn.setRequestorProperty(&quot;Cookie&quot;, &quot;ASP.NET_SessionId=&quot;+cookieSession +&quot;; userid=&quot;+cookieID);
-				pref.log(&quot;[fetch]:Cookie Zeug: &quot; + &quot;Cookie: ASP.NET_SessionId=&quot;+cookieSession +&quot;; userid=&quot;+cookieID);
+			conn.setRequestorProperty(&quot;User-Agent&quot;,
+					&quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.5) Gecko/20041107 Firefox/1.0&quot;);
+			if (cookieSession.length() &gt; 0) {
+				conn.setRequestorProperty(&quot;Cookie&quot;, &quot;ASP.NET_SessionId=&quot; + cookieSession + &quot;; userid=&quot; + cookieID);
+				pref.log(&quot;[fetch]:Cookie Zeug: &quot; + &quot;Cookie: ASP.NET_SessionId=&quot;
+						+ cookieSession + &quot;; userid=&quot; + cookieID);
 			} else
-				pref.log(&quot;[fetch]:No Cookie found&quot;,null);
+				pref.log(&quot;[fetch]:No Cookie found&quot;, null);
 			conn.setRequestorProperty(&quot;Connection&quot;, &quot;close&quot;);
 			conn.documentIsEncoded = true;
-			pref.log(&quot;[fetch]:Connecting &quot;+address);
+			pref.log(&quot;[fetch]:Connecting &quot; + address);
 			Socket sock = conn.connect();
-			pref.log(&quot;[fetch]:Connect ok! &quot;+address);
+			pref.log(&quot;[fetch]:Connect ok! &quot; + address);
 			// ByteArray daten = conn.readData(sock);
 			JavaUtf8Codec codec = new JavaUtf8Codec();
-			// c_data = codec.decodeText(daten.data, 0, daten.length, true, null);
+			// c_data = codec.decodeText(daten.data, 0, daten.length, true,
+			// null);
 			c_data = conn.readText(sock, codec);
 			sock.close();
-			pref.log(&quot;[fetch]:Read data ok &quot;+address);
+			pref.log(&quot;[fetch]:Read data ok &quot; + address);
 			if (withResponseHeaders)
-				return getResponseHeaders(conn)+c_data.toString();
-			else return c_data.toString();
-		}catch(IOException ioex){
+				return getResponseHeaders(conn) + c_data.toString();
+			else
+				return c_data.toString();
+		} catch (IOException ioex) {
 			pref.log(&quot;IOException in fetch&quot;, ioex);
-		}finally{
-			//continue
+		} finally {
+			// continue
 		}
 		return &quot;&quot;;
 	}
 
 	/**
-	*	After a fetch to gc.com the next fetches have to use the post method.
-	*	This method does exactly that. Actually this method is generic in the sense
-	*	that it can be used to post to a URL using http post.
-	*/
-	private static String fetch_post(String address, String document, String path, boolean withResponseHeaders) {
+	 * After a fetch to gc.com the next fetches have to use the post method.
+	 * This method does exactly that. Actually this method is generic in the
+	 * sense that it can be used to post to a URL using http post.
+	 */
+	private static String fetch_post(String address, String document,
+			String path, boolean withResponseHeaders) {
 		HttpConnection conn;
 		try {
 			conn = new HttpConnection(address);
 			JavaUtf8Codec codec = new JavaUtf8Codec();
 			conn.documentIsEncoded = true;
-			conn.setRequestorProperty(&quot;User-Agent&quot;, &quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.5) Gecko/20041107 Firefox/1.0&quot;);
-			conn.setPostData(codec.encodeText(document.toCharArray(),0,document.length(),true,null));
+			conn.setRequestorProperty(&quot;User-Agent&quot;,
+					&quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.5) Gecko/20041107 Firefox/1.0&quot;);
+			conn.setPostData(codec.encodeText(document.toCharArray(), 0, document.length(), true, null));
 			conn.setRequestorProperty(&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;);
-			if(cookieSession.length()&gt;0){
-				conn.setRequestorProperty(&quot;Cookie&quot;, &quot;ASP.NET_SessionId=&quot;+cookieSession+&quot;; userid=&quot;+cookieID);
-				pref.log(&quot;[fetch_post] &quot; + &quot;Cookie: ASP.NET_SessionId=&quot;+cookieSession +&quot;; userid=&quot;+cookieID);
+			if (cookieSession.length() &gt; 0) {
+				conn.setRequestorProperty(&quot;Cookie&quot;, &quot;ASP.NET_SessionId=&quot;
+						+ cookieSession + &quot;; userid=&quot; + cookieID);
+				pref.log(&quot;[fetch_post] &quot; + &quot;Cookie: ASP.NET_SessionId=&quot;
+						+ cookieSession + &quot;; userid=&quot; + cookieID);
 			} else {
-				pref.log(&quot;[fetch_post]:No Cookie found&quot;,null);
+				pref.log(&quot;[fetch_post]:No Cookie found&quot;, null);
 			}
 			conn.setRequestorProperty(&quot;Connection&quot;, &quot;close&quot;);
 			Socket sock = conn.connect();
-			pref.log(&quot;[fetch_post]:Connect ok! &quot;+address);
+			pref.log(&quot;[fetch_post]:Connect ok! &quot; + address);
 			// ByteArray daten = conn.readData(sock);
 			CharArray c_data = conn.readText(sock, codec);
-			pref.log(&quot;[fetch_post]:Read data ok &quot;+address);
-			// CharArray c_data = codec.decodeText(daten.data, 0, daten.length, true, null);
+			pref.log(&quot;[fetch_post]:Read data ok &quot; + address);
+			// CharArray c_data = codec.decodeText(daten.data, 0, daten.length,
+			// true, null);
 			sock.close();
 			if (withResponseHeaders)
-				return getResponseHeaders(conn)+c_data.toString();
-			else return c_data.toString();
+				return getResponseHeaders(conn) + c_data.toString();
+			else
+				return c_data.toString();
 		} catch (Exception e) {
 			// pref.log(&quot;[fetch_post] Ignored Exception&quot;, e, true);
 		}
@@ -2496,9 +3034,10 @@
 			boolean gotany = false;
 
 			for (int i = 0; i &lt; pl.size(); i++) {
-				Property currProp = (Property)pl.get(i);
+				Property currProp = (Property) pl.get(i);
 				if (currProp.value != null) {
-					sb.append(currProp.name).append(&quot;: &quot;).append(currProp.value).append(&quot;\r\n&quot;);
+					sb.append(currProp.name).append(&quot;: &quot;)
+							.append(currProp.value).append(&quot;\r\n&quot;);
 					gotany = true;
 				}
 			}
@@ -2509,20 +3048,23 @@
 	}
 
 	final static String hex = ewe.util.TextEncoder.hex;
+
 	public String encodeUTF8URL(byte[] what) {
 		int max = what.length;
-		char [] dest = new char[6*max]; // Assume each char is a UTF char and encoded into 6 chars
+		char[] dest = new char[6 * max]; // Assume each char is a UTF char and
+											// encoded into 6 chars
 		char d = 0;
-		for (int i = 0; i&lt;max; i++){
+		for (int i = 0; i &lt; max; i++) {
 			char c = (char) what[i];
-			if (c &lt;= ' ' || c == '+' || c == '&amp;' || c == '%' || c == '=' ||
-				   c == '|' || c == '{' || c == '}' || c&gt;0x7f ){
-					dest[d++] = '%';
-					dest[d++] = hex.charAt((c &gt;&gt; 4) &amp; 0xf);
-					dest[d++] = hex.charAt(c &amp; 0xf);
-			} else dest[d++] = c;
+			if (c &lt;= ' ' || c == '+' || c == '&amp;' || c == '%' || c == '='
+					|| c == '|' || c == '{' || c == '}' || c &gt; 0x7f) {
+				dest[d++] = '%';
+				dest[d++] = hex.charAt((c &gt;&gt; 4) &amp; 0xf);
+				dest[d++] = hex.charAt(c &amp; 0xf);
+			} else
+				dest[d++] = c;
 		}
-		return new String(dest,0,d);
+		return new String(dest, 0, d);
 	}
 
 	/**
@@ -2530,124 +3072,159 @@
 	 * sometimes several bugs with identical names but different IDs. Normally
 	 * the bug GUID is used which can be obtained from the cache page.&lt;br&gt;
 	 * Note that each bug has both an ID and a GUID.
-	 * @param name The name (or partial name) of a travelbug
+	 * 
+	 * @param name
+	 *            The name (or partial name) of a travelbug
 	 * @return the id of the bug
 	 */
-	public String getBugId (String name) {
+	public String getBugId(String name) {
 		String bugList;
-		try{
-			//infB.setInfo(oldInfoBox+&quot;\nGetting bug: &quot;+bug);
-			bugList = fetch(p.getProp(&quot;getBugByName&quot;)+STRreplace.replace(SafeXML.clean(name),&quot; &quot;,&quot;+&quot;),false);
-			pref.log(&quot;[getBugId] Fetched bugId: &quot;+name);
-		}catch(Exception ex){
-			pref.log(&quot;[getBugId] Could not fetch bug list&quot;+name,ex);
-			bugList=&quot;&quot;;
+		try {
+			// infB.setInfo(oldInfoBox+&quot;\nGetting bug: &quot;+bug);
+			bugList = fetch(p.getProp(&quot;getBugByName&quot;)
+					+ STRreplace.replace(SafeXML.clean(name), &quot; &quot;, &quot;+&quot;), false);
+			pref.log(&quot;[getBugId] Fetched bugId: &quot; + name);
+		} catch (Exception ex) {
+			pref.log(&quot;[getBugId] Could not fetch bug list&quot; + name, ex);
+			bugList = &quot;&quot;;
 		}
 		try {
-			if (bugList.equals(&quot;&quot;) || bugList.indexOf(p.getProp(&quot;bugNotFound&quot;))&gt;=0) {
-				(new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;), MyLocale.getMsg(6020,&quot;Travelbug not found.&quot;), FormBase.OKB)).execute();
+			if (bugList.equals(&quot;&quot;)
+					|| bugList.indexOf(p.getProp(&quot;bugNotFound&quot;)) &gt;= 0) {
+				(new MessageBox(MyLocale.getMsg(5500, &quot;Error&quot;), 
+						MyLocale.getMsg(6020, &quot;Travelbug not found.&quot;),
+						FormBase.OKB)).execute();
 				return &quot;&quot;;
 			}
-			if (bugList.indexOf(p.getProp(&quot;bugTotalRecords&quot;))&lt;0) {
-				(new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;), MyLocale.getMsg(6021,&quot;More than one travelbug found. Specify name more precisely.&quot;), FormBase.OKB)).execute();
+			if (bugList.indexOf(p.getProp(&quot;bugTotalRecords&quot;)) &lt; 0) {
+				(new MessageBox(MyLocale.getMsg(5500, &quot;Error&quot;),
+						MyLocale.getMsg(6021, &quot;More than one travelbug found. Specify name more precisely.&quot;),
+						FormBase.OKB)).execute();
 				return &quot;&quot;;
 			}
-			Extractor exGuid = new Extractor(bugList,p.getProp(&quot;bugGuidExStart&quot;),p.getProp(&quot;bugGuidExEnd&quot;),0,Extractor.EXCLUDESTARTEND); // TODO Replace with spider.def
+			Extractor exGuid = new Extractor(bugList, 
+					p.getProp(&quot;bugGuidExStart&quot;), 
+					p.getProp(&quot;bugGuidExEnd&quot;), 
+					0, Extractor.EXCLUDESTARTEND); 
+			// TODO Replace with spider.def
 			return exGuid.findNext();
 		} catch (Exception ex) {
-			pref.log(&quot;[getBugId] Error getting TB&quot;,ex);
+			pref.log(&quot;[getBugId] Error getting TB&quot;, ex);
 			return &quot;&quot;;
 		}
 	}
 
 	/**
-	 * Fetch a bug's mission for a given GUID or ID. If the guid String is longer
-	 * than 10 characters it is assumed to be a GUID, otherwise it is an ID.
-	 * @param guid the guid or id of the travelbug
+	 * Fetch a bug's mission for a given GUID or ID. If the guid String is
+	 * longer than 10 characters it is assumed to be a GUID, otherwise it is an
+	 * ID.
+	 * 
+	 * @param guid
+	 *            the guid or id of the travelbug
 	 * @return The mission
 	 */
 	public String getBugMissionByGuid(String guid) {
 		String bugDetails;
-		try{
-			//infB.setInfo(oldInfoBox+&quot;\nGetting bug: &quot;+bug);
-			if (guid.length()&gt;10)
-				bugDetails = fetch(p.getProp(&quot;getBugByGuid&quot;)+guid,false);
+		try {
+			// infB.setInfo(oldInfoBox+&quot;\nGetting bug: &quot;+bug);
+			if (guid.length() &gt; 10)
+				bugDetails = fetch(p.getProp(&quot;getBugByGuid&quot;) + guid, false);
 			else
-				bugDetails = fetch(p.getProp(&quot;getBugById&quot;)+guid,false);
-			pref.log(&quot;[getBugMissionByGuid] Fetched TB detailsById: &quot;+guid);
-		}catch(Exception ex){
-			pref.log(&quot;[getBugMissionByGuid] Could not fetch TB details &quot;+guid,ex);
-			bugDetails=&quot;&quot;;
+				bugDetails = fetch(p.getProp(&quot;getBugById&quot;) + guid, false);
+			pref.log(&quot;[getBugMissionByGuid] Fetched TB detailsById: &quot; + guid);
+		} catch (Exception ex) {
+			pref.log(&quot;[getBugMissionByGuid] Could not fetch TB details &quot; + guid, ex);
+			bugDetails = &quot;&quot;;
 		}
 		try {
-			if (bugDetails.indexOf(p.getProp(&quot;bugNotFound&quot;))&gt;=0) {
-				(new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;), MyLocale.getMsg(6020,&quot;Travelbug not found.&quot;), FormBase.OKB)).execute();
+			if (bugDetails.indexOf(p.getProp(&quot;bugNotFound&quot;)) &gt;= 0) {
+				(new MessageBox(MyLocale.getMsg(5500, &quot;Error&quot;),
+						MyLocale.getMsg(6020, &quot;Travelbug not found.&quot;),
+						FormBase.OKB)).execute();
 				return &quot;&quot;;
 			}
-			Extractor exDetails = new Extractor(bugDetails,p.getProp(&quot;bugDetailsStart&quot;),p.getProp(&quot;bugDetailsEnd&quot;),0,Extractor.EXCLUDESTARTEND);
+			Extractor exDetails = new Extractor(bugDetails, 
+					p.getProp(&quot;bugDetailsStart&quot;), 
+					p.getProp(&quot;bugDetailsEnd&quot;),
+					0, Extractor.EXCLUDESTARTEND);
 			return exDetails.findNext();
 		} catch (Exception ex) {
-			pref.log(&quot;[getBugMissionByGuid] Error getting TB &quot;+guid,ex);
+			pref.log(&quot;[getBugMissionByGuid] Error getting TB &quot; + guid, ex);
 			return &quot;&quot;;
 		}
 	}
 
 	/**
 	 * Fetch a bug's mission for a given tracking number
-	 * @param trackNr the tracking number of the travelbug
+	 * 
+	 * @param trackNr
+	 *            the tracking number of the travelbug
 	 * @return The mission
 	 */
 	public String getBugMissionByTrackNr(String trackNr) {
 		String bugDetails;
-		try{
-			bugDetails = fetch(p.getProp(&quot;getBugByTrackNr&quot;)+trackNr,false);
-			pref.log(&quot;[getBugMissionByTrackNr] Fetched bug detailsByTrackNr: &quot;+trackNr);
-		}catch(Exception ex){
-			pref.log(&quot;[getBugMissionByTrackNr] getBugByTrackNr &quot;+trackNr,ex);
-			bugDetails=&quot;&quot;;
+		try {
+			bugDetails = fetch(p.getProp(&quot;getBugByTrackNr&quot;) + trackNr, false);
+			pref.log(&quot;[getBugMissionByTrackNr] Fetched bug detailsByTrackNr: &quot; + trackNr);
+		} catch (Exception ex) {
+			pref.log(&quot;[getBugMissionByTrackNr] getBugByTrackNr &quot; + trackNr, ex);
+			bugDetails = &quot;&quot;;
 		}
 		try {
-			if (bugDetails.indexOf(p.getProp(&quot;bugNotFound&quot;))&gt;=0) {
-				pref.log(&quot;[getBugMissionByTrackNr], bugNotFound &quot;+trackNr,null);
-//				(new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;), MyLocale.getMsg(6020,&quot;Travelbug not found.&quot;), MessageBox.OKB)).execute();
+			if (bugDetails.indexOf(p.getProp(&quot;bugNotFound&quot;)) &gt;= 0) {
+				pref.log(&quot;[getBugMissionByTrackNr], bugNotFound &quot; + trackNr, null);
+				// (new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;),
+				// MyLocale.getMsg(6020,&quot;Travelbug not found.&quot;),
+				// MessageBox.OKB)).execute();
 				return &quot;&quot;;
 			}
-			Extractor exDetails = new Extractor(bugDetails,p.getProp(&quot;bugDetailsStart&quot;),p.getProp(&quot;bugDetailsEnd&quot;),0,Extractor.EXCLUDESTARTEND);
+			Extractor exDetails = new Extractor(bugDetails, 
+					p.getProp(&quot;bugDetailsStart&quot;), 
+					p.getProp(&quot;bugDetailsEnd&quot;),
+					0, Extractor.EXCLUDESTARTEND);
 			return exDetails.findNext();
 		} catch (Exception ex) {
-			pref.log(&quot;[getBugMissionByTrackNr] TB Details, bugNotFound &quot;+trackNr,ex);
+			pref.log(&quot;[getBugMissionByTrackNr] TB Details, bugNotFound &quot; + trackNr, ex);
 			return &quot;&quot;;
 		}
 	}
 
 	/**
 	 * Fetch a bug's mission and namefor a given tracking number
-	 * @param TB the travelbug
+	 * 
+	 * @param TB
+	 *            the travelbug
 	 * @return true if suceeded
 	 */
 	public boolean getBugMissionAndNameByTrackNr(Travelbug TB) {
 		String bugDetails;
 		String trackNr = TB.getTrackingNo();
-		try{
-			bugDetails = fetch(p.getProp(&quot;getBugByTrackNr&quot;)+trackNr,false);
-			pref.log(&quot;[getBugMissionAndNameByTrackNr] Fetched TB getBugByTrackNr: &quot;+trackNr);
-		}catch(Exception ex){
-			pref.log(&quot;[getBugMissionAndNameByTrackNr] Could not fetch bug details: &quot;+trackNr,ex);
-			bugDetails=&quot;&quot;;
+		try {
+			bugDetails = fetch(p.getProp(&quot;getBugByTrackNr&quot;) + trackNr, false);
+			pref.log(&quot;[getBugMissionAndNameByTrackNr] Fetched TB getBugByTrackNr: &quot; + trackNr);
+		} catch (Exception ex) {
+			pref.log(&quot;[getBugMissionAndNameByTrackNr] Could not fetch bug details: &quot; + trackNr, ex);
+			bugDetails = &quot;&quot;;
 		}
 		try {
-			if (bugDetails.indexOf(p.getProp(&quot;bugNotFound&quot;))&gt;=0) {
-				pref.log(&quot;[getBugMissionAndNameByTrackNr], bugNotFound: &quot;+trackNr,null);
-//				(new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;), MyLocale.getMsg(6020,&quot;Travelbug not found.&quot;), MessageBox.OKB)).execute();
+			if (bugDetails.indexOf(p.getProp(&quot;bugNotFound&quot;)) &gt;= 0) {
+				pref.log(&quot;[getBugMissionAndNameByTrackNr], bugNotFound: &quot; + trackNr, null);
+				// (new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;),
+				// MyLocale.getMsg(6020,&quot;Travelbug not found.&quot;),
+				// MessageBox.OKB)).execute();
 				return false;
 			}
-			Extractor exDetails = new Extractor(bugDetails,p.getProp(&quot;bugDetailsStart&quot;),p.getProp(&quot;bugDetailsEnd&quot;),0,Extractor.EXCLUDESTARTEND);
-			TB.setMission( exDetails.findNext() );
-			Extractor exName = new Extractor(bugDetails,p.getProp(&quot;bugNameStart&quot;),p.getProp(&quot;bugNameEnd&quot;),0,Extractor.EXCLUDESTARTEND);
-			TB.setName( exName.findNext() );
+			Extractor exDetails = new Extractor(bugDetails, 
+					p.getProp(&quot;bugDetailsStart&quot;), p.getProp(&quot;bugDetailsEnd&quot;), 0,
+					Extractor.EXCLUDESTARTEND);
+			TB.setMission(exDetails.findNext());
+			Extractor exName = new Extractor(bugDetails, 
+					p.getProp(&quot;bugNameStart&quot;), p.getProp(&quot;bugNameEnd&quot;), 0,
+					Extractor.EXCLUDESTARTEND);
+			TB.setName(exName.findNext());
 			return true;
 		} catch (Exception ex) {
-			pref.log(&quot;[getBugMissionAndNameByTrackNr] TB Details, bugNotFound: &quot;+trackNr,ex);
+			pref.log(&quot;[getBugMissionAndNameByTrackNr] TB Details, bugNotFound: &quot; + trackNr, ex);
 			return false;
 		}
 	}
@@ -2656,28 +3233,82 @@
 		SpiderProperties() {
 			super();
 			try {
-				load(new FileInputStream(FileBase.getProgramDirectory()+&quot;/spider.def&quot;));
+				load(new FileInputStream(FileBase.getProgramDirectory() + &quot;/spider.def&quot;));
 			} catch (Exception ex) {
-				pref.log(&quot;Failed to load spider.def from &quot;+FileBase.getProgramDirectory(),ex);
-				(new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;), MyLocale.getMsg(5504,&quot;Could not load 'spider.def'&quot;), FormBase.OKB)).execute();
+				pref.log(&quot;Failed to load spider.def from &quot; + FileBase.getProgramDirectory(), ex);
+				(new MessageBox(MyLocale.getMsg(5500, &quot;Error&quot;), 
+						MyLocale.getMsg(5504, &quot;Could not load 'spider.def'&quot;),
+						FormBase.OKB)).execute();
 			}
 		}
 
 		/**
 		 * Gets an entry in spider.def by its key (tag)
-		 * @param key The key which is attributed to a specific entry
+		 * 
+		 * @param key
+		 *            The key which is attributed to a specific entry
 		 * @return The value for the key
-		 * @throws Exception When a key is requested which doesn't exist
+		 * @throws Exception
+		 *             When a key is requested which doesn't exist
 		 */
 		public String getProp(String key) throws Exception {
-			String s=super.getProperty(key);
+			String s = super.getProperty(key);
 			if (s == null) {
-				(new MessageBox(MyLocale.getMsg(5500,&quot;Error&quot;), MyLocale.getMsg(5497,&quot;Error missing tag in spider.def&quot;) + &quot;: &quot;+key, FormBase.OKB)).execute();
-				pref.log(&quot;Missing tag in spider.def: &quot;+key);
-				throw new Exception(&quot;Missing tag in spider.def: &quot;+key);
+				(new MessageBox(MyLocale.getMsg(5500, &quot;Error&quot;),
+						MyLocale.getMsg(5497, &quot;Error missing tag in spider.def&quot;)+ &quot;: &quot; + key,
+						FormBase.OKB)).execute();
+				pref.log(&quot;Missing tag in spider.def: &quot; + key);
+				throw new Exception(&quot;Missing tag in spider.def: &quot; + key);
 			}
 			return s;
 		}
 
 	}
+
+	class RouteImporter extends MinML {
+
+		String _fileName;
+		Vector _routePoints;
+
+		RouteImporter(String fileName) {
+			_fileName = fileName;
+			_routePoints = new Vector();
+		}
+
+		Vector doIt() {
+			FileInputStream rFIS = null;
+			InputStreamReader r = null;
+			try {
+				rFIS = new ewe.io.FileInputStream(_fileName);
+				r = new ewe.io.InputStreamReader(rFIS);
+				if (r.read() != 65279) {
+					r.close();
+					rFIS.close();
+					rFIS = new ewe.io.FileInputStream(_fileName);
+					r = new ewe.io.InputStreamReader(rFIS);
+				}
+				parse(r);
+				r.close();
+				rFIS.close();
+			} catch (Exception e) {
+			}
+			return _routePoints;
+		}
+
+		public void startElement(String name, AttributeList atts) {
+			if (name.equals(&quot;trkpt&quot;)|| name.equals(&quot;rtept&quot;)) {
+				double lat = Common.parseDouble(atts.getValue(&quot;lat&quot;));
+				double lon = Common.parseDouble(atts.getValue(&quot;lon&quot;));
+				TrackPoint tp = new TrackPoint(lat, lon);
+				if (tp.isValid())
+					_routePoints.add(tp);
+				return;
+			}
+		}
+
+		public void endElement(String name) {
+
+		}
+
+	}
 }

Modified: trunk/src/CacheWolf/navi/MovingMap.java
===================================================================
--- trunk/src/CacheWolf/navi/MovingMap.java	2010-09-25 17:26:01 UTC (rev 2794)
+++ trunk/src/CacheWolf/navi/MovingMap.java	2010-09-27 10:02:03 UTC (rev 2795)
@@ -76,7 +76,6 @@
 import ewe.ui.MenuItem;
 import ewe.ui.MessageBox;
 import ewe.ui.PenEvent;
-import ewe.ui.ToolTip;
 import ewe.ui.WindowConstants;
 import ewe.ui.WindowEvent;
 import ewe.ui.mButton;

Modified: trunk/src/CacheWolf/navi/Navigate.java
===================================================================
--- trunk/src/CacheWolf/navi/Navigate.java	2010-09-25 17:26:01 UTC (rev 2794)
+++ trunk/src/CacheWolf/navi/Navigate.java	2010-09-27 10:02:03 UTC (rev 2795)
@@ -60,7 +60,7 @@
 	public boolean destinationIsCache = false;
 	public CWGPSPoint gpsPos = new CWGPSPoint();
 	public Track curTrack = null;
-	Color trackColor = new Color(255,0,0); // red
+	public Color trackColor = new Color(255,0,0); // red
 	public CWPoint skyOrientationDir = new CWPoint();
 	public int luminary = SkyOrientation.SUN;
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002786.html">[Cachewolf-svn] r2798 - trunk/src/CacheWolf/imp
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2783">[ date ]</a>
              <a href="thread.html#2783">[ thread ]</a>
              <a href="subject.html#2783">[ subject ]</a>
              <a href="author.html#2783">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/cachewolf-svn">More information about the Cachewolf-svn
mailing list</a><br>
</body></html>

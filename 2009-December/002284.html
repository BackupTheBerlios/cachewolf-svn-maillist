<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Cachewolf-svn] r2360 - in trunk: lib src/CacheWolf	src/CacheWolf/imp src/CacheWolf/navi
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/cachewolf-svn/2009-December/index.html" >
   <LINK REL="made" HREF="mailto:cachewolf-svn%40lists.berlios.de?Subject=Re%3A%20%5BCachewolf-svn%5D%20r2360%20-%20in%20trunk%3A%20lib%20src/CacheWolf%0A%09src/CacheWolf/imp%20src/CacheWolf/navi&In-Reply-To=%3C200912131534.nBDFYUDF011745%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002283.html">
   <LINK REL="Next"  HREF="002285.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Cachewolf-svn] r2360 - in trunk: lib src/CacheWolf	src/CacheWolf/imp src/CacheWolf/navi</H1>
    <B>araber95 at mail.berlios.de</B> 
    <A HREF="mailto:cachewolf-svn%40lists.berlios.de?Subject=Re%3A%20%5BCachewolf-svn%5D%20r2360%20-%20in%20trunk%3A%20lib%20src/CacheWolf%0A%09src/CacheWolf/imp%20src/CacheWolf/navi&In-Reply-To=%3C200912131534.nBDFYUDF011745%40sheep.berlios.de%3E"
       TITLE="[Cachewolf-svn] r2360 - in trunk: lib src/CacheWolf	src/CacheWolf/imp src/CacheWolf/navi">araber95 at mail.berlios.de
       </A><BR>
    <I>Sun Dec 13 16:34:30 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002283.html">[Cachewolf-svn] r2359 - in trunk: res_noewe/languages	src/CacheWolf/exp
</A></li>
        <LI>Next message: <A HREF="002285.html">[Cachewolf-svn] r2361 - in trunk/src/CacheWolf: . exp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2284">[ date ]</a>
              <a href="thread.html#2284">[ thread ]</a>
              <a href="subject.html#2284">[ subject ]</a>
              <a href="author.html#2284">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: araber95
Date: 2009-12-13 16:34:19 +0100 (Sun, 13 Dec 2009)
New Revision: 2360

Modified:
   trunk/lib/ewe.jar
   trunk/src/CacheWolf/Version.java
   trunk/src/CacheWolf/imp/SpiderGC.java
   trunk/src/CacheWolf/navi/MapLoader.java
   trunk/src/CacheWolf/navi/MapLoaderGui.java
   trunk/src/CacheWolf/navi/MapsList.java
Log:
doing some unnecessary things.

Modified: trunk/lib/ewe.jar
===================================================================
(Binary files differ)

Modified: trunk/src/CacheWolf/Version.java
===================================================================
--- trunk/src/CacheWolf/Version.java	2009-12-12 22:26:10 UTC (rev 2359)
+++ trunk/src/CacheWolf/Version.java	2009-12-13 15:34:19 UTC (rev 2360)
@@ -8,7 +8,7 @@
 
 /**
  * Class to hold and handle version information of the cachewolf project
- * language localisation string at at number 7000 
+ * language localisation string at at number 7000
  */
 
 public class Version {
@@ -18,12 +18,12 @@
 	static final int SVN_REVISION = Common.parseInt(VER_SVN.substring(VER_SVN.indexOf(&quot; &quot;)+1, VER_SVN.lastIndexOf(&quot; &quot;)));
 	static final int VERSION_TYPE = 3;
 	public static final String[] VERSION_TYPES = {
-		&quot;Release&quot;, 
+		&quot;Release&quot;,
 		&quot;ReleaseCandidate&quot;,
 		&quot;InDevelopmentStable&quot;,
 		&quot;InDevelopmentNewest&quot;
 	};
-	
+
 	/** only valid after calling checkForUpdates() */
 	static int[] updateavailabe = {0,0,0,0,0};
 	/** only valid after calling checkForUpdates() */
@@ -40,8 +40,8 @@
 	}
 
 	/**
-	 * Checks if newer versions of cachewolf are available 
-	 * @return [0] = recommended version type, [1]...[4]: 0: no update available, 1: newer version available, 2: version doesn't exists, 3: error 
+	 * Checks if newer versions of cachewolf are available
+	 * @return [0] = recommended version type, [1]...[4]: 0: no update available, 1: newer version available, 2: version doesn't exists, 3: error
 	 * @throws IOException
 	 */
 	public static void checkForUpdates() throws IOException {
@@ -96,20 +96,20 @@
 
 	private static int checkVersion(Properties curvers, String prefix, int t) {
 		try {
-			int curvmaj = Convert.toInt(curvers.getProperty(prefix + &quot;VersionMajor&quot;, &quot;0&quot;)); 
+			int curvmaj = Convert.toInt(curvers.getProperty(prefix + &quot;VersionMajor&quot;, &quot;0&quot;));
 			int curvmin = Convert.toInt(curvers.getProperty(prefix + &quot;VersionMinor&quot;, &quot;0&quot;));
 			String svnRString = curvers.getProperty(prefix + &quot;SvnRevision&quot;,&quot;0&quot;);
 			if (svnRString.startsWith(&quot;http&quot;)) {
 				String tmp;
 				Regex s;
-				int i = svnRString.indexOf(' '); 
+				int i = svnRString.indexOf(' ');
 				if (i &gt; 0) {
 					tmp = UrlFetcher.fetchString(svnRString.substring(0, i));
 					s = new Regex (svnRString.substring(i+1, svnRString.length())); // flyingfish works 3/2008 with (&quot;(?i)Revision[\\s]*[:=][\\s]*[\\\\r]*[\\\\n]*[\\s]*([0-9]*)&quot;);
-				} else { versionnumbers[t] = &quot;error: no RegEx&quot;; return 3; } 
+				} else { versionnumbers[t] = &quot;error: no RegEx&quot;; return 3; }
 				s.search(tmp);
 				if (!s.didMatch()) { versionnumbers[t] = &quot;error: RegEx didnot match&quot;; return 3; }
-				svnRString = s.stringMatched(1); 
+				svnRString = s.stringMatched(1);
 			}
 			versionnumbers[t] = curvmaj + &quot;.&quot; + curvmin + &quot;.&quot; + svnRString;
 			if (curvmaj &gt; VER_MAJOR) return 1;
@@ -119,7 +119,7 @@
 			if (Convert.toInt(svnRString) &gt; SVN_REVISION) return 1;
 			return 0;
 		} catch (IOException e) {
-			versionnumbers[t] = &quot;IO-error&quot;; 
+			versionnumbers[t] = &quot;IO-error&quot;;
 			return 3;
 		}
 	}

Modified: trunk/src/CacheWolf/imp/SpiderGC.java
===================================================================
--- trunk/src/CacheWolf/imp/SpiderGC.java	2009-12-12 22:26:10 UTC (rev 2359)
+++ trunk/src/CacheWolf/imp/SpiderGC.java	2009-12-13 15:34:19 UTC (rev 2360)
@@ -85,9 +85,6 @@
 	private static Preferences pref;
 	private Profile profile;
 	private static String viewstate = &quot;&quot;;
-	private static String viewstate1 = &quot;&quot;;
-	//FIXME Field is never read. Needed?
-	//private static String eventvalidation = &quot;&quot;;
 	private static String cookieID = &quot;&quot;;
 	private static String cookieSession = &quot;&quot;;
 	private static double distance = 0;
@@ -156,7 +153,7 @@
 		if (!localInfB.isClosed) { // If user has not aborted, we continue
 			Regex rexCookieID = new Regex(&quot;(?i)Set-Cookie: userid=(.*?);.*&quot;);
 			Regex rexViewstate = new Regex(&quot;id=\&quot;__VIEWSTATE\&quot; value=\&quot;(.*?)\&quot; /&gt;&quot;);
-			Regex rexViewstate1 = new Regex(&quot;id=\&quot;__VIEWSTATE1\&quot; value=\&quot;(.*?)\&quot; /&gt;&quot;);
+			// Regex rexViewstate1 = new Regex(&quot;id=\&quot;__VIEWSTATE1\&quot; value=\&quot;(.*?)\&quot; /&gt;&quot;);
 			Regex rexEventvalidation = new Regex(&quot;id=\&quot;__EVENTVALIDATION\&quot; value=\&quot;(.*?)\&quot; /&gt;&quot;);
 			Regex rexCookieSession = new Regex(&quot;(?i)Set-Cookie: ASP.NET_SessionId=(.*?);.*&quot;);
 			rexViewstate.search(start);
@@ -217,11 +214,12 @@
 			}
 			viewstate = rexViewstate.stringMatched(1);
 
+			/*
 			rexViewstate1.search(start);
 			if (!rexViewstate1.didMatch()) {
 				pref.log(&quot;[login]:Viewstate1 not found&quot;);
 			}
-			viewstate1 = rexViewstate1.stringMatched(1);
+			*/
 
 			rexCookieID.search(start);
 			if (!rexCookieID.didMatch()) {
@@ -353,7 +351,7 @@
 		}
 		String start = &quot;&quot;;
 		Regex rexViewstate = new Regex(&quot;id=\&quot;__VIEWSTATE\&quot; value=\&quot;(.*)\&quot; /&gt;&quot;);
-		Regex rexViewstate1 = new Regex(&quot;id=\&quot;__VIEWSTATE1\&quot; value=\&quot;(.*)\&quot; /&gt;&quot;);
+		// Regex rexViewstate1 = new Regex(&quot;id=\&quot;__VIEWSTATE1\&quot; value=\&quot;(.*)\&quot; /&gt;&quot;);
 		Regex rexEventvalidation = new Regex(&quot;id=\&quot;__EVENTVALIDATION\&quot; value=\&quot;(.*)\&quot; /&gt;&quot;);
 		String doc = &quot;&quot;;
 
@@ -498,15 +496,6 @@
 					pref.log(&quot;Viewstate not found&quot;);
 				}
 
-				rexViewstate1.search(start);
-				if(rexViewstate1.didMatch()){
-					viewstate1 = rexViewstate1.stringMatched(1);
-					//Vm.debug(&quot;ViewState: &quot; + viewstate);
-				} else {
-					viewstate1 = &quot;&quot;;
-					pref.log(&quot;Viewstate1 not found&quot;);
-				}
-
 				rexEventvalidation.search(start);
 				if(rexEventvalidation.didMatch()){
 					// eventvalidation = rexEventvalidation.stringMatched(1);
@@ -604,7 +593,7 @@
 					}
 					*/
 					strNextPage = &quot;ctl00$ContentBody$pgrTop$ctl08&quot;;
-					
+
 					doc = URL.encodeURL(&quot;__EVENTTARGET&quot;,false) +&quot;=&quot;+ URL.encodeURL(strNextPage,false)
 					    + &quot;&amp;&quot; + URL.encodeURL(&quot;__EVENTARGUMENT&quot;,false) +&quot;=&quot;+ URL.encodeURL(&quot;&quot;,false)
 //					    + &quot;&amp;&quot; + URL.encodeURL(&quot;__VIEWSTATEFIELDCOUNT&quot;,false) +&quot;=2&quot;
@@ -1575,14 +1564,15 @@
 				pref.log(&quot;[fetch]:No Cookie found&quot;);
 			conn.setRequestorProperty(&quot;Connection&quot;, &quot;close&quot;);
 			conn.documentIsEncoded = true;
-			if (pref.debug) pref.log(&quot;[fetch]:Connecting&quot;);
+			if (pref.debug) pref.log(&quot;[fetch]:Connecting &quot;+address);
 			Socket sock = conn.connect();
-			if (pref.debug) pref.log(&quot;[fetch]:Connect ok!&quot;);
-			ByteArray daten = conn.readData(sock);
-			if (pref.debug) pref.log(&quot;[fetch]:Read data ok&quot;);
+			if (pref.debug) pref.log(&quot;[fetch]:Connect ok! &quot;+address);
+			// ByteArray daten = conn.readData(sock);
 			JavaUtf8Codec codec = new JavaUtf8Codec();
-			c_data = codec.decodeText(daten.data, 0, daten.length, true, null);
+			// c_data = codec.decodeText(daten.data, 0, daten.length, true, null);
+			c_data = conn.readText(sock, codec);
 			sock.close();
+			if (pref.debug) pref.log(&quot;[fetch]:Read data ok &quot;+address);
 			return getResponseHeaders(conn)+ c_data.toString();
 		}catch(IOException ioex){
 			pref.log(&quot;IOException in fetch&quot;, ioex);
@@ -1608,17 +1598,18 @@
 			conn.setRequestorProperty(&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;);
 			if(cookieSession.length()&gt;0){
 				conn.setRequestorProperty(&quot;Cookie&quot;, &quot;ASP.NET_SessionId=&quot;+cookieSession+&quot;; userid=&quot;+cookieID);
-				pref.log(&quot;[fetch]:Cookie Zeug: &quot; + &quot;Cookie: ASP.NET_SessionId=&quot;+cookieSession +&quot;; userid=&quot;+cookieID);
+				pref.log(&quot;[fetch_post]:Cookie Zeug: &quot; + &quot;Cookie: ASP.NET_SessionId=&quot;+cookieSession +&quot;; userid=&quot;+cookieID);
 			} else {
-				pref.log(&quot;[fetch]:No Cookie found&quot;);
+				pref.log(&quot;[fetch_post]:No Cookie found&quot;);
 			}
 			conn.setRequestorProperty(&quot;Connection&quot;, &quot;close&quot;);
-			if (pref.debug) pref.log(&quot;[fetch]:Connecting&quot;);
+			if (pref.debug) pref.log(&quot;[fetch_post]:Connecting &quot;+address);
 			Socket sock = conn.connect();
-			if (pref.debug) pref.log(&quot;[fetch]:Connect ok!&quot;);
-			ByteArray daten = conn.readData(sock);
-			if (pref.debug) pref.log(&quot;[fetch]:Read data ok&quot;);
-			CharArray c_data = codec.decodeText(daten.data, 0, daten.length, true, null);
+			if (pref.debug) pref.log(&quot;[fetch_post]:Connect ok! &quot;+address);
+			// ByteArray daten = conn.readData(sock);
+			CharArray c_data = conn.readText(sock, codec);
+			if (pref.debug) pref.log(&quot;[fetch_post]:Read data ok &quot;+address);
+			// CharArray c_data = codec.decodeText(daten.data, 0, daten.length, true, null);
 			sock.close();
 			return getResponseHeaders(conn)+c_data.toString();
 		} catch (Exception e) {

Modified: trunk/src/CacheWolf/navi/MapLoader.java
===================================================================
--- trunk/src/CacheWolf/navi/MapLoader.java	2009-12-12 22:26:10 UTC (rev 2359)
+++ trunk/src/CacheWolf/navi/MapLoader.java	2009-12-13 15:34:19 UTC (rev 2360)
@@ -7,7 +7,6 @@
 import CacheWolf.InfoBox;
 import CacheWolf.MyLocale;
 import CacheWolf.STRreplace;
-import CacheWolf.utils.CWWrapper;
 import CacheWolf.utils.FileBugfix;
 import ewe.ui.*;
 import ewe.io.*;

Modified: trunk/src/CacheWolf/navi/MapLoaderGui.java
===================================================================
--- trunk/src/CacheWolf/navi/MapLoaderGui.java	2009-12-12 22:26:10 UTC (rev 2359)
+++ trunk/src/CacheWolf/navi/MapLoaderGui.java	2009-12-13 15:34:19 UTC (rev 2360)
@@ -7,7 +7,6 @@
 import CacheWolf.Global;
 import CacheWolf.InfoBox;
 import CacheWolf.MyLocale;
-import CacheWolf.NewProfileForm;
 import CacheWolf.Preferences;
 import ewe.io.FileBase;
 import ewe.sys.Convert;

Modified: trunk/src/CacheWolf/navi/MapsList.java
===================================================================
--- trunk/src/CacheWolf/navi/MapsList.java	2009-12-12 22:26:10 UTC (rev 2359)
+++ trunk/src/CacheWolf/navi/MapsList.java	2009-12-13 15:34:19 UTC (rev 2360)
@@ -10,7 +10,6 @@
 import ewe.io.FileBase;
 import ewe.io.IOException;
 import ewe.sys.Time;
-import ewe.sys.Vm;
 import ewe.ui.FormBase;
 import ewe.ui.MessageBox;
 import ewe.util.Comparer;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002283.html">[Cachewolf-svn] r2359 - in trunk: res_noewe/languages	src/CacheWolf/exp
</A></li>
	<LI>Next message: <A HREF="002285.html">[Cachewolf-svn] r2361 - in trunk/src/CacheWolf: . exp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2284">[ date ]</a>
              <a href="thread.html#2284">[ thread ]</a>
              <a href="subject.html#2284">[ subject ]</a>
              <a href="author.html#2284">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/cachewolf-svn">More information about the Cachewolf-svn
mailing list</a><br>
</body></html>

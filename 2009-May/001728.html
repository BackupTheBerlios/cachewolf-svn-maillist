<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Cachewolf-svn] r1810 - in experiments/greiol: . docs src/CacheWolf
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/cachewolf-svn/2009-May/index.html" >
   <LINK REL="made" HREF="mailto:cachewolf-svn%40lists.berlios.de?Subject=Re%3A%20%5BCachewolf-svn%5D%20r1810%20-%20in%20experiments/greiol%3A%20.%20docs%20src/CacheWolf&In-Reply-To=%3C200905152027.n4FKRCbK026707%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001727.html">
   <LINK REL="Next"  HREF="001729.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Cachewolf-svn] r1810 - in experiments/greiol: . docs src/CacheWolf</H1>
    <B>greiol at mail.berlios.de</B> 
    <A HREF="mailto:cachewolf-svn%40lists.berlios.de?Subject=Re%3A%20%5BCachewolf-svn%5D%20r1810%20-%20in%20experiments/greiol%3A%20.%20docs%20src/CacheWolf&In-Reply-To=%3C200905152027.n4FKRCbK026707%40sheep.berlios.de%3E"
       TITLE="[Cachewolf-svn] r1810 - in experiments/greiol: . docs src/CacheWolf">greiol at mail.berlios.de
       </A><BR>
    <I>Fri May 15 22:27:12 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001727.html">[Cachewolf-svn] r1809 - in experiments/greiol/src: CacheWolf exp
</A></li>
        <LI>Next message: <A HREF="001729.html">[Cachewolf-svn] r1811 - trunk/src/CacheWolf
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1728">[ date ]</a>
              <a href="thread.html#1728">[ thread ]</a>
              <a href="subject.html#1728">[ subject ]</a>
              <a href="author.html#1728">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: greiol
Date: 2009-05-15 22:27:09 +0200 (Fri, 15 May 2009)
New Revision: 1810

Modified:
   experiments/greiol/build.xml
   experiments/greiol/docs/
   experiments/greiol/src/CacheWolf/CacheHolder.java
   experiments/greiol/src/CacheWolf/CacheType.java
   experiments/greiol/src/CacheWolf/Version.java
Log:
added version1 import
templates are finally added to ant build

Modified: experiments/greiol/build.xml
===================================================================
--- experiments/greiol/build.xml	2009-05-15 18:47:04 UTC (rev 1809)
+++ experiments/greiol/build.xml	2009-05-15 20:27:09 UTC (rev 1810)
@@ -55,7 +55,7 @@
 	&lt;property name=&quot;assemble.dir&quot; value=&quot;assemble&quot;/&gt;
 
 	&lt;!-- lists of files to be packaged, this should become less confusing later on --&gt;
-	&lt;property name=&quot;template.files&quot; value=&quot;*/*.tpl&quot;/&gt;
+	&lt;property name=&quot;template.files&quot; value=&quot;*.tpl&quot;/&gt;
 	&lt;property name=&quot;icons.gui.files&quot; value=&quot;dnf.gif,bug.gif,red.png,yellow.png,blue.png&quot;/&gt;
 	&lt;property name=&quot;icons.log.files&quot; value=&quot;traffic_cone.gif,recommendedlog.gif,icon_smile.gif,icon_sad.gif,icon_rsvp.gif,icon_note.gif,icon_needsmaint.gif,icon_maint.gif,icon_enabled.gif,icon_disabled.gif,icon_camera.gif,icon_attended.gif,big_smile.gif,coord_update.gif,icon_greenlight.gif,icon_redlight.gif&quot;/&gt;
 	&lt;property name=&quot;icons.cache.files&quot; value=&quot;11.gif,8.gif,6.gif,5.gif,4.gif,3.gif,2.gif,1858.gif,13.gif,137.gif,12.gif&quot;/&gt;
@@ -239,54 +239,54 @@
 
 	&lt;target name=&quot;copyres&quot; description=&quot;copy images to the assembly directory&quot;&gt;
 		&lt;!-- copy templates --&gt;
-		&lt;copy todir=&quot;${assemble.dir}&quot;&gt;
+		&lt;copy todir=&quot;${assemble.dir}&quot; failonerror=&quot;true&quot; verbose=&quot;true&quot;&gt;
 			&lt;fileset dir=&quot;res_noewe&quot;&gt;
 				&lt;include name=&quot;${template.files}&quot;/&gt;
 			&lt;/fileset&gt;
 		&lt;/copy&gt;
 		&lt;!-- copy gui icons --&gt;
-		&lt;copy todir=&quot;${assemble.dir}&quot;&gt;
+		&lt;copy todir=&quot;${assemble.dir}&quot; failonerror=&quot;true&quot; verbose=&quot;true&quot;&gt;
 			&lt;fileset dir=&quot;res_noewe&quot; includes=&quot;${icons.gui.files}&quot;/&gt;
 		&lt;/copy&gt;
 		&lt;!-- copy browser icons --&gt;
-		&lt;copy todir=&quot;${assemble.dir}&quot;&gt;
+		&lt;copy todir=&quot;${assemble.dir}&quot; failonerror=&quot;true&quot; verbose=&quot;true&quot;&gt;
 			&lt;fileset dir=&quot;res_noewe&quot; includes=&quot;${icons.browser.files}&quot;/&gt;
 		&lt;/copy&gt;
 		&lt;!-- copy cache icons --&gt;
-		&lt;copy todir=&quot;${assemble.dir}&quot;&gt;
+		&lt;copy todir=&quot;${assemble.dir}&quot; failonerror=&quot;true&quot; verbose=&quot;true&quot;&gt;
 			&lt;fileset dir=&quot;res_noewe&quot; includes=&quot;${icons.cache.files}&quot;/&gt;
 		&lt;/copy&gt;
 		&lt;!-- copy log icons --&gt;
-		&lt;copy todir=&quot;${assemble.dir}&quot;&gt;
+		&lt;copy todir=&quot;${assemble.dir}&quot; failonerror=&quot;true&quot; verbose=&quot;true&quot;&gt;
 			&lt;fileset dir=&quot;res_noewe&quot; includes=&quot;${icons.log.files}&quot;/&gt;
 		&lt;/copy&gt;
 		&lt;!-- copy webmapservices --&gt;
-		&lt;copy todir=&quot;${assemble.dir}/webmapservices&quot;&gt;
+		&lt;copy todir=&quot;${assemble.dir}/webmapservices&quot; failonerror=&quot;true&quot; verbose=&quot;true&quot;&gt;
 			&lt;fileset dir=&quot;res_noewe/webmapservices&quot;/&gt;
 		&lt;/copy&gt;
 		&lt;!-- copy languages --&gt;
-		&lt;copy todir=&quot;${assemble.dir}/languages&quot;&gt;
+		&lt;copy todir=&quot;${assemble.dir}/languages&quot; failonerror=&quot;true&quot; verbose=&quot;true&quot;&gt;
 			&lt;fileset dir=&quot;res_noewe/languages&quot;/&gt;
 		&lt;/copy&gt;
 		&lt;!-- copy attributes --&gt;
-		&lt;copy todir=&quot;${assemble.dir}/attributes&quot;&gt;
+		&lt;copy todir=&quot;${assemble.dir}/attributes&quot; failonerror=&quot;true&quot; verbose=&quot;true&quot;&gt;
 			&lt;fileset dir=&quot;resources/attributes&quot;/&gt;
 		&lt;/copy&gt;
 		&lt;!-- copy addons --&gt;
-		&lt;copy todir=&quot;${assemble.dir}&quot;&gt;
+		&lt;copy todir=&quot;${assemble.dir}&quot; failonerror=&quot;true&quot; verbose=&quot;true&quot;&gt;
 			&lt;fileset dir=&quot;res_noewe&quot;&gt;
 				&lt;include name=&quot;Garmin*.zip&quot;/&gt;
 				&lt;include name=&quot;POI*.zip&quot;/&gt;
 			&lt;/fileset&gt;
 		&lt;/copy&gt;
 		&lt;!-- copy logo --&gt;
-		&lt;copy todir=&quot;${assemble.dir}&quot; file=&quot;resources/CacheWolf.ico&quot;/&gt;
+		&lt;copy todir=&quot;${assemble.dir}&quot; file=&quot;resources/CacheWolf.ico&quot; failonerror=&quot;true&quot; verbose=&quot;true&quot;/&gt;
 		&lt;!-- copy documentation --&gt;
-		&lt;copy todir=&quot;${assemble.dir}&quot;&gt;
+		&lt;copy todir=&quot;${assemble.dir}&quot; failonerror=&quot;true&quot; verbose=&quot;true&quot;&gt;
 			&lt;fileset dir=&quot;res_noewe&quot; includes=&quot;${doc.files}&quot;/&gt;
 		&lt;/copy&gt;
 		&lt;!-- spider.def --&gt;
-		&lt;copy todir=&quot;${assemble.dir}&quot; file=&quot;res_noewe/spider.def&quot;/&gt;
+		&lt;copy todir=&quot;${assemble.dir}&quot; file=&quot;res_noewe/spider.def&quot; failonerror=&quot;true&quot; verbose=&quot;true&quot;/&gt;
 	&lt;/target&gt;
 
 	&lt;target name=&quot;compilecabhelper&quot; description=&quot;helper classes for building cabs&quot; if=&quot;build.cab&quot;&gt;


Property changes on: experiments/greiol/docs
___________________________________________________________________
Name: svn:ignore
   + *


Modified: experiments/greiol/src/CacheWolf/CacheHolder.java
===================================================================
--- experiments/greiol/src/CacheWolf/CacheHolder.java	2009-05-15 18:47:04 UTC (rev 1809)
+++ experiments/greiol/src/CacheWolf/CacheHolder.java	2009-05-15 20:27:09 UTC (rev 1810)
@@ -198,7 +198,13 @@
 		        
 		        start = xmlString.indexOf('&quot;', end + 1);
 		        end = xmlString.indexOf('&quot;', start + 1);
-	            setType(CacheType.v1Converter((xmlString.substring(start + 1, end))));
+		        try {
+		        	setType(CacheType.v1Converter((xmlString.substring(start + 1, end))));
+		        } catch (IllegalArgumentException ex) {
+		        	setType(CacheType.CW_TYPE_ERROR);
+		        	Global.getPref().log(wayPoint, ex, true);
+		        	setIncomplete(true);
+		        }
 	            
 		        start = xmlString.indexOf('&quot;', end + 1);
 		        end = xmlString.indexOf('&quot;', start + 1);
@@ -215,9 +221,14 @@
 
 		        start = xmlString.indexOf('&quot;', end + 1);
 		        end = xmlString.indexOf('&quot;', start + 1);
+		        try {
+		        	setCacheSize(CacheSize.v1Converter(xmlString.substring(start + 1, end)));
+		        } catch (IllegalArgumentException ex) {
+		        	setCacheSize(CacheSize.CW_SIZE_ERROR);
+		        	Global.getPref().log(wayPoint, ex, true);
+		        	setIncomplete(true);
+		        }
 		        
-		        setCacheSize(CacheSize.v1Converter(xmlString.substring(start + 1, end)));
-		        
 		        start = xmlString.indexOf('&quot;', end + 1);
 		        end = xmlString.indexOf('&quot;', start + 1);
 		        setAvailable(xmlString.substring(start + 1, end).equals(&quot;true&quot;));
@@ -271,7 +282,7 @@
 
 		        start = xmlString.indexOf('&quot;', end + 1);
 		        end = xmlString.indexOf('&quot;', start + 1);
-		        setIncomplete(xmlString.substring(start + 1, end).equals(&quot;true&quot;));
+		        setIncomplete(xmlString.substring(start + 1, end).equals(&quot;true&quot;) || incomplete);
 
 		        start = xmlString.indexOf('&quot;', end + 1);
 		        end = xmlString.indexOf('&quot;', start + 1);

Modified: experiments/greiol/src/CacheWolf/CacheType.java
===================================================================
--- experiments/greiol/src/CacheWolf/CacheType.java	2009-05-15 18:47:04 UTC (rev 1809)
+++ experiments/greiol/src/CacheWolf/CacheType.java	2009-05-15 20:27:09 UTC (rev 1810)
@@ -227,6 +227,32 @@
 	 * @deprecated remove once v1 file version compatibility is abandoned
 	 */
 	public static final byte v1Converter(String type) throws IllegalArgumentException  {
+		if (type.equals(&quot;0&quot;)) return CW_TYPE_CUSTOM;
+		if (type.equals(&quot;2&quot;)) return CW_TYPE_TRADITIONAL;
+		if (type.equals(&quot;3&quot;)) return CW_TYPE_MULTI;
+		if (type.equals(&quot;4&quot;)) return CW_TYPE_VIRTUAL;
+		if (type.equals(&quot;5&quot;)) return CW_TYPE_LETTERBOX;
+		if (type.equals(&quot;6&quot;)) return CW_TYPE_EVENT;
+		if (type.equals(&quot;&quot;)) return CW_TYPE_QUIZ;
+		if (type.equals(&quot;8&quot;)) return CW_TYPE_UNKNOWN;
+		if (type.equals(&quot;&quot;)) return CW_TYPE_MATH;
+		if (type.equals(&quot;&quot;)) return CW_TYPE_MOVING;
+		if (type.equals(&quot;&quot;)) return CW_TYPE_DRIVE_IN;
+		if (type.equals(&quot;11&quot;)) return CW_TYPE_WEBCAM;
+		if (type.equals(&quot;12&quot;)) return CW_TYPE_LOCATIONLESS;
+		if (type.equals(&quot;&quot;)) return CW_TYPE_CITO;
+		if (type.equals(&quot;50&quot;)) return CW_TYPE_PARKING;
+		if (type.equals(&quot;51&quot;)) return CW_TYPE_STAGE;
+		if (type.equals(&quot;52&quot;)) return CW_TYPE_QUESTION;
+		if (type.equals(&quot;53&quot;)) return CW_TYPE_FINAL;
+		if (type.equals(&quot;54&quot;)) return CW_TYPE_TRAILHEAD;
+		if (type.equals(&quot;55&quot;)) return CW_TYPE_REFERENCE;
+		if (type.equals(&quot;453&quot;)) return CW_TYPE_MEGA_EVENT;
+		if (type.equals(&quot;1858&quot;)) return CW_TYPE_WHEREIGO;
+		if (type.equals(&quot;&quot;)) return CW_TYPE_APE;
+		if (type.equals(&quot;&quot;)) return CW_TYPE_MAZE;
+		if (type.equals(&quot;137&quot;)) return CW_TYPE_EARTH;
+		
 		throw new IllegalArgumentException(&quot;unmatched argument &quot;+type+&quot; in CacheSizeNew v1Converter()&quot;);
 	}
 

Modified: experiments/greiol/src/CacheWolf/Version.java
===================================================================
--- experiments/greiol/src/CacheWolf/Version.java	2009-05-15 18:47:04 UTC (rev 1809)
+++ experiments/greiol/src/CacheWolf/Version.java	2009-05-15 20:27:09 UTC (rev 1810)
@@ -15,7 +15,7 @@
 	static final int VER_MAJOR = 1;
 	static final int VER_MINOR = 0;
 	static final String VER_SVN =&quot;$LastChangedRevision$&quot;; // the number is automatically replaced by subversion to the latest versionnumer of this file (svn:keywords LastChangedRevision)
-	static final int SVN_REVISION = 20090512;
+	static final int SVN_REVISION = 20090515;
 	static final int VERSION_TYPE = 3;
 	public static final String[] VERSION_TYPES = {
 		&quot;Release&quot;, 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001727.html">[Cachewolf-svn] r1809 - in experiments/greiol/src: CacheWolf exp
</A></li>
	<LI>Next message: <A HREF="001729.html">[Cachewolf-svn] r1811 - trunk/src/CacheWolf
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1728">[ date ]</a>
              <a href="thread.html#1728">[ thread ]</a>
              <a href="subject.html#1728">[ subject ]</a>
              <a href="author.html#1728">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/cachewolf-svn">More information about the Cachewolf-svn
mailing list</a><br>
</body></html>

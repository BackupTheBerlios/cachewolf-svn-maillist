<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Cachewolf-svn] r2690 - in trunk: res_noewe/templates src/CacheWolf
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/cachewolf-svn/2010-July/index.html" >
   <LINK REL="made" HREF="mailto:cachewolf-svn%40lists.berlios.de?Subject=Re%3A%20%5BCachewolf-svn%5D%20r2690%20-%20in%20trunk%3A%20res_noewe/templates%20src/CacheWolf&In-Reply-To=%3C20100717163148.A5ED3480BC7%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002671.html">
   <LINK REL="Next"  HREF="002670.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Cachewolf-svn] r2690 - in trunk: res_noewe/templates src/CacheWolf</H1>
    <B>araber95 at mail.berlios.de</B> 
    <A HREF="mailto:cachewolf-svn%40lists.berlios.de?Subject=Re%3A%20%5BCachewolf-svn%5D%20r2690%20-%20in%20trunk%3A%20res_noewe/templates%20src/CacheWolf&In-Reply-To=%3C20100717163148.A5ED3480BC7%40sheep.berlios.de%3E"
       TITLE="[Cachewolf-svn] r2690 - in trunk: res_noewe/templates src/CacheWolf">araber95 at mail.berlios.de
       </A><BR>
    <I>Sat Jul 17 06:31:48 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002671.html">[Cachewolf-svn] r2689 - in trunk: res_noewe/templates src/CacheWolf
</A></li>
        <LI>Next message: <A HREF="002670.html">[Cachewolf-svn] r2688 - in trunk: res_noewe/languages	res_noewe/templates src/CacheWolf src/CacheWolf/exp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2672">[ date ]</a>
              <a href="thread.html#2672">[ thread ]</a>
              <a href="subject.html#2672">[ subject ]</a>
              <a href="author.html#2672">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: araber95
Date: 2010-07-17 18:31:48 +0200 (Sat, 17 Jul 2010)
New Revision: 2690

Modified:
   trunk/res_noewe/templates/Short documentation for the export via templates.htm
   trunk/src/CacheWolf/CacheHolder.java
   trunk/src/CacheWolf/CacheHolderDetail.java
   trunk/src/CacheWolf/DescriptionPanel.java
   trunk/src/CacheWolf/ImageInfo.java
   trunk/src/CacheWolf/ShowCacheInBrowser.java
Log:
adding image - information to the tpl-exporter

Modified: trunk/res_noewe/templates/Short documentation for the export via templates.htm
===================================================================
--- trunk/res_noewe/templates/Short documentation for the export via templates.htm	2010-07-17 14:44:51 UTC (rev 2689)
+++ trunk/res_noewe/templates/Short documentation for the export via templates.htm	2010-07-17 16:31:48 UTC (rev 2690)
@@ -445,11 +445,23 @@
 
 &lt;p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
 mso-outline-level:1'&gt;&lt;span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
-mso-ansi-language:EN-GB'&gt;Further documentation of template library:
-<A HREF="http://html-tmpl-java.sourceforge.net/&lt;/span">http://html-tmpl-java.sourceforge.net/&lt;/span</A>&gt;&lt;span lang=EN-GB style='mso-ansi-language:
-EN-GB'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
+mso-ansi-language:EN-GB'&gt;ALLIMGS&lt;span style='mso-tab-count:8'&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/span&gt;:
+the &lt;&lt;span class=SpellE&gt;tmpl_loop&lt;/span&gt; ALLIMGS&gt;&lt;br&gt;
+FILENAME&lt;span style='mso-tab-count:8'&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/span&gt;:
+the filename in the profile directory&lt;br&gt;
+TEXT&lt;span style='mso-tab-count:9'&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/span&gt;:
+caption&lt;br&gt;
+COMMENT&lt;span style='mso-tab-count:8'&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/span&gt;:
+description&lt;br&gt;
+URL&lt;span style='mso-tab-count:9'&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/span&gt;:
+original source of the image&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 
 &lt;p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+mso-outline-level:1'&gt;&lt;span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
+mso-ansi-language:EN-GB'&gt;Further documentation of template library: <A HREF="http://html-tmpl-java.sourceforge.net/&lt;/span">http://html-tmpl-java.sourceforge.net/&lt;/span</A>&gt;&lt;span
+lang=EN-GB style='mso-ansi-language:EN-GB'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
+
+&lt;p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
 mso-outline-level:1'&gt;&lt;u&gt;&lt;span lang=EN-GB style='font-size:10.0pt;font-family:
 Arial;mso-ansi-language:EN-GB'&gt;Example&lt;/span&gt;&lt;/u&gt;&lt;u&gt;&lt;span lang=EN-GB
 style='mso-ansi-language:EN-GB'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/u&gt;&lt;/p&gt;
@@ -477,8 +489,9 @@
 name=DIFFICULTY&gt;-&lt;&lt;span class=SpellE&gt;tmpl_var&lt;/span&gt; name=TERRAIN&gt;
 &lt;&lt;span class=SpellE&gt;tmpl_var&lt;/span&gt; name=NAME&gt;&quot;;&lt;&lt;span
 class=SpellE&gt;tmpl_var&lt;/span&gt; name=LAT&gt;;&lt;&lt;span class=SpellE&gt;tmpl_var&lt;/span&gt;
-name=LON&gt;;&quot;&lt;&lt;span class=SpellE&gt;tmpl_var&lt;/span&gt; name=TYPE&gt;&quot;;&quot;&lt;&lt;span
-class=SpellE&gt;tmpl_var&lt;/span&gt; name=SIZE&gt;&quot;;&quot;&lt;&lt;span class=SpellE&gt;tmpl_var&lt;/span&gt;
+name=LON&gt;;&quot;&lt;&lt;span class=SpellE&gt;tmpl_var&lt;/span&gt;
+name=TYPE&gt;&quot;;&quot;&lt;&lt;span class=SpellE&gt;tmpl_var&lt;/span&gt;
+name=SIZE&gt;&quot;;&quot;&lt;&lt;span class=SpellE&gt;tmpl_var&lt;/span&gt;
 name=WAYPOINT&gt;&quot;;&quot;&lt;&lt;span class=SpellE&gt;tmpl_var&lt;/span&gt;
 name=DATE&gt;&quot;;&quot;&lt;&lt;span class=SpellE&gt;tmpl_var&lt;/span&gt;
 name=URL&gt;&quot;&lt;&lt;span class=SpellE&gt;br&lt;/span&gt; /&gt;&lt;br&gt;
@@ -640,8 +653,8 @@
 style='mso-spacerun:yes'&gt;&#160; &lt;/span&gt;you&lt;/span&gt;&lt;/span&gt;&lt;span lang=EN-GB
 style='mso-ansi-language:EN-GB'&gt; &lt;/span&gt;&lt;span lang=EN-GB style='font-size:10.0pt;
 font-family:Arial;mso-ansi-language:EN-GB'&gt;place &lt;&lt;span class=SpellE&gt;tmpl_var&lt;/span&gt;&gt;s.&lt;b
-style='mso-bidi-font-weight:normal'&gt; The only loop used by the template exporter
-is '&lt;span class=SpellE&gt;cache_index&lt;/span&gt;', see example above. &lt;/b&gt;&lt;/span&gt;&lt;span
+style='mso-bidi-font-weight:normal'&gt; The only loop used by the template
+exporter is '&lt;span class=SpellE&gt;cache_index&lt;/span&gt;', see example above. &lt;/b&gt;&lt;/span&gt;&lt;span
 lang=EN-GB style='mso-ansi-language:EN-GB'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 
 &lt;p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
@@ -671,16 +684,16 @@
 for the last run of the loop, false otherwise&lt;br&gt;
 __ODD__&lt;span style='mso-tab-count:1'&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/span&gt;&lt;/span&gt;&lt;span lang=EN-GB
 style='mso-ansi-language:EN-GB'&gt;&nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;span lang=EN-GB
-style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'&gt;True for
-every other iteration of the loop - a loop starts at 1&lt;br&gt;
+style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'&gt;True for every
+other iteration of the loop - a loop starts at 1&lt;br&gt;
 __INNER__&lt;/span&gt;&lt;span lang=EN-GB style='mso-ansi-language:EN-GB'&gt;&lt;span
 style='mso-tab-count:1'&gt;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/span&gt;&nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;span
 lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'&gt;True
 if both __FIRST__ and __LAST__ are false&lt;br&gt;
 __COUNTER__&lt;span style='mso-tab-count:1'&gt; &lt;/span&gt;&lt;/span&gt;&lt;span lang=EN-GB
 style='mso-ansi-language:EN-GB'&gt;&nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;span lang=EN-GB
-style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'&gt;Which iteration
-is currently on. Starts at 1&lt;br style='mso-special-character:line-break'&gt;
+style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'&gt;Which
+iteration is currently on. Starts at 1&lt;br style='mso-special-character:line-break'&gt;
 &lt;![if !supportLineBreakNewLine]&gt;&lt;br style='mso-special-character:line-break'&gt;
 &lt;![endif]&gt;&lt;/span&gt;&lt;span lang=EN-GB style='mso-ansi-language:EN-GB'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 

Modified: trunk/src/CacheWolf/CacheHolder.java
===================================================================
--- trunk/src/CacheWolf/CacheHolder.java	2010-07-17 14:44:51 UTC (rev 2689)
+++ trunk/src/CacheWolf/CacheHolder.java	2010-07-17 16:31:48 UTC (rev 2690)
@@ -752,9 +752,17 @@
 					addis.put(&quot;LONGDESC&quot;,(ModTyp == 0) ? SafeXML.cleanGPX(ch.getCacheDetails(false).LongDescription) : ch.getCacheDetails(false).LongDescription);
 					addiVect.add(addis);
 				}
-				varParams.put(&quot;ADDIS&quot;,addiVect);
+				if (addiWpts.size()&gt;0) varParams.put(&quot;ADDIS&quot;,addiVect);
 			}
-
+			Vector imgVect=new Vector(det.images.size());
+			for (int i=0; i&lt;det.images.size(); i++) {
+				Hashtable imgs=new Hashtable();
+				imgs.put(&quot;FILENAME&quot;,det.images.get(i).getFilename());
+				imgs.put(&quot;TEXT&quot;,det.images.get(i).getTitle());
+				imgs.put(&quot;COMMENT&quot;,det.images.get(i).getComment());
+				imgs.put(&quot;URL&quot;,det.images.get(i).getURL());
+			}
+			if (det.images.size()&gt;0) varParams.put(&quot;ALLIMGS&quot;,imgVect);
 		}
 		return varParams;
 	}	

Modified: trunk/src/CacheWolf/CacheHolderDetail.java
===================================================================
--- trunk/src/CacheWolf/CacheHolderDetail.java	2010-07-17 14:44:51 UTC (rev 2689)
+++ trunk/src/CacheWolf/CacheHolderDetail.java	2010-07-17 16:31:48 UTC (rev 2690)
@@ -401,7 +401,7 @@
 				  int iis = images.size();
 				  for(int i = 0;i&lt;iis;i++){
 						stbuf = images.get(i).getTitle();
-						if (i&lt; iis &amp;&amp; images.get(i).getComment() != null)
+						if (i&lt; iis &amp;&amp; !images.get(i).getComment().equals(&quot;&quot;))
 							detfile.print(&quot;    &lt;IMGTEXT&gt;&quot;+stbuf+&quot;&lt;DESC&gt;&quot;+images.get(i).getComment()+&quot;&lt;/DESC&gt;&lt;/IMGTEXT&gt;\n&quot;);
 						else 
 							detfile.print(&quot;    &lt;IMGTEXT&gt;&quot;+stbuf+&quot;&lt;/IMGTEXT&gt;\n&quot;);
@@ -453,7 +453,7 @@
 		 */
 		public boolean hasImageInfo() {
 			for (int i=this.images.size()-1; i&gt;=0; i--)
-				if (this.images.get(i).getComment() != null) return true;
+				if (!this.images.get(i).getComment().equals(&quot;&quot;)) return true;
 			return false;
 		}
 

Modified: trunk/src/CacheWolf/DescriptionPanel.java
===================================================================
--- trunk/src/CacheWolf/DescriptionPanel.java	2010-07-17 14:44:51 UTC (rev 2689)
+++ trunk/src/CacheWolf/DescriptionPanel.java	2010-07-17 16:31:48 UTC (rev 2690)
@@ -139,7 +139,7 @@
 		for (int i=imagesShown; i&lt;chD.images.size(); i++) {
 			sb.append(chD.images.get(i).getTitle()).append(&quot;&lt;br&gt;&quot;);
 			// Show the additional text if there is one
-			if (chD.images.get(i).getComment()!=null) sb.append(&quot;&lt;font color='blue'&gt;&quot;).append(chD.images.get(i).getComment()).append(&quot;&lt;/font&gt;&quot;);
+			if (!chD.images.get(i).getComment().equals(&quot;&quot;)) sb.append(&quot;&lt;font color='blue'&gt;&quot;).append(chD.images.get(i).getComment()).append(&quot;&lt;/font&gt;&quot;);
 			// Only show the image if images are enabled
 			if (Global.getPref().descShowImg) sb.append(&quot;&lt;img src=\&quot;&quot;+chD.images.get(i).getFilename()+&quot;\&quot;&gt;&lt;br&gt;&quot;);
 			sb.append(&quot;&lt;br&gt;&lt;br&gt;&lt;hr&gt;&quot;);

Modified: trunk/src/CacheWolf/ImageInfo.java
===================================================================
--- trunk/src/CacheWolf/ImageInfo.java	2010-07-17 14:44:51 UTC (rev 2689)
+++ trunk/src/CacheWolf/ImageInfo.java	2010-07-17 16:31:48 UTC (rev 2690)
@@ -49,19 +49,15 @@
 	 * @return Comment
 	 */
 	public String getComment() {
+		if (comment == null) return &quot;&quot;;
     	return comment;
     }
 	/**
-	 * Sets the comment of the image. If an empty string is passed, the comment will be set to &lt;code&gt;
-	 * null&lt;/code&gt;.
+	 * Sets the comment of the image.
 	 * @param comment Comment
 	 */
 	public void setComment(String comment) {
-		if (comment != null &amp;&amp; comment.equals(&quot;&quot;)) {
-			this.comment = null;
-		} else {
 			this.comment = comment;
-		}
     }
 	public String getURL() {
 		if (URL == null) return &quot;&quot;;

Modified: trunk/src/CacheWolf/ShowCacheInBrowser.java
===================================================================
--- trunk/src/CacheWolf/ShowCacheInBrowser.java	2010-07-17 14:44:51 UTC (rev 2689)
+++ trunk/src/CacheWolf/ShowCacheInBrowser.java	2010-07-17 16:31:48 UTC (rev 2690)
@@ -95,10 +95,8 @@
 							imgs.put(&quot;IMAGE&quot;,&quot;&lt;img src=\&quot;<A HREF="file://">file://</A>&quot;+
 									   Global.getProfile().dataDir+chD.getCacheDetails(true).images.get(imageNo).getFilename()+&quot;\&quot; border=0&gt;&quot;);
 							imgs.put(&quot;IMAGETEXT&quot;,chD.getCacheDetails(true).images.get(imageNo).getTitle());
-							if (imageNo&lt;chD.getCacheDetails(true).images.size() &amp;&amp; chD.getCacheDetails(true).images.get(imageNo).getComment()!=null)
+							if (imageNo&lt;chD.getCacheDetails(true).images.size())
 								imgs.put(&quot;IMAGECOMMENT&quot;,chD.getCacheDetails(true).images.get(imageNo).getComment());
-							else
-								imgs.put(&quot;IMAGECOMMENT&quot;,&quot;&quot;);
 							imgs.put(&quot;I&quot;,&quot;'img&quot;+new Integer(imageNo).toString()+&quot;'&quot;);
 							imageVect.add(imgs);
 						}


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002671.html">[Cachewolf-svn] r2689 - in trunk: res_noewe/templates src/CacheWolf
</A></li>
	<LI>Next message: <A HREF="002670.html">[Cachewolf-svn] r2688 - in trunk: res_noewe/languages	res_noewe/templates src/CacheWolf src/CacheWolf/exp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2672">[ date ]</a>
              <a href="thread.html#2672">[ thread ]</a>
              <a href="subject.html#2672">[ subject ]</a>
              <a href="author.html#2672">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/cachewolf-svn">More information about the Cachewolf-svn
mailing list</a><br>
</body></html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Cachewolf-svn] r2692 - in trunk: res_noewe/templates src/CacheWolf	src/CacheWolf/exp
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/cachewolf-svn/2010-July/index.html" >
   <LINK REL="made" HREF="mailto:cachewolf-svn%40lists.berlios.de?Subject=Re%3A%20%5BCachewolf-svn%5D%20r2692%20-%20in%20trunk%3A%20res_noewe/templates%20src/CacheWolf%0A%09src/CacheWolf/exp&In-Reply-To=%3C20100718220855.CB8C2480E8E%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002678.html">
   <LINK REL="Next"  HREF="002679.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Cachewolf-svn] r2692 - in trunk: res_noewe/templates src/CacheWolf	src/CacheWolf/exp</H1>
    <B>araber95 at mail.berlios.de</B> 
    <A HREF="mailto:cachewolf-svn%40lists.berlios.de?Subject=Re%3A%20%5BCachewolf-svn%5D%20r2692%20-%20in%20trunk%3A%20res_noewe/templates%20src/CacheWolf%0A%09src/CacheWolf/exp&In-Reply-To=%3C20100718220855.CB8C2480E8E%40sheep.berlios.de%3E"
       TITLE="[Cachewolf-svn] r2692 - in trunk: res_noewe/templates src/CacheWolf	src/CacheWolf/exp">araber95 at mail.berlios.de
       </A><BR>
    <I>Mon Jul 19 12:08:55 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002678.html">[Cachewolf-svn] [Bug #17338] Template-Exporter wahlweise mit xml /	html / textAusgabe
</A></li>
        <LI>Next message: <A HREF="002679.html">[Cachewolf-svn] r2693 - trunk/res_noewe/webmapservices
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2677">[ date ]</a>
              <a href="thread.html#2677">[ thread ]</a>
              <a href="subject.html#2677">[ subject ]</a>
              <a href="author.html#2677">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: araber95
Date: 2010-07-19 00:08:55 +0200 (Mon, 19 Jul 2010)
New Revision: 2692

Modified:
   trunk/res_noewe/templates/Short documentation for the export via templates.htm
   trunk/src/CacheWolf/MainMenu.java
   trunk/src/CacheWolf/exp/TPLExporter.java
Log:
now you can nearly do everything with the tpl - exporter : two new params are introduced singleFile and formatModifier. explanation see doc

Modified: trunk/res_noewe/templates/Short documentation for the export via templates.htm
===================================================================
--- trunk/res_noewe/templates/Short documentation for the export via templates.htm	2010-07-18 09:35:50 UTC (rev 2691)
+++ trunk/res_noewe/templates/Short documentation for the export via templates.htm	2010-07-18 22:08:55 UTC (rev 2692)
@@ -208,8 +208,15 @@
 Filename or Extension&lt;br&gt;
 &lt;&lt;span class=SpellE&gt;tmpl_par&lt;/span&gt; name=&quot;&lt;span class=SpellE&gt;NrLogs&lt;/span&gt;
 &quot; value=&quot;-1&quot;&gt;&lt;span style='mso-tab-count:4'&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/span&gt;&lt;span
-class=SpellE&gt;Anzahl&lt;/span&gt; logs (-1 = alle)&lt;/span&gt;&lt;span lang=EN-GB
-style='mso-ansi-language:EN-GB'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
+class=SpellE&gt;Anzahl&lt;/span&gt; logs (-1 = alle)&lt;br&gt;
+&lt;&lt;span class=SpellE&gt;tmpl_par&lt;/span&gt; name=&quot;&lt;span class=SpellE&gt;singleFile&lt;/span&gt;&quot;
+value=&quot;yes&quot;&gt;&lt;span style='mso-tab-count:3'&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/span&gt;one
+&lt;span class=SpellE&gt;outputfile&lt;/span&gt; value=&#148;yes&#148; or one file per cache value=&#148;no&#148;
+(use a dummy / not existing name for Out par)&lt;br&gt;
+&lt;&lt;span class=SpellE&gt;tmpl_par&lt;/span&gt; name=&quot;&lt;span class=SpellE&gt;formatModifier&lt;/span&gt;&quot;
+value=&quot;0&quot;&gt;&lt;span style='mso-tab-count:3'&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/span&gt;0
+is xml as &lt;span class=SpellE&gt;gpx&lt;/span&gt; generation before, 1 is html like &lt;span
+class=SpellE&gt;showCacheInBrowser&lt;/span&gt;, 2 is html like html-exporter&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 
 &lt;p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
 mso-outline-level:1'&gt;&lt;u&gt;&lt;span lang=EN-GB style='font-size:10.0pt;font-family:
@@ -458,8 +465,9 @@
 
 &lt;p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
 mso-outline-level:1'&gt;&lt;span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
-mso-ansi-language:EN-GB'&gt;Further documentation of template library: <A HREF="http://html-tmpl-java.sourceforge.net/&lt;/span">http://html-tmpl-java.sourceforge.net/&lt;/span</A>&gt;&lt;span
-lang=EN-GB style='mso-ansi-language:EN-GB'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
+mso-ansi-language:EN-GB'&gt;Further documentation of template library:
+<A HREF="http://html-tmpl-java.sourceforge.net/&lt;/span">http://html-tmpl-java.sourceforge.net/&lt;/span</A>&gt;&lt;span lang=EN-GB style='mso-ansi-language:
+EN-GB'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
 
 &lt;p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
 mso-outline-level:1'&gt;&lt;u&gt;&lt;span lang=EN-GB style='font-size:10.0pt;font-family:
@@ -614,9 +622,9 @@
 the if block allows us to display some output if a condition is true&lt;span
 class=GramE&gt;,&lt;span style='mso-spacerun:yes'&gt;&#160; &lt;/span&gt;we&lt;/span&gt;&lt;/span&gt;&lt;span
 lang=EN-GB style='mso-ansi-language:EN-GB'&gt; &lt;/span&gt;&lt;span lang=EN-GB
-style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'&gt;may also
-need to display content if the condition is false. This can be done by using
-the optional else&lt;/span&gt;&lt;span lang=EN-GB style='mso-ansi-language:EN-GB'&gt; &lt;/span&gt;&lt;span
+style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'&gt;may also need
+to display content if the condition is false. This can be done by using the
+optional else&lt;/span&gt;&lt;span lang=EN-GB style='mso-ansi-language:EN-GB'&gt; &lt;/span&gt;&lt;span
 lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'&gt;branch
 of &lt;span class=GramE&gt;the if&lt;/span&gt; block.&lt;/span&gt;&lt;span lang=EN-GB
 style='mso-ansi-language:EN-GB'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;
@@ -684,8 +692,8 @@
 for the last run of the loop, false otherwise&lt;br&gt;
 __ODD__&lt;span style='mso-tab-count:1'&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/span&gt;&lt;/span&gt;&lt;span lang=EN-GB
 style='mso-ansi-language:EN-GB'&gt;&nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;span lang=EN-GB
-style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'&gt;True for every
-other iteration of the loop - a loop starts at 1&lt;br&gt;
+style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'&gt;True for
+every other iteration of the loop - a loop starts at 1&lt;br&gt;
 __INNER__&lt;/span&gt;&lt;span lang=EN-GB style='mso-ansi-language:EN-GB'&gt;&lt;span
 style='mso-tab-count:1'&gt;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/span&gt;&nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;span
 lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'&gt;True

Modified: trunk/src/CacheWolf/MainMenu.java
===================================================================
--- trunk/src/CacheWolf/MainMenu.java	2010-07-18 09:35:50 UTC (rev 2691)
+++ trunk/src/CacheWolf/MainMenu.java	2010-07-18 22:08:55 UTC (rev 2692)
@@ -465,7 +465,7 @@
 				fc.addMask(&quot;*.tpl&quot;);
 				fc.setTitle(MyLocale.getMsg(910,&quot;Select Template file&quot;));
 				if(fc.execute() != FormBase.IDCANCEL){
-					TPLExporter tpl = new TPLExporter( pref,profile, fc.getChosenFile().toString());
+					TPLExporter tpl = new TPLExporter( pref, profile, fc.getChosenFile().toString());
 					tpl.doIt();
 				}
 			}

Modified: trunk/src/CacheWolf/exp/TPLExporter.java
===================================================================
--- trunk/src/CacheWolf/exp/TPLExporter.java	2010-07-18 09:35:50 UTC (rev 2691)
+++ trunk/src/CacheWolf/exp/TPLExporter.java	2010-07-18 22:08:55 UTC (rev 2692)
@@ -37,6 +37,7 @@
 import ewe.sys.*;
 import ewe.ui.*;
 import ewe.util.*;
+
 import com.stevesoft.ewe_pat.*;
 
 /**
@@ -53,6 +54,8 @@
 	int shortNameLength=30;
 	int shortWaypointLength=3;
 	int noOfLogs=-1; // means all
+	boolean single = true;
+	int formatModifier = 0;
 	String out=&quot;*.gpx&quot;;
 
 
@@ -124,6 +127,12 @@
 			if (param.equals(&quot;NrLogs&quot;)) {
 				noOfLogs = Integer.valueOf(value).intValue();
 			}
+			if (param.equals(&quot;singleFile&quot;)) {
+				single = value.equals(&quot;yes&quot;) ? true : false ;
+			}
+			if (param.equals(&quot;formatModifier&quot;)) {
+				formatModifier = Integer.valueOf(value).intValue();
+			}
 			if (param.equals(&quot;Out&quot;)) {
 				out = value;
 			}
@@ -197,7 +206,17 @@
 				h.changed();
 				if(ch.isVisible() &amp;&amp; ch.pos.isValid()){
 					try {
-						cache_index.add(ch.toHashtable(dec, rex, myFilter.shortWaypointLength, myFilter.shortNameLength, myFilter.noOfLogs, myFilter.codec, gm, false, 0));
+						Hashtable varParams=ch.toHashtable(dec, rex, myFilter.shortWaypointLength, myFilter.shortNameLength, myFilter.noOfLogs, myFilter.codec, gm, false, myFilter.formatModifier);
+						if (myFilter.single) {
+							cache_index.add(varParams);
+						}
+						else {
+							tpl.setParams(varParams);
+							String ext = (myFilter.out.substring(myFilter.out.lastIndexOf(&quot;.&quot;)).toLowerCase()+&quot;    &quot;).trim();
+							PrintWriter pagefile = new PrintWriter(new BufferedWriter(new FileWriter(saveTo.getPath() + ch.getWayPoint() + ext)));
+							pagefile.print(tpl.output());
+							pagefile.close();							
+						}
 					}catch(Exception e){
 						Vm.debug(&quot;Problem getting Parameter, Cache: &quot; + ch.getWayPoint());
 						e.printStackTrace();
@@ -205,14 +224,16 @@
 					}
 				}
 			}
-			tpl.setParam(&quot;cache_index&quot;, cache_index);
-			PrintWriter detfile;
-			FileWriter fw = new FileWriter(saveTo);
-			fw.codec = myFilter.codec;
-			detfile = new PrintWriter(new BufferedWriter(fw));
-			tpl.printTo(detfile);
-			//detfile.print(tpl.output());
-			detfile.close();
+			if (myFilter.single) {
+				tpl.setParam(&quot;cache_index&quot;, cache_index);
+				PrintWriter detfile;
+				FileWriter fw = new FileWriter(saveTo);
+				fw.codec = myFilter.codec;
+				detfile = new PrintWriter(new BufferedWriter(fw));
+				tpl.printTo(detfile);
+				//detfile.print(tpl.output());
+				detfile.close();
+			}
 		} catch (Exception e) {
 			e.printStackTrace();
 			Global.getPref().log(&quot;Exception in TplExporter&quot;, e, true);


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002678.html">[Cachewolf-svn] [Bug #17338] Template-Exporter wahlweise mit xml /	html / textAusgabe
</A></li>
	<LI>Next message: <A HREF="002679.html">[Cachewolf-svn] r2693 - trunk/res_noewe/webmapservices
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2677">[ date ]</a>
              <a href="thread.html#2677">[ thread ]</a>
              <a href="subject.html#2677">[ subject ]</a>
              <a href="author.html#2677">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/cachewolf-svn">More information about the Cachewolf-svn
mailing list</a><br>
</body></html>

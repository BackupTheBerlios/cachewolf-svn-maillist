<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Cachewolf-svn] r1360 - in trunk: res_noewe/languages	res_noewe/webmapservices src/CacheWolf
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/cachewolf-svn/2008-April/index.html" >
   <LINK REL="made" HREF="mailto:cachewolf-svn%40lists.berlios.de?Subject=Re%3A%20%5BCachewolf-svn%5D%20r1360%20-%20in%20trunk%3A%20res_noewe/languages%0A%09res_noewe/webmapservices%20src/CacheWolf&In-Reply-To=%3C200804120729.m3C7T73P015668%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001253.html">
   <LINK REL="Next"  HREF="001255.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Cachewolf-svn] r1360 - in trunk: res_noewe/languages	res_noewe/webmapservices src/CacheWolf</H1>
    <B>mik77 at mail.berlios.de</B> 
    <A HREF="mailto:cachewolf-svn%40lists.berlios.de?Subject=Re%3A%20%5BCachewolf-svn%5D%20r1360%20-%20in%20trunk%3A%20res_noewe/languages%0A%09res_noewe/webmapservices%20src/CacheWolf&In-Reply-To=%3C200804120729.m3C7T73P015668%40sheep.berlios.de%3E"
       TITLE="[Cachewolf-svn] r1360 - in trunk: res_noewe/languages	res_noewe/webmapservices src/CacheWolf">mik77 at mail.berlios.de
       </A><BR>
    <I>Sat Apr 12 09:29:07 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001253.html">[Cachewolf-svn] r1359 - in trunk/src/CacheWolf: . navi
</A></li>
        <LI>Next message: <A HREF="001255.html">[Cachewolf-svn] r1361 - trunk/res_noewe/languages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1254">[ date ]</a>
              <a href="thread.html#1254">[ thread ]</a>
              <a href="subject.html#1254">[ subject ]</a>
              <a href="author.html#1254">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mik77
Date: 2008-04-12 09:29:03 +0200 (Sat, 12 Apr 2008)
New Revision: 1360

Modified:
   trunk/res_noewe/languages/DE.cfg
   trunk/res_noewe/languages/EN.cfg
   trunk/res_noewe/webmapservices/de-rlp_photo.wms
   trunk/res_noewe/webmapservices/de-rlp_topo_50.wms
   trunk/src/CacheWolf/CoordsScreen.java
   trunk/src/CacheWolf/DetailsPanel.java
   trunk/src/CacheWolf/Parser.java
Log:
- Add Clear Button to CoordsScreen if invalid coordinates are allowed
- URL in RLB WMS corrected
- Create new additional waypoints if needed in skeleton command


Modified: trunk/res_noewe/languages/DE.cfg
===================================================================
--- trunk/res_noewe/languages/DE.cfg	2008-04-12 07:16:41 UTC (rev 1359)
+++ trunk/res_noewe/languages/DE.cfg	2008-04-12 07:29:03 UTC (rev 1360)
@@ -336,6 +336,7 @@
 		1410=Meilen
 		1411=Bitte g%fcltige Koordinaten eingeben.
 		1412=Koordinaten ung%fcltig. Trotzdem %fcbernehmen?
+		1413=L%f6schen
 		1500=Ziel:
 		1501=Aktuell
 		1502=Grad

Modified: trunk/res_noewe/languages/EN.cfg
===================================================================
--- trunk/res_noewe/languages/EN.cfg	2008-04-12 07:16:41 UTC (rev 1359)
+++ trunk/res_noewe/languages/EN.cfg	2008-04-12 07:29:03 UTC (rev 1360)
@@ -337,6 +337,7 @@
 		1410=miles
 		1411=Please enter valid coordinates
 		1412=Coordinates invalid. Apply anyway?
+		1413=Clear
 		1500=DST:
 		1501=Current
 		1502=deg

Modified: trunk/res_noewe/webmapservices/de-rlp_photo.wms
===================================================================
--- trunk/res_noewe/webmapservices/de-rlp_photo.wms	2008-04-12 07:16:41 UTC (rev 1359)
+++ trunk/res_noewe/webmapservices/de-rlp_photo.wms	2008-04-12 07:29:03 UTC (rev 1360)
@@ -1,9 +1,9 @@
 # please refer to readme_wms.txt for an explantion of this file format
 TakenFromUrl:	<A HREF="http://deutschlandviewer.bayern.de/deutschlandviewer/D_Viewer_Hilfe/Hilfe_D_Viewer.htm#Geodaten">http://deutschlandviewer.bayern.de/deutschlandviewer/D_Viewer_Hilfe/Hilfe_D_Viewer.htm#Geodaten</A>
-GetCapabilitiesUrl:	<A HREF="http://geodaten.service24.rlp.de/cgi/wms.cgi?REQUEST=GetCapabilities&amp;VERSION=1.1.0&amp;SERVICE=WMS">http://geodaten.service24.rlp.de/cgi/wms.cgi?REQUEST=GetCapabilities&amp;VERSION=1.1.0&amp;SERVICE=WMS</A>
+GetCapabilitiesUrl:	<A HREF="http://geodaten.service24.rlp.de/cgi-bin/wms.cgi?REQUEST=GetCapabilities&amp;VERSION=1.1.0&amp;SERVICE=WMS">http://geodaten.service24.rlp.de/cgi-bin/wms.cgi?REQUEST=GetCapabilities&amp;VERSION=1.1.0&amp;SERVICE=WMS</A>
 Name:	de.rlp Luftbild
 MapType:	photo
-MainUrl:	<A HREF="http://geodaten.service24.rlp.de/cgi/wms.cgi?">http://geodaten.service24.rlp.de/cgi/wms.cgi?</A>
+MainUrl:	<A HREF="http://geodaten.service24.rlp.de/cgi-bin/wms.cgi?">http://geodaten.service24.rlp.de/cgi-bin/wms.cgi?</A>
 ServiceTypeUrlPart:	SERVICE=WMS 
 VersionUrlPart:	VERSION=1.1.1 
 CoordinateReferenceSystemCacheWolf:   31466 31467

Modified: trunk/res_noewe/webmapservices/de-rlp_topo_50.wms
===================================================================
--- trunk/res_noewe/webmapservices/de-rlp_topo_50.wms	2008-04-12 07:16:41 UTC (rev 1359)
+++ trunk/res_noewe/webmapservices/de-rlp_topo_50.wms	2008-04-12 07:29:03 UTC (rev 1360)
@@ -1,9 +1,9 @@
 # please refer to readme_wms.txt for an explantion of this file format
 TakenFromUrl:	<A HREF="http://deutschlandviewer.bayern.de/deutschlandviewer/D_Viewer_Hilfe/Hilfe_D_Viewer.htm#Geodaten">http://deutschlandviewer.bayern.de/deutschlandviewer/D_Viewer_Hilfe/Hilfe_D_Viewer.htm#Geodaten</A>
-GetCapabilitiesUrl:	<A HREF="http://geodaten.service24.rlp.de/cgi/wms.cgi?REQUEST=GetCapabilities&amp;VERSION=1.1.0&amp;SERVICE=WMS">http://geodaten.service24.rlp.de/cgi/wms.cgi?REQUEST=GetCapabilities&amp;VERSION=1.1.0&amp;SERVICE=WMS</A>
+GetCapabilitiesUrl:	<A HREF="http://geodaten.service24.rlp.de/cgi-bin/wms.cgi?REQUEST=GetCapabilities&amp;VERSION=1.1.0&amp;SERVICE=WMS">http://geodaten.service24.rlp.de/cgi-bin/wms.cgi?REQUEST=GetCapabilities&amp;VERSION=1.1.0&amp;SERVICE=WMS</A>
 Name:	de.rlp Topo 50
 MapType:	topo
-MainUrl:	<A HREF="http://geodaten.service24.rlp.de/cgi/wms.cgi?">http://geodaten.service24.rlp.de/cgi/wms.cgi?</A>
+MainUrl:	<A HREF="http://geodaten.service24.rlp.de/cgi-bin/wms.cgi?">http://geodaten.service24.rlp.de/cgi-bin/wms.cgi?</A>
 ServiceTypeUrlPart:	SERVICE=WMS 
 VersionUrlPart:	VERSION=1.1.1 
 CoordinateReferenceSystemCacheWolf:   31466 31467

Modified: trunk/src/CacheWolf/CoordsScreen.java
===================================================================
--- trunk/src/CacheWolf/CoordsScreen.java	2008-04-12 07:16:41 UTC (rev 1359)
+++ trunk/src/CacheWolf/CoordsScreen.java	2008-04-12 07:29:03 UTC (rev 1360)
@@ -19,17 +19,29 @@
 	mInput inpNSDeg, inpNSm, inpNSs, inpEWDeg, inpEWm, inpEWs;
 	mInput inpUTMZone, inpUTMNorthing, inpUTMEasting;
 	mInput inpText;
-	mButton btnCancel, btnApply, btnCopy, btnPaste, btnParse, btnGps;
+	mButton btnCancel, btnApply, btnCopy, btnPaste, btnParse, btnGps, btnClear;
 	CWPoint coordInp = new CWPoint();
 	CellPanel topLinePanel = new CellPanel();
 	CellPanel mainPanel = new CellPanel();
 	int exitKeys[]={75009};
 	int currFormat;
 	
-	boolean allowInvalid = false;
+	private boolean allowInvalid = false;
 	
+	public CoordsScreen(boolean allowInvalidCoords)
+	{
+		allowInvalid = allowInvalidCoords;
+		
+		InitCoordsScreen();		
+	}
+	
 	public CoordsScreen()
 	{
+		InitCoordsScreen();		
+	}
+	
+	private void InitCoordsScreen()
+	{
 		this.setTitle(&quot;&quot;);
 		//Radiobuttons for format
 		topLinePanel.addNext(chkDD =new mCheckBox(&quot;d.d&#176;&quot;),CellConstants.DONTSTRETCH, CellConstants.WEST);
@@ -60,10 +72,17 @@
 		mainPanel.addLast(inpEWs = new mInput(),CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.WEST));
 
 		// Input for UTM
-		mainPanel.addNext(new mLabel(MyLocale.getMsg(1400,&quot;Zone&quot;)),CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.WEST));
-		mainPanel.addNext(new mLabel(MyLocale.getMsg(1402,&quot;Easting&quot;)),CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.WEST));
-		mainPanel.addLast(new mLabel(MyLocale.getMsg(1401,&quot;Northing&quot;)),CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.WEST));
-
+		if (allowInvalid){
+			mainPanel.addNext(new mLabel(MyLocale.getMsg(1400,&quot;Zone&quot;)),CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.SOUTHWEST));
+			mainPanel.addNext(new mLabel(MyLocale.getMsg(1402,&quot;Easting&quot;)),CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.SOUTHWEST));
+			mainPanel.addNext(new mLabel(MyLocale.getMsg(1401,&quot;Northing&quot;)),CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.SOUTHWEST));
+			mainPanel.addLast(btnClear = new mButton(MyLocale.getMsg(1413,&quot;Clear&quot;)),CellConstants.HSTRETCH, (CellConstants.HFILL));
+		} else {
+			mainPanel.addNext(new mLabel(MyLocale.getMsg(1400,&quot;Zone&quot;)),CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.SOUTHWEST));
+			mainPanel.addNext(new mLabel(MyLocale.getMsg(1402,&quot;Easting&quot;)),CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.SOUTHWEST));
+			mainPanel.addLast(new mLabel(MyLocale.getMsg(1401,&quot;Northing&quot;)),CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.SOUTHWEST));
+		}
+		
 		mainPanel.addNext(inpUTMZone = new mInput(),CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.WEST));
 		mainPanel.addNext(inpUTMEasting = new mInput(),CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.WEST));
 		mainPanel.addNext(inpUTMNorthing = new mInput(),CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.WEST));
@@ -278,6 +297,13 @@
 					activateFields(currFormat);
 				}
 			}
+			
+			if (ev.target == btnClear){
+				CWPoint coord = new CWPoint(91,361);
+				currFormat = chkFormat.getSelectedIndex();
+				setFields(coord,currFormat);
+				activateFields(currFormat);
+			}
 		}
 		super.onEvent(ev);
 	}

Modified: trunk/src/CacheWolf/DetailsPanel.java
===================================================================
--- trunk/src/CacheWolf/DetailsPanel.java	2008-04-12 07:16:41 UTC (rev 1359)
+++ trunk/src/CacheWolf/DetailsPanel.java	2008-04-12 07:29:03 UTC (rev 1360)
@@ -404,8 +404,7 @@
 			}
 			else if (ev.target == btnWayLoc){
 				CWPoint coords = new CWPoint(btnWayLoc.getText(),CWPoint.CW);
-				CoordsScreen cs = new CoordsScreen();
-				cs.allowInvalid = true;
+				CoordsScreen cs = new CoordsScreen(true);
 				cs.setFields(coords, CWPoint.CW);
 				if (cs.execute()== FormBase.IDOK){
 					dirty_details=true;

Modified: trunk/src/CacheWolf/Parser.java
===================================================================
--- trunk/src/CacheWolf/Parser.java	2008-04-12 07:16:41 UTC (rev 1359)
+++ trunk/src/CacheWolf/Parser.java	2008-04-12 07:29:03 UTC (rev 1360)
@@ -662,9 +662,16 @@
 			for (int i=0; i&lt;nStages; i++) {
 				String stage=MyLocale.formatLong(i,&quot;00&quot;);
 				String stageWpt=&quot;$&quot;+stage+waypointName.substring(2);
+				String stageName = &quot;Stage &quot;+(i+1);
+				String type = &quot;51&quot;;
+				if (i == nStages - 1) {
+					stageName = &quot;Final&quot;;
+					type = &quot;53&quot;;
+				}
+				createWptIfNeeded(stage+waypointName.substring(2), stageName, type);
 				op.append(&quot;IF &quot;+stageWpt+&quot;=\&quot;\&quot; THEN\n&quot;);
 				op.append(&quot;  &quot;+stageWpt+&quot; = \&quot;\&quot;\n&quot;);
-				op.append(&quot;  \&quot;Stage &quot;+(i+1)+&quot; = \&quot; &quot;+stageWpt+&quot;\n&quot;);
+				op.append(&quot;  \&quot;&quot;+stageName+&quot; = \&quot; &quot;+stageWpt+&quot;\n&quot;);
 				op.append(&quot;  goto(&quot;+stageWpt+&quot;); STOP\n&quot;);
 				op.append(&quot;ENDIF\n&quot;);
 			}		
@@ -1059,4 +1066,24 @@
 		}
 	}
 	
+	private void createWptIfNeeded(String wayPoint, String name, String type){
+	   	int ci=Global.getProfile().getCacheIndex(wayPoint);
+    	if (ci &gt;= 0) return;
+    	
+    	Global.mainTab.updatePendingChanges();
+
+		CacheHolder ch = new CacheHolder();
+		ch.wayPoint = wayPoint;
+		ch.type = type;
+		ch.CacheSize = &quot;None&quot;;
+		ch.CacheName= name;
+		
+		Global.getProfile().hasUnsavedChanges=true;
+		Global.getProfile().setAddiRef(ch);
+
+		Global.mainTab.cacheDB.add(ch);
+		Global.mainTab.tbP.myMod.numRows++;
+		Global.mainTab.tbP.refreshTable();
+	}
+	
 }


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001253.html">[Cachewolf-svn] r1359 - in trunk/src/CacheWolf: . navi
</A></li>
	<LI>Next message: <A HREF="001255.html">[Cachewolf-svn] r1361 - trunk/res_noewe/languages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1254">[ date ]</a>
              <a href="thread.html#1254">[ thread ]</a>
              <a href="subject.html#1254">[ subject ]</a>
              <a href="author.html#1254">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/cachewolf-svn">More information about the Cachewolf-svn
mailing list</a><br>
</body></html>

From araber95 at mail.berlios.de  Fri Jan  1 12:12:15 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Fri, 1 Jan 2010 12:12:15 +0100
Subject: [Cachewolf-svn] r2382 - trunk/src/CacheWolf
Message-ID: <201001011112.o01BCFRC028667@sheep.berlios.de>

Author: araber95
Date: 2010-01-01 12:12:11 +0100 (Fri, 01 Jan 2010)
New Revision: 2382

Modified:
   trunk/src/CacheWolf/CacheHolder.java
Log:
quickfix for archived/available Caches

Modified: trunk/src/CacheWolf/CacheHolder.java
===================================================================
--- trunk/src/CacheWolf/CacheHolder.java	2009-12-24 09:59:06 UTC (rev 2381)
+++ trunk/src/CacheWolf/CacheHolder.java	2010-01-01 11:12:11 UTC (rev 2382)
@@ -1205,6 +1205,7 @@
 	public void setArchived(boolean is_archived) {
 		Global.getProfile().notifyUnsavedChanges(is_archived != this.archived);		
     	this.archived = is_archived;
+    	if (this.archived) {this.available=false;}
     }
 
 	public boolean is_available() {



From araber95 at mail.berlios.de  Fri Jan  1 13:10:08 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Fri, 1 Jan 2010 13:10:08 +0100
Subject: [Cachewolf-svn] r2383 - trunk/src/CacheWolf
Message-ID: <201001011210.o01CA8Yc028557@sheep.berlios.de>

Author: araber95
Date: 2010-01-01 13:09:59 +0100 (Fri, 01 Jan 2010)
New Revision: 2383

Modified:
   trunk/src/CacheWolf/DataMover.java
Log:
possible error on deleting caches

Modified: trunk/src/CacheWolf/DataMover.java
===================================================================
--- trunk/src/CacheWolf/DataMover.java	2010-01-01 11:12:11 UTC (rev 2382)
+++ trunk/src/CacheWolf/DataMover.java	2010-01-01 12:09:59 UTC (rev 2383)
@@ -251,7 +251,7 @@
 		// delete files in dstDir to clean up trash
 		// String tmp[] = new FileBugfix(dir).list(wpt + "*.*", ewe.io.FileBase.LIST_FILES_ONLY);
 		for (int i=0; i < tmp.length;i++){
-			if (tmp[i].substring(0, wpt.length()).equalsIgnoreCase(wpt)) {
+			if (tmp[i].substring(0, java.lang.Math.min(tmp[i].length(),wpt.length())).equalsIgnoreCase(wpt)) {
 				File tmpFile = new File(dir + tmp[i]);
 				tmpFile.delete();
 			}



From araber95 at mail.berlios.de  Fri Jan  1 14:55:46 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Fri, 1 Jan 2010 14:55:46 +0100
Subject: [Cachewolf-svn] r2384 - in trunk/src/CacheWolf: . exp
Message-ID: <201001011355.o01DtkxT031684@sheep.berlios.de>

Author: araber95
Date: 2010-01-01 14:55:44 +0100 (Fri, 01 Jan 2010)
New Revision: 2384

Modified:
   trunk/src/CacheWolf/CacheType.java
   trunk/src/CacheWolf/exp/KMLExporter.java
Log:
Changing some texts in KMLExporter

Modified: trunk/src/CacheWolf/CacheType.java
===================================================================
--- trunk/src/CacheWolf/CacheType.java	2010-01-01 12:09:59 UTC (rev 2383)
+++ trunk/src/CacheWolf/CacheType.java	2010-01-01 13:55:44 UTC (rev 2384)
@@ -496,6 +496,9 @@
 	public static String type2GSTypeTag(final byte typeId) {
 		return CT_GSTYPETAG[CT_Index(typeId)];
 	}
+	public static String type2Gui(final byte typeId) {
+		return CT_GUI[CT_Index(typeId)];
+	}
 
 	/**
 	 * checks if the given type would be valid for internal use in cachewolf

Modified: trunk/src/CacheWolf/exp/KMLExporter.java
===================================================================
--- trunk/src/CacheWolf/exp/KMLExporter.java	2010-01-01 12:09:59 UTC (rev 2383)
+++ trunk/src/CacheWolf/exp/KMLExporter.java	2010-01-01 13:55:44 UTC (rev 2384)
@@ -6,6 +6,7 @@
 import CacheWolf.CacheType;
 import CacheWolf.Preferences;
 import CacheWolf.Profile;
+import CacheWolf.STRreplace;
 import CacheWolf.SafeXML;
 import ewe.io.BufferedWriter;
 import ewe.io.File;
@@ -47,6 +48,7 @@
 
 	String []categoryNames = {"Available","Found", "Owned", "Not Available", "UNKNOWN"};
 	Hashtable [] outCacheDB = new Hashtable[categoryNames.length];
+	private Profile prof;
 
 	public KMLExporter(){
 		super();
@@ -55,9 +57,10 @@
 	}
 
 
-	public KMLExporter(Preferences p, Profile prof){
+	public KMLExporter(Preferences p, Profile _prof){
 			super();
 			this.setMask("*.kml");
+			prof=_prof;
 	}
 
 	public void doIt(int variant){
@@ -86,7 +89,7 @@
 
 		try{
 			PrintWriter outp =  new PrintWriter(new BufferedWriter(new FileWriter(outFile)));
-			str = this.header();
+			str = STRreplace.replace(this.header(),"CacheWolf",prof.name);
 			if (str != null) outp.print(str);
 			for (int cat = 0; cat < categoryNames.length; cat++) {
 				// skip over empty categories
@@ -102,7 +105,7 @@
 					tmp = (Vector)entry.getValue();
 					// skip over empty cachetypes
 					if (tmp.size() == 0) continue;
-					outp.print(startFolder(CacheType.type2SymTag(new Integer((String)entry.getKey()).byteValue())));
+					outp.print(startFolder(CacheType.type2Gui(new Integer((String)entry.getKey()).byteValue())));
 
 					for(int i = 0; i<tmp.size(); i++){
 						ch = (CacheHolder) tmp.get(i);



From araber95 at mail.berlios.de  Fri Jan  1 15:03:55 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Fri, 1 Jan 2010 15:03:55 +0100
Subject: [Cachewolf-svn] r2385 - trunk/src/CacheWolf
Message-ID: <201001011403.o01E3tt4001831@sheep.berlios.de>

Author: araber95
Date: 2010-01-01 15:03:54 +0100 (Fri, 01 Jan 2010)
New Revision: 2385

Modified:
   trunk/src/CacheWolf/DataMover.java
Log:
doing the rest correction (move and copy)

Modified: trunk/src/CacheWolf/DataMover.java
===================================================================
--- trunk/src/CacheWolf/DataMover.java	2010-01-01 13:55:44 UTC (rev 2384)
+++ trunk/src/CacheWolf/DataMover.java	2010-01-01 14:03:54 UTC (rev 2385)
@@ -261,7 +261,7 @@
 	private void moveCacheFiles(String wpt, String srcDir, String dstDir, String[] srcFiles){
 		// String srcFiles[] = new FileBugfix(srcDir).list(wpt + "*.*", ewe.io.FileBase.LIST_FILES_ONLY);
 		for (int i=0; i < srcFiles.length;i++){
-			if (srcFiles[i].substring(0, wpt.length()).equalsIgnoreCase(wpt)) {
+			if (srcFiles[i].substring(0, java.lang.Math.min(srcFiles[i].length(),wpt.length())).equalsIgnoreCase(wpt)) {
 				File srcFile = new File(srcDir + srcFiles[i]);
 				File dstFile = new File(dstDir + srcFiles[i]);
 				srcFile.move(dstFile);
@@ -272,7 +272,7 @@
 	private void copyCacheFiles(String wpt, String srcDir, String dstDir, String[] srcFiles){
 		// String srcFiles[] = new FileBugfix(srcDir).list(wpt + "*.*", ewe.io.FileBase.LIST_FILES_ONLY);
 		for (int i=0; i < srcFiles.length;i++){
-			if (srcFiles[i].substring(0, wpt.length()).equalsIgnoreCase(wpt)) {
+			if (srcFiles[i].substring(0, java.lang.Math.min(srcFiles[i].length(),wpt.length())).equalsIgnoreCase(wpt)) {
 				copy(srcDir + srcFiles[i],dstDir + srcFiles[i]);
 			}
 		}



From araber95 at mail.berlios.de  Fri Jan  1 19:19:21 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Fri, 1 Jan 2010 19:19:21 +0100
Subject: [Cachewolf-svn] r2386 - in trunk: res_noewe/templates
	src/CacheWolf/exp
Message-ID: <201001011819.o01IJLxN024620@sheep.berlios.de>

Author: araber95
Date: 2010-01-01 19:19:17 +0100 (Fri, 01 Jan 2010)
New Revision: 2386

Modified:
   trunk/res_noewe/templates/Short documentation for the export via templates.htm
   trunk/src/CacheWolf/exp/TPLExporter.java
Log:
Output - Filename/Extension for template Export : Parameter Out

Modified: trunk/res_noewe/templates/Short documentation for the export via templates.htm
===================================================================
--- trunk/res_noewe/templates/Short documentation for the export via templates.htm	2010-01-01 14:03:54 UTC (rev 2385)
+++ trunk/res_noewe/templates/Short documentation for the export via templates.htm	2010-01-01 18:19:17 UTC (rev 2386)
@@ -1,20 +1,16 @@
-<html xmlns:v="urn:schemas-microsoft-com:vml"
-xmlns:o="urn:schemas-microsoft-com:office:office"
-xmlns:w="urn:schemas-microsoft-com:office:word"
-xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
-xmlns="http://www.w3.org/TR/REC-html40">
-
-<head>
-<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
-<meta name=ProgId content=Word.Document>
-<meta name=Generator content="Microsoft Word 10">
-<meta name=Originator content="Microsoft Word 10">
-<link rel=File-List
-href="Short%20documentation%20for%20the%20export%20via%20templates-Dateien/filelist.xml">
-<title>Short documentation for the export via templates</title>
-<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
- name="place"/>
-<!--[if gte mso 9]><xml>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
+<HTML>
+<HEAD>
+	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
+	<TITLE>Short documentation for the export via templates</TITLE>
+	<META NAME="GENERATOR" CONTENT="OpenOffice.org 3.0  (Win32)">
+	<META NAME="CREATED" CONTENT="0;0">
+	<META NAME="CHANGED" CONTENT="20100101;19153000">
+	<META NAME="Info 3" CONTENT="">
+	<META NAME="Info 4" CONTENT="">
+	<META NAME="Originator" CONTENT="Microsoft Word 10">
+	<META NAME="ProgId" CONTENT="Word.Document">
+	<!--[if gte mso 9]><xml>
  <o:DocumentProperties>
   <o:Author>.</o:Author>
   <o:LastAuthor>.</o:LastAuthor>
@@ -30,7 +26,8 @@
   <o:CharactersWithSpaces>6964</o:CharactersWithSpaces>
   <o:Version>10.6856</o:Version>
  </o:DocumentProperties>
-</xml><![endif]--><!--[if gte mso 9]><xml>
+</xml><![endif]-->
+	<!--[if gte mso 9]><xml>
  <w:WordDocument>
   <w:SpellingState>Clean</w:SpellingState>
   <w:GrammarState>Clean</w:GrammarState>
@@ -43,54 +40,16 @@
   </w:Compatibility>
   <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
  </w:WordDocument>
-</xml><![endif]--><!--[if !mso]><object
+</xml><![endif]-->
+	<!--[if !mso]><object
  classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
 <style>
 st1\:*{behavior:url(#ieooui) }
 </style>
 <![endif]-->
+	<!--[if gte mso 10]>
 <style>
-<!--
- /* Font Definitions */
- @font-face
-	{font-family:Helvetica;
-	panose-1:2 11 6 4 2 2 2 2 2 4;
-	mso-font-charset:0;
-	mso-generic-font-family:swiss;
-	mso-font-pitch:variable;
-	mso-font-signature:536902279 -2147483648 8 0 511 0;}
  /* Style Definitions */
- p.MsoNormal, li.MsoNormal, div.MsoNormal
-	{mso-style-parent:"";
-	margin:0cm;
-	margin-bottom:.0001pt;
-	mso-pagination:widow-orphan;
-	font-size:12.0pt;
-	font-family:"Times New Roman";
-	mso-fareast-font-family:"Times New Roman";}
-span.apple-style-span
-	{mso-style-name:apple-style-span;}
-span.apple-converted-space
-	{mso-style-name:apple-converted-space;}
-span.SpellE
-	{mso-style-name:"";
-	mso-spl-e:yes;}
-span.GramE
-	{mso-style-name:"";
-	mso-gram-e:yes;}
- at page Section1
-	{size:595.3pt 841.9pt;
-	margin:70.85pt 70.85pt 2.0cm 70.85pt;
-	mso-header-margin:35.4pt;
-	mso-footer-margin:35.4pt;
-	mso-paper-source:0;}
-div.Section1
-	{page:Section1;}
--->
-</style>
-<!--[if gte mso 10]>
-<style>
- /* Style Definitions */
  table.MsoNormalTable
 	{mso-style-name:"Normale Tabelle";
 	mso-tstyle-rowband-size:0;
@@ -104,749 +63,381 @@
 	font-size:10.0pt;
 	font-family:"Times New Roman";}
 </style>
-<![endif]--><!--[if gte mso 9]><xml>
+<![endif]-->
+	<!--[if gte mso 9]><xml>
  <o:shapedefaults v:ext="edit" spidmax="2050"/>
-</xml><![endif]--><!--[if gte mso 9]><xml>
+</xml><![endif]-->
+	<!--[if gte mso 9]><xml>
  <o:shapelayout v:ext="edit">
   <o:idmap v:ext="edit" data="1"/>
  </o:shapelayout></xml><![endif]-->
-</head>
-
-<body lang=DE style='tab-interval:35.4pt'>
-
-<div class=Section1>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Short documentation for the
-export via templates<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><u><span lang=EN-GB
-style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Comment<o:p></o:p></span></u></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;#-- <span class=SpellE>TomTom</span>
-ASC or POI --&gt;<span style='mso-tab-count:1'>???????????????????????????????????????????? </span>Anything
-between &quot;&lt;#--&quot; and &quot;--&gt;&quot; is handled as a comment<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><u><span lang=EN-GB
-style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Configuration
-section </span></u><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
-mso-ansi-language:EN-GB'>&lt;<span class=SpellE>tmpl_par</span> name=&quot;<span
-class=SpellE>NameOfParameter</span>&quot; value=&quot;<span class=SpellE>ValueOfParameter</span>&quot;&gt;<u><o:p></o:p></u></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;<span class=SpellE>tmpl_par</span>
-name=&quot;<span class=SpellE>charset</span>&quot; value=&quot;ASCII&quot;&gt;<span
-style='mso-tab-count:1'>???????????????????????? </span><span class=SpellE>Charsets</span>:
-<span style='mso-spacerun:yes'>?</span>values ASCII or UTF8<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;<span class=SpellE>tmpl_par</span>
-name=&quot;<span class=SpellE>badchars</span>&quot; value=&quot;,&quot;&gt;<span
-style='mso-tab-count:1'>????????????????????????????? </span><span
-class=SpellE><span class=GramE>BadChars</span></span><span class=GramE> :</span>
-These chars are removed from the <span class=SpellE>cachename</span>, hints and
-notes.<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><span style='mso-tab-count:
-1'>?????????????????????????????????????????????????????????????????????????????????????? </span>for
-example the value=&quot;,&quot; if ',' is used as a separator. <span
-class=GramE>Regular expressions possible.</span><o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;<span class=SpellE>tmpl_par</span>
-name=&quot;<span class=SpellE>newline</span>&quot; value=&quot;CRLF&quot;&gt;<span
-style='mso-tab-count:1'>???????????????????????? </span><span class=SpellE><span
-class=GramE>Newline</span></span><span class=GramE> :</span> values are CR, LF
-or CRLF . These defines, what should be used for replacing &lt;<span
-class=SpellE>br</span> /&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;<span class=SpellE>tmpl_par</span>
-name=&quot;<span class=SpellE>decsep</span>&quot; value=&quot;,&quot;&gt; <span
-style='mso-tab-count:1'>??????????????????????????????? </span>Decimal <span
-class=GramE>separator :</span> Defines, which decimal separator is used ,
-values &quot;.&quot; or ','<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;<span class=SpellE>tmpl_par</span>
-name=&quot; <span class=SpellE>ShortNameLength</span>&quot; value=&quot;30&quot;&gt;<span
-style='mso-tab-count:1'>????????????? </span>Number of characters for Variable<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><u><span lang=EN-GB
-style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Output
-section<o:p></o:p></span></u></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Anything (except comments and
-variables) is written to the output file. The <span class=SpellE>cachedata</span>
-<span class=SpellE><span class=GramE>ist</span></span> placed between &lt;<span
-class=SpellE>tmpl_loop</span> <span class=SpellE>cache_index</span>&gt; and
-&lt;/<span class=SpellE>tmpl_loop</span>&gt;. Variables defined like this: &lt;<span
-class=SpellE>tmpl_var</span> name=LON&gt;. At the end of the line &lt;<span
-class=SpellE>br</span> /&gt; has to be placed, this <span class=SpellE><span
-class=GramE>ist</span></span> replaced by CR.<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Variables &lt;<span
-class=SpellE>tmpl_var</span> <span class=SpellE>NameOfVariable</span>&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>=========<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>TYPE<span style='mso-tab-count:
-1'>?????????????????????????????????????????????????????????????????????????????? </span>:
-Type of cache, e.g. Regular, Multi<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>SHORTTYPE<span
-style='mso-tab-count:1'>??????????????????????????????????????????????????????????????????? </span>:
-First Letter of type<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>SIZE<span style='mso-tab-count:
-1'>??????????????????????????????????????????????????????????????????????????????? </span>:
-Size of Cache, e.g. Regular, Micro<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>SHORTSIZE<span
-style='mso-tab-count:1'>???????????????????????????????????????????????????????????????????? </span>:
-First letter of size<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>WAYPOINT<span
-style='mso-tab-count:1'>????????????????????????????????????????????????????????????????????? </span>:
-GCXXXX, OCXXXX<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>NAME<span style='mso-tab-count:
-1'>????????????????????????????????????????????????????????????????????????????? </span>:
-Name of cache (<span class=SpellE>badchars</span> are removed, see below) (<span
-class=SpellE>neuerdings</span> <span class=SpellE>bei</span> ASCII <span
-class=SpellE>Simplifizierung</span> von <span class=SpellE>Zeichen</span>)<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span style='font-size:10.0pt;
-font-family:Arial'>SHORTNAME<span style='mso-tab-count:1'>?????????????????????????????????????????????????????????????????? </span>:</span><span
-class=apple-style-span><span style='font-size:10.0pt;font-family:Helvetica;
-color:black'> Name der durch Weglassen von Vokalen von hinten und wenn das
-nicht reicht durch Weglassen von Kleinbuchstaben von hinten auf eine in den
-Einstellungen vorgegebene L?nge gek?rzt wird. (Hintergrund: das Notes -Feld der
-meisten <span class=SpellE>Garmins</span> kann nur 30 Buchstaben)</span></span></span></span><span
-style='font-size:10.0pt;font-family:Arial'><o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>OWNER<span style='mso-tab-count:
-1'>?????????????????????????????????????????????????????????????????????????? </span>:<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>DIFFICULTY<span
-style='mso-tab-count:1'>???????????????????????????????????????????????????????????????????? </span>:<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=apple-style-span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Helvetica;color:black;
-mso-ansi-language:EN-GB'>SHORTDIFFICULTY<span style='mso-tab-count:1'>????????????????????????????????????????????????????????? </span>:
-Difficulty mal 10 also 15 <span class=SpellE>statt</span> 1.5</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Helvetica;color:black;
-mso-ansi-language:EN-GB'><br>
-<span class=apple-style-span>SHDIFFICULTY<span style='mso-tab-count:1'>???????????????????????????????????????????????????????????????? </span>:
-Difficulty <span class=SpellE>abgerundet</span> also 1 <span class=SpellE>statt</span>
-1.5</span><br>
-</span><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:
-EN-GB'>TERRAIN<span style='mso-tab-count:1'>???????????????????????????????????????????????????????????????????????? </span>:<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=apple-style-span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Helvetica;color:black;
-mso-ansi-language:EN-GB'>SHORTTERAIN<span style='mso-tab-count:1'>???????????????????????????????????????????????????????????????? </span>:
-Terrain mal 10</span></span><span lang=EN-GB style='font-size:10.0pt;
-font-family:Helvetica;color:black;mso-ansi-language:EN-GB'><br>
-<span class=apple-style-span>SHTERRAIN<span style='mso-tab-count:1'>???????????????????????????????????????????????????????????????????? </span>:
-Terrain <span class=SpellE>abgerundet</span></span><br>
-</span><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:
-EN-GB'>DISTANCE<span style='mso-tab-count:1'>?????????????????????????????????????????????????????????????????????? </span>:
-Distance calculated in <span class=SpellE>cachelist</span><o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>BEARING<span
-style='mso-tab-count:1'>???????????????????????????????????????????????????????????????????????? </span>:
-Bearing calculated in <span class=SpellE>cachelist</span><o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>LATON<span style='mso-tab-count:
-1'>???????????????????????????????????????????????????????????????????????????? </span>:
-Coordinates in long format, e.g. N 50? 31.234 E 008? 45.267<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>LAT<span style='mso-tab-count:
-1'>???????????????????????????????????????????????????????????????????????????????? </span>:
-Latitude in decimal format, e.g. 50.20147<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>LON<span style='mso-tab-count:
-1'>???????????????????????????????????????????????????????????????????????????????? </span>:
-Longitude in decimal format, e.g. 008.58132<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>STATUS<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>STATUS_DATE<span
-style='mso-tab-count:1'>??????????????????????????????????????????????????????????????? </span>:
-Get the date part of the status <o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>STATUS_TIME<span
-style='mso-tab-count:1'>???????????????????????????????????????????????????????????????? </span>:
-Get the time part of the status<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>DATE<span style='mso-tab-count:
-1'>?????????????????????????????????????????????????????????????????????????????? </span>:
-date hidden<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>URL<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>DESCRIPTION<span
-style='mso-tab-count:1'>????????????????????????????????????????????????????????????????? </span>:
-Cache Description (possibly in HTML Format)<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>NOTES<span style='mso-tab-count:
-1'>??????????????????????????????????????????????????????????????????????????? </span>:
-User Notes<span style='mso-spacerun:yes'>?? </span>(<span class=SpellE>badchars</span>
-are removed, see below)<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>HINTS<span style='mso-tab-count:
-1'>????????????????????????????????????????????????????????????????????????????? </span>:
-Encrypted hints<span style='mso-spacerun:yes'>?? </span>(<span class=SpellE>badchars</span>
-are removed, see below)<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>DESCRYPTEDHINTS<span
-style='mso-tab-count:1'>??????????????????????????????????????????????????????? </span>:
-Decrypted hints<span style='mso-spacerun:yes'>??? </span>(<span class=SpellE>badchars</span>
-are removed, see below) <o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=apple-style-span><span
-style='font-size:10.0pt;font-family:Helvetica;color:black'>SHORTWAYPOINT<span
-style='mso-tab-count:1'>?????????????????????????????????????????????????????????? </span>:
-nur die letzten drei Zeichen des <span class=SpellE>Waypoints</span> (f?r
-Benutzer alter Ger?te mit nur 6 <span class=SpellE>Waypointzeichen</span>, dann
-kriegen sie noch Infos wie <span class=SpellE>Difficulty</span> etc. rein)</span></span><span
-style='font-size:10.0pt;font-family:Helvetica;color:black'><br>
-<span class=apple-style-span>TRAVELBUG<span style='mso-tab-count:1'>??????????????????????????????????????????????????????????????????? </span>:
-Y <span class=SpellE>or</span> N f?r Anwesenheit/Abwesenheit von <span
-class=SpellE>TBs</span> im Cache</span><span class=apple-converted-space>&nbsp;</span><br>
-<span class=apple-style-span>GMTYPE<span style='mso-tab-count:1'>???????????????????????????????????????????????????????????????????????? </span>:
-Type aus der <span class=SpellE>Garminmap.xml</span>, also z.B. <span
-class=SpellE>Custom</span> 1, zur Verwendung der Benutzerdefinierten Icons</span><br
-style='mso-special-character:line-break'>
-<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
-<![endif]></span><span style='font-size:10.0pt;font-family:Arial'></span><o:p></o:p></span></p>
-
-</span>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span style='font-size:10.0pt;
-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Further documentation of
-template library: http://html-tmpl-java.sourceforge.net/<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Example<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>=======<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;#-- Microsoft AutoRoute
---&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;#-- <span class=SpellE>Codecs</span>:
-ASCII, UTF8 --&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;<span class=SpellE>tmpl_par</span>
-name=&quot;<span class=SpellE>charset</span>&quot; value=&quot;ASCII&quot;&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;#-- <span class=SpellE><span
-class=GramE>somme</span></span> chars should not appear in the <span
-class=SpellE>cachename</span> --&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;<span class=SpellE>tmpl_par</span>
-name=&quot;<span class=SpellE>badchars</span>&quot;
-value=&quot;;&quot;&quot;&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;#-- <span class=SpellE>newline</span>:
-CR, LF, CRLF --&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;<span class=SpellE>tmpl_par</span>
-name=&quot;<span class=SpellE>newline</span>&quot; value=&quot;CRLF&quot;&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;#-- decimal <span
-class=SpellE>seperator</span><span class=GramE>: .</span> <span class=GramE>or
-,</span> --&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;<span class=SpellE>tmpl_par</span>
-name=&quot;<span class=SpellE>decsep</span>&quot; value=&quot;,&quot;&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span style='font-size:10.0pt;
-font-family:Arial'>Name<span class=GramE>;Breitengrad</span>;L?ngengrad;Typ1;Typ2;Waypoint;Datum;Hyperlink&lt;br
-/&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;<span class=SpellE>tmpl_loop</span>
-<span class=SpellE>cache_index</span>&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&quot;&lt;<span class=SpellE>tmpl_var</span>
-name=SHORTTYPE&gt;-&lt;<span class=SpellE>tmpl_var</span>
-name=SHORTSIZE&gt;-&lt;<span class=SpellE>tmpl_var</span>
-name=DIFFICULTY&gt;-&lt;<span class=SpellE>tmpl_var</span> name=TERRAIN&gt;
-&lt;<span class=SpellE>tmpl_var</span> name=NAME&gt;&quot;;<span class=GramE>&lt;<span
-class=SpellE>tmpl</span></span><span class=SpellE>_var</span> name=LAT&gt;;&lt;<span
-class=SpellE>tmpl_var</span> name=LON&gt;;&quot;&lt;<span class=SpellE>tmpl_var</span>
-name=TYPE&gt;&quot;;&quot;&lt;<span class=SpellE>tmpl_var</span>
-name=SIZE&gt;&quot;;&quot;&lt;<span class=SpellE>tmpl_var</span>
-name=WAYPOINT&gt;&quot;;&quot;&lt;<span class=SpellE>tmpl_var</span>
-name=DATE&gt;&quot;;&quot;&lt;<span class=SpellE>tmpl_var</span>
-name=URL&gt;&quot;&lt;<span class=SpellE>br</span> /&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;/<span class=SpellE>tmpl_loop</span>&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Tags<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>====<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=SpellE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>tmpl_var</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>--------<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>You can set default values
-for your template variables, <o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=GramE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>which</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>
-will be used if no value has been set through the <span class=SpellE>setParam</span>
-method.<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;TMPL_VAR name=&quot;<span
-class=SpellE>var_name</span>&quot; default=&quot;my value&quot;&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>If <span class=SpellE>var_name</span>
-is set using <span class=SpellE>setParam</span> (or <span class=SpellE>setParams</span>),
-then <span class=GramE>it's</span> value will be whatever it was set to, <o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=GramE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>else</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>
-it will be &quot;my value&quot; (without the quotes).<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>You can also
-&quot;escape&quot; certain strings. The following escape modes are possible.<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><span
-style='mso-spacerun:yes'>? </span><span class=GramE>none</span>:<span
-style='mso-spacerun:yes'>?? </span>String unchanged (this is the default if
-escape is not specified)<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><span
-style='mso-spacerun:yes'>? </span><span class=GramE>html</span>:<span
-style='mso-spacerun:yes'>?? </span>Encode special characters: &amp; &gt; &lt;
-&quot;.<span style='mso-spacerun:yes'>? </span>They are changed to &amp;amp;
-&amp;<span class=SpellE>lt</span><span class=GramE>;<span
-style='mso-spacerun:yes'>? </span>&amp;</span><span class=SpellE>gt</span>;<span
-style='mso-spacerun:yes'>? </span>and &amp;<span class=SpellE>quot</span>;
-respectively<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><span
-style='mso-spacerun:yes'>? </span><span class=SpellE><span class=GramE>url</span></span>:<span
-style='mso-spacerun:yes'>??? </span>Encode special characters in URL, e.g.
-space becomes %20<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><span
-style='mso-spacerun:yes'>? </span><span class=GramE>quote</span>:<span
-style='mso-spacerun:yes'>? </span>Change quotation marks:<span
-style='mso-spacerun:yes'>?? </span>&quot; becomes \&quot;<span
-style='mso-spacerun:yes'>? </span>and ' becomes \'<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Example: &lt;TMPL_VAR
-name=&quot;<span class=SpellE>var_name</span>&quot; escape=&quot;html&quot;&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=SpellE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>tmpl_if</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>-------<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>The &lt;<span class=SpellE>tmpl_if</span>&gt;
-tag allows you to include or not include a block of the template based on the
-value <o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=GramE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>of</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>
-a given parameter name. If the parameter is given a value that is true, then
-the block is included <o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=GramE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>in</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>
-the output. If the value is false, then it is skipped.<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>The <span class=SpellE>tmpl_if</span>
-must be closed with a corresponding /<span class=SpellE>tmpl_if</span>, e.g.<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;<span class=SpellE>tmpl_if</span>
-...&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>...<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;/<span class=SpellE>tmpl_if</span>&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Parameter values for
-conditions are Strings in java, and not <span class=SpellE><span class=GramE>boolean</span></span>
-values, hence, what evaluates to true <o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=GramE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>and</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>
-false needs to be specifically defined.<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>As of now, the following
-values evaluate to false:<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&quot;&quot; - the empty
-string<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&quot;0&quot; - the string
-containing only the number zero<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=GramE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>null</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>
-- the null value<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=SpellE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>tmpl_else</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>---------<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>While the if block allows us
-to display some output if a condition is true, <o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=GramE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>we</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>
-may also need to display content if the condition is false. This can be done by
-using the optional <o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=GramE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>else</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>
-branch of the if block.<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=SpellE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>tmpl_unless</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>-----------<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>This tag is the exact
-opposite of the &lt;<span class=SpellE>tmpl_if</span>&gt; tag. A &lt;<span
-class=SpellE>tmpl_unless</span>&gt; block is displayed if its control <o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=GramE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>variable</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>
-evaluates to false. If the control variable evaluates to true, then the else
-block, <o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=GramE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>if</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>
-any, is displayed instead.<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=SpellE><span
-style='font-size:10.0pt;font-family:Arial'>tmpl_loop</span></span><span
-style='font-size:10.0pt;font-family:Arial'><o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>---------<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>The &lt;<span class=SpellE>tmpl_loop</span>&gt;
-tag is a bit more complicated than the other tags. It allows you to create a
-section of text <o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=GramE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>that</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>
-will be displayed repeatedly for every item in the loop control variable. Inside
-the &lt;<span class=SpellE>tmpl_loop</span>&gt;, <o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=GramE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>you</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>
-place &lt;<span class=SpellE>tmpl_var</span>&gt;s. The only loop used by the
-template exporter is '<span class=SpellE>cache_index</span>', see example
-above. <o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><st1:place><span lang=EN-GB
- style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Loop</span></st1:place><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>
-context variables<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>----------------------<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>If you set <span
-class=SpellE>loop_context_vars</span> to true in your Template's constructor,
-then you will have access to five <o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=GramE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>special</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>
-variables in all your loops. These are:<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>__FIRST__<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><span
-style='mso-spacerun:yes'>??? </span>True for the first run of the loop, false otherwise<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>__LAST__<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><span
-style='mso-spacerun:yes'>??? </span>True for the last run of the loop, false
-otherwise<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>__ODD__<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><span
-style='mso-spacerun:yes'>??? </span>True for every other iteration of the loop
-- a loop starts at 1<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>__INNER__<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><span
-style='mso-spacerun:yes'>??? </span>True if both __FIRST__ and __LAST__ are
-false<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>__COUNTER__<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><span
-style='mso-spacerun:yes'>??? </span>Which iteration is currently <span
-class=GramE>on.</span> Starts at 1<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>You may use these like any
-other &lt;TMPL_VAR&gt; inside your loop.<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=SpellE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>tmpl_include</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>------------<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>The &lt;<span class=SpellE>tmpl_include</span>&gt;
-tag is the next simplest tag after &lt;<span class=SpellE>tmpl_var</span>&gt;<span
-class=GramE>,</span> however, it will not do what you expect it to do <o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span class=GramE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>inside</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>
-a &lt;<span class=SpellE>tmpl_if</span>&gt;<o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;<span class=SpellE>tmpl_include</span>&gt;
-is used to include the contents of another template within this template, at
-the position of the tag. <o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Processing then continues, as
-if the included template were always a part of the current template. <o:p></o:p></span></p>
-
-<p class=MsoNormal style='tab-stops:261.0pt'><span lang=EN-GB style='font-size:
-10.0pt;font-family:Arial;mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
-
-</div>
-
-</body>
-
-</html>
+	<STYLE TYPE="text/css">
+	<!--
+		P { color: #000000 }
+	-->
+	</STYLE>
+</HEAD>
+<BODY LANG="de-DE" TEXT="#000000" DIR="LTR">
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Short
+documentation for the export via templates</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><U>Comment</U></FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;#--
+TomTom ASC or POI --&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+Anything between &quot;&lt;#--&quot; and &quot;--&gt;&quot; is
+handled as a comment</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB"><U>Configuration
+section </U></SPAN></FONT></FONT><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">&lt;tmpl_par
+name=&quot;NameOfParameter&quot; value=&quot;ValueOfParameter&quot;&gt;</SPAN></FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
+name=&quot;charset&quot; value=&quot;ASCII&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+Charsets: &nbsp;values ASCII or UTF8</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
+name=&quot;badchars&quot; value=&quot;,&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+BadChars : These chars are removed from the cachename, hints and
+notes.</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">for example the
+value=&quot;,&quot; if ',' is used as a separator. Regular
+expressions possible.</SPAN></FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
+name=&quot;newline&quot; value=&quot;CRLF&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+Newline : values are CR, LF or CRLF . These defines, what should be
+used for replacing &lt;br /&gt;</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
+name=&quot;decsep&quot; value=&quot;,&quot;&gt;
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+Decimal separator : Defines, which decimal separator is used , values
+&quot;.&quot; or ','</FONT></FONT></P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">&lt;tmpl_par
+name=&quot; ShortNameLength&quot; value=&quot;30&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+Number of characters for Variable SHORTNAME </SPAN></FONT></FONT>
+</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
+name=&quot; WaypointLength&quot; value=&quot;3&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+Number of characters for Variable SHORTWAYPOINT</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
+name=&quot; Out&quot; value=&quot;*.gpx&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+Output Filename or Extension</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><BR><BR>
+</P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><U>Output
+section</U></FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Anything
+(except comments and variables) is written to the output file. The
+cachedata ist placed between &lt;tmpl_loop cache_index&gt; and
+&lt;/tmpl_loop&gt;. Variables defined like this: &lt;tmpl_var
+name=LON&gt;. At the end of the line &lt;br /&gt; has to be placed,
+this ist replaced by CR.</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Variables
+&lt;tmpl_var NameOfVariable&gt;</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>=========</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Type of cache, e.g. Regular, Multi</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>SHORTTYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: First Letter of type</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>SIZE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Size of Cache, e.g. Regular, Micro</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>SHORTSIZE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: First letter of size</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>WAYPOINT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: GCXXXX, OCXXXX</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Name of cache (badchars are removed, see below) (neuerdings bei
+ASCII Simplifizierung von Zeichen)</FONT></FONT></P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>SHORTNAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+:</FONT></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#000000"><FONT FACE="Helvetica"><FONT SIZE=2>Name
+der durch Weglassen von Vokalen von hinten und wenn das nicht reicht
+durch Weglassen von Kleinbuchstaben von hinten auf eine in den
+Einstellungen vorgegebene L&auml;nge gek&uuml;rzt wird. (Hintergrund:
+das Notes -Feld der meisten Garmins kann nur 30 Buchstaben)</FONT></FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>OWNER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+:</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>DIFFICULTY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+:</FONT></FONT></P>
+<P CLASS="msonormal"><FONT COLOR="#000000"><FONT FACE="Helvetica"><FONT SIZE=2><SPAN LANG="en-GB">SHORTDIFFICULTY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Difficulty mal 10 also 15 statt
+1.5<BR>SHDIFFICULTY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Difficulty abgerundet also 1 statt
+1.5<BR></SPAN></FONT></FONT></FONT><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">TERRAIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+:</SPAN></FONT></FONT></P>
+<P CLASS="msonormal"><FONT COLOR="#000000"><FONT FACE="Helvetica"><FONT SIZE=2><SPAN LANG="en-GB">SHORTTERAIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Terrain mal
+10<BR>SHTERRAIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Terrain
+abgerundet<BR></SPAN></FONT></FONT></FONT><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">DISTANCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Distance calculated in cachelist</SPAN></FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>BEARING&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Bearing calculated in cachelist</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>LATON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Coordinates in long format, e.g. N 50&deg; 31.234 E 008&deg; 45.267</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>LAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Latitude in decimal format, e.g. 50.20147</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>LON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Longitude in decimal format, e.g. 008.58132</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>STATUS</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>STATUS_DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Get the date part of the status </FONT></FONT>
+</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>STATUS_TIME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Get the time part of the status</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: date hidden</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>URL</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>DESCRIPTION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Cache Description (possibly in HTML Format)</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>NOTES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: User Notes&nbsp;&nbsp; (badchars are removed, see below)</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>HINTS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Encrypted hints&nbsp;&nbsp; (badchars are removed, see below)</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>DESCRYPTEDHINTS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Decrypted hints&nbsp;&nbsp;&nbsp; (badchars are removed, see below)
+</FONT></FONT>
+</P>
+<P CLASS="msonormal"><FONT COLOR="#000000"><FONT FACE="Helvetica"><FONT SIZE=2>SHORTWAYPOINT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: nur die letzten drei Zeichen des Waypoints (f&uuml;r Benutzer alter
+Ger&auml;te mit nur 6 Waypointzeichen, dann kriegen sie noch Infos
+wie Difficulty etc.
+rein)<BR>TRAVELBUG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Y or N f&uuml;r Anwesenheit/Abwesenheit von TBs im
+Cache&nbsp;<BR>GMTYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: Type aus der Garminmap.xml, also z.B. Custom 1, zur Verwendung der
+Benutzerdefinierten Icons</FONT></FONT></FONT></P>
+<P CLASS="msonormal"><FONT COLOR="#000000"><FONT FACE="Helvetica"><FONT SIZE=2>MAINWP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+: &ldquo;&ldquo; if is Mainwaypoint, Mainwaypointname if is Addi
+Waypoint</FONT></FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Further
+documentation of template library:
+http://html-tmpl-java.sourceforge.net/</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Example</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>=======</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;#--
+Microsoft AutoRoute --&gt;</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;#--
+Codecs: ASCII, UTF8 --&gt;</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
+name=&quot;charset&quot; value=&quot;ASCII&quot;&gt;</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;#--
+somme chars should not appear in the cachename --&gt;</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
+name=&quot;badchars&quot; value=&quot;;&quot;&quot;&gt;</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;#--
+newline: CR, LF, CRLF --&gt;</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
+name=&quot;newline&quot; value=&quot;CRLF&quot;&gt;</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;#--
+decimal seperator: . or , --&gt;</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
+name=&quot;decsep&quot; value=&quot;,&quot;&gt;</FONT></FONT></P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Name;Breitengrad;L&auml;ngengrad;Typ1;Typ2;Waypoint;Datum;Hyperlink&lt;br
+/&gt;</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_loop
+cache_index&gt;</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&quot;&lt;tmpl_var
+name=SHORTTYPE&gt;-&lt;tmpl_var name=SHORTSIZE&gt;-&lt;tmpl_var
+name=DIFFICULTY&gt;-&lt;tmpl_var name=TERRAIN&gt; &lt;tmpl_var
+name=NAME&gt;&quot;;&lt;tmpl_var name=LAT&gt;;&lt;tmpl_var
+name=LON&gt;;&quot;&lt;tmpl_var name=TYPE&gt;&quot;;&quot;&lt;tmpl_var
+name=SIZE&gt;&quot;;&quot;&lt;tmpl_var name=WAYPOINT&gt;&quot;;&quot;&lt;tmpl_var
+name=DATE&gt;&quot;;&quot;&lt;tmpl_var name=URL&gt;&quot;&lt;br /&gt;</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;/tmpl_loop&gt;</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Tags</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>====</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>tmpl_var</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>--------</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>You
+can set default values for your template variables, </FONT></FONT>
+</P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">which</SPAN></FONT></FONT>
+<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">will be used if no
+value has been set through the setParam method.</SPAN></FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;TMPL_VAR
+name=&quot;var_name&quot; default=&quot;my value&quot;&gt;</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>If
+var_name is set using setParam (or setParams), then it's value will
+be whatever it was set to, </FONT></FONT>
+</P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">else</SPAN></FONT></FONT>
+<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">it will be &quot;my
+value&quot; (without the quotes).</SPAN></FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>You
+can also &quot;escape&quot; certain strings. The following escape
+modes are possible.</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp; <FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">none:&nbsp;&nbsp;
+String unchanged (this is the default if escape is not specified)</SPAN></FONT></FONT></P>
+<P CLASS="msonormal">&nbsp; <FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">html:&nbsp;&nbsp;
+Encode special characters: &amp; &gt; &lt; &quot;.&nbsp; They are
+changed to &amp;amp; &amp;lt;&nbsp; &amp;gt;&nbsp; and &amp;quot;
+respectively</SPAN></FONT></FONT></P>
+<P CLASS="msonormal">&nbsp; <FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">url:&nbsp;&nbsp;&nbsp;
+Encode special characters in URL, e.g. space becomes %20</SPAN></FONT></FONT></P>
+<P CLASS="msonormal">&nbsp; <FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">quote:&nbsp;
+Change quotation marks:&nbsp;&nbsp; &quot; becomes \&quot;&nbsp; and
+' becomes \'</SPAN></FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Example:
+&lt;TMPL_VAR name=&quot;var_name&quot; escape=&quot;html&quot;&gt;</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>tmpl_if</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>-------</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>The
+&lt;tmpl_if&gt; tag allows you to include or not include a block of
+the template based on the value </FONT></FONT>
+</P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">of</SPAN></FONT></FONT>
+<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">a given parameter
+name. If the parameter is given a value that is true, then the block
+is included </SPAN></FONT></FONT>
+</P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">in</SPAN></FONT></FONT>
+<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">the output. If the
+value is false, then it is skipped.</SPAN></FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>The
+tmpl_if must be closed with a corresponding /tmpl_if, e.g.</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_if
+...&gt;</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>...</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;/tmpl_if&gt;</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Parameter
+values for conditions are Strings in java, and not boolean values,
+hence, what evaluates to true </FONT></FONT>
+</P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">and</SPAN></FONT></FONT>
+<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">false needs to be
+specifically defined.</SPAN></FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>As
+of now, the following values evaluate to false:</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&quot;&quot;
+- the empty string</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&quot;0&quot;
+- the string containing only the number zero</FONT></FONT></P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">null</SPAN></FONT></FONT>
+<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">- the null value</SPAN></FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>tmpl_else</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>---------</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>While
+the if block allows us to display some output if a condition is true,
+</FONT></FONT>
+</P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">we</SPAN></FONT></FONT>
+<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">may also need to
+display content if the condition is false. This can be done by using
+the optional </SPAN></FONT></FONT>
+</P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">else</SPAN></FONT></FONT>
+<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">branch of the if
+block.</SPAN></FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>tmpl_unless</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>-----------</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>This
+tag is the exact opposite of the &lt;tmpl_if&gt; tag. A &lt;tmpl_unless&gt;
+block is displayed if its control </FONT></FONT>
+</P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">variable</SPAN></FONT></FONT>
+<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">evaluates to
+false. If the control variable evaluates to true, then the else
+block, </SPAN></FONT></FONT>
+</P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">if</SPAN></FONT></FONT>
+<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">any, is displayed
+instead.</SPAN></FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>tmpl_loop</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>---------</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>The
+&lt;tmpl_loop&gt; tag is a bit more complicated than the other tags.
+It allows you to create a section of text </FONT></FONT>
+</P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">that</SPAN></FONT></FONT>
+<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">will be displayed
+repeatedly for every item in the loop control variable. Inside the
+&lt;tmpl_loop&gt;, </SPAN></FONT></FONT>
+</P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">you</SPAN></FONT></FONT>
+<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">place &lt;tmpl_var&gt;s.
+The only loop used by the template exporter is 'cache_index', see
+example above. </SPAN></FONT></FONT>
+</P>
+<P CLASS="msonormal">&nbsp;</P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">Loop</SPAN></FONT></FONT>
+<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">context variables</SPAN></FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>----------------------</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>If
+you set loop_context_vars to true in your Template's constructor,
+then you will have access to five </FONT></FONT>
+</P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">special</SPAN></FONT></FONT>
+<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">variables in all
+your loops. These are:</SPAN></FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>__FIRST__</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;&nbsp;&nbsp; <FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">True
+for the first run of the loop, false otherwise</SPAN></FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>__LAST__</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;&nbsp;&nbsp; <FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">True
+for the last run of the loop, false otherwise</SPAN></FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>__ODD__</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;&nbsp;&nbsp; <FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">True
+for every other iteration of the loop - a loop starts at 1</SPAN></FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>__INNER__</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;&nbsp;&nbsp; <FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">True
+if both __FIRST__ and __LAST__ are false</SPAN></FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>__COUNTER__</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;&nbsp;&nbsp; <FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">Which
+iteration is currently on. Starts at 1</SPAN></FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>You
+may use these like any other &lt;TMPL_VAR&gt; inside your loop.</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>tmpl_include</FONT></FONT></P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>------------</FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>The
+&lt;tmpl_include&gt; tag is the next simplest tag after &lt;tmpl_var&gt;,
+however, it will not do what you expect it to do </FONT></FONT>
+</P>
+<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">inside</SPAN></FONT></FONT>
+<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">a &lt;tmpl_if&gt;</SPAN></FONT></FONT></P>
+<P CLASS="msonormal">&nbsp;</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_include&gt;
+is used to include the contents of another template within this
+template, at the position of the tag. </FONT></FONT>
+</P>
+<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Processing
+then continues, as if the included template were always a part of the
+current template. </FONT></FONT>
+</P>
+<P CLASS="msonormal">&nbsp;</P>
+</BODY>
+</HTML>
\ No newline at end of file

Modified: trunk/src/CacheWolf/exp/TPLExporter.java
===================================================================
--- trunk/src/CacheWolf/exp/TPLExporter.java	2010-01-01 14:03:54 UTC (rev 2385)
+++ trunk/src/CacheWolf/exp/TPLExporter.java	2010-01-01 18:19:17 UTC (rev 2386)
@@ -58,6 +58,7 @@
 	String decSep = ".";
 	int shortNameLength=30;
 	int shortWaypointLength=3;
+	String out="*.gpx";
 
 
 	public TplFilter(){
@@ -124,6 +125,9 @@
 			if (param.equals("WaypointLength")) {
 				shortWaypointLength = Integer.valueOf(value).intValue();
 			}
+			if (param.equals("Out")) {
+				out = value;
+			}
 
 
 		}
@@ -163,12 +167,6 @@
 		CacheHolder ch;
 		ProgressBarForm pbf = new ProgressBarForm();
 		ewe.sys.Handle h = new ewe.sys.Handle();
-
-		FileChooser fc = new FileChooser(FileChooserBase.SAVE, pref.getExportPath(expName));
-		fc.setTitle("Select target file:");
-		if(fc.execute() == FormBase.IDCANCEL) return;
-		File saveTo = fc.getChosenFile();
-		pref.setExportPath(expName, saveTo.getPath());
 		int counter = cacheDB.countVisible();
 		pbf.showMainTask = false;
 		pbf.setTask(h,"Exporting ...");
@@ -196,6 +194,14 @@
 			args.put("max_includes", new Integer(5));
 			args.put("filter", myFilter);
 			Template tpl = new Template(args);
+
+			FileChooser fc = new FileChooser(FileChooserBase.SAVE, pref.getExportPath(expName));
+			fc.setTitle("Select target file:");
+			fc.addMask(myFilter.out);
+			if(fc.execute() == FormBase.IDCANCEL) return;
+			File saveTo = fc.getChosenFile();
+			pref.setExportPath(expName, saveTo.getPath());
+
 			for(int i = 0; i<counter;i++){
 				ch = cacheDB.get(i);
 				det = ch.getExistingDetails();



From salzkammergut at mail.berlios.de  Sun Jan  3 18:41:18 2010
From: salzkammergut at mail.berlios.de (salzkammergut at mail.berlios.de)
Date: Sun, 3 Jan 2010 18:41:18 +0100
Subject: [Cachewolf-svn] r2387 - trunk/lib
Message-ID: <201001031741.o03HfI6n003291@sheep.berlios.de>

Author: salzkammergut
Date: 2010-01-03 18:40:56 +0100 (Sun, 03 Jan 2010)
New Revision: 2387

Modified:
   trunk/lib/JavaEwe.zip
   trunk/lib/ewe.jar
Log:
EWE: Bugfix for Alt-Gr Bug (http://www.geoclub.de/viewtopic.php?t=38793) in Java Version.
Modified keyboard event handling in ewe/applet/WinCanvas to pass Alt-Gr keys as KEY_TYPED instead of KEY_PRESSED.

Modified: trunk/lib/JavaEwe.zip
===================================================================
(Binary files differ)

Modified: trunk/lib/ewe.jar
===================================================================
(Binary files differ)



From araber95 at mail.berlios.de  Sun Jan  3 19:10:45 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Sun, 3 Jan 2010 19:10:45 +0100
Subject: [Cachewolf-svn] r2388 - trunk
Message-ID: <201001031810.o03IAjdr030646@sheep.berlios.de>

Author: araber95
Date: 2010-01-03 19:10:27 +0100 (Sun, 03 Jan 2010)
New Revision: 2388

Modified:
   trunk/buildexe.bat
Log:
Additional Line for creating exe for  pda w2003 on windows

Modified: trunk/buildexe.bat
===================================================================
--- trunk/buildexe.bat	2010-01-03 17:40:56 UTC (rev 2387)
+++ trunk/buildexe.bat	2010-01-03 18:10:27 UTC (rev 2388)
@@ -1,6 +1,7 @@
 cd %~d0%~p0
 call getres.bat
 java -cp lib/ewe.jar Ewe programs/Jewel.ewe -c cw-pda.jnf
+java -cp lib/ewe.jar Ewe programs/Jewel.ewe -c cw-ppc2003.jnf
 java -cp lib/ewe.jar Ewe programs/Jewel.ewe -c cw-pc.jnf
 REM Dont change the order above because the PC version has to overwrite the PDA version of the EWE-file
 rem pause



From araber95 at mail.berlios.de  Sun Jan  3 19:12:10 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Sun, 3 Jan 2010 19:12:10 +0100
Subject: [Cachewolf-svn] r2389 - trunk
Message-ID: <201001031812.o03ICABu032532@sheep.berlios.de>

Author: araber95
Date: 2010-01-03 19:12:07 +0100 (Sun, 03 Jan 2010)
New Revision: 2389

Modified:
   trunk/buildexe.sh
Log:
additional line for creating ppc w2003 on linux

Modified: trunk/buildexe.sh
===================================================================
--- trunk/buildexe.sh	2010-01-03 18:10:27 UTC (rev 2388)
+++ trunk/buildexe.sh	2010-01-03 18:12:07 UTC (rev 2389)
@@ -1,4 +1,5 @@
 #!/bin/sh
 programs/ewecl programs/Jewel.ewe -c cw-pda.jnf
+programs/ewecl programs/Jewel.ewe -c cw-ppc2003.jnf
 programs/ewecl programs/Jewel.ewe -c cw-pc.jnf
 # Dont change the order above because the PC version has to overwrite the PDA version of the EWE-file



From salzkammergut at mail.berlios.de  Sun Jan  3 20:43:23 2010
From: salzkammergut at mail.berlios.de (salzkammergut at mail.berlios.de)
Date: Sun, 3 Jan 2010 20:43:23 +0100
Subject: [Cachewolf-svn] r2390 - trunk/programs
Message-ID: <201001031943.o03JhNYJ025206@sheep.berlios.de>

Author: salzkammergut
Date: 2010-01-03 20:42:31 +0100 (Sun, 03 Jan 2010)
New Revision: 2390

Modified:
   trunk/programs/JewelData.jar
Log:
EWE: Bugfix for Alt-Gr Bug Part 2 - should now work for .jar file


Modified: trunk/programs/JewelData.jar
===================================================================
(Binary files differ)



From araber95 at mail.berlios.de  Mon Jan  4 11:11:28 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Mon, 4 Jan 2010 11:11:28 +0100
Subject: [Cachewolf-svn] r2391 - in trunk/src/CacheWolf: . exp
Message-ID: <201001041011.o04ABSot028549@sheep.berlios.de>

Author: araber95
Date: 2010-01-04 11:11:25 +0100 (Mon, 04 Jan 2010)
New Revision: 2391

Modified:
   trunk/src/CacheWolf/Profile.java
   trunk/src/CacheWolf/exp/GpxExportNg.java
Log:
remember last input selection of GpxExportNg.java

Modified: trunk/src/CacheWolf/Profile.java
===================================================================
--- trunk/src/CacheWolf/Profile.java	2010-01-03 19:42:31 UTC (rev 2390)
+++ trunk/src/CacheWolf/Profile.java	2010-01-04 10:11:25 UTC (rev 2391)
@@ -49,6 +49,10 @@
 	private String minDistGC = new String();
 	/** Direction for geocaching caches */
 	private String directionGC = new String();
+	
+	private String gpxStyle =new String(); 
+	private String gpxTarget =new String(); 
+	private String gpxId =new String(); 
 
 	/** path to the maps of the profile relative to the maps root */
 	private String relativeCustomMapsPath = new String();
@@ -120,6 +124,9 @@
 		setDistGC("");
 		setMinDistGC("");
 		setDirectionGC("");
+		setGpxId("0");
+		setGpxStyle("0");
+		setGpxTarget("0");
 		setRelativeCustomMapsPath("");
 		resetUnsavedChanges();
 	}
@@ -211,6 +218,7 @@
 			detfile.print(this.getCurrentFilter().toXML(""));
 			detfile.print("    <SYNCOC date = \""+getLast_sync_opencaching()+"\" dist = \""+getDistOC()+"\"/>\n");
 			detfile.print("    <SPIDERGC dist = \"" + getDistGC() + "\" mindist = \"" + getMinDistGC() + "\" direction = \"" + getDirectionGC() + "\"/>\n");
+			detfile.print("    <EXPORT style = \"" + getGpxStyle() + "\" target = \"" + getGpxTarget() + "\" id = \"" + getGpxId() + "\"/>\n");
 			detfile.print("    <mapspath relativeDir = \"" + SafeXML.clean(relativeCustomMapsPath) + "\"/>\n");
 			int size = cacheDB.size();
 			for (int i = 0; i < size; i++) {
@@ -316,9 +324,21 @@
 					int start=text.indexOf("dist = \"")+8;
 					setDistGC(text.substring(start,text.indexOf("\"",start)));
 					start=text.indexOf("mindist = \"")+11;
-					setMinDistGC(text.substring(start,text.indexOf("\"",start)));
+					if (start==10) {setMinDistGC("0");}
+					else setMinDistGC(text.substring(start,text.indexOf("\"",start)));
 					start=text.indexOf("direction = \"")+13;
-					setDirectionGC(text.substring(start,text.indexOf("\"",start)));
+					if (start==12) {setDirectionGC("");}
+					else setDirectionGC(text.substring(start,text.indexOf("\"",start)));
+				} else if (text.indexOf("<EXPORT")>=0) {
+					int start=text.indexOf("style = \"")+9;
+					if (start==8) {setGpxStyle("0");}
+					else setGpxStyle(text.substring(start,text.indexOf("\"",start)));
+					start=text.indexOf("target = \"")+10;
+					if (start==9) {setGpxTarget("0");}
+					else setGpxTarget(text.substring(start,text.indexOf("\"",start)));
+					start=text.indexOf("id = \"")+6;
+					if (start==5) {setGpxId("0");}
+					else setGpxId(text.substring(start,text.indexOf("\"",start)));
 				} else if (indexXmlVersion <=2 && text.indexOf("<FILTER")>=0){
 					// Read filter data of file versions 1 and 2. (Legacy code)
 					ex.setSource(text.substring(text.indexOf("<FILTER")));
@@ -804,6 +824,18 @@
 	public String getDirectionGC() {
 		return directionGC;
 	}
+
+	public int getGpxStyle() {
+		return Convert.toInt(gpxStyle);
+	}
+
+	public int getGpxTarget() {
+		return Convert.toInt(gpxTarget);
+	}
+
+	public int getGpxId() {
+		return Convert.toInt(gpxId);
+	}
 //
 	public void setMinDistGC(String minDistGC) {
 		this.notifyUnsavedChanges(!minDistGC.equals(this.minDistGC));
@@ -820,6 +852,21 @@
 		this.directionGC = directionGC;
 	}
 
+	public void setGpxStyle(String style) {
+		this.notifyUnsavedChanges(!style.equals(this.gpxStyle));
+		this.gpxStyle = style;
+	}
+
+	public void setGpxTarget(String target) {
+		this.notifyUnsavedChanges(!target.equals(this.gpxTarget));
+		this.gpxTarget = target;
+	}
+
+	public void setGpxId(String id) {
+		this.notifyUnsavedChanges(!id.equals(this.gpxId));
+		this.gpxId = id;
+	}
+
 	public String getRelativeCustomMapsPath() {
 		return relativeCustomMapsPath;
 	}

Modified: trunk/src/CacheWolf/exp/GpxExportNg.java
===================================================================
--- trunk/src/CacheWolf/exp/GpxExportNg.java	2010-01-03 19:42:31 UTC (rev 2390)
+++ trunk/src/CacheWolf/exp/GpxExportNg.java	2010-01-04 10:11:25 UTC (rev 2391)
@@ -952,9 +952,9 @@
 			this.hasGpsbabelFrm = hasGpsbabel;
 
 			// TODO: get/set defaults from profile
-			chosenStyle = 0;
-			chosenTarget = 0;
-			chosenIds = 0;
+			chosenStyle = Global.getProfile().getGpxStyle();
+			chosenTarget = Global.getProfile().getGpxTarget();
+			chosenIds = Global.getProfile().getGpxId();
 
 			this.setTitle("GPX Export");
 			this.resizable = false;
@@ -1026,142 +1026,174 @@
 
 			addButton(btnOk);
 			addButton(btnCancel);
+
+			checkStyle();
+			checkTarget();
+			checkIds();
 		}
-
+		
 		/**
-		 * react to GUI events and toogle access to the checkboxes according to
-		 * radio button settings pass everything else to <code>super()</code>
+		 * in  : chStyle.selectedIndex;
+		 * out : chosenStyle
 		 */
-		public void onEvent(Event ev) {
-			if (ev instanceof DataChangeEvent && ev.type == DataChangeEvent.DATA_CHANGED) {
-				if (ev.target == chStyle && chStyle.selectedIndex != chosenStyle) {
-					if (chStyle.selectedIndex == 2) { // my finds export
-						chIds.select(0);
-						if (chIds.change(ControlConstants.Disabled, 0))
-							chIds.repaint();
+		private void checkStyle() {
+			if (chStyle.selectedIndex == 2) { // my finds export
+				chIds.select(0);
+				if (chIds.change(ControlConstants.Disabled, 0))
+					chIds.repaint();
 
-						chTarget.select(0);
-						if (chTarget.change(ControlConstants.Disabled, 0))
-							chTarget.repaint();
+				chTarget.select(0);
+				if (chTarget.change(ControlConstants.Disabled, 0))
+					chTarget.repaint();
 
-						if (ibPrefix.change(ControlConstants.Disabled, 0))
-							ibPrefix.repaint();
+				if (ibPrefix.change(ControlConstants.Disabled, 0))
+					ibPrefix.repaint();
 
-						if (ibMaxLogs.change(ControlConstants.Disabled, 0))
-							ibMaxLogs.repaint();
+				if (ibMaxLogs.change(ControlConstants.Disabled, 0))
+					ibMaxLogs.repaint();
 
-						cbSendToGarmin.state = false;
-						if (cbSendToGarmin.change(ControlConstants.Disabled, 0))
-							cbSendToGarmin.repaint();
+				cbSendToGarmin.state = false;
+				if (cbSendToGarmin.change(ControlConstants.Disabled, 0))
+					cbSendToGarmin.repaint();
 
-						cbCustomIcons.state = false;
-						if (cbCustomIcons.change(ControlConstants.Disabled, 0))
-							cbCustomIcons.repaint();
+				cbCustomIcons.state = false;
+				if (cbCustomIcons.change(ControlConstants.Disabled, 0))
+					cbCustomIcons.repaint();
 
-						cbSeperateHints.state = false;
-						if (cbSeperateHints.change(ControlConstants.Disabled, 0))
-							cbSeperateHints.repaint();
+				cbSeperateHints.state = false;
+				if (cbSeperateHints.change(ControlConstants.Disabled, 0))
+					cbSeperateHints.repaint();
 
-						if (ibMaxLogs.change(ControlConstants.Disabled, 0))
-							ibMaxLogs.repaint();
+				if (ibMaxLogs.change(ControlConstants.Disabled, 0))
+					ibMaxLogs.repaint();
 
-						if (ibPrefix.change(ControlConstants.Disabled, 0))
-							ibPrefix.repaint();
-					} else if (chStyle.selectedIndex == 1) { // PQ like export
-						if (chIds.change(0, ControlConstants.Disabled))
-							chIds.repaint();
+				if (ibPrefix.change(ControlConstants.Disabled, 0))
+					ibPrefix.repaint();
+			} else if (chStyle.selectedIndex == 1) { // PQ like export
+				if (chIds.change(0, ControlConstants.Disabled))
+					chIds.repaint();
 
-						chTarget.select(0);
-						if (chTarget.change(ControlConstants.Disabled, 0))
-							chTarget.repaint();
+				chTarget.select(0);
+				if (chTarget.change(ControlConstants.Disabled, 0))
+					chTarget.repaint();
 
-						if (hasGpsbabelFrm && cbSendToGarmin.change(0, ControlConstants.Disabled))
-							cbSendToGarmin.repaint();
+				if (hasGpsbabelFrm && cbSendToGarmin.change(0, ControlConstants.Disabled))
+					cbSendToGarmin.repaint();
 
-						if (hasGarminMapFrm && cbCustomIcons.change(0, ControlConstants.Disabled))
-							cbCustomIcons.repaint();
+				if (hasGarminMapFrm && cbCustomIcons.change(0, ControlConstants.Disabled))
+					cbCustomIcons.repaint();
 
-						cbSeperateHints.state = false;
-						if (cbSeperateHints.change(ControlConstants.Disabled, 0))
-							cbSeperateHints.repaint();
+				cbSeperateHints.state = false;
+				if (cbSeperateHints.change(ControlConstants.Disabled, 0))
+					cbSeperateHints.repaint();
 
-						if (ibMaxLogs.change(0, ControlConstants.Disabled))
-							ibMaxLogs.repaint();
+				if (ibMaxLogs.change(0, ControlConstants.Disabled))
+					ibMaxLogs.repaint();
 
-						if (ibPrefix.change(ControlConstants.Disabled, 0))
-							ibPrefix.repaint();
-					} else { // compact export
-						if (chIds.change(0, ControlConstants.Disabled))
-							chIds.repaint();
+				if (ibPrefix.change(ControlConstants.Disabled, 0))
+					ibPrefix.repaint();
+			} else { // compact export
+				if (chIds.change(0, ControlConstants.Disabled))
+					chIds.repaint();
 
-						if (chTarget.change(0, ControlConstants.Disabled))
-							chTarget.repaint();
+				if (chTarget.change(0, ControlConstants.Disabled))
+					chTarget.repaint();
 
-						if (hasGpsbabelFrm && cbSendToGarmin.change(0, ControlConstants.Disabled))
-							cbSendToGarmin.repaint();
+				if (hasGpsbabelFrm && cbSendToGarmin.change(0, ControlConstants.Disabled))
+					cbSendToGarmin.repaint();
 
-						if (hasGarminMapFrm && cbCustomIcons.change(0, ControlConstants.Disabled))
-							cbCustomIcons.repaint();
+				if (hasGarminMapFrm && cbCustomIcons.change(0, ControlConstants.Disabled))
+					cbCustomIcons.repaint();
 
-						cbSeperateHints.state = false;
-						if (cbSeperateHints.change(ControlConstants.Disabled, 0))
-							cbSeperateHints.repaint();
+				cbSeperateHints.state = false;
+				if (cbSeperateHints.change(ControlConstants.Disabled, 0))
+					cbSeperateHints.repaint();
 
-						if (ibMaxLogs.change(ControlConstants.Disabled, 0))
-							ibMaxLogs.repaint();
-					}
-					chosenStyle = chStyle.selectedIndex;
-				} else if (ev.target == chTarget && chTarget.selectedIndex != chosenTarget) {
-					if (chTarget.selectedIndex == 2) { // POI
-						cbSendToGarmin.state = false;
-						if (cbSendToGarmin.change(ControlConstants.Disabled, 0))
-							cbSendToGarmin.repaint();
+				if (ibMaxLogs.change(ControlConstants.Disabled, 0))
+					ibMaxLogs.repaint();
+			}
+			chosenStyle = chStyle.selectedIndex;
+			chosenTarget = chTarget.selectedIndex;
+			chosenIds = chIds.selectedIndex;
+		}
 
-						cbCustomIcons.state = false;
-						if (cbCustomIcons.change(ControlConstants.Disabled, 0))
-							cbCustomIcons.repaint();
+		/**
+		 * in : chTarget.selectedIndex
+		 * out: chosenTarget
+		 */
+		private void checkTarget() {
+			if (chTarget.selectedIndex == 2) { // POI
+				cbSendToGarmin.state = false;
+				if (cbSendToGarmin.change(ControlConstants.Disabled, 0))
+					cbSendToGarmin.repaint();
 
-						if (cbSeperateHints.change(0, ControlConstants.Disabled))
-							cbSeperateHints.repaint();
+				cbCustomIcons.state = false;
+				if (cbCustomIcons.change(ControlConstants.Disabled, 0))
+					cbCustomIcons.repaint();
 
-						if (ibPrefix.change(0, ControlConstants.Disabled))
-							ibPrefix.repaint();
-					} else if (chTarget.selectedIndex == 1) { // Separate File
-						cbSendToGarmin.state = false;
-						if (cbSendToGarmin.change(ControlConstants.Disabled, 0))
-							cbSendToGarmin.repaint();
+				if (cbSeperateHints.change(0, ControlConstants.Disabled))
+					cbSeperateHints.repaint();
 
-						if (hasBitmapsFrm && cbCustomIcons.change(0, ControlConstants.Disabled))
-							cbCustomIcons.repaint();
+				if (ibPrefix.change(0, ControlConstants.Disabled))
+					ibPrefix.repaint();
+			} else if (chTarget.selectedIndex == 1) { // Separate File
+				cbSendToGarmin.state = false;
+				if (cbSendToGarmin.change(ControlConstants.Disabled, 0))
+					cbSendToGarmin.repaint();
 
-						if (cbSeperateHints.change(0, ControlConstants.Disabled))
-							cbSeperateHints.repaint();
+				if (hasBitmapsFrm && cbCustomIcons.change(0, ControlConstants.Disabled))
+					cbCustomIcons.repaint();
 
-						if (ibPrefix.change(0, ControlConstants.Disabled))
-							ibPrefix.repaint();
-					} else { // Single GPX
-						if (hasGpsbabelFrm && cbSendToGarmin.change(0, ControlConstants.Disabled))
-							cbSendToGarmin.repaint();
+				if (cbSeperateHints.change(0, ControlConstants.Disabled))
+					cbSeperateHints.repaint();
 
-						if (hasGarminMapFrm && cbCustomIcons.change(0, ControlConstants.Disabled))
-							cbCustomIcons.repaint();
+				if (ibPrefix.change(0, ControlConstants.Disabled))
+					ibPrefix.repaint();
+			} else { // Single GPX
+				if (hasGpsbabelFrm && cbSendToGarmin.change(0, ControlConstants.Disabled))
+					cbSendToGarmin.repaint();
 
-						cbSeperateHints.state=false;
-						if (cbSeperateHints.change(ControlConstants.Disabled, 0))
-							cbSeperateHints.repaint();
+				if (hasGarminMapFrm && cbCustomIcons.change(0, ControlConstants.Disabled))
+					cbCustomIcons.repaint();
 
-						if (ibPrefix.change(ControlConstants.Disabled, 0))
-							ibPrefix.repaint();
-					}
+				cbSeperateHints.state=false;
+				if (cbSeperateHints.change(ControlConstants.Disabled, 0))
+					cbSeperateHints.repaint();
 
-					chosenTarget = chTarget.selectedIndex;
+				if (ibPrefix.change(ControlConstants.Disabled, 0))
+					ibPrefix.repaint();
+			}
+			chosenStyle = chStyle.selectedIndex;
+			chosenTarget = chTarget.selectedIndex;
+			chosenIds = chIds.selectedIndex;
+		}
+
+		private void checkIds() {
+			chosenStyle = chStyle.selectedIndex;
+			chosenTarget = chTarget.selectedIndex;
+			chosenIds = chIds.selectedIndex;
+		}
+		
+		/**
+		 * react to GUI events and toogle access to the checkboxes according to
+		 * radio button settings pass everything else to <code>super()</code>
+		 */
+		public void onEvent(Event ev) {
+			if (ev instanceof DataChangeEvent && ev.type == DataChangeEvent.DATA_CHANGED) {
+				if (ev.target == chStyle && chStyle.selectedIndex != chosenStyle) {
+					checkStyle();
+				} else if (ev.target == chTarget && chTarget.selectedIndex != chosenTarget) {
+					checkTarget();
 				} else if (ev.target == chIds && chIds.selectedIndex != chosenIds) {
-					chosenIds = chIds.selectedIndex;
+					checkIds();
 				}
 			} else if (ev instanceof ControlEvent && ev.type == ControlEvent.PRESSED) {
 				if (ev.target == btnCancel) {
 					close(-1);
 				} else if (ev.target == btnOk) {
+					Global.getProfile().setGpxStyle(Convert.toString(chosenStyle));
+					Global.getProfile().setGpxTarget(Convert.toString(chosenTarget));
+					Global.getProfile().setGpxId(Convert.toString(chosenIds));
 					if (chosenStyle == GpxExportNg.STYLE_GPX_PQLIKE) {
 						try {
 							int logs = getMaxLogs();



From salzkammergut at mail.berlios.de  Tue Jan  5 22:16:15 2010
From: salzkammergut at mail.berlios.de (salzkammergut at mail.berlios.de)
Date: Tue, 5 Jan 2010 22:16:15 +0100
Subject: [Cachewolf-svn] r2392 - in trunk: lib programs
Message-ID: <201001052116.o05LGFwJ030138@sheep.berlios.de>

Author: salzkammergut
Date: 2010-01-05 22:15:32 +0100 (Tue, 05 Jan 2010)
New Revision: 2392

Modified:
   trunk/lib/JavaEwe.zip
   trunk/lib/ewe.jar
   trunk/programs/JewelData.jar
Log:
EWE: Added TAB & SHIFT-TAB as alternative focus keys for Eclipse and .jar version
All Modifications in Applet.WinCanvas (disabled awt focus key with SetFocusKeyEnabled to generate TAB key event)

Modified: trunk/lib/JavaEwe.zip
===================================================================
(Binary files differ)

Modified: trunk/lib/ewe.jar
===================================================================
(Binary files differ)

Modified: trunk/programs/JewelData.jar
===================================================================
(Binary files differ)



From araber95 at mail.berlios.de  Wed Jan  6 00:56:00 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Wed, 6 Jan 2010 00:56:00 +0100
Subject: [Cachewolf-svn] r2393 - trunk/src/CacheWolf/imp
Message-ID: <201001052356.o05Nu0Y1022355@sheep.berlios.de>

Author: araber95
Date: 2010-01-06 00:55:52 +0100 (Wed, 06 Jan 2010)
New Revision: 2393

Modified:
   trunk/src/CacheWolf/imp/OCXMLImporter.java
Log:
no new message window for each cache import!

Modified: trunk/src/CacheWolf/imp/OCXMLImporter.java
===================================================================
--- trunk/src/CacheWolf/imp/OCXMLImporter.java	2010-01-05 21:15:32 UTC (rev 2392)
+++ trunk/src/CacheWolf/imp/OCXMLImporter.java	2010-01-05 23:55:52 UTC (rev 2393)
@@ -137,10 +137,13 @@
 			return true;
 		}
 
+		/*
 		inf = new InfoBox("Opencaching download", MyLocale.getMsg(1608,"downloading data\n from " + hostname), InfoBox.PROGRESS_WITH_WARNINGS, false);
 		inf.setPreferredSize(220, 300);
 		inf.relayout(false);
 		inf.exec();
+		*/
+		
 		String lastS;
 		/** pref.downloadmissingOC = true, if not the last syncdate shall be used,
 		 *  but the caches shall be reloaded



From mik77 at mail.berlios.de  Wed Jan  6 14:02:44 2010
From: mik77 at mail.berlios.de (mik77 at mail.berlios.de)
Date: Wed, 6 Jan 2010 14:02:44 +0100
Subject: [Cachewolf-svn] r2394 - trunk/src/CacheWolf/imp
Message-ID: <201001061302.o06D2iXN029406@sheep.berlios.de>

Author: mik77
Date: 2010-01-06 14:02:36 +0100 (Wed, 06 Jan 2010)
New Revision: 2394

Modified:
   trunk/src/CacheWolf/imp/SpiderGC.java
Log:
Better cooperation of new spider criteria and automatic update functionality.

Modified: trunk/src/CacheWolf/imp/SpiderGC.java
===================================================================
--- trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-05 23:55:52 UTC (rev 2393)
+++ trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-06 13:02:36 UTC (rev 2394)
@@ -453,7 +453,7 @@
 					}
 				} else {
 					if ( (!ch.is_archived())
-						 && (ch.kilom <= distanceInKm) && (ch.kilom >= minDistanceInKm)
+						 && (ch.kilom <= distanceInKm) /*&& (ch.kilom >= minDistanceInKm)*/
 						 && !(doNotgetFound && (ch.is_found() || ch.is_owned()))
 						 && (ch.getWayPoint().substring(0,2).equalsIgnoreCase("GC"))
 						 && ( (restrictedCacheType == CacheType.CW_TYPE_ERROR) || (ch.getType() == restrictedCacheType) )
@@ -546,11 +546,10 @@
 					oneCacheDesc=lineRex.stringMatched(1);
 					double gotDistance=getDist(oneCacheDesc);
 					if(gotDistance <= maxDistance){
-						if ( gotDistance >= minDistance &&
-							 directionOK(directions,getDirection(oneCacheDesc)) ){
-							String chWaypoint=getWP(oneCacheDesc);
-							ch=cacheDB.get(chWaypoint);
-							if(ch == null){
+					  String chWaypoint=getWP(oneCacheDesc);
+						ch=cacheDB.get(chWaypoint);
+						if(ch == null){
+						  if ( gotDistance >= minDistance && directionOK(directions,getDirection(oneCacheDesc)) ){
 								pref.log(chWaypoint+" added to load!");
 								cachesToLoad.add(chWaypoint);
 								if ((maxNumber > 0) && (cachesToLoad.size() >= maxNumber)) {
@@ -558,32 +557,32 @@
 									maxDistance = 0; //add no more caches
 									cachesToUpdate.clear(); //don't update existing caches, because list is not correct when aborting
 								}
+							}
+						} else {
+							// if (pref.spiderUpdates != Preferences.NO) {
+							pref.log(chWaypoint+" already in DB");
+						  // If the <strike> tag is used, the cache is marked as unavailable or archived
+							boolean is_archived_GC=oneCacheDesc.indexOf("<strike><font color=\"red\">")!=-1;
+							boolean is_available_GC=oneCacheDesc.indexOf("<strike>")==-1;
+							// CacheHolderDetail det = ch.getCacheDetails(true);
+							if (ch.is_archived()!=is_archived_GC) { // Update the database with the cache status
+								pref.log("Updating status of "+chWaypoint+" to "+(is_archived_GC?"archived":"not archived"));
+								if ( ch.is_archived() ) {
+									// is not yet in updateList
+									cachesToUpdate.put(chWaypoint, ch);
+								}
+								ch.setArchived(is_archived_GC);
+							} else if (ch.is_available()!=is_available_GC) { // Update the database with the cache status
+								pref.log("Updating status of "+chWaypoint+" to "+(is_available_GC?"available":"not available"));
+								ch.setAvailable(is_available_GC);
+							} else if (spiderAllFinds && !ch.is_found()) { // Update the database with the cache status
+								pref.log("Updating status of "+chWaypoint+" to found");
+								ch.setFound(true);
 							} else {
-								// if (pref.spiderUpdates != Preferences.NO) {
-									pref.log(chWaypoint+" already in DB");
-									// If the <strike> tag is used, the cache is marked as unavailable or archived
-									boolean is_archived_GC=oneCacheDesc.indexOf("<strike><font color=\"red\">")!=-1;
-									boolean is_available_GC=oneCacheDesc.indexOf("<strike>")==-1;
-									// CacheHolderDetail det = ch.getCacheDetails(true);
-									if (ch.is_archived()!=is_archived_GC) { // Update the database with the cache status
-										pref.log("Updating status of "+chWaypoint+" to "+(is_archived_GC?"archived":"not archived"));
-										if ( ch.is_archived() ) {
-											// is not yet in updateList
-											cachesToUpdate.put(chWaypoint, ch);
-										}
-										ch.setArchived(is_archived_GC);
-									} else if (ch.is_available()!=is_available_GC) { // Update the database with the cache status
-										pref.log("Updating status of "+chWaypoint+" to "+(is_available_GC?"available":"not available"));
-										ch.setAvailable(is_available_GC);
-									} else if (spiderAllFinds && !ch.is_found()) { // Update the database with the cache status
-										pref.log("Updating status of "+chWaypoint+" to found");
-										ch.setFound(true);
-									} else {
-										cachesToUpdate.remove( chWaypoint );
-									}
-								// }
+								cachesToUpdate.remove( chWaypoint );
 							}
-						}
+						// }
+  					}
 					} else maxDistance = 0;
 					// next Cache Description of this page
 					lineRex.searchFrom(dummy, lineRex.matchedTo());



From cw-manual at mail.berlios.de  Thu Jan  7 01:20:01 2010
From: cw-manual at mail.berlios.de (cw-manual at mail.berlios.de)
Date: Thu, 7 Jan 2010 01:20:01 +0100
Subject: [Cachewolf-svn] r2395 - in trunk/docs/CacheWolf Doku: . pics
Message-ID: <201001070020.o070K1ce008664@sheep.berlios.de>

Author: cw-manual
Date: 2010-01-07 01:14:47 +0100 (Thu, 07 Jan 2010)
New Revision: 2395

Modified:
   trunk/docs/CacheWolf Doku/Der_erste_Start.xml
   trunk/docs/CacheWolf Doku/ansichten.xml
   trunk/docs/CacheWolf Doku/pics/ansicht_liste.jpg
   trunk/docs/CacheWolf Doku/pics/list_popup.jpg
   trunk/docs/CacheWolf Doku/pics/spider_gc.jpg
   trunk/docs/CacheWolf Doku/pics/statusleiste.jpg
Log:
Adapt Chapter 3.1 and 3.1.1 to actual build

Modified: trunk/docs/CacheWolf Doku/Der_erste_Start.xml
===================================================================
--- trunk/docs/CacheWolf Doku/Der_erste_Start.xml	2010-01-06 13:02:36 UTC (rev 2394)
+++ trunk/docs/CacheWolf Doku/Der_erste_Start.xml	2010-01-07 00:14:47 UTC (rev 2395)
@@ -44,9 +44,19 @@
           <surname>Klaus Rieger</surname>
         </author>
         <revdescription>
-          <para>Bilder auf V1.1.2320 aktualisiert, Tippfehler korrigiert, neue Funktionen beschrieben</para>
+          <para>Bilder auf V1.1.2320 aktualisiert, Tippfehler korrigiert, neue Funktionen beschrieben
</para>
         </revdescription>
       </revision>
+      <revision>
+        <revnumber>1.01</revnumber>
+        <date>07.01.2010</date>
+        <author>
+          <surname>Klaus Rieger</surname>
+        </author>
+        <revdescription>
+          <para>Bilder auf V1.1.2386 akutalisiert</para>
+        </revdescription>
+      </revision>
     </revhistory>
   </chapterinfo>
   <title>Der erste Start</title>
@@ -181,7 +191,7 @@
           <para>PL = Polnisch</para>
         </listitem>
       </itemizedlist>
-      <para>Die Sprache kann aus dem Dropdown-Men? ausgew?hlt werden. Die neu eingestellte Sprache wird im Fall einer ?nderung allerdings erst nach einem Neustart benutzt.


</para>
+      <para>Die Sprache kann aus dem Dropdown-Men? ausgew?hlt werden. Die neu eingestellte Sprache wird im Fall einer ?nderung allerdings erst nach einem Neustart benutzt.</para>
       <para>Unter L?ngeneinheit kann auf die Verwendung von Meilen statt km umgestellt werden.</para>
       <para>Mit <literal>Sortierung nach Cache gruppiert</literal> wird erreicht, da? bei Sortierung einer Spalte in der Listenansicht immer nur der Hauptwegpunkt eines Caches ber?cksichtigt wird, die Additional Waypoints werden durch die Sortierung nicht erfasst und bleiben stets unter Ihrem Hauptwegpunkt eingeordnet. Andernfalls werden wirklich alle Zeilen entsprechend sortiert, was aber dazu f?hren kann, da? die Additional Waypoints an ganz anderer Stelle in der sortierten Liste auftauchen, wie der zugeh?rige Hauptwegpunkt.</para>
       <para>Ist <literal>use own symbols</literal> angehakt und befinden sich im Unterverzeichnis &quot;Symbols&quot;  .png-Dateien, werden diese als alternative Symbole in den Cachewolf geladen. Dabei sollte es sich um PNGs der Gr??e 15x15 handeln. Wichtig ist die korrekte Benennung der Dateien. Falsch benannte Dateien werden ignoriert.
@@ -224,7 +234,7 @@
       <section id="DatenImportGPX">
         <title>Import einer GPX Datei</title>
         <para>Um an GPX-Dateien von geocaching.com zu kommen, muss man Premium-Mitglied sein. Die GPX-Dateien werden nach einer Pocket Query (h?ufig als zip-Archiv) per Mail verschickt. Alternativ k?nnen GPX-Dateien f?r einzelne Caches direkt heruntergeladen werden. Die heruntengeladenen Dateien k?nnen einfach in ein Verzeichnis abgelegt und m?ssen nicht entpackt werden.</para>
-        <para>Den Import startest Du durch Anw?hlen von &quot;<literal>Anwendung -&gt; Import -&gt; Importiere GPX</literal>&quot;. Du kannst eine Datei oder mit Hilfe der Umschalt - Taste mehrere Dateien ausw?hlen.</para>
+        <para>Den Import startest Du durch Anw?hlen von &quot;<literal>Anwendung -&gt; Import -&gt; aus GPX-Datei</literal>&quot;. Du kannst eine Datei oder mit Hilfe der Umschalt - Taste mehrere Dateien ausw?hlen.</para>
         <para>Nach der Wahl der Datei, die du importieren m?chtest, erscheint ein Fenster mit der Frage, ob Du auch Bilder herunterladen m?chtest:</para>
         <para>
           <inlinemediaobject>
@@ -247,7 +257,7 @@
       <section id="DatenImportSpider">
         <title>Direktes herunterladen (spidern)</title>
         <para>WICHTIG: Durch Anwenden dieser Funktion ruft CW automatisiert die Internetseiten mit den entsprechenden Cachebeschreibungen auf und speichert die dort enthaltenen Daten in seiner Datenbank ab. Dies ist aber lt. den Nutzungsbestimmungen von Geocaching.com verboten. Zuwiederhandlungen k?nnen u.U. auch ein Sperren des entspechenden Nutzerkontos bei Geocaching.com zur Folge haben!</para>
-        <para>Durch Anw?hlen von <literal>Anwendung -&gt; Import -&gt; Spider von geocaching.com</literal> wirst Du zuerst aufgefordert Dein Passwort einzugeben. Dies ist das Passwort, das Du f?r Deinen Account bei geocaching.com nutzt. Deinen Alias hast Du ja bereits in den Einstellungen eingetragen. Nach der Eingabe Deines Passwortes loggt sich CacheWolf auf der geocaching.com Homepage ein und pr?sentiert dann die Spideroptionen ein einem neuen Fenster:</para>
+        <para>Durch Anw?hlen von <literal>Anwendung -&gt; Import -&gt; von geocaching.com</literal> wirst Du zuerst aufgefordert Dein Passwort einzugeben. Dies ist das Passwort, das Du f?r Deinen Account bei geocaching.com nutzt. Deinen Alias hast Du ja bereits in den Einstellungen eingetragen. Nach der Eingabe Deines Passwortes loggt sich CacheWolf auf der geocaching.com Homepage ein und pr?sentiert dann die Spideroptionen ein einem neuen Fenster:</para>
         <para>
           <inlinemediaobject>
             <imageobject>
@@ -255,7 +265,7 @@
             </imageobject>
           </inlinemediaobject>
         </para>
-        <para>Ganz oben kann im Drop-Down Feld gew?hlt werden ob alle Cachetypen gespidert werden sollen oder nur ein bestimmter Cachetyp, z.B. alle Traditionals. Unter <literal>max. Abstand</literal> wird eine Entfernung zum aktuellem Zentrum eingestellt (siehe <xref linkend="zentrum"/>). Cachewolf wird alle Caches im angegebenen Umkreis um das Zentrum herunterladen. Mit der Einstellung <literal>Max. Anzahl </literal> wird die maximale Zahl der Caches die gespidert werden begrenzt. Liegen mehr Caches innerhalb des Spiderradiusses wird das spidern nach der angegebenen Anzahl abgebrochen. Damit soll verhindert werden, da? auf der Webseite von GC zu gro?er Traffic entsteht. (Siehe auch WICHTIG ganz oben in diesem Kapitel! Wird der Haken bei <literal>Bilder downloaden</literal> gesetzt, wird Cachewolf sowohl die Bilder in der Cachebeschreibung als auch die Spoilerbilder herunterladen. Mit dem Haken bei <literal>TBs downloaden </literal>werden neben den Cachedaten auch die e!
 vtl. in den Caches enthaltenen Trackable Items wie Geocoins oder Travelbugs heruntergeladen und in dem CW-Profil verwaltet. Der Download von bereits gefundenen Caches kann durch Ausw?hlen der Option <literal>Gefundene Caches nicht laden verhindert</literal> werden.</para>
+        <para>Ganz oben kann im Drop-Down Feld gew?hlt werden ob alle Cachetypen gespidert werden sollen oder nur ein bestimmter Cachetyp, z.B. alle Traditionals. Es werden alle Caches geladen, die zwischen <literal>min. Abstand </literal>und <literal>max. Abstand</literal> um das aktuelle Zentrum liegen (siehe <xref linkend="zentrum"/>). Gibt man bei <literal>Richtung </literal>etwas ein, werden nur die Caches geladen, die in der angegebenen Richtung vom Zentrum aus liegen. Bleibt das Feld leer, werden alle Richtungen ber?cksichtigt. Mit der Einstellung <literal>Max. Anzahl </literal> wird die maximale Zahl der Caches die gespidert werden begrenzt. Liegen mehr Caches innerhalb des Spiderradiusses wird das spidern nach der angegebenen Anzahl abgebrochen. Damit soll verhindert werden, da? auf der Webseite von GC zu gro?er Traffic entsteht. (Siehe auch WICHTIG ganz oben in diesem Kapitel! Wird der Haken bei <literal>Bilder downloaden</literal> gesetzt, wird Cachewolf sowo!
 hl die Bilder in der Cachebeschreibung als auch die Spoilerbilder herunterladen. Mit dem Haken bei <literal>TBs downloaden </literal>werden neben den Cachedaten auch die evtl. in den Caches enthaltenen Trackable Items wie Geocoins oder Travelbugs heruntergeladen und in dem CW-Profil verwaltet. Der Download von bereits gefundenen Caches kann durch Ausw?hlen der Option <literal>Gefundene Caches nicht laden verhindert</literal> werden.</para>
         <para>Mit <literal>OK</literal> wird der Spider gestartet. Je nach Entfernung und Cache-Dichte wird das Spidern nun einige Zeit in Anspruch nehmen.</para>
       </section>
     </section>
@@ -268,7 +278,7 @@
       </section>
       <section id="DatenImportDownload">
         <title id="OpenSpider">Direkter Download von opencaching.de</title>
-        <para>Mit der Funktion <literal>Anwendung -&gt; Import -&gt; Download von opencaching.de</literal> ?ffnet sich ein Dialog. Ganz oben im Drop-Down Feld kann die Datenbank gew?hlt werden, aus der die Cachedaten importiert werden sollen. Darunter die Eingabe des Abstands: </para>
+        <para>Mit der Funktion <literal>Anwendung -&gt; Import -&gt; von opencaching de,pl,cz.uk</literal> ?ffnet sich ein Dialog. Ganz oben im Drop-Down Feld kann die Datenbank gew?hlt werden, aus der die Cachedaten importiert werden sollen. Darunter die Eingabe des Abstands: </para>
         <para>
           <inlinemediaobject>
             <imageobject>

Modified: trunk/docs/CacheWolf Doku/ansichten.xml
===================================================================
--- trunk/docs/CacheWolf Doku/ansichten.xml	2010-01-06 13:02:36 UTC (rev 2394)
+++ trunk/docs/CacheWolf Doku/ansichten.xml	2010-01-07 00:14:47 UTC (rev 2395)
@@ -49,6 +49,16 @@
           <para>Kapitel fertig.</para>
         </revdescription>
       </revision>
+      <revision>
+        <revnumber>1.01</revnumber>
+        <date>07.01.2010</date>
+        <author>
+          <surname>Klaus Rieger</surname>
+        </author>
+        <revdescription>
+          <para>an V1.1.2386 angepasst</para>
+        </revdescription>
+      </revision>
     </revhistory>
   </chapterinfo>
   <title>Ansichten</title>
@@ -64,7 +74,7 @@
     <para>Die Listenansicht zeigt tabellarisch die Caches im ausgew?hlten
     Profil an. Welche Spalten sichtbar sind ,l??t sich in den Einstellungen
     konfigurieren (siehe <xref linkend="einstellungListe"/>). Ein Doppelklick
-    auf eine Zeile ?ffnet die Beschreibung zu dem Cache.</para>
+    auf eine Zeile ?ffnet die Beschreibung zu dem Cache (siehe Section <xref linkend="Beschreibungsansicht"/> )</para>
     <para><inlinemediaobject>
         <imageobject>
           <imagedata fileref="pics/ansicht_liste.jpg"/>
@@ -97,8 +107,12 @@
       </inlinemediaobject> l??t sich ein- und auschalten. Der Filter <xref linkend="filter"/> wird hier ausf?hrlich beschrieben.</para>
     <para>Durch einen Klick auf den Spaltenkopf wird die Tabelle neu
     sortiert., z.B. nach der Entfernung zum Zentrum. Zuerst aufsteigend und
-    dann absteigend, oder andersherum, je nachdem &quot;wo&quot; man angefangen hat. Die
-    Spaltenbreite l??t sich ebenfalls ver?ndern.</para>
+    dann absteigend, oder andersherum, je nachdem &quot;wo&quot; man angefangen hat. Die Sortierrichtung wird durch einen Marker   <inlinemediaobject>
+        <imageobject>
+          <imagedata fileref="pics/sortierrichtung.jpg"/>
+        </imageobject>
+      </inlinemediaobject> vor dem Spaltennamen angezeigt. Die
+    Spaltenbreite l??t sich durch Klicken und Verschieben der Spaltentrennlinien ebenfalls ver?ndern.</para>
     <para id="WegpunktStatus"><emphasis role="bold">In der Listenansicht k?nnen einzelne Zeilen mit Farben hinterlegt sein:</emphasis></para>
     <itemizedlist>
       <listitem>
@@ -204,21 +218,26 @@
           in der Listenansicht an.</para>
         </listitem>
         <listitem>
+          <para><literal>Addis einblenden</literal> zeigt die zugeh?rigen Additional Waypoints f?r einen Cache an, wenn mittels Filter die Addis ausgeblendet sind. Der Text ?ndert sich dann zu <literal>Addis ausblenden</literal> damit k?nnen die angezeigten Additional Waypoints wieder ausgeblendet werden. Hat man in den Einstellungen zur Listenansicht die Spalte <literal># Addis</literal> eingeblendet, dann kann man bei jedem Hauptwegpunkt sehen, ob und wieviele zugeh?rige Additional Waypoints vorhanden sind (in der Spalte &quot;A&quot;)</para>
+        </listitem>
+        <listitem>
           <para><literal>Im Browser online ?ffnen</literal>: Die originale
           Cachebeschreibung wird von geocaching.com oder opencaching.de
           gezeigt. Ben?tigt eine online-Verbindung. Die Daten in Cachewolf
-          werden hierbei nicht aktualisiert! In der Java Version wird dies
-          nicht funktionieren, da aktuell ein Bug in der EWE VM vorhanden
-          ist.</para>
+          werden hierbei nicht aktualisiert! </para>
         </listitem>
         <listitem>
           <para><literal>Im Browser offline ?ffnen</literal>: Die
           Cachebeschreibung wird in dem Browser, der in den Pr?ferenzen
-          eingestellt wurde, dargestellt. In der Java Version wird dies nicht
-          funktionieren, da aktuell ein Bug in der EWE VM vorhanden
-          ist.</para>
+          eingestellt wurde, dargestellt. </para>
         </listitem>
         <listitem>
+          <para><literal>Im Browser online loggen</literal> ?ffnet im eingestellten Browser die Logseite des angew?hlten Caches.</para>
+        </listitem>
+        <listitem>
+          <para><literal>In Googlemaps ?ffnen</literal> ?ffnet im eingestellten Browser Google Maps und zeigt f?r den angew?hlten Wegpunkt (sofern dieser Koordinaten besitzt) einen Marker auf der Karte an. Hat der Wegpunkt keine Koordinaten ?ffnet sich der Browser nicht.</para>
+        </listitem>
+        <listitem>
           <para><literal>Markierte l?schen</literal>: Es werden alle Wegpunkte
           gel?scht, die mit einem H?kchen versehen sind. Bevor die Wegpunkte
           tats?chlich gel?scht werden, erfolgt noch eine Sicherheitsabfrage in
@@ -396,7 +415,7 @@
       </inlinemediaobject></para>
   </section>
   <section>
-    <title>Beschreibung</title>
+    <title id="Beschreibungsansicht">Beschreibung</title>
     <para>Die Beschreibung erfolgt weitestgehend in HTML. Bilder werden, falls
     m?glich, ebenfalls angezeigt. Ansonsten kann man sich die Bilder auch
     einzeln in der Bilderansicht (n?chster Reiter) anschauen.</para>

Modified: trunk/docs/CacheWolf Doku/pics/ansicht_liste.jpg
===================================================================
(Binary files differ)

Modified: trunk/docs/CacheWolf Doku/pics/list_popup.jpg
===================================================================
(Binary files differ)

Modified: trunk/docs/CacheWolf Doku/pics/spider_gc.jpg
===================================================================
(Binary files differ)

Modified: trunk/docs/CacheWolf Doku/pics/statusleiste.jpg
===================================================================
(Binary files differ)



From araber95 at mail.berlios.de  Sat Jan  9 20:53:02 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Sat, 9 Jan 2010 20:53:02 +0100
Subject: [Cachewolf-svn] r2396 - in trunk: res_noewe/languages
	src/CacheWolf/imp
Message-ID: <201001091953.o09Jr2Xh002399@sheep.berlios.de>

Author: araber95
Date: 2010-01-09 20:52:58 +0100 (Sat, 09 Jan 2010)
New Revision: 2396

Modified:
   trunk/res_noewe/languages/DE.cfg
   trunk/res_noewe/languages/EN.cfg
   trunk/res_noewe/languages/FR.cfg
   trunk/res_noewe/languages/NL.cfg
   trunk/res_noewe/languages/PL.cfg
   trunk/src/CacheWolf/imp/OCXMLImporter.java
Log:
reverting OCXMLImporter.java

Modified: trunk/res_noewe/languages/DE.cfg
===================================================================
--- trunk/res_noewe/languages/DE.cfg	2010-01-07 00:14:47 UTC (rev 2395)
+++ trunk/res_noewe/languages/DE.cfg	2010-01-09 19:52:58 UTC (rev 2396)
@@ -441,7 +441,7 @@
 		1603=Karten laden
 		1604=Abbrechen
 		1605=OK
-		1606=OC ignoriere Akt.Datum
+		1606=OC alle neu laden
 		1607=Update von opencaching erfolgreich
 		1608=Daten von opencaching laden...
 		1609=Importiere Cache:
@@ -466,6 +466,7 @@
 		1628=min. Abstand:
 		1629=Richtung (leer/N/N*/N,NE,E):
 		1630=z.B. leer oder N oder N* oder N,NE,E
+		1631=Max. Updates:
 		1700=Fehler in Zeile:
 		1701=Spalte:
 		1702=Variable nicht definiert:

Modified: trunk/res_noewe/languages/EN.cfg
===================================================================
--- trunk/res_noewe/languages/EN.cfg	2010-01-07 00:14:47 UTC (rev 2395)
+++ trunk/res_noewe/languages/EN.cfg	2010-01-09 19:52:58 UTC (rev 2396)
@@ -441,7 +441,7 @@
 		1603=Download maps
 		1604=Cancel
 		1605=OK
-		1606=OC ignore act.date
+		1606=OC reload all
 		1607=Update from opencaching successful
 		1608=Downloading data from opencaching...
 		1609=Importing Cache:
@@ -466,6 +466,7 @@
 		1628=min. Distance:
 		1629=Direction (empty/N/N*/N,NE,E):
 		1630=e.g. blank or N or N* or N,NE,E
+		1631=Max. updates:
 		1700=Error on line:
 		1701= position:
 		1702=Variable not defined:

Modified: trunk/res_noewe/languages/FR.cfg
===================================================================
--- trunk/res_noewe/languages/FR.cfg	2010-01-07 00:14:47 UTC (rev 2395)
+++ trunk/res_noewe/languages/FR.cfg	2010-01-09 19:52:58 UTC (rev 2396)
@@ -438,7 +438,7 @@
 		1603=T%e9l%e9charger cartes
 		1604=Annuler
 		1605=OK
-		1606=OC ignorer mise %e0 jour
+		1606=OC recharger tous
 		1607=Mise %e0 jour par opencaching r%e9ussi
 		1608=T%e9l%e9chargant donn%e9es par opencaching...
 		1609=Importe Cache:
@@ -463,6 +463,7 @@
 		1628=min. Distance:
 		1629=Direction (vide/N/N*/N,NE,E):
 		1630=par exemple nulle ou N ou N* ou N,NE,E
+		1631=max. Mises %e0 jour:
 		1700=Erreur en lingne:
 		1701=Colonne:
 		1702=Variable pas d%e9fini:

Modified: trunk/res_noewe/languages/NL.cfg
===================================================================
--- trunk/res_noewe/languages/NL.cfg	2010-01-07 00:14:47 UTC (rev 2395)
+++ trunk/res_noewe/languages/NL.cfg	2010-01-09 19:52:58 UTC (rev 2396)
@@ -417,7 +417,7 @@
 		1603=Download kaarten
 		1604=Annuleren
 		1605=OK
-		1606=OC negeren actueel
+		1606=OC reload all
 		1607=Update van Opencaching.de is gelukt.
 		1608=Download data van Opencaching.de.
 		1609=Importeren cache
@@ -442,6 +442,7 @@
 		1628=max. Afstand:
 		1629=Richting (leeg/N/N*/N,NE,E):
 		1630=bv. blanco of N of N* of N,NE,E
+		1631=Max. Updates:
 		1700=Fout in lijn:
 		1701=Positie:
 		1702=Variabele niet gedefinieerd.

Modified: trunk/res_noewe/languages/PL.cfg
===================================================================
--- trunk/res_noewe/languages/PL.cfg	2010-01-07 00:14:47 UTC (rev 2395)
+++ trunk/res_noewe/languages/PL.cfg	2010-01-09 19:52:58 UTC (rev 2396)
@@ -440,7 +440,7 @@
                 1603=Sciagnij mapy
                 1604=Anuluj
                 1605=OK
-                1606=OC ignorowac Data aktualizacji
+                1606=OC Odswiez wszystkie
                 1607=Update Z opencaching udany
                 1608=Sciagam dane Z opencaching...
                 1609=Importuje Skrzynke:
@@ -465,6 +465,7 @@
                 1628=min. Odleglosc:
                 1629=Kierunek (pusty/N/N*/N,NE,E):
                 1630=np. puste lub N lub N* lub N,S,E
+                1631=Max. Aktualizacje:
                 1700=Blad on line:
                 1701= pozycja:
                 1702=Zmienna niezdefiniowana:

Modified: trunk/src/CacheWolf/imp/OCXMLImporter.java
===================================================================
--- trunk/src/CacheWolf/imp/OCXMLImporter.java	2010-01-07 00:14:47 UTC (rev 2395)
+++ trunk/src/CacheWolf/imp/OCXMLImporter.java	2010-01-09 19:52:58 UTC (rev 2396)
@@ -137,13 +137,11 @@
 			return true;
 		}
 
-		/*
 		inf = new InfoBox("Opencaching download", MyLocale.getMsg(1608,"downloading data\n from " + hostname), InfoBox.PROGRESS_WITH_WARNINGS, false);
 		inf.setPreferredSize(220, 300);
 		inf.relayout(false);
 		inf.exec();
-		*/
-		
+
 		String lastS;
 		/** pref.downloadmissingOC = true, if not the last syncdate shall be used,
 		 *  but the caches shall be reloaded



From araber95 at mail.berlios.de  Sat Jan  9 21:19:27 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Sat, 9 Jan 2010 21:19:27 +0100
Subject: [Cachewolf-svn] r2397 - in trunk: res_noewe src/CacheWolf/imp
Message-ID: <201001092019.o09KJRfn003882@sheep.berlios.de>

Author: araber95
Date: 2010-01-09 21:19:24 +0100 (Sat, 09 Jan 2010)
New Revision: 2397

Modified:
   trunk/res_noewe/spider.def
   trunk/src/CacheWolf/imp/OCXMLImporterScreen.java
   trunk/src/CacheWolf/imp/SpiderGC.java
Log:
new founds stop if all found. update checks for new logs.

Modified: trunk/res_noewe/spider.def
===================================================================
--- trunk/res_noewe/spider.def	2010-01-09 19:52:58 UTC (rev 2396)
+++ trunk/res_noewe/spider.def	2010-01-09 20:19:24 UTC (rev 2397)
@@ -56,8 +56,8 @@
 # Regex to search for cachenames
 listBlockRex       = <table id="ctl00_ContentBody_dlResults"((?s).*?)</table>
 lineRex            = <tr\ bgcolor='#.{6}'>(?:(?s).*?)<td\ valign="top"\ align="left">((?s).*?)</tr>
-directionRex       = /compass/(.*?).gif" alt="
-distRex            = <br\ />(.*?)(?:km|mi)(?:\\s*)</td>
+directionRex       = /compass/(.*?).gif
+distRex            = <br\ />(.*?)(?:km|mi)
 waypointRex        = \\(GC(.*?)\\)<br\ />
 showOnlyFound      = &f=1
 maxDistance        = &dist=

Modified: trunk/src/CacheWolf/imp/OCXMLImporterScreen.java
===================================================================
--- trunk/src/CacheWolf/imp/OCXMLImporterScreen.java	2010-01-09 19:52:58 UTC (rev 2396)
+++ trunk/src/CacheWolf/imp/OCXMLImporterScreen.java	2010-01-09 20:19:24 UTC (rev 2397)
@@ -26,6 +26,7 @@
 	mInput minDistanceInput;
 	mInput directionInput;
 	mInput maxNumberInput;
+	mInput maxNumberUpdates;
 	mInput maxLogsInput;
 	mCheckBox imagesCheckBox, /*mapsCheckBox, */ missingCheckBox, foundCheckBox, travelbugsCheckBox;
 	ewe.ui.mChoice domains;
@@ -46,6 +47,7 @@
 	public static final int HOST = 512;
 	public static final int MINDIST = 1024;
 	public static final int DIRECTION = 2048;
+	public static final int MAXUPDATE = 4096;
 
 
 	public OCXMLImporterScreen(String title, int options) {
@@ -128,6 +130,14 @@
 			this.addLast( new mLabel(MyLocale.getMsg(1624," caches")),CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.WEST));
 		}
 
+		if ((options & MAXUPDATE) > 0) {
+			this.addNext(new mLabel(MyLocale.getMsg(1631,"Max. Updates:")),CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.WEST));
+			maxNumberUpdates = new mInput();
+			maxNumberUpdates.setText("");
+			this.addNext(maxNumberUpdates,CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.WEST));
+			this.addLast( new mLabel(MyLocale.getMsg(1624," caches")),CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.WEST));
+		}
+
 		if ((options & MAXLOGS) > 0) {
 			this.addNext(new mLabel(MyLocale.getMsg(1626,"Max. logs:")),CellConstants.DONTSTRETCH, (CellConstants.DONTFILL|CellConstants.WEST));
 			maxLogsInput = new mInput();

Modified: trunk/src/CacheWolf/imp/SpiderGC.java
===================================================================
--- trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-09 19:52:58 UTC (rev 2396)
+++ trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-09 20:19:24 UTC (rev 2397)
@@ -84,19 +84,40 @@
 	private static int ERR_LOGIN = -10;
 	private static Preferences pref;
 	private Profile profile;
-	private static String viewstate = "";
+
 	private static String cookieID = "";
 	private static String cookieSession = "";
 	private static double minDistance = 0;
 	private static double maxDistance = 0;
 	private static String direction = "";
 	private static String[] directions;
-	private Regex inRex = new Regex();
 	private CacheDB cacheDB;
 	private Vector cachesToLoad = new Vector();
 	private InfoBox infB;
 	private static SpiderProperties p=null;
+	// following filled at doit
+	private CWPoint origin;
+	private double saveDistanceInMiles;
+	private boolean doNotgetFound;
+	private String cacheTypeRestriction;
+	private boolean spiderAllFinds;
+	private int page_number;
+	private int found_on_page;
+	private String htmlListPage;
+	private int maxNew;
+	private int maxUpdate;
+	private boolean maxNumberAbort;
 
+	private static String propFirstPage;
+	private static String propFirstPage2;
+	private static String propFirstPageFinds;
+	private static String propFirstLine;
+	private static String propFirstLine2;
+	private static String propMaxDistance;
+	private static String propShowOnlyFound;
+	private static String propListBlockRex;
+	private static String propLineRex;
+
 	public SpiderGC(Preferences prf, Profile profile, boolean bypass){
 		this.profile=profile;
 		this.cacheDB = profile.cacheDB;
@@ -108,238 +129,14 @@
 	}
 
 	/**
-	 * Method to login the user to gc.com
-	 * It will request a password and use the alias defined in preferences
-	 * If the login page cannot be fetched, the password is cleared.
-	 * If the login fails, an appropriate message is displayed.
-	 */
-	public int login(){
-		loggedIn = false;
-		String start,loginPage,loginSuccess,nextPage;
-		try {
-			loginPage=p.getProp("loginPage");
-			loginSuccess=p.getProp("loginSuccess");
-			nextPage=p.getProp("nextPage");
-		} catch (Exception ex) { // Tag not found in spider.def
-			return ERR_LOGIN;
-		}
-		//Get password
-		InfoBox localInfB = new InfoBox(MyLocale.getMsg(5506,"Password"), MyLocale.getMsg(5505,"Enter Password"), InfoBox.INPUT);
-		localInfB.feedback.setText(passwort); // Remember the PWD for next time
-		localInfB.feedback.isPassword=true;
-		int code=FormBase.IDOK;
-		if (passwort.equals("")) {
-			code = localInfB.execute();
-			passwort = localInfB.getInput();
-		}
-		localInfB.close(0);
-		if(code != FormBase.IDOK) return code;
-		// Now start the login proper
-		localInfB = new InfoBox(MyLocale.getMsg(5507,"Status"), MyLocale.getMsg(5508,"Logging in..."));
-		localInfB.exec();
-		try{
-			pref.log("[login]:Fetching login page");
-			//Access the page once to get a viewstate
-			start = fetch(loginPage);   //http://www.geocaching.com/login/Default.aspx
-			if (start.equals("")) {
-				localInfB.close(0);
-				(new MessageBox(MyLocale.getMsg(5500,"Error"), MyLocale.getMsg(5499,"Error loading login page.%0aPlease check your internet connection."), FormBase.OKB)).execute();
-				pref.log("[login]:Could not fetch: gc.com login page");
-				return ERR_LOGIN;
-			}
-		} catch(Exception ex){
-			localInfB.close(0);
-			(new MessageBox(MyLocale.getMsg(5500,"Error"), MyLocale.getMsg(5499,"Error loading login page.%0aPlease check your internet connection."), FormBase.OKB)).execute();
-			pref.log("[login]:Could not fetch: gc.com login page",ex);
-			return ERR_LOGIN;
-		}
-		if (!localInfB.isClosed) { // If user has not aborted, we continue
-			Regex rexCookieID = new Regex("(?i)Set-Cookie: userid=(.*?);.*");
-			Regex rexViewstate = new Regex("id=\"__VIEWSTATE\" value=\"(.*?)\" />");
-			// Regex rexViewstate1 = new Regex("id=\"__VIEWSTATE1\" value=\"(.*?)\" />");
-			Regex rexEventvalidation = new Regex("id=\"__EVENTVALIDATION\" value=\"(.*?)\" />");
-			Regex rexCookieSession = new Regex("(?i)Set-Cookie: ASP.NET_SessionId=(.*?);.*");
-			rexViewstate.search(start);
-			if(rexViewstate.didMatch()){
-				viewstate = rexViewstate.stringMatched(1);
-				//Vm.debug("ViewState: " + viewstate);
-			} else
-				pref.log("[login]:Viewstate not found before login");
-
-			if(start.indexOf(loginSuccess) > 0)
-				pref.log("[login]:Already logged in");
-			else {
-				rexEventvalidation.search(start);
-				if(rexEventvalidation.didMatch()){
-					// eventvalidation = rexEventvalidation.stringMatched(1);
-					//Vm.debug("EVENTVALIDATION: " + eventvalidation);
-				} else
-					pref.log("[login]:Eventvalidation not found before login");
-				//Ok now login!
-				try{
-					pref.log("[login]:Logging in as "+pref.myAlias);
-					StringBuffer sb=new StringBuffer(1000);
-					sb.append(URL.encodeURL("__VIEWSTATE",false));	sb.append("="); sb.append(URL.encodeURL(viewstate,false));
-					sb.append("&ctl00%24ContentBody%24"); sb.append(URL.encodeURL("myUsername",false));
-					sb.append("="); sb.append(encodeUTF8URL(Utils.encodeJavaUtf8String(pref.myAlias)));
-					sb.append("&ctl00%24ContentBody%24"); sb.append(URL.encodeURL("myPassword",false));
-					sb.append("="); sb.append(encodeUTF8URL(Utils.encodeJavaUtf8String(passwort)));
-					sb.append("&ctl00%24ContentBody%24"); sb.append(URL.encodeURL("cookie",false));
-					sb.append("="); sb.append(URL.encodeURL("on",false));
-					sb.append("&ctl00%24ContentBody%24"); sb.append(URL.encodeURL("Button1",false));
-					sb.append("="); sb.append(URL.encodeURL("Login",false));
-//					sb.append("&"); sb.append(URL.encodeURL("__EVENTVALIDATION",false));
-//					sb.append("="); sb.append(URL.encodeURL(eventvalidation,false));
-					start = fetch_post(loginPage, sb.toString(), nextPage);  // /login/default.aspx
-					if(start.indexOf(loginSuccess) > 0)
-						pref.log("[login]:Login successful");
-					else {
-						pref.log("[login]:Login failed. Wrong Account or Password?");
-						if (pref.debug) {
-							pref.log("[login.LoginUrl]:"+sb.toString());
-							pref.log("[login.Answer]:"+start);
-						}
-						localInfB.close(0);
-						(new MessageBox(MyLocale.getMsg(5500,"Error"), MyLocale.getMsg(5501,"Login failed! Wrong account or password?"), FormBase.OKB)).execute();
-						return ERR_LOGIN;
-					}
-				}catch(Exception ex){
-					pref.log("[login]:Login failed with exception.", ex);
-					localInfB.close(0);
-					(new MessageBox(MyLocale.getMsg(5500,"Error"), MyLocale.getMsg(5501,"Login failed. Error loading page after login."), FormBase.OKB)).execute();
-					return ERR_LOGIN;
-				}
-			}
-
-			rexViewstate.search(start);
-			if (!rexViewstate.didMatch()) {
-				pref.log("[login]:Viewstate not found");
-			}
-			viewstate = rexViewstate.stringMatched(1);
-
-			/*
-			rexViewstate1.search(start);
-			if (!rexViewstate1.didMatch()) {
-				pref.log("[login]:Viewstate1 not found");
-			}
-			*/
-
-			rexCookieID.search(start);
-			if (!rexCookieID.didMatch()) {
-				pref.log("[login]:CookieID not found. Using old one.");
-			} else
-				cookieID = rexCookieID.stringMatched(1);
-			//Vm.debug(cookieID);
-			rexCookieSession.search(start);
-			if (!rexCookieSession.didMatch()) {
-				pref.log("[login]:CookieSession not found. Using old one.");
-				//cookieSession="";
-			} else
-				cookieSession = rexCookieSession.stringMatched(1);
-			//Vm.debug("cookieSession = " + cookieSession);
-		}
-		boolean loginAborted=localInfB.isClosed;
-		localInfB.close(0);
-		if (loginAborted)
-			return FormBase.IDCANCEL;
-		else {
-			loggedIn = true;
-			return FormBase.IDOK;
-		}
-	}
-
-	/**
-	 * Method to spider a single cache.
-	 * It assumes a login has already been performed!
-	 * @return 1 if spider was successful, -1 if spider was cancelled by closing the infobox, 0 error, but continue with next cache
-	 */
-	public int spiderSingle(int number, InfoBox pInfB, boolean forceLogin, boolean loadAllLogs){
-		int ret=-1;
-		this.infB = pInfB;
-		CacheHolder ch = new CacheHolder(); // cacheDB.get(number);
-		ch.setWayPoint(cacheDB.get(number).getWayPoint());
-		if (ch.isAddiWpt()) return -1;  // No point re-spidering an addi waypoint, comes with parent
-
-		// check if we need to login
-		if (!loggedIn || forceLogin){
-			if (this.login()!=FormBase.IDOK) return -1;
-			// loggedIn is already set by this.login()
-		}
-		try{
-			// Read the cache data from GC.COM and compare to old data
-			ret=getCacheByWaypointName(ch,true,pref.downloadPics,pref.downloadTBs,false,loadAllLogs);
-			// Save the spidered data
-			if (ret == SPIDER_OK) {
-				CacheHolder cacheInDB = cacheDB.get(number);
-				cacheInDB.initStates(false);
-				if (cacheInDB.is_found() && !ch.is_found() && ! loadAllLogs) {
-					// If the number of logs to spider is 5 or less, then the "not found" information
-					// of the spidered cache is not credible. In this case it should not overwrite
-					// the "found" state of an existing cache.
-					ch.setFound(true);
-				}
-				// preserve rating information
-				ch.setNumRecommended(cacheInDB.getNumRecommended());
-				if (pref.downloadPics) {
-					// delete obsolete images when we have current set
-					CacheImages.cleanupOldImages(cacheInDB.getExistingDetails().images, ch.getFreshDetails().images);
-				} else {
-					// preserve images if not downloaded
-					ch.getFreshDetails().images = cacheInDB.getExistingDetails().images;
-				}
-				cacheInDB.update(ch);
-				cacheInDB.save();
-			}
-		}catch(Exception ex){
-			pref.log("Error spidering " + ch.getWayPoint() + " in spiderSingle");
-		}
-		return ret;
-	} // spiderSingle
-
-	/**
-	 * Fetch the coordinates of a waypoint from GC
-	 * @param wayPoint the name of the waypoint
-	 * @return the cache coordinates
-	 */
-	public String getCacheCoordinates(String wayPoint) {
-		String completeWebPage;
-		// Check whether spider definitions could be loaded, if not issue appropriate message and terminate
-		// Try to login. If login fails, issue appropriate message and terminate
-		if (!loggedIn || Global.getPref().forceLogin) {
-			if (login()!=FormBase.IDOK) {
-				return "";
-			}
-		}
-		InfoBox localInfB = new InfoBox("Info", "Loading", InfoBox.PROGRESS_WITH_WARNINGS);
-		localInfB.exec();
-		try{
-			String doc = p.getProp("waypoint") + wayPoint;
-			pref.log("Fetching: " + wayPoint);
-			completeWebPage = fetch(doc);
-		}catch(Exception ex){
-			localInfB.close(0);
-			pref.log("Could not fetch " + wayPoint,ex);
-			return "";
-		}
-		localInfB.close(0);
-		try {
-			return getLatLon(completeWebPage);
-		} catch (Exception ex) {
-			return "????";
-		}
-	}
-
-	/**
 	*	Method to start the spider for a search around the centre coordinates
 	*/
 	public void doIt(){
 		doIt(false);
 	}
-	public void doIt(boolean spiderAllFinds){
-		String postStr, dummy, ln, wpt;
-		Regex lineRex;
-		CacheHolder holder;
-		CWPoint origin = pref.getCurCentrePt(); // No need to copy curCentrePt as it is only read and not written
+	public void doIt(boolean _spiderAllFinds){
+		spiderAllFinds=_spiderAllFinds;
+		origin = pref.getCurCentrePt(); // No need to copy curCentrePt as it is only read and not written
 		if ( !spiderAllFinds && !origin.isValid()) {
 			(new MessageBox(MyLocale.getMsg(5500,"Error"), MyLocale.getMsg(5509,"Coordinates for centre must be set"), FormBase.OKB)).execute();
 			return;
@@ -352,27 +149,44 @@
 			ch = cacheDB.get(i);
 			if (ch.mainCache==null) ch.initStates(false);
 		}
-		String start = "";
-		Regex rexViewstate = new Regex("id=\"__VIEWSTATE\" value=\"(.*)\" />");
-		// Regex rexViewstate1 = new Regex("id=\"__VIEWSTATE1\" value=\"(.*)\" />");
-		Regex rexEventvalidation = new Regex("id=\"__EVENTVALIDATION\" value=\"(.*)\" />");
-		String doc = "";
 
 		if (!loggedIn || Global.getPref().forceLogin) {
 			if(login() != FormBase.IDOK) return;
 		}
 
-		boolean doNotgetFound = false;
+		doNotgetFound = false;
 
 		OCXMLImporterScreen options;
 		if (spiderAllFinds) {
-			options = new OCXMLImporterScreen(MyLocale.getMsg(5510,"Spider Options"), OCXMLImporterScreen.MAXNUMBER|OCXMLImporterScreen.IMAGES| OCXMLImporterScreen.ISGC| OCXMLImporterScreen.TRAVELBUGS| OCXMLImporterScreen.MAXLOGS| OCXMLImporterScreen.TYPE);
+			options = new OCXMLImporterScreen(MyLocale.getMsg(5510,"Spider Options"),
+					OCXMLImporterScreen.MAXNUMBER|
+					OCXMLImporterScreen.MAXUPDATE|
+					OCXMLImporterScreen.IMAGES|
+					OCXMLImporterScreen.ISGC|
+					OCXMLImporterScreen.TRAVELBUGS);
+
+			options.maxNumberUpdates.setText("0"); // no updates for founds
+
 			if (options.execute() == FormBase.IDCANCEL) {return; }
 			maxDistance = 1;
 			minDistance = 0;
 			direction="";
 		} else {
-			options = new OCXMLImporterScreen(MyLocale.getMsg(5510,"Spider Options"),	OCXMLImporterScreen.MAXNUMBER|OCXMLImporterScreen.INCLUDEFOUND | OCXMLImporterScreen.MINDIST| OCXMLImporterScreen.DIST| OCXMLImporterScreen.DIRECTION| OCXMLImporterScreen.IMAGES| OCXMLImporterScreen.ISGC| OCXMLImporterScreen.TRAVELBUGS| OCXMLImporterScreen.MAXLOGS| OCXMLImporterScreen.TYPE);
+			options = new OCXMLImporterScreen(MyLocale.getMsg(5510,"Spider Options"),
+					OCXMLImporterScreen.MAXNUMBER|
+					OCXMLImporterScreen.MAXUPDATE|
+					OCXMLImporterScreen.INCLUDEFOUND|
+					OCXMLImporterScreen.MINDIST|
+					OCXMLImporterScreen.DIST|
+					OCXMLImporterScreen.DIRECTION|
+					OCXMLImporterScreen.IMAGES|
+					OCXMLImporterScreen.ISGC|
+					OCXMLImporterScreen.TRAVELBUGS|
+					OCXMLImporterScreen.MAXLOGS|
+					OCXMLImporterScreen.TYPE);
+
+			if (pref.spiderUpdates == Preferences.NO) {options.maxNumberUpdates.setText("0");} // no updates else all
+
 			if (options.execute() == FormBase.IDCANCEL) {return; }
 
 			String minDist = options.minDistanceInput.getText();
@@ -403,27 +217,36 @@
 		}
 		directions=mString.split(direction, ',');
 
-		int maxNumber = -1;
+		maxNew = -1;
 		String maxNumberString = options.maxNumberInput.getText();
 		if (maxNumberString.length()!= 0) {
-			maxNumber = Common.parseInt(maxNumberString);
+			maxNew = Common.parseInt(maxNumberString);
 		}
-		if (maxNumber != pref.maxSpiderNumber) {
-			pref.maxSpiderNumber = maxNumber;
+		if (maxNew != pref.maxSpiderNumber) {
+			pref.maxSpiderNumber = maxNew;
 			pref.savePreferences();
 		}
-		if (maxNumber == 0) return;
-		boolean maxNumberAbort = false;
 
+		maxUpdate = -1;
+		String maxUpdateString = options.maxNumberUpdates.getText();
+		if (maxUpdateString.length()!= 0) {
+			maxUpdate = Common.parseInt(maxUpdateString);
+		}
+		// TODO maxUpdate in preferences ?
+		
+		if (maxNew == 0) return;
+		if(maxNew==-1) maxNew=Integer.MAX_VALUE;
+		if(maxUpdate==-1) maxUpdate=Integer.MAX_VALUE;
+
 		boolean getImages = options.imagesCheckBox.getState();
 		boolean getTBs = options.travelbugsCheckBox.getState();
 
-		String cacheTypeRestriction = options.getCacheTypeRestriction(p);
-
+		cacheTypeRestriction = options.getCacheTypeRestriction(p);
+		byte restrictedCacheType = options.getRestrictedCacheType(p);
 		options.close(0);
 
 		//max distance in miles for URL, so we can get more than 80km
-		double saveDistanceInMiles = maxDistance;
+		saveDistanceInMiles = maxDistance;
 		if ( Global.getPref().metricSystem != Metrics.IMPERIAL ) {
 			saveDistanceInMiles = Metrics.convertUnit(maxDistance, Metrics.KILOMETER, Metrics.MILES);
 		}
@@ -431,29 +254,24 @@
 		saveDistanceInMiles = java.lang.Math.ceil(saveDistanceInMiles) + 1;
 
 		Hashtable cachesToUpdate = new Hashtable(cacheDB.size());
+		Hashtable cachesShouldUpdate = new Hashtable(cacheDB.size()); // for don't loose the already done work
 
-		if (pref.spiderUpdates != Preferences.NO) {
+		if (maxUpdate==Integer.MAX_VALUE) {
 			double distanceInKm = maxDistance;
 			if ( Global.getPref().metricSystem == Metrics.IMPERIAL ) {
 				distanceInKm = Metrics.convertUnit(maxDistance, Metrics.MILES, Metrics.KILOMETER);
 			}
-			double minDistanceInKm = minDistance;
-			if ( Global.getPref().metricSystem == Metrics.IMPERIAL ) {
-				minDistanceInKm = Metrics.convertUnit(minDistance, Metrics.MILES, Metrics.KILOMETER);
-			}
-
-			byte restrictedCacheType = options.getRestrictedCacheType(p);
+			// to get in meantime possibly archived caches
 			for(int i = 0; i<cacheDB.size();i++){
 				ch = cacheDB.get(i);
 				if (spiderAllFinds) {
 					if ( (ch.getWayPoint().substring(0,2).equalsIgnoreCase("GC"))
-					     && ( (restrictedCacheType == CacheType.CW_TYPE_ERROR) || (ch.getType() == restrictedCacheType) )
 					     && !ch.is_black() ) {
 						cachesToUpdate.put(ch.getWayPoint(), ch);
 					}
 				} else {
 					if ( (!ch.is_archived())
-						 && (ch.kilom <= distanceInKm) /*&& (ch.kilom >= minDistanceInKm)*/
+						 && (ch.kilom <= distanceInKm)
 						 && !(doNotgetFound && (ch.is_found() || ch.is_owned()))
 						 && (ch.getWayPoint().substring(0,2).equalsIgnoreCase("GC"))
 						 && ( (restrictedCacheType == CacheType.CW_TYPE_ERROR) || (ch.getType() == restrictedCacheType) )
@@ -467,178 +285,95 @@
 		//=======
 		// Prepare list of all caches that are to be spidered
 		//=======
-		Vm.showWait(true);
-		infB = new InfoBox("Status", MyLocale.getMsg(5502,"Fetching first page..."));
-		infB.exec();
-		//Get first page
-		try{
-			if (spiderAllFinds) {
-				ln = p.getProp("firstPageFinds") + encodeUTF8URL(Utils.encodeJavaUtf8String(pref.myAlias));
-			} else {
-				ln = p.getProp("firstPage") + origin.getLatDeg(TransformCoordinates.DD) + p.getProp("firstPage2") + origin.getLonDeg(TransformCoordinates.DD)
-			                              + p.getProp("maxDistance") + Integer.toString( (int)saveDistanceInMiles );
-				if(doNotgetFound) ln = ln + p.getProp("showOnlyFound");
-			}
-			ln = ln + cacheTypeRestriction;
-			pref.log("Getting first page: "+ln);
-			start = fetch(ln);
-			pref.log("Got first page");
-		}catch(Exception ex){
-			pref.log("Error fetching first list page",ex,true);
-			Vm.showWait(false);
-			infB.close(0);
-			(new MessageBox(MyLocale.getMsg(5500,"Error"), MyLocale.getMsg(5503,"Error fetching first list page."), FormBase.OKB)).execute();
-			return;
+		initialiseProperties();
+		getFirstListPage();
+
+		int numFinds=0; // spiderAllFinds : Number of GC-founds for this user
+		int numFoundInDB=0; // Number of GC-founds already in this profile
+		if (spiderAllFinds) {
+			numFoundInDB=getFoundInDB();
+			numFinds=getNumFound(htmlListPage);
+			maxNew=java.lang.Math.min(numFinds-numFoundInDB,maxNew);
+			if (maxUpdate==0 && maxNew == 0) { Vm.showWait(false); infB.close(0); return; }
 		}
-		dummy = "";
-		//String lineBlck = "";
-		int page_number = 1;
-		try  {
-			lineRex = new Regex(p.getProp("lineRex")); //"<tr bgcolor=((?s).*?)</tr>"
-		} catch (Exception ex) {
-			infB.close(0);
-			Vm.showWait(false);
-			return;
-		}
-		int page = 0;
-		int found_on_page = 0;
+		
+		String[] cacheDescGC;
+		int anzLines=38;
+		int lineDistance=1;
+		int lineDirection=1;
+		int lineWaypoint=22;
+		int lineDescription=20;
+		int lineLastFound=27;
+		Regex lineRex = new Regex(propLineRex);
 		try {
-			//Loop till maximum distance has been found or no more caches are in the list
+			//Loop pages till maximum distance has been found or no more caches are in the list
 			while(maxDistance > 0){
-				if (infB.isClosed){
-					//don't update existing caches, because list is not correct when aborting
-					cachesToUpdate.clear();
-
-					break;
-				}
-
-				rexViewstate.search(start);
-				if(rexViewstate.didMatch()){
-					viewstate = rexViewstate.stringMatched(1);
-					//Vm.debug("ViewState: " + viewstate);
-				} else {
-					viewstate = "";
-					pref.log("Viewstate not found");
-				}
-
-				rexEventvalidation.search(start);
-				if(rexEventvalidation.didMatch()){
-					// eventvalidation = rexEventvalidation.stringMatched(1);
-					//Vm.debug("EVENTVALIDATION: " + eventvalidation);
-				} else {
-					// eventvalidation = "";
-					// pref.log("Eventvalidation not found");
-				}
-
-				//Vm.debug("In loop");
-				Regex listBlockRex = new Regex(p.getProp("listBlockRex")); // "<table id=\"dlResults\"((?s).*?)</table>"
-				listBlockRex.search(start);
-				dummy = listBlockRex.stringMatched(1);
-				try{
-					lineRex.search(dummy);
-				}catch(NullPointerException nex){
-					Global.getPref().log("Ignored Exception", nex, true);
-				}
-				String oneCacheDesc="";
-				while ( maxDistance>0 && lineRex.didMatch()){
-					//Vm.debug(getDist(lineRex.stringMatched(1)) + " / " +getWP(lineRex.stringMatched(1)));
+				Regex listBlockRex = new Regex(propListBlockRex); // "<table id=\"dlResults\"((?s).*?)</table>"
+				listBlockRex.search(htmlListPage);
+				String tableOfHtmlListPage = listBlockRex.stringMatched(1);
+				lineRex.search(tableOfHtmlListPage);
+				while (maxDistance > 0){
+					if (!lineRex.didMatch()) break;
 					found_on_page++;
-					oneCacheDesc=lineRex.stringMatched(1);
-					double gotDistance=getDist(oneCacheDesc);
+					cacheDescGC=mString.split(lineRex.stringMatched(1),'\n');
+					if(cacheDescGC.length!=anzLines) {
+						maxDistance = 0; //add no more caches
+						(new MessageBox(MyLocale.getMsg(5500,"Error"), "GC changed table output \nCW must be changed too!", FormBase.OKB)).execute();
+						throw new Exception("GC changed table output");
+					}
+					double gotDistance=getDistGC(cacheDescGC[lineDistance]);
+					String chWaypoint=getWP(cacheDescGC[lineWaypoint]);
 					if(gotDistance <= maxDistance){
-					  String chWaypoint=getWP(oneCacheDesc);
 						ch=cacheDB.get(chWaypoint);
-						if(ch == null){
-						  if ( gotDistance >= minDistance && directionOK(directions,getDirection(oneCacheDesc)) ){
-								pref.log(chWaypoint+" added to load!");
+						if(ch == null){ // not in DB
+							if ( gotDistance >= minDistance &&
+								 directionOK(directions,getDirection(cacheDescGC[lineDirection])) ){
 								cachesToLoad.add(chWaypoint);
-								if ((maxNumber > 0) && (cachesToLoad.size() >= maxNumber)) {
-									maxNumberAbort = true;
-									maxDistance = 0; //add no more caches
-									cachesToUpdate.clear(); //don't update existing caches, because list is not correct when aborting
+								if(cachesToLoad.size()==maxNew) {
+									if(maxUpdate!=Integer.MAX_VALUE) maxDistance=0;
 								}
 							}
-						} else {
-							// if (pref.spiderUpdates != Preferences.NO) {
-							pref.log(chWaypoint+" already in DB");
-						  // If the <strike> tag is used, the cache is marked as unavailable or archived
-							boolean is_archived_GC=oneCacheDesc.indexOf("<strike><font color=\"red\">")!=-1;
-							boolean is_available_GC=oneCacheDesc.indexOf("<strike>")==-1;
-							// CacheHolderDetail det = ch.getCacheDetails(true);
-							if (ch.is_archived()!=is_archived_GC) { // Update the database with the cache status
-								pref.log("Updating status of "+chWaypoint+" to "+(is_archived_GC?"archived":"not archived"));
-								if ( ch.is_archived() ) {
-									// is not yet in updateList
-									cachesToUpdate.put(chWaypoint, ch);
+						}
+						else {
+							if (maxUpdate>0) {
+								boolean update=false;
+								if (spiderAllFinds) {
+									if(!ch.is_found()) { ch.setFound(true); update=true;}
+									boolean is_archived_GC=cacheDescGC[lineDescription].indexOf("<font color=\"red\"><strike>")!=-1;
+									if (is_archived_GC!=ch.is_archived()) { ch.setArchived(is_archived_GC); update=true;}
 								}
-								ch.setArchived(is_archived_GC);
-							} else if (ch.is_available()!=is_available_GC) { // Update the database with the cache status
-								pref.log("Updating status of "+chWaypoint+" to "+(is_available_GC?"available":"not available"));
-								ch.setAvailable(is_available_GC);
-							} else if (spiderAllFinds && !ch.is_found()) { // Update the database with the cache status
-								pref.log("Updating status of "+chWaypoint+" to found");
-								ch.setFound(true);
-							} else {
-								cachesToUpdate.remove( chWaypoint );
+								boolean is_available_GC=cacheDescGC[lineDescription].indexOf("<strike>")==-1;
+								if (is_available_GC != ch.is_available()) { ch.setAvailable(is_available_GC); update=true;}
+								if (newLogExists(ch,cacheDescGC[lineLastFound])) {update=true;}
+								if (update) {
+									cachesShouldUpdate.put(chWaypoint, ch);
+									if(cachesShouldUpdate.size()==maxUpdate) maxDistance=0;
+								}
+								else
+									if (maxUpdate==Integer.MAX_VALUE) cachesToUpdate.remove( chWaypoint );
 							}
-						// }
-  					}
-					} else maxDistance = 0;
-					// next Cache Description of this page
-					lineRex.searchFrom(dummy, lineRex.matchedTo());
-				}
-
-				page++;
-				infB.setInfo(MyLocale.getMsg(5521,"Page ") + page + "\n" + MyLocale.getMsg(5511,"Found ") + cachesToLoad.size() + MyLocale.getMsg(5512," caches"));
-
-				if(found_on_page < 20) maxDistance = 0;
-				if (spiderAllFinds) {
-					postStr = p.getProp("firstLine");
-				} else {
-					postStr = p.getProp("firstLine") + origin.getLatDeg(TransformCoordinates.DD) + p.getProp("firstLine2") + origin.getLonDeg(TransformCoordinates.DD)
-							                             + p.getProp("maxDistance") + Integer.toString( (int)saveDistanceInMiles );
-					if(doNotgetFound) postStr = postStr + p.getProp("showOnlyFound");
-				}
-				postStr = postStr + cacheTypeRestriction;
-				if(maxDistance > 0){
-					page_number++;
-					String strNextPage;
-					/*
-					if(page_number >= 15) page_number = 5;
-					if (page_number < 10) {
-						strNextPage = "ctl00$ContentBody$pgrTop$ctl0" + page_number;
-					} else {
-						strNextPage = "ctl00$ContentBody$pgrTop$ctl" + page_number;
-					}
-					*/
-					strNextPage = "ctl00$ContentBody$pgrTop$ctl08";
-
-					doc = URL.encodeURL("__EVENTTARGET",false) +"="+ URL.encodeURL(strNextPage,false)
-					    + "&" + URL.encodeURL("__EVENTARGUMENT",false) +"="+ URL.encodeURL("",false)
-//					    + "&" + URL.encodeURL("__VIEWSTATEFIELDCOUNT",false) +"=2"
-					    + "&" + URL.encodeURL("__VIEWSTATE",false) +"="+ URL.encodeURL(viewstate,false);
-//					    + "&" + URL.encodeURL("__VIEWSTATE1",false) +"="+ URL.encodeURL(viewstate1,false);
-//					    + "&" + URL.encodeURL("__EVENTVALIDATION",false) +"="+ URL.encodeURL(eventvalidation,false);
-					try{
-						start = "";
-						pref.log("Fetching next list page:" + doc);
-						start = fetch_post(postStr, doc, p.getProp("nextListPage"));
-					}catch(Exception ex){
-						//Vm.debug("Couldn't get the next page");
-						pref.log("Error getting next page");
-					}
-				}
-				//Vm.debug("Distance is now: " + distance);
-				found_on_page = 0;
-			}
-		} catch (Exception ex) { // Some tag missing from spider.def
+						}
+					} else maxDistance = 0; // finish listing
+					// get next row of table (next Cache Description) of this htmlListPage
+					lineRex.searchFrom(tableOfHtmlListPage, lineRex.matchedTo());
+					if (infB.isClosed) break;
+				} // next Cache
+				infB.setInfo(MyLocale.getMsg(5521,"Page ") + page_number + "\n" +
+							 MyLocale.getMsg(5511,"Found ") + cachesToLoad.size() + MyLocale.getMsg(5512," caches"));
+				if(found_on_page < 20) maxDistance = 0; // last page (has less than 20 entries!?) to check reached
+				if(maxDistance > 0){getNextListPage();}
+			} // loop pages
+		} // try
+		catch (Exception ex) {
 			infB.close(0);
 			Vm.showWait(false);
 			return;
 		}
+
+		if (infB.isClosed) { Vm.showWait(false); return; }
+		infB.setInfo(MyLocale.getMsg(5511,"Found ") + cachesToLoad.size() + MyLocale.getMsg(5512," caches"));
 		pref.log("Found " + cachesToLoad.size() + " new caches");
 		pref.log("Found " + cachesToUpdate.size() + " caches for update");
-		if (!infB.isClosed) infB.setInfo(MyLocale.getMsg(5511,"Found ") + cachesToLoad.size() + MyLocale.getMsg(5512," caches"));
 
 		//=======
 		// Now ready to spider each cache in the list
@@ -646,6 +381,7 @@
 		boolean loadAllLogs = (pref.maxLogsToSpider > 5) || spiderAllFinds;
 
 		int spiderErrors = 0;
+		if (cachesToUpdate.size()==0) cachesToUpdate=cachesShouldUpdate;
 
 		if ( cachesToUpdate.size() > 0 ) {
 			switch (pref.spiderUpdates) {
@@ -666,11 +402,11 @@
 		for(int i = 0; i<cachesToLoad.size(); i++){
 			if (infB.isClosed) break;
 
-			wpt = (String)cachesToLoad.get(i);
+			String wpt = (String)cachesToLoad.get(i);
 			// Get only caches not already available in the DB
 			if(cacheDB.getIndex(wpt) == -1){
 				infB.setInfo(MyLocale.getMsg(5513,"Loading: ") + wpt +" (" + (i+1) + " / " + totalCachesToLoad + ")");
-				holder = new CacheHolder();
+				CacheHolder holder = new CacheHolder();
 				holder.setWayPoint(wpt);
 				int test = getCacheByWaypointName(holder,false,getImages,getTBs,doNotgetFound,loadAllLogs);
 				if (test == SPIDER_CANCEL) {
@@ -692,8 +428,6 @@
 			for (Enumeration e = cachesToUpdate.elements() ; e.hasMoreElements() ; j++) {
 				ch = (CacheHolder)e.nextElement();
 				infB.setInfo(MyLocale.getMsg(5513,"Loading: ") + ch.getWayPoint() +" (" + (cachesToLoad.size()+j) + " / " + totalCachesToLoad + ")");
-				infB.redisplay();
-
 				int test = spiderSingle(cacheDB.getIndex(ch), infB,false,loadAllLogs);
 				if (test == SPIDER_CANCEL) {
 					break;
@@ -716,8 +450,396 @@
 		}
 		Global.getProfile().restoreFilter();
 		Global.getProfile().saveIndex(Global.getPref(),true);
+	} // End of DoIt spider many / all finds
+
+	/**
+	 * Method to spider a single cache.
+	 * It assumes a login has already been performed!
+	 * @return 1 if spider was successful, -1 if spider was cancelled by closing the infobox, 0 error, but continue with next cache
+	 */
+	public int spiderSingle(int number, InfoBox pInfB, boolean forceLogin, boolean loadAllLogs){
+		int ret=-1;
+		this.infB = pInfB;
+		CacheHolder ch = new CacheHolder(); // cacheDB.get(number);
+		ch.setWayPoint(cacheDB.get(number).getWayPoint());
+		if (ch.isAddiWpt()) return -1;  // No point re-spidering an addi waypoint, comes with parent
+
+		// check if we need to login
+		if (!loggedIn || forceLogin){
+			if (this.login()!=FormBase.IDOK) return -1;
+			// loggedIn is already set by this.login()
+		}
+		try{
+			// Read the cache data from GC.COM and compare to old data
+			ret=getCacheByWaypointName(ch,true,pref.downloadPics,pref.downloadTBs,false,loadAllLogs);
+			// Save the spidered data
+			if (ret == SPIDER_OK) {
+				CacheHolder cacheInDB = cacheDB.get(number);
+				cacheInDB.initStates(false);
+				if (cacheInDB.is_found() && !ch.is_found() && ! loadAllLogs) {
+					// If the number of logs to spider is 5 or less, then the "not found" information
+					// of the spidered cache is not credible. In this case it should not overwrite
+					// the "found" state of an existing cache.
+					ch.setFound(true);
+				}
+				// preserve rating information
+				ch.setNumRecommended(cacheInDB.getNumRecommended());
+				if (pref.downloadPics) {
+					// delete obsolete images when we have current set
+					CacheImages.cleanupOldImages(cacheInDB.getExistingDetails().images, ch.getFreshDetails().images);
+				} else {
+					// preserve images if not downloaded
+					ch.getFreshDetails().images = cacheInDB.getExistingDetails().images;
+				}
+				cacheInDB.update(ch);
+				cacheInDB.save();
+			}
+		}catch(Exception ex){
+			pref.log("Error spidering " + ch.getWayPoint() + " in spiderSingle");
+		}
+		return ret;
+	} // spiderSingle
+
+	/**
+	 * Fetch the coordinates of a waypoint from GC
+	 * @param wayPoint the name of the waypoint
+	 * @return the cache coordinates
+	 */
+	public String getCacheCoordinates(String wayPoint) {
+		String completeWebPage;
+		// Check whether spider definitions could be loaded, if not issue appropriate message and terminate
+		// Try to login. If login fails, issue appropriate message and terminate
+		if (!loggedIn || Global.getPref().forceLogin) {
+			if (login()!=FormBase.IDOK) {
+				return "";
+			}
+		}
+		InfoBox localInfB = new InfoBox("Info", "Loading", InfoBox.PROGRESS_WITH_WARNINGS);
+		localInfB.exec();
+		try{
+			String doc = p.getProp("waypoint") + wayPoint;
+			pref.log("Fetching: " + wayPoint);
+			completeWebPage = fetch(doc);
+		}catch(Exception ex){
+			localInfB.close(0);
+			pref.log("Could not fetch " + wayPoint,ex);
+			return "";
+		}
+		localInfB.close(0);
+		try {
+			return getLatLon(completeWebPage);
+		} catch (Exception ex) {
+			return "????";
+		}
+	} // getCacheCoordinates
+
+	/**
+	 * Method to login the user to gc.com
+	 * It will request a password and use the alias defined in preferences
+	 * If the login page cannot be fetched, the password is cleared.
+	 * If the login fails, an appropriate message is displayed.
+	 */
+	private int login(){
+		loggedIn = false;
+		String loginPage,loginPageUrl,loginSuccess,nextPage;
+		try {
+			loginPageUrl=p.getProp("loginPage");
+			loginSuccess=p.getProp("loginSuccess");
+			nextPage=p.getProp("nextPage");
+		} catch (Exception ex) { // Tag not found in spider.def
+			return ERR_LOGIN;
+		}
+		//Get password
+		InfoBox localInfB = new InfoBox(MyLocale.getMsg(5506,"Password"), MyLocale.getMsg(5505,"Enter Password"), InfoBox.INPUT);
+		localInfB.feedback.setText(passwort); // Remember the PWD for next time
+		localInfB.feedback.isPassword=true;
+		int code=FormBase.IDOK;
+		if (passwort.equals("")) {
+			code = localInfB.execute();
+			passwort = localInfB.getInput();
+		}
+		localInfB.close(0);
+		if(code != FormBase.IDOK) return code;
+		// Now start the login proper
+		localInfB = new InfoBox(MyLocale.getMsg(5507,"Status"), MyLocale.getMsg(5508,"Logging in..."));
+		localInfB.exec();
+		try{
+			pref.log("[login]:Fetching login page");
+			//Access the page once to get a viewstate
+			loginPage = fetch(loginPageUrl);   //http://www.geocaching.com/login/Default.aspx
+			if (loginPage.equals("")) {
+				localInfB.close(0);
+				(new MessageBox(MyLocale.getMsg(5500,"Error"), MyLocale.getMsg(5499,"Error loading login page.%0aPlease check your internet connection."), FormBase.OKB)).execute();
+				pref.log("[login]:Could not fetch: gc.com login page");
+				return ERR_LOGIN;
+			}
+		} catch(Exception ex){
+			localInfB.close(0);
+			(new MessageBox(MyLocale.getMsg(5500,"Error"), MyLocale.getMsg(5499,"Error loading login page.%0aPlease check your internet connection."), FormBase.OKB)).execute();
+			pref.log("[login]:Could not fetch: gc.com login page",ex);
+			return ERR_LOGIN;
+		}
+		if (!localInfB.isClosed) { // If user has not aborted, we continue
+			Regex rexCookieID = new Regex("(?i)Set-Cookie: userid=(.*?);.*");
+			Regex rexViewstate = new Regex("id=\"__VIEWSTATE\" value=\"(.*?)\" />");
+			// Regex rexViewstate1 = new Regex("id=\"__VIEWSTATE1\" value=\"(.*?)\" />");
+			Regex rexEventvalidation = new Regex("id=\"__EVENTVALIDATION\" value=\"(.*?)\" />");
+			Regex rexCookieSession = new Regex("(?i)Set-Cookie: ASP.NET_SessionId=(.*?);.*");
+			String viewstate="";
+			rexViewstate.search(loginPage);
+			if(rexViewstate.didMatch()){
+				viewstate = rexViewstate.stringMatched(1);
+				//Vm.debug("ViewState: " + viewstate);
+			} else
+				pref.log("[login]:Viewstate not found before login");
+
+			if(loginPage.indexOf(loginSuccess) > 0)
+				pref.log("[login]:Already logged in");
+			else {
+				rexEventvalidation.search(loginPage);
+				if(rexEventvalidation.didMatch()){
+					// eventvalidation = rexEventvalidation.stringMatched(1);
+					//Vm.debug("EVENTVALIDATION: " + eventvalidation);
+				} else
+					pref.log("[login]:Eventvalidation not found before login");
+				//Ok now login!
+				try{
+					pref.log("[login]:Logging in as "+pref.myAlias);
+					StringBuffer sb=new StringBuffer(1000);
+					sb.append(URL.encodeURL("__VIEWSTATE",false));	sb.append("="); sb.append(URL.encodeURL(viewstate,false));
+					sb.append("&ctl00%24ContentBody%24"); sb.append(URL.encodeURL("myUsername",false));
+					sb.append("="); sb.append(encodeUTF8URL(Utils.encodeJavaUtf8String(pref.myAlias)));
+					sb.append("&ctl00%24ContentBody%24"); sb.append(URL.encodeURL("myPassword",false));
+					sb.append("="); sb.append(encodeUTF8URL(Utils.encodeJavaUtf8String(passwort)));
+					sb.append("&ctl00%24ContentBody%24"); sb.append(URL.encodeURL("cookie",false));
+					sb.append("="); sb.append(URL.encodeURL("on",false));
+					sb.append("&ctl00%24ContentBody%24"); sb.append(URL.encodeURL("Button1",false));
+					sb.append("="); sb.append(URL.encodeURL("Login",false));
+//					sb.append("&"); sb.append(URL.encodeURL("__EVENTVALIDATION",false));
+//					sb.append("="); sb.append(URL.encodeURL(eventvalidation,false));
+					loginPage = fetch_post(loginPageUrl, sb.toString(), nextPage);  // /login/default.aspx
+					if(loginPage.indexOf(loginSuccess) > 0)
+						pref.log("[login]:Login successful");
+					else {
+						pref.log("[login]:Login failed. Wrong Account or Password?");
+						if (pref.debug) {
+							pref.log("[login.LoginUrl]:"+sb.toString());
+							pref.log("[login.Answer]:"+loginPage);
+						}
+						localInfB.close(0);
+						(new MessageBox(MyLocale.getMsg(5500,"Error"), MyLocale.getMsg(5501,"Login failed! Wrong account or password?"), FormBase.OKB)).execute();
+						return ERR_LOGIN;
+					}
+				}catch(Exception ex){
+					pref.log("[login]:Login failed with exception.", ex);
+					localInfB.close(0);
+					(new MessageBox(MyLocale.getMsg(5500,"Error"), MyLocale.getMsg(5501,"Login failed. Error loading page after login."), FormBase.OKB)).execute();
+					return ERR_LOGIN;
+				}
+			}
+
+			rexViewstate.search(loginPage);
+			if (!rexViewstate.didMatch()) {
+				pref.log("[login]:Viewstate not found");
+			}
+			viewstate = rexViewstate.stringMatched(1);
+
+			/*
+			rexViewstate1.search(start);
+			if (!rexViewstate1.didMatch()) {
+				pref.log("[login]:Viewstate1 not found");
+			}
+			*/
+
+			rexCookieID.search(loginPage);
+			if (!rexCookieID.didMatch()) {
+				pref.log("[login]:CookieID not found. Using old one.");
+			} else
+				cookieID = rexCookieID.stringMatched(1);
+			//Vm.debug(cookieID);
+			rexCookieSession.search(loginPage);
+			if (!rexCookieSession.didMatch()) {
+				pref.log("[login]:CookieSession not found. Using old one.");
+				//cookieSession="";
+			} else
+				cookieSession = rexCookieSession.stringMatched(1);
+			//Vm.debug("cookieSession = " + cookieSession);
+		}
+		boolean loginAborted=localInfB.isClosed;
+		localInfB.close(0);
+		if (loginAborted)
+			return FormBase.IDCANCEL;
+		else {
+			loggedIn = true;
+			return FormBase.IDOK;
+		}
 	}
-	
+	/*
+	 *
+	 */
+	private void initialiseProperties() {
+		try {
+			propFirstPage=p.getProp("firstPage");
+			propFirstPage2=p.getProp("firstPage2");
+			propFirstPageFinds=p.getProp("firstPageFinds");
+			propFirstLine=p.getProp("firstLine");
+			propFirstLine2=p.getProp("firstLine2");
+			propMaxDistance=p.getProp("maxDistance");
+			propShowOnlyFound=p.getProp("showOnlyFound");
+			propListBlockRex=p.getProp("listBlockRex");
+			propLineRex=p.getProp("lineRex");
+		}catch(Exception ex){
+		}
+	}
+
+	/*
+	 *
+	 */
+	private void getFirstListPage() {
+		Vm.showWait(true);
+		infB = new InfoBox("Status", MyLocale.getMsg(5502,"Fetching first page..."));
+		infB.exec();
+		//Get first page
+
+		String url;
+		if (spiderAllFinds) {
+			url = propFirstPageFinds + encodeUTF8URL(Utils.encodeJavaUtf8String(pref.myAlias));
+		} else {
+			url = propFirstPage + origin.getLatDeg(TransformCoordinates.DD) + propFirstPage2 + origin.getLonDeg(TransformCoordinates.DD)
+		                              + propMaxDistance + Integer.toString( (int)saveDistanceInMiles );
+			if(doNotgetFound) url = url + propShowOnlyFound;
+		}
+		url = url + cacheTypeRestriction;
+		pref.log("Getting first page: "+url);
+		try{
+			htmlListPage = fetch(url);
+			pref.log("Got first page");
+		}catch(Exception ex){
+			pref.log("Error fetching first list page",ex,true);
+			Vm.showWait(false);
+			infB.close(0);
+			(new MessageBox(MyLocale.getMsg(5500,"Error"), MyLocale.getMsg(5503,"Error fetching first list page."), FormBase.OKB)).execute();
+			return;
+		}
+		page_number = 1;
+		found_on_page = 0;
+	}
+
+	/**
+	 * in: ...
+	 * out: page_number,htmlPage
+	 */
+	private void getNextListPage() {
+		String postStr;
+		if (spiderAllFinds) {
+			postStr = propFirstLine;
+		} else {
+			postStr = propFirstLine + origin.getLatDeg(TransformCoordinates.DD) + propFirstLine2 + origin.getLonDeg(TransformCoordinates.DD)
+					                             + propMaxDistance + Integer.toString( (int)saveDistanceInMiles );
+			if(doNotgetFound) postStr = postStr + propShowOnlyFound;
+		}
+		postStr = postStr + cacheTypeRestriction;
+		Regex rexViewstate = new Regex("id=\"__VIEWSTATE\" value=\"(.*?)\" />");
+		String viewstate;
+		rexViewstate.search(htmlListPage);
+		if(rexViewstate.didMatch()){
+			viewstate = rexViewstate.stringMatched(1);
+		} else {
+			viewstate = "";
+		}
+		/*
+		rexEventvalidation.search(htmlPage);
+		if(rexEventvalidation.didMatch()){
+			eventvalidation = rexEventvalidation.stringMatched(1);
+		} else {
+			eventvalidation = "";
+		}
+		*/
+		String strNextPage = "ctl00$ContentBody$pgrTop$ctl08";
+		String url = URL.encodeURL("__EVENTTARGET",false) +"="+ URL.encodeURL(strNextPage,false)
+	    + "&" + URL.encodeURL("__EVENTARGUMENT",false) +"="+ URL.encodeURL("",false)
+//	    + "&" + URL.encodeURL("__VIEWSTATEFIELDCOUNT",false) +"=2"
+	    + "&" + URL.encodeURL("__VIEWSTATE",false) +"="+ URL.encodeURL(viewstate,false);
+//	    + "&" + URL.encodeURL("__VIEWSTATE1",false) +"="+ URL.encodeURL(viewstate1,false);
+//	    + "&" + URL.encodeURL("__EVENTVALIDATION",false) +"="+ URL.encodeURL(eventvalidation,false);
+		try{
+			pref.log("Fetching next list page:" + url);
+			htmlListPage = fetch_post(postStr, url, p.getProp("nextListPage"));
+		}catch(Exception ex){
+			pref.log("Error getting next page");
+		}
+		page_number++;
+		found_on_page = 0;
+	}
+
+	/**
+	 * Get num found
+	 * @param doc A previously fetched cachepage
+	 * @return numFound
+	 */
+	private int getNumFound(String doc) {
+		Regex numFindsRex = new Regex("Total Records: <b>(.*?)</b>");
+		numFindsRex.search(doc);
+		if (numFindsRex.didMatch()) {
+			 return Convert.toInt(numFindsRex.stringMatched(1));}
+		else return 0;
+	}
+
+	private int getFoundInDB() {
+		CacheHolder ch;
+		int counter = 0;
+		for(int i = 0; i<cacheDB.size();i++){
+			ch = cacheDB.get(i);
+			if(ch.is_found() == true) {
+				if(ch.getWayPoint().startsWith("GC") ) counter++;
+			}
+		}
+		return counter;
+	}
+
+	/**
+	 * Get the Distance to the centre
+	 * @param doc A previously fetched cachepage
+	 * @return Distance
+	 */
+	private double getDistGC(String doc) throws Exception {
+		if(doc.indexOf("Here") >= 0) {
+			return(0);
+		}
+		else {
+			//inRex = new Regex(p.getProp("distRex"));
+			Regex inRex = new Regex("<br />(.*?)(?:km|mi)");
+			inRex.search(doc);
+			if (!inRex.didMatch()) return 0;
+			if(MyLocale.getDigSeparator().equals(",")) return Convert.toDouble(inRex.stringMatched(1).replace('.',','));
+			return Convert.toDouble(inRex.stringMatched(1));
+		}
+	}
+
+	/**
+	 * Get the waypoint name
+	 * @param doc A previously fetched cachepage
+	 * @return Name of waypoint to add to list
+	 */
+	private String getWP(String doc) throws Exception {
+		Regex inRex = new Regex(p.getProp("waypointRex"));
+		inRex.search(doc);
+		if (!inRex.didMatch()) return "???";
+		return "GC"+inRex.stringMatched(1);
+	}
+
+	/**
+	 * Get the direction
+	 * @param doc A previously fetched cachepage
+	 * @return direction String
+	 */
+	private String getDirection(String doc) throws Exception {
+		Regex inRex = new Regex(p.getProp("directionRex"));
+		inRex.search(doc);
+		if (!inRex.didMatch()) return "";
+		return inRex.stringMatched(1);
+	}
+
 	private boolean directionOK(String[] directions, String gotDirection) {
 		if (directions.length==0) return true; // nothing means all
 		for (int i = 0; i < directions.length; i++) {
@@ -734,6 +856,50 @@
 		return false;
 	}
 
+	/*
+	 * in CacheHolder ch
+	 * in String cacheDescGC
+	 */
+	private boolean newLogExists(CacheHolder ch, String cacheDescGC) {
+		Time lastLogCW = new Time();
+		CacheHolderDetail chd = ch.getCacheDetails(true);
+		String slastLogCW=chd.CacheLogs.getLog(0).getDate();
+		if (slastLogCW.equals("")) return true; // or check cacheDescGC also no log?
+		lastLogCW.parse(slastLogCW,"yyyy-MM-dd");
+
+		Time lastLogGC = new Time(); // is current time
+		lastLogGC.hour=0;
+		lastLogGC.minute=0;
+		lastLogGC.second=0;
+		lastLogGC.millis=0;
+		String[] SDate;
+		String stmp=cacheDescGC.trim();
+		if (stmp.indexOf("day")>0) {
+			lastLogGC.day=java.lang.Math.max(1, lastLogGC.day-7); // simplyfied (update if not newer than last week)
+		}
+		else if (stmp.startsWith("<br />")) {
+			Vm.debug("no log yet");
+			return false; // no log yet
+		}
+		else {
+			final String monthNames[] = { "January", "February", "March", "April", "May",
+					"June", "July", "August", "September", "October", "November",
+					"December" };
+			SDate=mString.split(stmp,' ');
+			lastLogGC.day=Integer.parseInt(SDate[0]);
+			for (int m = 0; m < 12; m++) {
+				if (monthNames[m].startsWith(SDate[1])) {
+					lastLogGC.month=m+1;
+					m=12;
+				}
+			}
+			lastLogGC.year=2000+Integer.parseInt(SDate[2].substring(0,2));
+		}
+		// compare
+		// Vm.debug("CW:"+lastLogCW.toString()+" GC:"+lastLogGC.toString());
+		return lastLogCW.compareTo(lastLogGC) < 0;
+	}
+
 	/**
 	 * Read a complete cachepage from geocaching.com including all logs. This is used both when
 	 * updating already existing caches (via spiderSingle) and when spidering around a centre. It
@@ -802,8 +968,6 @@
 						}
 
 						ch.setHTML(true);
-						ch.setAvailable(true);
-						ch.setArchived(false);
 						ch.setIncomplete(true);
 						// Save size of logs to be able to check whether any new logs were added
 						//int logsz = chD.CacheLogs.size();
@@ -811,8 +975,8 @@
 						ch.addiWpts.clear();
 						ch.getFreshDetails().images.clear();
 
-						if(completeWebPage.indexOf(p.getProp("cacheUnavailable")) >= 0) ch.setAvailable(false);
-						if(completeWebPage.indexOf(p.getProp("cacheArchived")) >= 0) ch.setArchived(true);
+						ch.setAvailable(!(completeWebPage.indexOf(p.getProp("cacheUnavailable")) >= 0));
+						ch.setArchived(completeWebPage.indexOf(p.getProp("cacheArchived")) >= 0);
 						//==========
 						// General Cache Data
 						//==========
@@ -965,50 +1129,12 @@
 
 
 	/**
-	 * Get the Distance to the centre
-	 * @param doc A previously fetched cachepage
-	 * @return Distance
-	 */
-	private double getDist(String doc) throws Exception {
-		inRex = new Regex(p.getProp("distRex"));
-		inRex.search(doc);
-		if(doc.indexOf("Here") >= 0) return(0);
-		if (!inRex.didMatch()) return 0;
-		if(MyLocale.getDigSeparator().equals(",")) return Convert.toDouble(inRex.stringMatched(1).replace('.',','));
-		return Convert.toDouble(inRex.stringMatched(1));
-	}
-
-	/**
-	 * Get the direction
-	 * @param doc A previously fetched cachepage
-	 * @return direction String
-	 */
-	private String getDirection(String doc) throws Exception {
-		inRex = new Regex(p.getProp("directionRex"));
-		inRex.search(doc);
-		if (!inRex.didMatch()) return "";
-		return inRex.stringMatched(1);
-	}
-
-	/**
-	 * Get the waypoint name
-	 * @param doc A previously fetched cachepage
-	 * @return Name of waypoint to add to list
-	 */
-	private String getWP(String doc) throws Exception {
-		inRex = new Regex(p.getProp("waypointRex"));
-		inRex.search(doc);
-		if (!inRex.didMatch()) return "???";
-		return "GC"+inRex.stringMatched(1);
-	}
-
-	/**
 	 * Get the coordinates of the cache
 	 * @param doc A previously fetched cachepage
 	 * @return Cache coordinates
 	 */
 	private String getLatLon(String doc) throws Exception{
-		inRex = new Regex(p.getProp("latLonRex"));
+		Regex inRex = new Regex(p.getProp("latLonRex"));
 		inRex.search(doc);
 		if (!inRex.didMatch()) return "???";
 		return inRex.stringMatched(1);
@@ -1021,7 +1147,7 @@
 	 */
 	private String getLongDesc(String doc) throws Exception{
 		String res = "";
-		inRex = new Regex(p.getProp("shortDescRex"));
+		Regex inRex = new Regex(p.getProp("shortDescRex"));
 		Regex rex2 = new Regex(p.getProp("longDescRex"));
 		inRex.search(doc);
 		rex2.search(doc);
@@ -1040,7 +1166,7 @@
 	 * @return the location (country and state) of the cache
 	 */
 	private String getLocation(String doc) throws Exception{
-		inRex = new Regex(p.getProp("cacheLocationRex"));
+		Regex inRex = new Regex(p.getProp("cacheLocationRex"));
 		inRex.search(doc);
 		if (!inRex.didMatch()) return "";
 
@@ -1053,7 +1179,7 @@
 	 * @return the name of the cache
 	 */
 	private String getName(String doc) throws Exception{
-		inRex = new Regex(p.getProp("cacheNameRex"));
+		Regex inRex = new Regex(p.getProp("cacheNameRex"));
 		inRex.search(doc);
 		if (!inRex.didMatch()) return "???";
 		return inRex.stringMatched(1);
@@ -1065,7 +1191,7 @@
 	 * @return the cache owner
 	 */
 	private String getOwner(String doc) throws Exception{
-		inRex = new Regex(p.getProp("cacheOwnerRex"));
+		Regex inRex = new Regex(p.getProp("cacheOwnerRex"));
 		inRex.search(doc);
 		if (!inRex.didMatch()) return "???";
 		return inRex.stringMatched(1);
@@ -1077,7 +1203,7 @@
 	 * @return Hidden date
 	 */
 	private String getDateHidden(String doc) throws Exception{
-		inRex = new Regex(p.getProp("dateHiddenRex"));
+		Regex inRex = new Regex(p.getProp("dateHiddenRex"));
 		inRex.search(doc);
 		if (!inRex.didMatch()) return "???";
 		return inRex.stringMatched(1);
@@ -1089,7 +1215,7 @@
 	 * @return Cachehints
 	 */
 	private String getHints(String doc) throws Exception{
-		inRex = new Regex(p.getProp("hintsRex"));
+		Regex inRex = new Regex(p.getProp("hintsRex"));
 		inRex.search(doc);
 		if (!inRex.didMatch()) return "";
 		return inRex.stringMatched(1);
@@ -1101,7 +1227,7 @@
 	 * @return Cache size
 	 */
 	private String getSize(String doc) throws Exception{
-		inRex = new Regex(p.getProp("sizeRex"));
+		Regex inRex = new Regex(p.getProp("sizeRex"));
 		inRex.search(doc);
 		if(inRex.didMatch()) return inRex.stringMatched(1);
 		else return "None";
@@ -1113,7 +1239,7 @@
 	 * @return The cache difficulty
 	 */
 	private String getDiff(String doc) throws Exception{
-		inRex = new Regex(p.getProp("difficultyRex"));
+		Regex inRex = new Regex(p.getProp("difficultyRex"));
 		inRex.search(doc);
 		if(inRex.didMatch()) return inRex.stringMatched(1);
 		else return "";
@@ -1125,7 +1251,7 @@
 	 * @return Terrain rating
 	 */
 	private String getTerr(String doc) throws Exception{
-		inRex = new Regex(p.getProp("terrainRex"));
+		Regex inRex = new Regex(p.getProp("terrainRex"));
 		inRex.search(doc);
 		if(inRex.didMatch()) return inRex.stringMatched(1);
 		else return "";
@@ -1137,7 +1263,7 @@
 	 * @return the waypoint type (Tradi, Multi, etc.)
 	 */
 	private byte getType(String doc) throws Exception {
-		inRex = new Regex(p.getProp("cacheTypeRex"));
+		Regex inRex = new Regex(p.getProp("cacheTypeRex"));
 		inRex.search(doc);
 		if(inRex.didMatch()) return CacheType.gcSpider2CwType(inRex.stringMatched(1));
 		else return 0;
@@ -1508,7 +1634,7 @@
 	 * @param wayPoint The name of the cache
 	 * @param is_found Found status of the cached (is inherited by the additional waypoints)
 	 */
-	public void getAddWaypoints(String doc, String wayPoint, boolean is_found) throws Exception{
+	private void getAddWaypoints(String doc, String wayPoint, boolean is_found) throws Exception{
 		Extractor exWayBlock = new Extractor(doc,p.getProp("wayBlockExStart"),p.getProp("wayBlockExEnd"), 0, false);
 		String wayBlock = "";
 		String rowBlock = "";



From mik77 at mail.berlios.de  Mon Jan 11 11:00:27 2010
From: mik77 at mail.berlios.de (mik77 at mail.berlios.de)
Date: Mon, 11 Jan 2010 11:00:27 +0100
Subject: [Cachewolf-svn] r2398 - trunk/src/CacheWolf
Message-ID: <201001111000.o0BA0Rvd018438@sheep.berlios.de>

Author: mik77
Date: 2010-01-11 11:00:21 +0100 (Mon, 11 Jan 2010)
New Revision: 2398

Modified:
   trunk/src/CacheWolf/LogList.java
Log:
Ignore all other logs but Found and DNF when counting number of recent DNFs

Modified: trunk/src/CacheWolf/LogList.java
===================================================================
--- trunk/src/CacheWolf/LogList.java	2010-01-09 20:19:24 UTC (rev 2397)
+++ trunk/src/CacheWolf/LogList.java	2010-01-11 10:00:21 UTC (rev 2398)
@@ -98,7 +98,9 @@
 		while(countNoFoundLogs < size() && countNoFoundLogs < 5){
 			if(getLog(countNoFoundLogs).getIcon().startsWith("icon_sad")) {
 				countNoFoundLogs++;
-			}else break;
+			}else if (getLog(countNoFoundLogs).getIcon().startsWith("icon_smile")) {
+        break;
+      }
 		}
 		return countNoFoundLogs;
 	 }



From araber95 at mail.berlios.de  Mon Jan 11 11:27:04 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Mon, 11 Jan 2010 11:27:04 +0100
Subject: [Cachewolf-svn] r2399 - in trunk: res_noewe src/CacheWolf
	src/CacheWolf/imp
Message-ID: <201001111027.o0BAR44Y020893@sheep.berlios.de>

Author: araber95
Date: 2010-01-11 11:27:01 +0100 (Mon, 11 Jan 2010)
New Revision: 2399

Modified:
   trunk/res_noewe/spider.def
   trunk/src/CacheWolf/Preferences.java
   trunk/src/CacheWolf/imp/SpiderGC.java
Log:
changes due to input of MiK (hopefully all!?!)

Modified: trunk/res_noewe/spider.def
===================================================================
--- trunk/res_noewe/spider.def	2010-01-11 10:00:21 UTC (rev 2398)
+++ trunk/res_noewe/spider.def	2010-01-11 10:27:01 UTC (rev 2399)
@@ -57,7 +57,7 @@
 listBlockRex       = <table id="ctl00_ContentBody_dlResults"((?s).*?)</table>
 lineRex            = <tr\ bgcolor='#.{6}'>(?:(?s).*?)<td\ valign="top"\ align="left">((?s).*?)</tr>
 directionRex       = /compass/(.*?).gif
-distRex            = <br\ />(.*?)(?:km|mi)
+distRex            = <br\ />(.*?)(?:km|mi)(?:\\s*)</td>
 waypointRex        = \\(GC(.*?)\\)<br\ />
 showOnlyFound      = &f=1
 maxDistance        = &dist=

Modified: trunk/src/CacheWolf/Preferences.java
===================================================================
--- trunk/src/CacheWolf/Preferences.java	2010-01-11 10:00:21 UTC (rev 2398)
+++ trunk/src/CacheWolf/Preferences.java	2010-01-11 10:27:01 UTC (rev 2399)
@@ -226,12 +226,16 @@
 	public boolean addDetailsToName = false;
 	/** The own GC member ID */
 	public String gcMemberId = "";
+	/** Premium Member ? */
+	public boolean isPremium = true;
 	/** The maximum number of logs to export */
 	public int numberOfLogsToExport = 5;
 	/** Add Travelbugs when exporting */
 	public boolean exportTravelbugs = false;
 	/** Try to make a MyFinds GPX when exporting to GPX */
 	public boolean exportGpxAsMyFinds = true;
+	/** Check if lastFound is newer than saved log*/
+	public boolean checkLog=false;
 	/** Download images when loading cache data */
 	public boolean downloadPics = true;
 	/** Download TB information when loading cache data */
@@ -258,10 +262,10 @@
 
     /** SortingGroupedByCache */
     public boolean SortingGroupedByCache=true;
-    
+
     /** useOwnSymbols */
     public boolean useOwnSymbols=true;
-    
+
     /** TRUE if we want automatic sorting **/
     public boolean sortAutomatic = true;
 
@@ -382,7 +386,10 @@
 			SpiderGC.passwort=password;
 		}
 		else if(name.equals("alias2")) myAlias2 = SafeXML.cleanback(atts.getValue("name"));
-		else if(name.equals("gcmemberid")) gcMemberId = atts.getValue("name");
+		else if(name.equals("gcmemberid")) {
+			gcMemberId = atts.getValue("name");
+			isPremium=Boolean.valueOf(atts.getValue("Premium")).booleanValue();
+		}
 		else if(name.equals("location")){
 			curCentrePt.set(atts.getValue("lat")+" "+atts.getValue("long"));
 		}
@@ -488,6 +495,7 @@
 		}
 		else if (name.equals("spider")) {
 			forceLogin = Boolean.valueOf(atts.getValue("forcelogin")).booleanValue();
+			checkLog = Boolean.valueOf(atts.getValue("checkLog")).booleanValue();
 			tmp = atts.getValue("spiderUpdates");
 			if (tmp != null) spiderUpdates=Convert.parseInt(tmp);
 			tmp = atts.getValue("maxSpiderNumber");
@@ -625,7 +633,7 @@
 			outp.print("    <CurrentCentre FromGPSPosition=\"" + SafeXML.clean(Convert.toString(setCurrentCentreFromGPSPosition)) + "\"/>\n");
 			outp.print("    <alias name =\""+ SafeXML.clean(myAlias) +"\" password=\""+SafeXML.clean(password)+"\" />\n");
 			outp.print("    <alias2 name =\""+ SafeXML.clean(myAlias2) +"\"/>\n");
-			outp.print("    <gcmemberid name =\""+ SafeXML.clean(gcMemberId) +"\"/>\n");
+			outp.print("    <gcmemberid name =\""+ SafeXML.clean(gcMemberId) + "\"" + " Premium =\""+ SafeXML.strxmlencode(isPremium) +"\"/>\n");
 			outp.print("    <browser name = \"" + SafeXML.clean(browser) + "\"/>\n");
 			outp.print("    <proxy prx = \"" + SafeXML.clean(myproxy) + "\" prt = \"" + SafeXML.clean(myproxyport) + "\" active = \"" + SafeXML.strxmlencode(proxyActive) + "\" />\n");
 			outp.print("    <port portname = \"" + SafeXML.clean(mySPO.portName) + "\" baud = \"" + SafeXML.strxmlencode(mySPO.baudRate) + "\"/>\n");
@@ -646,7 +654,7 @@
 					        "\" addDetailsToWaypoint = \"" + SafeXML.strxmlencode(addDetailsToWaypoint) + "\" addDetailsToName = \"" + SafeXML.strxmlencode(addDetailsToName) + "\" />\n");
 			outp.print("    <opencaching downloadMissing=\"" + SafeXML.strxmlencode(downloadmissingOC) + "\"/>\n");
 			outp.print("    <location lat = \"" + SafeXML.clean(curCentrePt.getLatDeg(TransformCoordinates.DD)) + "\" long = \"" + SafeXML.clean(curCentrePt.getLonDeg(TransformCoordinates.DD)) + "\"/>\n");
-			outp.print("    <spider forcelogin=\"" + SafeXML.strxmlencode(forceLogin) + "\" spiderUpdates=\"" + SafeXML.strxmlencode(spiderUpdates) + "\" maxSpiderNumber=\"" + SafeXML.strxmlencode(maxSpiderNumber) + "\" downloadPics=\"" + SafeXML.strxmlencode(downloadPics) + "\" downloadTBs=\"" + SafeXML.strxmlencode(downloadTBs) +"\"/>\n");
+			outp.print("    <spider forcelogin=\"" + SafeXML.strxmlencode(forceLogin) + "\" spiderUpdates=\"" + SafeXML.strxmlencode(spiderUpdates) + "\" checkLog=\"" + SafeXML.strxmlencode(checkLog) + "\" maxSpiderNumber=\"" + SafeXML.strxmlencode(maxSpiderNumber) + "\" downloadPics=\"" + SafeXML.strxmlencode(downloadPics) + "\" downloadTBs=\"" + SafeXML.strxmlencode(downloadTBs) +"\"/>\n");
 			outp.print("    <gotopanel northcentered=\"" + SafeXML.strxmlencode(northCenteredGoto) + "\" />\n");
 			outp.print("    <details cacheSize=\"" + SafeXML.strxmlencode(maxDetails) + "\" delete=\"" + SafeXML.strxmlencode(deleteDetails) + "\"/>\n");
 			outp.print("    <metric type=\"" + SafeXML.strxmlencode(metricSystem) + "\"/>\n");

Modified: trunk/src/CacheWolf/imp/SpiderGC.java
===================================================================
--- trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-11 10:00:21 UTC (rev 2398)
+++ trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-11 10:27:01 UTC (rev 2399)
@@ -296,14 +296,6 @@
 			maxNew=java.lang.Math.min(numFinds-numFoundInDB,maxNew);
 			if (maxUpdate==0 && maxNew == 0) { Vm.showWait(false); infB.close(0); return; }
 		}
-		
-		String[] cacheDescGC;
-		int anzLines=38;
-		int lineDistance=1;
-		int lineDirection=1;
-		int lineWaypoint=22;
-		int lineDescription=20;
-		int lineLastFound=27;
 		Regex lineRex = new Regex(propLineRex);
 		try {
 			//Loop pages till maximum distance has been found or no more caches are in the list
@@ -315,40 +307,28 @@
 				while (maxDistance > 0){
 					if (!lineRex.didMatch()) break;
 					found_on_page++;
-					cacheDescGC=mString.split(lineRex.stringMatched(1),'\n');
-					if(cacheDescGC.length!=anzLines) {
-						maxDistance = 0; //add no more caches
-						(new MessageBox(MyLocale.getMsg(5500,"Error"), "GC changed table output \nCW must be changed too!", FormBase.OKB)).execute();
-						throw new Exception("GC changed table output");
-					}
-					double gotDistance=getDistGC(cacheDescGC[lineDistance]);
-					String chWaypoint=getWP(cacheDescGC[lineWaypoint]);
+					String CacheDescriptionGC=lineRex.stringMatched(1);
+					double gotDistance=getDistGC(CacheDescriptionGC);
+					String chWaypoint=getWP(CacheDescriptionGC);
 					if(gotDistance <= maxDistance){
 						ch=cacheDB.get(chWaypoint);
 						if(ch == null){ // not in DB
-							if ( gotDistance >= minDistance &&
-								 directionOK(directions,getDirection(cacheDescGC[lineDirection])) ){
+							if(cachesToLoad.size() < maxNew) {
+								if ( gotDistance >= minDistance &&
+										 directionOK(directions,getDirection(CacheDescriptionGC))  &&
+										 doPMCache(CacheDescriptionGC) ){
 								cachesToLoad.add(chWaypoint);
-								if(cachesToLoad.size()==maxNew) {
-									if(maxUpdate!=Integer.MAX_VALUE) maxDistance=0;
 								}
 							}
+							else {
+								if(maxUpdate!=Integer.MAX_VALUE) { maxDistance=0; }
+							}
 						}
 						else {
 							if (maxUpdate>0) {
-								boolean update=false;
-								if (spiderAllFinds) {
-									if(!ch.is_found()) { ch.setFound(true); update=true;}
-									boolean is_archived_GC=cacheDescGC[lineDescription].indexOf("<font color=\"red\"><strike>")!=-1;
-									if (is_archived_GC!=ch.is_archived()) { ch.setArchived(is_archived_GC); update=true;}
+								if (updateExists(ch,CacheDescriptionGC)) {
+									if (!ch.is_black() && (cachesShouldUpdate.size()<maxUpdate)) cachesShouldUpdate.put(chWaypoint, ch);
 								}
-								boolean is_available_GC=cacheDescGC[lineDescription].indexOf("<strike>")==-1;
-								if (is_available_GC != ch.is_available()) { ch.setAvailable(is_available_GC); update=true;}
-								if (newLogExists(ch,cacheDescGC[lineLastFound])) {update=true;}
-								if (update) {
-									cachesShouldUpdate.put(chWaypoint, ch);
-									if(cachesShouldUpdate.size()==maxUpdate) maxDistance=0;
-								}
 								else
 									if (maxUpdate==Integer.MAX_VALUE) cachesToUpdate.remove( chWaypoint );
 							}
@@ -773,6 +753,24 @@
 	}
 
 	/**
+	 * check if new Update exists
+	 * @param ch CacheHolder
+	 * @param CacheDescription A previously fetched cachepage
+	 * @return true if new Update exists else false
+	 */
+	private boolean updateExists(CacheHolder ch, String CacheDescription) {
+		// int lineDescription=20;
+		if (spiderAllFinds) {
+			if(!ch.is_found()) { ch.setFound(true); ch.save(); return true;}
+			boolean is_archived_GC=CacheDescription.indexOf("<font color=\"red\"><strike>")!=-1;
+			if (is_archived_GC!=ch.is_archived()) { ch.setArchived(is_archived_GC); ch.save(); return true;}
+		}
+		boolean is_available_GC=CacheDescription.indexOf("<strike>")==-1;
+		if (is_available_GC != ch.is_available()) { ch.setAvailable(is_available_GC); ch.save(); return true;}
+		if (newLogExists(ch,CacheDescription)) {return true;}
+		return false;
+	}
+	/**
 	 * Get num found
 	 * @param doc A previously fetched cachepage
 	 * @return numFound
@@ -807,8 +805,8 @@
 			return(0);
 		}
 		else {
-			//inRex = new Regex(p.getProp("distRex"));
-			Regex inRex = new Regex("<br />(.*?)(?:km|mi)");
+			 // int lineDistance=1;
+			Regex inRex = new Regex(p.getProp("distRex"));
 			inRex.search(doc);
 			if (!inRex.didMatch()) return 0;
 			if(MyLocale.getDigSeparator().equals(",")) return Convert.toDouble(inRex.stringMatched(1).replace('.',','));
@@ -822,11 +820,21 @@
 	 * @return Name of waypoint to add to list
 	 */
 	private String getWP(String doc) throws Exception {
+		// int lineWaypoint=22;
 		Regex inRex = new Regex(p.getProp("waypointRex"));
 		inRex.search(doc);
 		if (!inRex.didMatch()) return "???";
 		return "GC"+inRex.stringMatched(1);
 	}
+	
+	/**
+	 * check for Premium Member Cache
+	 */
+	private boolean doPMCache(String toCheck) {
+		// int linePM=10;
+		if (pref.isPremium) return true;
+		if (toCheck.indexOf("small_profile.gif")>0) return false; else return true;
+	}
 
 	/**
 	 * Get the direction
@@ -834,12 +842,16 @@
 	 * @return direction String
 	 */
 	private String getDirection(String doc) throws Exception {
+		// int lineDirection=1;
 		Regex inRex = new Regex(p.getProp("directionRex"));
 		inRex.search(doc);
 		if (!inRex.didMatch()) return "";
 		return inRex.stringMatched(1);
 	}
-
+	
+	/*
+	 * if cache lies in the desired direction
+	 */
 	private boolean directionOK(String[] directions, String gotDirection) {
 		if (directions.length==0) return true; // nothing means all
 		for (int i = 0; i < directions.length; i++) {
@@ -857,10 +869,20 @@
 	}
 
 	/*
-	 * in CacheHolder ch
-	 * in String cacheDescGC
+	 * @param CacheHolder ch
+	 * @param String cacheDescGC
+	 * @return boolean newLogExists
 	 */
-	private boolean newLogExists(CacheHolder ch, String cacheDescGC) {
+	private boolean newLogExists(CacheHolder ch, String cacheDescrition) {
+		if(!pref.checkLog) return false;
+		String[] CacheDesc=mString.split(cacheDescrition,'\n');
+		int anzLines=38;
+		int lineLastFound=27;
+		if(CacheDesc.length!=anzLines) {
+			maxDistance = 0; //add no more caches
+			(new MessageBox(MyLocale.getMsg(5500,"Error"), "GC changed table output \nCW must be changed too!", FormBase.OKB)).execute();
+			return false;
+		}
 		Time lastLogCW = new Time();
 		CacheHolderDetail chd = ch.getCacheDetails(true);
 		String slastLogCW=chd.CacheLogs.getLog(0).getDate();
@@ -873,7 +895,7 @@
 		lastLogGC.second=0;
 		lastLogGC.millis=0;
 		String[] SDate;
-		String stmp=cacheDescGC.trim();
+		String stmp=CacheDesc[lineLastFound].trim();
 		if (stmp.indexOf("day")>0) {
 			lastLogGC.day=java.lang.Math.max(1, lastLogGC.day-7); // simplyfied (update if not newer than last week)
 		}



From araber95 at mail.berlios.de  Mon Jan 11 16:43:02 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Mon, 11 Jan 2010 16:43:02 +0100
Subject: [Cachewolf-svn] r2400 - in trunk: res_noewe/languages
	src/CacheWolf/imp
Message-ID: <201001111543.o0BFh2DL001909@sheep.berlios.de>

Author: araber95
Date: 2010-01-11 16:42:56 +0100 (Mon, 11 Jan 2010)
New Revision: 2400

Modified:
   trunk/res_noewe/languages/DE.cfg
   trunk/res_noewe/languages/EN.cfg
   trunk/res_noewe/languages/FR.cfg
   trunk/res_noewe/languages/NL.cfg
   trunk/res_noewe/languages/PL.cfg
   trunk/src/CacheWolf/imp/SpiderGC.java
Log:
some info added

Modified: trunk/res_noewe/languages/DE.cfg
===================================================================
--- trunk/res_noewe/languages/DE.cfg	2010-01-11 10:27:01 UTC (rev 2399)
+++ trunk/res_noewe/languages/DE.cfg	2010-01-11 15:42:56 UTC (rev 2400)
@@ -825,7 +825,7 @@
 		5509=Zentrumskoordinaten nicht gesetzt
 		5510=Spider Optionen
 		5511=Gefunden+
-		5512=+Caches
+		5512=+neue Caches
 		5513=Laden von:+
 		5514=%0aTravelbug:+
 		5515=Fehler beim Laden des Caches.%0aBitte %fcberpr%fcfen Sie Ihre Internetverbindung.%0aNoch einmal versuchen?

Modified: trunk/res_noewe/languages/EN.cfg
===================================================================
--- trunk/res_noewe/languages/EN.cfg	2010-01-11 10:27:01 UTC (rev 2399)
+++ trunk/res_noewe/languages/EN.cfg	2010-01-11 15:42:56 UTC (rev 2400)
@@ -813,7 +813,7 @@
 		5509=Coordinates for centre must be set
 		5510=Spider Options
 		5511=Found+
-		5512=+caches
+		5512=+new caches
 		5513=Loading:+
 		5514=%0aGetting bug:+
 		5515=Failed to load cache.%0aPlease check your internet connection.%0aRetry?

Modified: trunk/res_noewe/languages/FR.cfg
===================================================================
--- trunk/res_noewe/languages/FR.cfg	2010-01-11 10:27:01 UTC (rev 2399)
+++ trunk/res_noewe/languages/FR.cfg	2010-01-11 15:42:56 UTC (rev 2400)
@@ -817,7 +817,7 @@
 		5509=Coordonn%e9es de centre pas mis
 		5510=Options spider
 		5511=Trouv%e9e+
-		5512=+Caches
+		5512=+nouveau Caches
 		5513=Chargeant:+
 		5514=%0aTravel Bug:+
 		5515=Erreur en chargeant la cache.%0aMerci de v%e9rifier votre connexion internet..%0aContinuer d'essayer?

Modified: trunk/res_noewe/languages/NL.cfg
===================================================================
--- trunk/res_noewe/languages/NL.cfg	2010-01-11 10:27:01 UTC (rev 2399)
+++ trunk/res_noewe/languages/NL.cfg	2010-01-11 15:42:56 UTC (rev 2400)
@@ -625,7 +625,7 @@
 		5509=Co%f6rdinaten voor middelpunt moeten worden ingegeven.
 		5510=Spider options
 		5511=Gevonden+
-		5512=+caches
+		5512=+niew caches
 		5513=Bezig met laden:+
 		5514=%0aTravelbug
 		5515=Failed to load-cache.%0aPlease Controleer je internetverbinding.%0aRetry?

Modified: trunk/res_noewe/languages/PL.cfg
===================================================================
--- trunk/res_noewe/languages/PL.cfg	2010-01-11 10:27:01 UTC (rev 2399)
+++ trunk/res_noewe/languages/PL.cfg	2010-01-11 15:42:56 UTC (rev 2400)
@@ -809,7 +809,7 @@
                 5509=Wspolrzedne dla srodka musza byc podane
                 5510=Opcje Spidera
                 5511=Znaleziona+
-                5512=+skrzynki
+                5512=+nowy skrzynki
                 5513=Wczytuje:+
                 5514=%0aPobieram bugi:+
                 5515=Nie mozna zaladowac skrzynki.%0aProsze sprawdzic polaczenie z netem.%0aSprobowac ponownie?

Modified: trunk/src/CacheWolf/imp/SpiderGC.java
===================================================================
--- trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-11 10:27:01 UTC (rev 2399)
+++ trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-11 15:42:56 UTC (rev 2400)
@@ -118,6 +118,11 @@
 	private static String propListBlockRex;
 	private static String propLineRex;
 
+	private int numFoundUpdates=0;
+	private int numArchivedUpdates=0;
+	private int numAvailableUpdates=0;
+	private int numLogUpdates=0;
+	
 	public SpiderGC(Preferences prf, Profile profile, boolean bypass){
 		this.profile=profile;
 		this.cacheDB = profile.cacheDB;
@@ -352,8 +357,19 @@
 
 		if (infB.isClosed) { Vm.showWait(false); return; }
 		infB.setInfo(MyLocale.getMsg(5511,"Found ") + cachesToLoad.size() + MyLocale.getMsg(5512," caches"));
+		
+		pref.log("Checked " + page_number + " pages");
+		pref.log("with " + ((page_number-1)*20+found_on_page) + " caches");
 		pref.log("Found " + cachesToLoad.size() + " new caches");
-		pref.log("Found " + cachesToUpdate.size() + " caches for update");
+		pref.log("Found " + cachesToUpdate.size() + "/" + cachesShouldUpdate.size() + " caches for update");
+		if(spiderAllFinds){
+			pref.log("Found " + numFoundUpdates + " caches with no found in profile.");
+			pref.log("Found " + numArchivedUpdates + " caches with changed archived status.");
+		}
+		pref.log("Found " + numAvailableUpdates + " caches with changed available status.");
+		pref.log("Found " + numLogUpdates + " caches with new found in log.");
+		pref.log("Found " + (cachesToUpdate.size()-numAvailableUpdates-numLogUpdates) + " caches possibly archived.");
+		pref.log("Found " + cachesShouldUpdate.size() + "?=" + (numFoundUpdates+numArchivedUpdates+numAvailableUpdates+numArchivedUpdates) + " caches to update.");
 
 		//=======
 		// Now ready to spider each cache in the list
@@ -402,7 +418,7 @@
 				} // For test==SPIDER_IGNORE_PREMIUM: Nothing to do
 			}
 		}
-
+		
 		if (!infB.isClosed) {
 			int j = 1;
 			for (Enumeration e = cachesToUpdate.elements() ; e.hasMoreElements() ; j++) {
@@ -761,13 +777,13 @@
 	private boolean updateExists(CacheHolder ch, String CacheDescription) {
 		// int lineDescription=20;
 		if (spiderAllFinds) {
-			if(!ch.is_found()) { ch.setFound(true); ch.save(); return true;}
+			if(!ch.is_found()) { ch.setFound(true); ch.save(); numFoundUpdates+=1; return true;}
 			boolean is_archived_GC=CacheDescription.indexOf("<font color=\"red\"><strike>")!=-1;
-			if (is_archived_GC!=ch.is_archived()) { ch.setArchived(is_archived_GC); ch.save(); return true;}
+			if (is_archived_GC!=ch.is_archived()) { ch.setArchived(is_archived_GC); ch.save(); numArchivedUpdates+=1; return true;}
 		}
 		boolean is_available_GC=CacheDescription.indexOf("<strike>")==-1;
-		if (is_available_GC != ch.is_available()) { ch.setAvailable(is_available_GC); ch.save(); return true;}
-		if (newLogExists(ch,CacheDescription)) {return true;}
+		if (is_available_GC != ch.is_available()) { ch.setAvailable(is_available_GC); ch.save(); numAvailableUpdates+=1; return true;}
+		if (newLogExists(ch,CacheDescription)) {numLogUpdates+=1; return true;}
 		return false;
 	}
 	/**



From araber95 at mail.berlios.de  Tue Jan 12 10:33:12 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Tue, 12 Jan 2010 10:33:12 +0100
Subject: [Cachewolf-svn] r2401 - trunk/src/CacheWolf/imp
Message-ID: <201001120933.o0C9XCaJ015788@sheep.berlios.de>

Author: araber95
Date: 2010-01-12 10:33:09 +0100 (Tue, 12 Jan 2010)
New Revision: 2401

Modified:
   trunk/src/CacheWolf/imp/SpiderGC.java
Log:
changes for direction X*

Modified: trunk/src/CacheWolf/imp/SpiderGC.java
===================================================================
--- trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-11 15:42:56 UTC (rev 2400)
+++ trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-12 09:33:09 UTC (rev 2401)
@@ -122,7 +122,7 @@
 	private int numArchivedUpdates=0;
 	private int numAvailableUpdates=0;
 	private int numLogUpdates=0;
-	
+
 	public SpiderGC(Preferences prf, Profile profile, boolean bypass){
 		this.profile=profile;
 		this.cacheDB = profile.cacheDB;
@@ -238,7 +238,7 @@
 			maxUpdate = Common.parseInt(maxUpdateString);
 		}
 		// TODO maxUpdate in preferences ?
-		
+
 		if (maxNew == 0) return;
 		if(maxNew==-1) maxNew=Integer.MAX_VALUE;
 		if(maxUpdate==-1) maxUpdate=Integer.MAX_VALUE;
@@ -357,7 +357,7 @@
 
 		if (infB.isClosed) { Vm.showWait(false); return; }
 		infB.setInfo(MyLocale.getMsg(5511,"Found ") + cachesToLoad.size() + MyLocale.getMsg(5512," caches"));
-		
+
 		pref.log("Checked " + page_number + " pages");
 		pref.log("with " + ((page_number-1)*20+found_on_page) + " caches");
 		pref.log("Found " + cachesToLoad.size() + " new caches");
@@ -418,7 +418,7 @@
 				} // For test==SPIDER_IGNORE_PREMIUM: Nothing to do
 			}
 		}
-		
+
 		if (!infB.isClosed) {
 			int j = 1;
 			for (Enumeration e = cachesToUpdate.elements() ; e.hasMoreElements() ; j++) {
@@ -842,7 +842,7 @@
 		if (!inRex.didMatch()) return "???";
 		return "GC"+inRex.stringMatched(1);
 	}
-	
+
 	/**
 	 * check for Premium Member Cache
 	 */
@@ -864,7 +864,7 @@
 		if (!inRex.didMatch()) return "";
 		return inRex.stringMatched(1);
 	}
-	
+
 	/*
 	 * if cache lies in the desired direction
 	 */
@@ -876,7 +876,7 @@
 			}
 			int j=directions[i].indexOf("*");
 			if (j>0){
-				if (gotDirection.startsWith(directions[i].substring(0, 1))) {
+				if (gotDirection.indexOf(directions[i].substring(0, 1))>-1) {
 					return true;
 				}
 			}



From mik77 at mail.berlios.de  Thu Jan 14 02:37:46 2010
From: mik77 at mail.berlios.de (mik77 at mail.berlios.de)
Date: Thu, 14 Jan 2010 02:37:46 +0100
Subject: [Cachewolf-svn] r2402 - in trunk: . res_noewe src/CacheWolf
	src/CacheWolf/imp
Message-ID: <201001140137.o0E1bkUE008472@sheep.berlios.de>

Author: mik77
Date: 2010-01-14 02:37:42 +0100 (Thu, 14 Jan 2010)
New Revision: 2402

Modified:
   trunk/buildexe.bat
   trunk/res_noewe/spider.def
   trunk/src/CacheWolf/LogList.java
   trunk/src/CacheWolf/imp/SpiderGC.java
Log:
first draft for new GC design

Modified: trunk/buildexe.bat
===================================================================
--- trunk/buildexe.bat	2010-01-12 09:33:09 UTC (rev 2401)
+++ trunk/buildexe.bat	2010-01-14 01:37:42 UTC (rev 2402)
@@ -1,6 +1,5 @@
 cd %~d0%~p0
 call getres.bat
-java -cp lib/ewe.jar Ewe programs/Jewel.ewe -c cw-pda.jnf
 java -cp lib/ewe.jar Ewe programs/Jewel.ewe -c cw-ppc2003.jnf
 java -cp lib/ewe.jar Ewe programs/Jewel.ewe -c cw-pc.jnf
 REM Dont change the order above because the PC version has to overwrite the PDA version of the EWE-file

Modified: trunk/res_noewe/spider.def
===================================================================
--- trunk/res_noewe/spider.def	2010-01-12 09:33:09 UTC (rev 2401)
+++ trunk/res_noewe/spider.def	2010-01-14 01:37:42 UTC (rev 2402)
@@ -34,6 +34,7 @@
 # Version 4.10- 20091021 Tags in Description are now correctly closed
 # Version 4.11- 20091023 Reverted last change, because it doesn't work with EWE/EXE
 # Version 5.0 - 20091105 adaption to new GC-design
+# Version 6.0 - 20100113 adaption to new GC-design
 #============================================================
 # A suffix of Rex indicates a regular expression
 # A suffix of ExStart indicates the start of an Extractor search pattern
@@ -55,9 +56,12 @@
 firstPageFinds     = http://www.geocaching.com/seek/nearest.aspx?ul=
 # Regex to search for cachenames
 listBlockRex       = <table id="ctl00_ContentBody_dlResults"((?s).*?)</table>
-lineRex            = <tr\ bgcolor='#.{6}'>(?:(?s).*?)<td\ valign="top"\ align="left">((?s).*?)</tr>
+lineRex            = <tr\ bgcolor='#.{6}'\ class="Data\ BorderTop">((?s).*?)</tr>
 directionRex       = /compass/(.*?).gif
-distRex            = <br\ />(.*?)(?:km|mi)(?:\\s*)</td>
+logDateRex         = <td>(.*?)<br\ /><span\ class="Success"></span></td>
+availableRex       = <span class="Strike">
+PMRex              = small_profile.gif
+distRex            = <br\ />(.*?)(?:km|mi)
 waypointRex        = \\(GC(.*?)\\)<br\ />
 showOnlyFound      = &f=1
 maxDistance        = &dist=
@@ -85,46 +89,46 @@
 #--------------------------------------
 getPageByName      = http://www.geocaching.com/seek/cache_details.aspx?wp=
 fetchAllLogs       = &log=y
-cacheUnavailable   = <ul><font\ color="red"><li>This\ cache\ is\ temporarily\ unavailable.\ Read\ the\ logs\ below\ to\ read\ the\ status\ for\ this\ cache.</li></font></ul>
-cacheArchived      = This cache\ has\ been\ archived
-latLonRex          = <span\ id="LatLon"\ style="font-weight:bold;">((?s).*?)</span>
-shortDescRex       = <span\ id="ShortDescription">((?s).*?)</span>
+cacheUnavailable   = <ul\ class="OldWarning"><li>This\ cache\ is\ temporarily\ unavailable.\ Read\ the\ logs\ below\ to\ read\ the\ status\ for\ this\ cache.</li></ul></span>
+cacheArchived      = <ul\ class="OldWarning"><li>This\ cache\ has\ been\ archived,\ but\ is\ available\ for\ viewing\ for\ archival\ purposes.</li></ul></span>
+latLonRex          = <span\ id="ctl00_ContentBody_LatLon"\ style="font-weight:bold;">((?s).*?)</span>
+shortDescRex       = <span\ id="ctl00_ContentBody_ShortDescription">((?s).*?)</span>
 #This version doesn't work with EWE/EXE, so we trim the tags in code
-#longDescRex        = <span\ id="LongDescription">((?s).*?)</span>(?:\\s*)<br\ />(?:\\s*)</p>(?:\\s*)<p>(?:\\s*)<strong>Additional\ Hints&nbsp;\\(</strong>
-longDescRex        = <span\ id="LongDescription">((?s).*?)<strong>Additional\ Hints&nbsp;\\(</strong>
-cacheNameRex       = <span\ id="CacheName">((?s).*?)</span>
-cacheOwnerRex      = <span\ id="CacheOwner">by\ <a\ href=(?:(?s).*?)>((?s).*?)</a></span>
-dateHiddenRex      = <span\ id="DateHidden">((?s).*?)</span>
-hintsRex           = <span\ id="Hints"\ class="displayMe">((?s).*?)</span>
-sizeRex            = alt="Size:\ ((?s).*?)"\ title="Size:
-difficultyRex      = <span\ id="Difficulty">.*?alt="(.*?)\ out\ of
-terrainRex         = <span\ id="Terrain">.*?alt="(.*?)\ out\ of
-cacheTypeRex       = /images/WptTypes/(.*?)\\.gif"\ ALT="
-cacheLocationRex   = <span\ id="Location">In\ ([^<]*?)<
+#longDescRex        = <span\ id="ctl00_ContentBody_LongDescription">((?s).*?)</span>(?:\\s*)<br\ />(?:\\s*)</p>(?:\\s*)<p>(?:\\s*)<strong>Additional\ Hints&nbsp;\\(</strong>
+longDescRex        = <span\ id="ctl00_ContentBody_LongDescription">((?s).*?)<td\ valign="top"\ width="10%">&nbsp;</td>
+cacheNameRex       = <span\ id="ctl00_ContentBody_CacheName">((?s).*?)</span>
+cacheOwnerRex      = <span\ id="ctl00_ContentBody_CacheOwner">by\ <a\ href=(?:(?s).*?)>((?s).*?)</a></span>
+dateHiddenRex      = <span\ id="ctl00_ContentBody_DateHidden">((?s).*?)</span>
+hintsRex           = <span\ id="ctl00_ContentBody_Hints"\ class="displayMe">((?s).*?)</span>
+sizeRex            = alt="Size:\ ((?s).*?)"\ />&nbsp<small>
+difficultyRex      = <span\ id="ctl00_ContentBody_Difficulty">.*?alt="(.*?)\ out\ of
+terrainRex         = <span\ id="ctl00_ContentBody_Terrain">.*?alt="(.*?)\ out\ of
+cacheTypeRex       = /images/WptTypes/(.*?)\\.gif"\ alt="
+cacheLocationRex   = <span\ id="ctl00_ContentBody_Location">In\ ([^<]*?)<
 premiumCachepage   = Sorry, the owner of this listing has made it viewable to subscribers only.
 
 #--------------------------------------
 #Section2a: Logs
 #--------------------------------------
 # blockRex extrahiert zun?chst aus der gesamten Seite den Logbereich
-blockRex           = <span\ id="CacheLogs">((?s).*?)</span>
+blockRex           = <table class="LogsTable Table">((?s).*?)</table></span></p>
 # singleLogEx extrahiert in einer Schleife alle Logs aus dem Logbereich
-singleLogExStart   = <STRONG>
-singleLogExEnd     = [<a\ href=
+singleLogExStart   = <strong>
+singleLogExEnd     = <small><a\ href="
 # iconEx, nameTempEx, dateEx, singleLogEx werden auf einen singleLog angewendet
 iconExStart        = http://www.geocaching.com/images/icons/
-iconExEnd          = '\ align='abs
+iconExEnd          = "\ alt=""\ />
 nameTempExStart    = <a\ href="
 nameTempExEnd      = /a>
 # Name extrahiert aus nameTemp
 nameExStart        = >
 nameExEnd          = <
-dateExStart        = align='absmiddle'>&nbsp;
-dateExEnd          = \ by\ <
+dateExStart        = gif"\ alt=""\ />&nbsp;
+dateExEnd          = \ by\ <a\ href="/profile/?guid=
 logExStart         = found)<br\ />
-logExEnd           = <br\ />[
-logIdExStart         = by\ <a\ name="
-logIdExEnd           = "\ style="
+logExEnd           = <br\ /><small><a\ href="
+logIdExStart         = "\ id="
+logIdExEnd           = ">
 # Die Icons, die einen erfolgreichen Fund signalisieren
 icon_smile         = icon_smile.gif
 icon_camera        = icon_camera.gif
@@ -134,11 +138,11 @@
 #Section2b: Bugs
 #--------------------------------------
 # blockEx extrahiert zun?chst den Bugbereich aus der gesamten Seite
-blockExStart       = >&nbsp;<b>Inventory</b>
-blockExEnd         = What\ are\ Trackable\ Items?
+blockExStart       = >&nbsp;Inventory</h3>
+blockExEnd         = <p class="NoSpacing">
 # bugEx extrahiert die Namen der einzelnen Bugs aus dem Bugbereich
-bugExStart         = <a\ href='
-bugExEnd           = </a></strong></td>
+bugExStart         = <a\ href="
+bugExEnd           = </a></li>
 bugDetailsStart    = id="ctl00_ContentBody_BugDetails_BugGoal">
 bugDetailsEnd      = </span>
 getBugByName       = http://www.geocaching.com/track/search.aspx?k=
@@ -160,10 +164,10 @@
 imgBlockExStart    = <IMG
 imgBlockExEnd      = >
 # imgSpanEx searches for images in the image section
-imgSpanExStart     = <span\ id="Images"
-imgSpanExEnd       = </span>
-imgNameExStart     = align="absmiddle"\ border="0">
-imgNameExEnd       = </a><br\ />
+imgSpanExStart     = <span id="ctl00_ContentBody_Images">
+imgSpanExEnd       = </span></p>
+imgNameExStart     = "\ />\ <span>
+imgNameExEnd       = </span></a>
 imgSrcExStart      = <a\ href="http://
 imgSrcExEnd        = "\ rel="lightbox"
 imgCommentExStart  = </a><br\ />
@@ -175,18 +179,18 @@
 wayBlockExStart    = <strong>Additional\ Waypoints</strong>
 wayBlockExEnd      = </table>
 nameRex            = &RefDS=1">(.*)</a>
-koordRex           = align="left">([NSns]\ [0-9]{1,2}..[0-9]{1,2}.[0-9]{1,3}\ [EWew]\ [0-9]{1,3}..[0-9]{1,2}.[0-9]{1,3})</td>
+koordRex           = <td>([NSns]\ [0-9]{1,2}..[0-9]{1,2}.[0-9]{1,3}\ [EWew]\ [0-9]{1,3}..[0-9]{1,2}.[0-9]{1,3})</td>
 descRex            = colspan="4">((?:.|\n|\r)*?)</td>
 typeRex            = </a>\ \\((.*)\\)</td>
 rowBlockExStart    = <tr
 rowBlockExEnd      = </tr>
-prefixExStart      = <td\ valign=\"top\"\ align=\"left\">
+prefixExStart      = <td>
 prefixExEnd        = </td>
 
 #--------------------------------------
 #Section2e: Attributes
 #--------------------------------------
-attBlockExStart = &nbsp;<b>Attributes</b><br/><table
-attBlockExEnd  = </td></tr></table>
+attBlockExStart = watching\ this\ cache.<br\ /></small>
+attBlockExEnd  = What\ are\ Attributes?</a></small></p>
 attExStart = /images/attributes/
-attExEnd = " Alt="
+attExEnd = "\ alt="

Modified: trunk/src/CacheWolf/LogList.java
===================================================================
--- trunk/src/CacheWolf/LogList.java	2010-01-12 09:33:09 UTC (rev 2401)
+++ trunk/src/CacheWolf/LogList.java	2010-01-14 01:37:42 UTC (rev 2402)
@@ -93,17 +93,21 @@
 	 /**
 	  *  Count the number of not-found logs
 	  */
-	 public byte countNotFoundLogs() {
+	public byte countNotFoundLogs() {
 		byte countNoFoundLogs = 0;
+		int currentLog = 0;
+		String currentIcon;
 		while(countNoFoundLogs < size() && countNoFoundLogs < 5){
-			if(getLog(countNoFoundLogs).getIcon().startsWith("icon_sad")) {
+			currentIcon = getLog(currentLog).getIcon();
+			if(currentIcon.startsWith("icon_sad")) {
 				countNoFoundLogs++;
-			}else if (getLog(countNoFoundLogs).getIcon().startsWith("icon_smile")) {
-        break;
-      }
+			}else if (currentIcon.startsWith("icon_smile") || currentIcon.startsWith("icon_camera") || currentIcon.startsWith("icon_attended") || currentIcon.startsWith("icon_rsvp")) {
+				break;
+			}
+			currentLog++;
 		}
 		return countNoFoundLogs;
-	 }
+	}
 
 	 /** only valid after calling calcRecommendations() */
 	 int numRecommended = 0;

Modified: trunk/src/CacheWolf/imp/SpiderGC.java
===================================================================
--- trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-12 09:33:09 UTC (rev 2401)
+++ trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-14 01:37:42 UTC (rev 2402)
@@ -115,8 +115,12 @@
 	private static String propFirstLine2;
 	private static String propMaxDistance;
 	private static String propShowOnlyFound;
-	private static String propListBlockRex;
-	private static String propLineRex;
+	private static Regex RexPropListBlock;
+	private static Regex RexPropLine;
+	private static Regex RexPropLogDate;
+	private static String propAvailable;
+	private static String propPM;
+	private static Regex RexPropDirection;
 
 	private int numFoundUpdates=0;
 	private int numArchivedUpdates=0;
@@ -301,18 +305,16 @@
 			maxNew=java.lang.Math.min(numFinds-numFoundInDB,maxNew);
 			if (maxUpdate==0 && maxNew == 0) { Vm.showWait(false); infB.close(0); return; }
 		}
-		Regex lineRex = new Regex(propLineRex);
 		try {
 			//Loop pages till maximum distance has been found or no more caches are in the list
 			while(maxDistance > 0){
-				Regex listBlockRex = new Regex(propListBlockRex); // "<table id=\"dlResults\"((?s).*?)</table>"
-				listBlockRex.search(htmlListPage);
-				String tableOfHtmlListPage = listBlockRex.stringMatched(1);
-				lineRex.search(tableOfHtmlListPage);
+				RexPropListBlock.search(htmlListPage);
+				String tableOfHtmlListPage = RexPropListBlock.stringMatched(1);
+				RexPropLine.search(tableOfHtmlListPage);
 				while (maxDistance > 0){
-					if (!lineRex.didMatch()) break;
+					if (!RexPropLine.didMatch()) break;
 					found_on_page++;
-					String CacheDescriptionGC=lineRex.stringMatched(1);
+					String CacheDescriptionGC=RexPropLine.stringMatched(1);
 					double gotDistance=getDistGC(CacheDescriptionGC);
 					String chWaypoint=getWP(CacheDescriptionGC);
 					if(gotDistance <= maxDistance){
@@ -340,7 +342,7 @@
 						}
 					} else maxDistance = 0; // finish listing
 					// get next row of table (next Cache Description) of this htmlListPage
-					lineRex.searchFrom(tableOfHtmlListPage, lineRex.matchedTo());
+					RexPropLine.searchFrom(tableOfHtmlListPage, RexPropLine.matchedTo());
 					if (infB.isClosed) break;
 				} // next Cache
 				infB.setInfo(MyLocale.getMsg(5521,"Page ") + page_number + "\n" +
@@ -682,8 +684,12 @@
 			propFirstLine2=p.getProp("firstLine2");
 			propMaxDistance=p.getProp("maxDistance");
 			propShowOnlyFound=p.getProp("showOnlyFound");
-			propListBlockRex=p.getProp("listBlockRex");
-			propLineRex=p.getProp("lineRex");
+			RexPropListBlock = new Regex(p.getProp("listBlockRex"));
+			RexPropLine = new Regex(p.getProp("lineRex"));
+			RexPropLogDate = new Regex(p.getProp("logDateRex"));
+			propAvailable=p.getProp("availableRex");
+			propPM=p.getProp("PMRex");
+			RexPropDirection=new Regex(p.getProp("directionRex"));
 		}catch(Exception ex){
 		}
 	}
@@ -781,8 +787,9 @@
 			boolean is_archived_GC=CacheDescription.indexOf("<font color=\"red\"><strike>")!=-1;
 			if (is_archived_GC!=ch.is_archived()) { ch.setArchived(is_archived_GC); ch.save(); numArchivedUpdates+=1; return true;}
 		}
-		boolean is_available_GC=CacheDescription.indexOf("<strike>")==-1;
-		if (is_available_GC != ch.is_available()) { ch.setAvailable(is_available_GC); ch.save(); numAvailableUpdates+=1; return true;}
+		boolean is_available_GC=CacheDescription.indexOf(propAvailable)==-1;
+		if (is_available_GC != ch.is_available()) {
+			ch.setAvailable(is_available_GC); ch.save(); numAvailableUpdates+=1; return true;}
 		if (newLogExists(ch,CacheDescription)) {numLogUpdates+=1; return true;}
 		return false;
 	}
@@ -849,7 +856,10 @@
 	private boolean doPMCache(String toCheck) {
 		// int linePM=10;
 		if (pref.isPremium) return true;
-		if (toCheck.indexOf("small_profile.gif")>0) return false; else return true;
+		if (toCheck.indexOf(propPM)>0)
+			return false;
+		else
+			return true;
 	}
 
 	/**
@@ -858,11 +868,9 @@
 	 * @return direction String
 	 */
 	private String getDirection(String doc) throws Exception {
-		// int lineDirection=1;
-		Regex inRex = new Regex(p.getProp("directionRex"));
-		inRex.search(doc);
-		if (!inRex.didMatch()) return "";
-		return inRex.stringMatched(1);
+		RexPropDirection.search(doc);
+		if (!RexPropDirection.didMatch()) return "";
+		return RexPropDirection.stringMatched(1);
 	}
 
 	/*
@@ -891,14 +899,7 @@
 	 */
 	private boolean newLogExists(CacheHolder ch, String cacheDescrition) {
 		if(!pref.checkLog) return false;
-		String[] CacheDesc=mString.split(cacheDescrition,'\n');
-		int anzLines=38;
-		int lineLastFound=27;
-		if(CacheDesc.length!=anzLines) {
-			maxDistance = 0; //add no more caches
-			(new MessageBox(MyLocale.getMsg(5500,"Error"), "GC changed table output \nCW must be changed too!", FormBase.OKB)).execute();
-			return false;
-		}
+		// String[] CacheDesc=mString.split(cacheDescrition,'\n');
 		Time lastLogCW = new Time();
 		CacheHolderDetail chd = ch.getCacheDetails(true);
 		String slastLogCW=chd.CacheLogs.getLog(0).getDate();
@@ -911,11 +912,17 @@
 		lastLogGC.second=0;
 		lastLogGC.millis=0;
 		String[] SDate;
-		String stmp=CacheDesc[lineLastFound].trim();
+		// String stmp=CacheDesc[lineLastFound].trim();
+		String stmp="";
+		RexPropLogDate.search(cacheDescrition);
+		if (RexPropLogDate.didMatch()) {
+			stmp=RexPropLogDate.stringMatched(1);
+		}
+		else return false;
 		if (stmp.indexOf("day")>0) {
 			lastLogGC.day=java.lang.Math.max(1, lastLogGC.day-7); // simplyfied (update if not newer than last week)
 		}
-		else if (stmp.startsWith("<br />")) {
+		else if (stmp.equals("")) {
 			Vm.debug("no log yet");
 			return false; // no log yet
 		}
@@ -1395,7 +1402,7 @@
 		while(exBug.endOfSearch() == false){
 			if (infB.isClosed) break; // Allow user to cancel by closing progress form
 			linkPlusBug= exBug.findNext();
-			int idx=linkPlusBug.indexOf("'>");
+			int idx=linkPlusBug.indexOf("\">");
 			if (idx<0) break; // No link/bug pair found
 			link=linkPlusBug.substring(0,idx);
 			bug=linkPlusBug.substring(idx+2);
@@ -1688,8 +1695,16 @@
 			rowBlock = exRowBlock.findNext();
 			while(exRowBlock.endOfSearch()==false){
 				CacheHolder hd = null;
-				Extractor exPrefix=new Extractor(rowBlock,p.getProp("prefixExStart"),p.getProp("prefixExEnd"),0,true);
+
+				String[] AddiBlock=mString.split(rowBlock,'\n');
+				int linePrefix=3;
+				if(AddiBlock.length < linePrefix + 1) {
+					(new MessageBox(MyLocale.getMsg(5500,"Error"), "GC changed table output \nCW must be changed too!", FormBase.OKB)).execute();
+					break;
+				}				
+				Extractor exPrefix=new Extractor(AddiBlock[linePrefix].trim(),p.getProp("prefixExStart"),p.getProp("prefixExEnd"),0,true);
 				String prefix=exPrefix.findNext();
+
 				String adWayPoint;
 				if (prefix.length()==2)
 					adWayPoint=prefix+wayPoint.substring(2);



From mik77 at mail.berlios.de  Thu Jan 14 02:43:33 2010
From: mik77 at mail.berlios.de (mik77 at mail.berlios.de)
Date: Thu, 14 Jan 2010 02:43:33 +0100
Subject: [Cachewolf-svn] r2403 - trunk
Message-ID: <201001140143.o0E1hXTt008683@sheep.berlios.de>

Author: mik77
Date: 2010-01-14 02:43:32 +0100 (Thu, 14 Jan 2010)
New Revision: 2403

Modified:
   trunk/buildexe.bat
Log:
ups, correct version restored

Modified: trunk/buildexe.bat
===================================================================
--- trunk/buildexe.bat	2010-01-14 01:37:42 UTC (rev 2402)
+++ trunk/buildexe.bat	2010-01-14 01:43:32 UTC (rev 2403)
@@ -1,5 +1,6 @@
 cd %~d0%~p0
 call getres.bat
+java -cp lib/ewe.jar Ewe programs/Jewel.ewe -c cw-pda.jnf
 java -cp lib/ewe.jar Ewe programs/Jewel.ewe -c cw-ppc2003.jnf
 java -cp lib/ewe.jar Ewe programs/Jewel.ewe -c cw-pc.jnf
 REM Dont change the order above because the PC version has to overwrite the PDA version of the EWE-file



From mik77 at mail.berlios.de  Thu Jan 14 09:18:26 2010
From: mik77 at mail.berlios.de (mik77 at mail.berlios.de)
Date: Thu, 14 Jan 2010 09:18:26 +0100
Subject: [Cachewolf-svn] r2404 - trunk/src/CacheWolf
Message-ID: <201001140818.o0E8IQxl024162@sheep.berlios.de>

Author: mik77
Date: 2010-01-14 09:18:21 +0100 (Thu, 14 Jan 2010)
New Revision: 2404

Modified:
   trunk/src/CacheWolf/LogList.java
Log:
correct counting of DNFs

Modified: trunk/src/CacheWolf/LogList.java
===================================================================
--- trunk/src/CacheWolf/LogList.java	2010-01-14 01:43:32 UTC (rev 2403)
+++ trunk/src/CacheWolf/LogList.java	2010-01-14 08:18:21 UTC (rev 2404)
@@ -97,7 +97,7 @@
 		byte countNoFoundLogs = 0;
 		int currentLog = 0;
 		String currentIcon;
-		while(countNoFoundLogs < size() && countNoFoundLogs < 5){
+		while(currentLog < size() && countNoFoundLogs < 5){
 			currentIcon = getLog(currentLog).getIcon();
 			if(currentIcon.startsWith("icon_sad")) {
 				countNoFoundLogs++;



From mik77 at mail.berlios.de  Thu Jan 14 13:28:57 2010
From: mik77 at mail.berlios.de (mik77 at mail.berlios.de)
Date: Thu, 14 Jan 2010 13:28:57 +0100
Subject: [Cachewolf-svn] r2405 - trunk/src/CacheWolf
Message-ID: <201001141228.o0ECSvcC012522@sheep.berlios.de>

Author: mik77
Date: 2010-01-14 13:28:49 +0100 (Thu, 14 Jan 2010)
New Revision: 2405

Modified:
   trunk/src/CacheWolf/LogList.java
Log:
stop counting DNFs on owner maintenance

Modified: trunk/src/CacheWolf/LogList.java
===================================================================
--- trunk/src/CacheWolf/LogList.java	2010-01-14 08:18:21 UTC (rev 2404)
+++ trunk/src/CacheWolf/LogList.java	2010-01-14 12:28:49 UTC (rev 2405)
@@ -101,7 +101,9 @@
 			currentIcon = getLog(currentLog).getIcon();
 			if(currentIcon.startsWith("icon_sad")) {
 				countNoFoundLogs++;
-			}else if (currentIcon.startsWith("icon_smile") || currentIcon.startsWith("icon_camera") || currentIcon.startsWith("icon_attended") || currentIcon.startsWith("icon_rsvp")) {
+			}else if (currentIcon.startsWith("icon_smile") || currentIcon.startsWith("icon_camera")
+             || currentIcon.startsWith("icon_attended") || currentIcon.startsWith("icon_rsvp")
+             || currentIcon.startsWith("icon_maint")) {
 				break;
 			}
 			currentLog++;



From araber95 at mail.berlios.de  Thu Jan 14 18:25:26 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Thu, 14 Jan 2010 18:25:26 +0100
Subject: [Cachewolf-svn] r2406 - trunk/src/CacheWolf/imp
Message-ID: <201001141725.o0EHPQMu018197@sheep.berlios.de>

Author: araber95
Date: 2010-01-14 18:25:24 +0100 (Thu, 14 Jan 2010)
New Revision: 2406

Modified:
   trunk/src/CacheWolf/imp/SpiderGC.java
Log:
saving without html - entities due to GC update
Minor chnges for possible further checking for updates

Modified: trunk/src/CacheWolf/imp/SpiderGC.java
===================================================================
--- trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-14 12:28:49 UTC (rev 2405)
+++ trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-14 17:25:24 UTC (rev 2406)
@@ -121,6 +121,8 @@
 	private static String propAvailable;
 	private static String propPM;
 	private static Regex RexPropDirection;
+	private static Regex RexPropDistance;
+	private static Regex RexPropWaypoint;
 
 	private int numFoundUpdates=0;
 	private int numArchivedUpdates=0;
@@ -290,6 +292,7 @@
 				}
 			}
 		}
+		int startSize=cachesToUpdate.size();
 
 		//=======
 		// Prepare list of all caches that are to be spidered
@@ -361,7 +364,7 @@
 		infB.setInfo(MyLocale.getMsg(5511,"Found ") + cachesToLoad.size() + MyLocale.getMsg(5512," caches"));
 
 		pref.log("Checked " + page_number + " pages");
-		pref.log("with " + ((page_number-1)*20+found_on_page) + " caches");
+		pref.log("with " + ((page_number-1)*20+found_on_page-1) + " caches");
 		pref.log("Found " + cachesToLoad.size() + " new caches");
 		pref.log("Found " + cachesToUpdate.size() + "/" + cachesShouldUpdate.size() + " caches for update");
 		if(spiderAllFinds){
@@ -379,6 +382,7 @@
 		boolean loadAllLogs = (pref.maxLogsToSpider > 5) || spiderAllFinds;
 
 		int spiderErrors = 0;
+		if (cachesToUpdate.size()==startSize) cachesToUpdate.clear(); // there must be something wrong
 		if (cachesToUpdate.size()==0) cachesToUpdate=cachesShouldUpdate;
 
 		if ( cachesToUpdate.size() > 0 ) {
@@ -690,6 +694,8 @@
 			propAvailable=p.getProp("availableRex");
 			propPM=p.getProp("PMRex");
 			RexPropDirection=new Regex(p.getProp("directionRex"));
+			RexPropDistance = new Regex(p.getProp("distRex"));
+			RexPropWaypoint = new Regex(p.getProp("waypointRex"));
 		}catch(Exception ex){
 		}
 	}
@@ -781,17 +787,20 @@
 	 * @return true if new Update exists else false
 	 */
 	private boolean updateExists(CacheHolder ch, String CacheDescription) {
-		// int lineDescription=20;
+		boolean ret = false;
+		boolean save = false;
 		if (spiderAllFinds) {
-			if(!ch.is_found()) { ch.setFound(true); ch.save(); numFoundUpdates+=1; return true;}
+			if(!ch.is_found()) { ch.setFound(true); save=true; numFoundUpdates+=1; ret=true;}
 			boolean is_archived_GC=CacheDescription.indexOf("<font color=\"red\"><strike>")!=-1;
-			if (is_archived_GC!=ch.is_archived()) { ch.setArchived(is_archived_GC); ch.save(); numArchivedUpdates+=1; return true;}
+			if (is_archived_GC!=ch.is_archived()) { ch.setArchived(is_archived_GC); save=true; numArchivedUpdates+=1; ret=true;}
 		}
 		boolean is_available_GC=CacheDescription.indexOf(propAvailable)==-1;
 		if (is_available_GC != ch.is_available()) {
-			ch.setAvailable(is_available_GC); ch.save(); numAvailableUpdates+=1; return true;}
-		if (newLogExists(ch,CacheDescription)) {numLogUpdates+=1; return true;}
-		return false;
+			ch.setAvailable(is_available_GC); save=true; numAvailableUpdates+=1; ret=true;}
+		// we could check for update of terrain,difficult,size,cache type for not necessarily to load the complete cache 
+		if (newLogExists(ch,CacheDescription)) {numLogUpdates+=1; ret=true;}
+		if (save) ch.save();
+		return ret;
 	}
 	/**
 	 * Get num found
@@ -828,12 +837,10 @@
 			return(0);
 		}
 		else {
-			 // int lineDistance=1;
-			Regex inRex = new Regex(p.getProp("distRex"));
-			inRex.search(doc);
-			if (!inRex.didMatch()) return 0;
-			if(MyLocale.getDigSeparator().equals(",")) return Convert.toDouble(inRex.stringMatched(1).replace('.',','));
-			return Convert.toDouble(inRex.stringMatched(1));
+			RexPropDistance.search(doc);
+			if (!RexPropDistance.didMatch()) return 0;
+			if(MyLocale.getDigSeparator().equals(",")) return Convert.toDouble(RexPropDistance.stringMatched(1).replace('.',','));
+			return Convert.toDouble(RexPropDistance.stringMatched(1));
 		}
 	}
 
@@ -843,11 +850,9 @@
 	 * @return Name of waypoint to add to list
 	 */
 	private String getWP(String doc) throws Exception {
-		// int lineWaypoint=22;
-		Regex inRex = new Regex(p.getProp("waypointRex"));
-		inRex.search(doc);
-		if (!inRex.didMatch()) return "???";
-		return "GC"+inRex.stringMatched(1);
+		RexPropWaypoint.search(doc);
+		if (!RexPropWaypoint.didMatch()) return "???";
+		return "GC"+RexPropWaypoint.stringMatched(1);
 	}
 
 	/**
@@ -912,7 +917,6 @@
 		lastLogGC.second=0;
 		lastLogGC.millis=0;
 		String[] SDate;
-		// String stmp=CacheDesc[lineLastFound].trim();
 		String stmp="";
 		RexPropLogDate.search(cacheDescrition);
 		if (RexPropLogDate.didMatch()) {
@@ -1202,7 +1206,7 @@
 		if (spanEnd >= 0) {
 			res = res.substring(0, spanEnd);
 		}
-		return res; // SafeXML.cleanback(res);
+		return SafeXML.cleanback(res); // since internal viewer doesn't show html-entities that are now in cacheDescription
 	}
 
 	/**



From mik77 at mail.berlios.de  Thu Jan 14 19:47:20 2010
From: mik77 at mail.berlios.de (mik77 at mail.berlios.de)
Date: Thu, 14 Jan 2010 19:47:20 +0100
Subject: [Cachewolf-svn] r2407 - trunk/res_noewe
Message-ID: <201001141847.o0EIlKGn008504@sheep.berlios.de>

Author: mik77
Date: 2010-01-14 19:47:18 +0100 (Thu, 14 Jan 2010)
New Revision: 2407

Modified:
   trunk/res_noewe/spider.def
Log:
RegEx shortened for Exe-Versions

Modified: trunk/res_noewe/spider.def
===================================================================
--- trunk/res_noewe/spider.def	2010-01-14 17:25:24 UTC (rev 2406)
+++ trunk/res_noewe/spider.def	2010-01-14 18:47:18 UTC (rev 2407)
@@ -95,7 +95,7 @@
 shortDescRex       = <span\ id="ctl00_ContentBody_ShortDescription">((?s).*?)</span>
 #This version doesn't work with EWE/EXE, so we trim the tags in code
 #longDescRex        = <span\ id="ctl00_ContentBody_LongDescription">((?s).*?)</span>(?:\\s*)<br\ />(?:\\s*)</p>(?:\\s*)<p>(?:\\s*)<strong>Additional\ Hints&nbsp;\\(</strong>
-longDescRex        = <span\ id="ctl00_ContentBody_LongDescription">((?s).*?)<td\ valign="top"\ width="10%">&nbsp;</td>
+longDescRex        = <span\ id="ctl00_ContentBody_LongDescription">((?s).*?)<td\ valign="top"
 cacheNameRex       = <span\ id="ctl00_ContentBody_CacheName">((?s).*?)</span>
 cacheOwnerRex      = <span\ id="ctl00_ContentBody_CacheOwner">by\ <a\ href=(?:(?s).*?)>((?s).*?)</a></span>
 dateHiddenRex      = <span\ id="ctl00_ContentBody_DateHidden">((?s).*?)</span>



From mik77 at mail.berlios.de  Fri Jan 15 10:45:02 2010
From: mik77 at mail.berlios.de (mik77 at mail.berlios.de)
Date: Fri, 15 Jan 2010 10:45:02 +0100
Subject: [Cachewolf-svn] r2408 - trunk/res_noewe
Message-ID: <201001150945.o0F9j2Xc013756@sheep.berlios.de>

Author: mik77
Date: 2010-01-15 10:44:54 +0100 (Fri, 15 Jan 2010)
New Revision: 2408

Modified:
   trunk/res_noewe/spider.def
Log:
small correction to prevent false recognition of distance

Modified: trunk/res_noewe/spider.def
===================================================================
--- trunk/res_noewe/spider.def	2010-01-14 18:47:18 UTC (rev 2407)
+++ trunk/res_noewe/spider.def	2010-01-15 09:44:54 UTC (rev 2408)
@@ -61,7 +61,7 @@
 logDateRex         = <td>(.*?)<br\ /><span\ class="Success"></span></td>
 availableRex       = <span class="Strike">
 PMRex              = small_profile.gif
-distRex            = <br\ />(.*?)(?:km|mi)
+distRex            = <br\ />(.*?)(?:km|mi)</td>
 waypointRex        = \\(GC(.*?)\\)<br\ />
 showOnlyFound      = &f=1
 maxDistance        = &dist=



From mik77 at mail.berlios.de  Fri Jan 15 10:54:26 2010
From: mik77 at mail.berlios.de (mik77 at mail.berlios.de)
Date: Fri, 15 Jan 2010 10:54:26 +0100
Subject: [Cachewolf-svn] r2409 - in branches/bugfix_1.0: res_noewe
	src/CacheWolf
Message-ID: <201001150954.o0F9sQsx014393@sheep.berlios.de>

Author: mik77
Date: 2010-01-15 10:54:16 +0100 (Fri, 15 Jan 2010)
New Revision: 2409

Modified:
   branches/bugfix_1.0/res_noewe/spider.def
   branches/bugfix_1.0/src/CacheWolf/SpiderGC.java
Log:
Changes from trunk for new GC design

Modified: branches/bugfix_1.0/res_noewe/spider.def
===================================================================
--- branches/bugfix_1.0/res_noewe/spider.def	2010-01-15 09:44:54 UTC (rev 2408)
+++ branches/bugfix_1.0/res_noewe/spider.def	2010-01-15 09:54:16 UTC (rev 2409)
@@ -24,7 +24,8 @@
 # Version 4.0 - 20080725 adaption to new GC-design
 # Version 4.1 - 20080725 adaption to new GC-design (images and travelbugs)
 # Version 4.x - 20091105 some updates from trunk
-#=Version 5.0 - 20091105 adaption to new GC-design
+# Version 5.0 - 20091105 adaption to new GC-design
+# Version 6.0 - 20100113 adaption to new GC-design
 #============================================================
 # A suffix of Rex indicates a regular expression
 # A suffix of ExStart indicates the start of an Extractor search pattern
@@ -45,8 +46,9 @@
 firstPage2         = &lng=
 # Regex to search for cachenames 
 listBlockRex       = <table id="ctl00_ContentBody_dlResults"((?s).*?)</table>
-lineRex            = <tr\ bgcolor='#.{6}'>(?:(?s).*?)<td\ valign="top"\ align="left">((?s).*?)</tr>
-distRex            = <br\ />(.*?)(?:km|mi)(?:\\s*)</td>
+lineRex            = <tr\ bgcolor='#.{6}'\ class="Data\ BorderTop">((?s).*?)</tr>
+availableRex       = <span class="Strike">
+distRex            = <br\ />(.*?)(?:km|mi)</td>
 waypointRex        = \\(GC(.*?)\\)<br\ />
 showOnlyFound      = &f=1
 firstLine          = http://www.geocaching.com/seek/nearest.aspx?lat=
@@ -58,40 +60,40 @@
 #--------------------------------------
 getPageByName      = http://www.geocaching.com/seek/cache_details.aspx?wp=
 fetchAllLogs       = &log=y
-cacheUnavailable   = <ul><font\ color="red"><li>This\ cache\ is\ temporarily\ unavailable.\ Read\ the\ logs\ below\ to\ read\ the\ status\ for\ this\ cache.</li></font></ul>
-cacheArchived      = This cache\ has\ been\ archived
-latLonRex          = <span\ id="LatLon"\ style="font-weight:bold;">((?s).*?)</span>
-shortDescRex       = <span\ id="ShortDescription">((?s).*?)</span>
-longDescRex        = <span\ id="LongDescription">((?s).*?)<strong>Additional\ Hints&nbsp;\\(</strong>
-cacheNameRex       = <span\ id="CacheName">((?s).*?)</span>
-cacheOwnerRex      = <span\ id="CacheOwner">by\ <a\ href=(?:(?s).*?)>((?s).*?)</a></span>
-dateHiddenRex      = <span\ id="DateHidden">((?s).*?)</span>
-hintsRex           = <span\ id="Hints"\ class="displayMe">((?s).*?)</span>
-sizeRex            = alt="Size:\ ((?s).*?)"\ title="Size:
-difficultyRex      = <span\ id="Difficulty">.*?alt="(.*?)\ out\ of
-terrainRex         = <span\ id="Terrain">.*?alt="(.*?)\ out\ of
-cacheTypeRex       = /images/WptTypes/(.*?)\\.gif"\ ALT="
+cacheUnavailable   = <ul\ class="OldWarning"><li>This\ cache\ is\ temporarily\ unavailable.\ Read\ the\ logs\ below\ to\ read\ the\ status\ for\ this\ cache.</li></ul></span>
+cacheArchived      = <ul\ class="OldWarning"><li>This\ cache\ has\ been\ archived,\ but\ is\ available\ for\ viewing\ for\ archival\ purposes.</li></ul></span>
+latLonRex          = <span\ id="ctl00_ContentBody_LatLon"\ style="font-weight:bold;">((?s).*?)</span>
+shortDescRex       = <span\ id="ctl00_ContentBody_ShortDescription">((?s).*?)</span>
+longDescRex        = <span\ id="ctl00_ContentBody_LongDescription">((?s).*?)<td\ valign="top"
+cacheNameRex       = <span\ id="ctl00_ContentBody_CacheName">((?s).*?)</span>
+cacheOwnerRex      = <span\ id="ctl00_ContentBody_CacheOwner">by\ <a\ href=(?:(?s).*?)>((?s).*?)</a></span>
+dateHiddenRex      = <span\ id="ctl00_ContentBody_DateHidden">((?s).*?)</span>
+hintsRex           = <span\ id="ctl00_ContentBody_Hints"\ class="displayMe">((?s).*?)</span>
+sizeRex            = alt="Size:\ ((?s).*?)"\ />&nbsp<small>
+difficultyRex      = <span\ id="ctl00_ContentBody_Difficulty">.*?alt="(.*?)\ out\ of
+terrainRex         = <span\ id="ctl00_ContentBody_Terrain">.*?alt="(.*?)\ out\ of
+cacheTypeRex       = /images/WptTypes/(.*?)\\.gif"\ alt="
 
 #--------------------------------------
 #Section2a: Logs
 #--------------------------------------
 # blockRex extrahiert zun?chst aus der gesamten Seite den Logbereich
-blockRex           = <span\ id="CacheLogs">((?s).*?)</span>
+blockRex           = <table class="LogsTable Table">((?s).*?)</table></span></p>
 # singleLogEx extrahiert in einer Schleife alle Logs aus dem Logbereich
-singleLogExStart   = <STRONG>
-singleLogExEnd     = [<a\ href=
+singleLogExStart   = <strong>
+singleLogExEnd     = <small><a\ href="
 # iconEx, nameTempEx, dateEx, singleLogEx werden auf einen singleLog angewendet
 iconExStart        = http://www.geocaching.com/images/icons/
-iconExEnd          = '\ align='abs
+iconExEnd          = "\ alt=""\ />
 nameTempExStart    = <a\ href="
 nameTempExEnd      = /a>
 # Name extrahiert aus nameTemp
 nameExStart        = >
 nameExEnd          = <
-dateExStart        = align='absmiddle'>&nbsp;
-dateExEnd          = \ by\ <
+dateExStart        = gif"\ alt=""\ />&nbsp;
+dateExEnd          = \ by\ <a\ href="/profile/?guid=
 logExStart         = found)<br\ />
-logExEnd           = <br\ />[
+logExEnd           = <br\ /><small><a\ href="
 # Die Icons, die einen erfolgreichen Fund signalisieren
 icon_smile         = icon_smile.gif
 icon_camera        = icon_camera.gif
@@ -101,11 +103,11 @@
 #Section2b: Bugs
 #--------------------------------------
 # blockEx extrahiert zun?chst den Bugbereich aus der gesamten Seite
-blockExStart       = >&nbsp;<b>Inventory</b>
-blockExEnd         = What\ are\ Trackable\ Items?
+blockExStart       = >&nbsp;Inventory</h3>
+blockExEnd         = <p class="NoSpacing">
 # bugEx extrahiert die Namen der einzelnen Bugs aus dem Bugbereich
-bugExStart         = <a\ href='
-bugExEnd           = </a></strong></td>
+bugExStart         = <a\ href="
+bugExEnd           = </a></li>
 bugDetailsStart    = id="ctl00_ContentBody_BugDetails_BugGoal">
 bugDetailsEnd      = </span>
 getBugByName       = http://www.geocaching.com/track/search.aspx?k=
@@ -127,10 +129,10 @@
 imgBlockExStart    = <IMG
 imgBlockExEnd      = >
 # imgSpanEx searches for images in the image section
-imgSpanExStart     = <span\ id="Images"
-imgSpanExEnd       = </span>
-imgNameExStart     = align="absmiddle"\ border="0">
-imgNameExEnd       = </a><br\ />
+imgSpanExStart     = <span id="ctl00_ContentBody_Images">
+imgSpanExEnd       = </span></p>
+imgNameExStart     = "\ />\ <span>
+imgNameExEnd       = </span></a>
 imgSrcExStart      = <a\ href="http://
 imgSrcExEnd        = "\ rel="lightbox"
 imgCommentExStart  = </a><br\ />
@@ -142,18 +144,18 @@
 wayBlockExStart    = <strong>Additional\ Waypoints</strong>
 wayBlockExEnd      = </table>
 nameRex            = &RefDS=1">(.*)</a>
-koordRex           = align="left">([NSns]\ [0-9]{1,2}..[0-9]{1,2}.[0-9]{1,3}\ [EWew]\ [0-9]{1,3}..[0-9]{1,2}.[0-9]{1,3})</td>
+koordRex           = <td>([NSns]\ [0-9]{1,2}..[0-9]{1,2}.[0-9]{1,3}\ [EWew]\ [0-9]{1,3}..[0-9]{1,2}.[0-9]{1,3})</td>
 descRex            = colspan="4">((?:.|\n|\r)*?)</td>
 typeRex            = </a>\ \\((.*)\\)</td>
 rowBlockExStart    = <tr
 rowBlockExEnd      = </tr>
-prefixExStart      = <td\ valign=\"top\"\ align=\"left\">
+prefixExStart      = <td>
 prefixExEnd        = </td>
 
 #--------------------------------------
 #Section2e: Attributes
 #--------------------------------------
-attBlockExStart = &nbsp;<b>Attributes</b><br/><table
-attBlockExEnd  = </td></tr></table>
+attBlockExStart = watching\ this\ cache.<br\ /></small>
+attBlockExEnd  = What\ are\ Attributes?</a></small></p>
 attExStart = /images/attributes/
-attExEnd = " Alt="
+attExEnd = "\ alt="

Modified: branches/bugfix_1.0/src/CacheWolf/SpiderGC.java
===================================================================
--- branches/bugfix_1.0/src/CacheWolf/SpiderGC.java	2010-01-15 09:44:54 UTC (rev 2408)
+++ branches/bugfix_1.0/src/CacheWolf/SpiderGC.java	2010-01-15 09:54:16 UTC (rev 2409)
@@ -347,8 +347,10 @@
 		dummy = "";
 		//String lineBlck = "";
 		int page_number = 1;
+		String propAvailable;
 		try  {
 			lineRex = new Regex(p.getProp("lineRex")); //"<tr bgcolor=((?s).*?)</tr>"
+			propAvailable=p.getProp("availableRex");
 		} catch (Exception ex) {
 			infB.close(0);
 			Vm.showWait(false);
@@ -405,8 +407,8 @@
 							pref.log(waypoint+" already in DB");
 							ch=(CacheHolder) cacheDB.get(nr.intValue());
 							// If the <strike> tag is used, the cache is marked as unavailable or archived
-							boolean is_archived_GC=lineRex.stringMatched(1).indexOf("<strike><font color=\"red\">")!=-1;
-							boolean is_available_GC=lineRex.stringMatched(1).indexOf("<strike>")==-1;
+							boolean is_archived_GC=lineRex.stringMatched(1).indexOf("<font color=\"red\"><strike>")!=-1;
+							boolean is_available_GC=lineRex.stringMatched(1).indexOf(propAvailable)==-1;
 							if (ch.is_archived!=is_archived_GC) { // Update the database with the cache status
 								pref.log("Updating status of "+waypoint+" to "+(is_archived_GC?"archived":"not archived"));
 								ch.is_archived=is_archived_GC;
@@ -763,7 +765,7 @@
 		rex2.search(doc);
 		res = ((inRex.stringMatched(1)==null)?"":inRex.stringMatched(1)) + "<br>";
 		res += rex2.stringMatched(1);
-		return res; // SafeXML.cleanback(res);
+		return SafeXML.cleanback(res); // since internal viewer doesn't show html-entities that are now in cacheDescription
 	}
 
 	/**
@@ -942,7 +944,7 @@
 		while(exBug.endOfSearch() == false){
 			if (infB.isClosed) break; // Allow user to cancel by closing progress form
 			linkPlusBug= exBug.findNext();
-			int idx=linkPlusBug.indexOf("'>");
+			int idx=linkPlusBug.indexOf("\">");
 			if (idx<0) break; // No link/bug pair found
 			link=linkPlusBug.substring(0,idx);
 			bug=linkPlusBug.substring(idx+2);
@@ -1185,8 +1187,16 @@
 			rowBlock = exRowBlock.findNext();
 			while(exRowBlock.endOfSearch()==false){
 				CacheHolderDetail cxD = new CacheHolderDetail();
-				Extractor exPrefix=new Extractor(rowBlock,p.getProp("prefixExStart"),p.getProp("prefixExEnd"),0,true);
+				
+				String[] AddiBlock=mString.split(rowBlock,'\n');
+				int linePrefix=3;
+				if(AddiBlock.length < linePrefix + 1) {
+					(new MessageBox(MyLocale.getMsg(5500,"Error"), "GC changed table output \nCW must be changed too!", FormBase.OKB)).execute();
+					break;
+				}				
+				Extractor exPrefix=new Extractor(AddiBlock[linePrefix].trim(),p.getProp("prefixExStart"),p.getProp("prefixExEnd"),0,true);
 				String prefix=exPrefix.findNext();
+
 				String adWayPoint;
 				if (prefix.length()==2)
 					adWayPoint=prefix+wayPoint.substring(2);



From mik77 at mail.berlios.de  Sat Jan 16 15:57:23 2010
From: mik77 at mail.berlios.de (mik77 at mail.berlios.de)
Date: Sat, 16 Jan 2010 15:57:23 +0100
Subject: [Cachewolf-svn] r2410 - trunk
Message-ID: <201001161457.o0GEvNgo000783@sheep.berlios.de>

Author: mik77
Date: 2010-01-16 15:57:21 +0100 (Sat, 16 Jan 2010)
New Revision: 2410

Modified:
   trunk/currentversions.txt
Log:
current versions updated

Modified: trunk/currentversions.txt
===================================================================
--- trunk/currentversions.txt	2010-01-15 09:54:16 UTC (rev 2409)
+++ trunk/currentversions.txt	2010-01-16 14:57:21 UTC (rev 2410)
@@ -1,17 +1,17 @@
 # Release
 T0VersionMajor: 1
 T0VersionMinor: 0
-T0SvnRevision: 1947
+T0SvnRevision: 2409
 
 # ReleaseCandidate
 T1VersionMajor: 1
 T1VersionMinor: 0
-T1SvnRevision: 1947
+T1SvnRevision: 2409
 
 # InDevelopmentStable
 T2VersionMajor: 1
 T2VersionMinor: 1
-T2SvnRevision: 1536
+T2SvnRevision: 2408
 
 # InDevelopmentNewest
 T3VersionMajor: 1



From araber95 at mail.berlios.de  Sun Jan 17 10:43:54 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Sun, 17 Jan 2010 10:43:54 +0100
Subject: [Cachewolf-svn] r2411 - trunk/src/CacheWolf/imp
Message-ID: <201001170943.o0H9hso3002785@sheep.berlios.de>

Author: araber95
Date: 2010-01-17 10:43:52 +0100 (Sun, 17 Jan 2010)
New Revision: 2411

Modified:
   trunk/src/CacheWolf/imp/SpiderGC.java
Log:
correct default value for Premium

Modified: trunk/src/CacheWolf/imp/SpiderGC.java
===================================================================
--- trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-16 14:57:21 UTC (rev 2410)
+++ trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-17 09:43:52 UTC (rev 2411)
@@ -24,11 +24,6 @@
     */
 
 package CacheWolf.imp;
-import ewe.net.*;
-import ewe.io.*;
-import ewe.sys.*;
-import ewe.sys.Double;
-import ewe.util.*;
 import CacheWolf.CWPoint;
 import CacheWolf.CacheDB;
 import CacheWolf.CacheHolder;
@@ -55,10 +50,33 @@
 import CacheWolf.navi.Metrics;
 import CacheWolf.navi.TransformCoordinates;
 
-import com.stevesoft.ewe_pat.*;
-import ewe.ui.*;
+import com.stevesoft.ewe_pat.Regex;
+
 import ewe.data.Property;
 import ewe.data.PropertyList;
+import ewe.io.File;
+import ewe.io.FileBase;
+import ewe.io.FileInputStream;
+import ewe.io.FileOutputStream;
+import ewe.io.IOException;
+import ewe.io.JavaUtf8Codec;
+import ewe.net.Socket;
+import ewe.net.URL;
+import ewe.net.UnknownHostException;
+import ewe.sys.Convert;
+import ewe.sys.Double;
+import ewe.sys.Time;
+import ewe.sys.Vm;
+import ewe.ui.FormBase;
+import ewe.ui.MessageBox;
+import ewe.util.ByteArray;
+import ewe.util.CharArray;
+import ewe.util.Enumeration;
+import ewe.util.Hashtable;
+import ewe.util.Properties;
+import ewe.util.Utils;
+import ewe.util.Vector;
+import ewe.util.mString;
 
 /**
 *	Class to spider caches from gc.com
@@ -859,7 +877,6 @@
 	 * check for Premium Member Cache
 	 */
 	private boolean doPMCache(String toCheck) {
-		// int linePM=10;
 		if (pref.isPremium) return true;
 		if (toCheck.indexOf(propPM)>0)
 			return false;



From araber95 at mail.berlios.de  Sun Jan 17 11:09:33 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Sun, 17 Jan 2010 11:09:33 +0100
Subject: [Cachewolf-svn] r2412 - in trunk/src/CacheWolf: . imp
Message-ID: <201001171009.o0HA9XmS004757@sheep.berlios.de>

Author: araber95
Date: 2010-01-17 11:09:31 +0100 (Sun, 17 Jan 2010)
New Revision: 2412

Modified:
   trunk/src/CacheWolf/Preferences.java
   trunk/src/CacheWolf/imp/SpiderGC.java
Log:
correct default value for Premium (now committing the corresponding file)

Modified: trunk/src/CacheWolf/Preferences.java
===================================================================
--- trunk/src/CacheWolf/Preferences.java	2010-01-17 09:43:52 UTC (rev 2411)
+++ trunk/src/CacheWolf/Preferences.java	2010-01-17 10:09:31 UTC (rev 2412)
@@ -4,14 +4,33 @@
 import CacheWolf.navi.Metrics;
 import CacheWolf.navi.TransformCoordinates;
 import CacheWolf.utils.FileBugfix;
-import ewe.io.*;
-import ewe.sys.*;
-import ewe.ui.*;
-import ewesoft.xml.*;
-import ewesoft.xml.sax.*;
-import ewe.filechooser.*;
-import ewe.util.*;
+import ewe.filechooser.FileChooser;
+import ewe.filechooser.FileChooserBase;
+import ewe.io.BufferedWriter;
+import ewe.io.File;
+import ewe.io.FileBase;
+import ewe.io.FileWriter;
+import ewe.io.IOException;
+import ewe.io.PrintWriter;
+import ewe.io.SerialPort;
+import ewe.io.SerialPortOptions;
+import ewe.sys.Convert;
+import ewe.sys.Time;
+import ewe.sys.Vm;
+import ewe.ui.FormBase;
+import ewe.ui.InputBox;
+import ewe.ui.MessageBox;
+import ewe.ui.Window;
+import ewe.ui.WindowConstants;
+import ewe.util.Comparer;
+import ewe.util.Enumeration;
+import ewe.util.Hashtable;
+import ewe.util.Iterator;
+import ewe.util.StringTokenizer;
+import ewe.util.Utils;
 import ewe.util.Map.MapEntry;
+import ewesoft.xml.MinML;
+import ewesoft.xml.sax.AttributeList;
 
 /**
  *	A class to hold the preferences that were loaded upon start up of CacheWolf.
@@ -227,7 +246,7 @@
 	/** The own GC member ID */
 	public String gcMemberId = "";
 	/** Premium Member ? */
-	public boolean isPremium = true;
+	public boolean isPremium=true;
 	/** The maximum number of logs to export */
 	public int numberOfLogsToExport = 5;
 	/** Add Travelbugs when exporting */
@@ -388,7 +407,8 @@
 		else if(name.equals("alias2")) myAlias2 = SafeXML.cleanback(atts.getValue("name"));
 		else if(name.equals("gcmemberid")) {
 			gcMemberId = atts.getValue("name");
-			isPremium=Boolean.valueOf(atts.getValue("Premium")).booleanValue();
+			tmp=atts.getValue("Premium");
+			if (tmp != null) isPremium=Boolean.valueOf(tmp).booleanValue();
 		}
 		else if(name.equals("location")){
 			curCentrePt.set(atts.getValue("lat")+" "+atts.getValue("long"));

Modified: trunk/src/CacheWolf/imp/SpiderGC.java
===================================================================
--- trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-17 09:43:52 UTC (rev 2411)
+++ trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-17 10:09:31 UTC (rev 2412)
@@ -878,10 +878,7 @@
 	 */
 	private boolean doPMCache(String toCheck) {
 		if (pref.isPremium) return true;
-		if (toCheck.indexOf(propPM)>0)
-			return false;
-		else
-			return true;
+		return toCheck.indexOf(propPM) <= 0;
 	}
 
 	/**



From kalli at mail.berlios.de  Sun Jan 17 17:17:14 2010
From: kalli at mail.berlios.de (kalli at mail.berlios.de)
Date: Sun, 17 Jan 2010 17:17:14 +0100
Subject: [Cachewolf-svn] r2413 - in trunk: res_noewe/languages src/CacheWolf
	src/CacheWolf/exp
Message-ID: <201001171617.o0HGHELJ016055@sheep.berlios.de>

Author: kalli
Date: 2010-01-17 17:16:23 +0100 (Sun, 17 Jan 2010)
New Revision: 2413

Added:
   trunk/src/CacheWolf/exp/SpoilerPOIExporter.java
Modified:
   trunk/res_noewe/languages/DE.cfg
   trunk/res_noewe/languages/EN.cfg
   trunk/res_noewe/languages/FR.cfg
   trunk/res_noewe/languages/NL.cfg
   trunk/res_noewe/languages/PL.cfg
   trunk/src/CacheWolf/MainMenu.java
Log:
SpoilerPOI exporter added

Modified: trunk/res_noewe/languages/DE.cfg
===================================================================
--- trunk/res_noewe/languages/DE.cfg	2010-01-17 10:09:31 UTC (rev 2412)
+++ trunk/res_noewe/languages/DE.cfg	2010-01-17 16:16:23 UTC (rev 2413)
@@ -36,6 +36,7 @@
 		132=nach Explorist
 		133=Suche alle
 		134=Gew%e4hlter Cache
+		135=nach SpoilerPOI
 		139=Travelbugs verwalten
 		140=Verwalten
 		141=Kopieren

Modified: trunk/res_noewe/languages/EN.cfg
===================================================================
--- trunk/res_noewe/languages/EN.cfg	2010-01-17 10:09:31 UTC (rev 2412)
+++ trunk/res_noewe/languages/EN.cfg	2010-01-17 16:16:23 UTC (rev 2413)
@@ -36,6 +36,7 @@
 		132=to Explorist
 		133=Search all
 		134=Selected Cache
+		135=to SpoilerPOI
 		139=Manage Travelbugs
 		140=Organise
 		141=Copy

Modified: trunk/res_noewe/languages/FR.cfg
===================================================================
--- trunk/res_noewe/languages/FR.cfg	2010-01-17 10:09:31 UTC (rev 2412)
+++ trunk/res_noewe/languages/FR.cfg	2010-01-17 16:16:23 UTC (rev 2413)
@@ -36,6 +36,7 @@
 		132=vers Explorist
 		133=Cherche toutes
 		134=Cache choisi
+		135=vers SpoilerPOI
 		139=G%e9rer Travelbugs
 		140=G%e9rer
 		141=Copier

Modified: trunk/res_noewe/languages/NL.cfg
===================================================================
--- trunk/res_noewe/languages/NL.cfg	2010-01-17 10:09:31 UTC (rev 2412)
+++ trunk/res_noewe/languages/NL.cfg	2010-01-17 16:16:23 UTC (rev 2413)
@@ -36,6 +36,7 @@
 		132=Naar Explorist
 		133=Allen zoeken
 		134=Gekozen Cache
+		135=Naar SpoilerPOI
 		139=Beheren Travelbugs
 		140=Organiseren
 		141=Kopi%ebren

Modified: trunk/res_noewe/languages/PL.cfg
===================================================================
--- trunk/res_noewe/languages/PL.cfg	2010-01-17 10:09:31 UTC (rev 2412)
+++ trunk/res_noewe/languages/PL.cfg	2010-01-17 16:16:23 UTC (rev 2413)
@@ -36,6 +36,7 @@
                 132=Explorist
                 133=Szukaj wszystkich
                 134=Zaznaczony Cache
+                135=SpoilerPOI
                 139=Zarzadzaj Travelbugami
                 140=Zarzadzanie
                 141=Kopiuj

Modified: trunk/src/CacheWolf/MainMenu.java
===================================================================
--- trunk/src/CacheWolf/MainMenu.java	2010-01-17 10:09:31 UTC (rev 2412)
+++ trunk/src/CacheWolf/MainMenu.java	2010-01-17 16:16:23 UTC (rev 2413)
@@ -10,6 +10,7 @@
 import CacheWolf.exp.MSARCSVExporter;
 import CacheWolf.exp.OVLExporter;
 import CacheWolf.exp.OziExporter;
+import CacheWolf.exp.SpoilerPOIExporter;
 import CacheWolf.exp.TPLExporter;
 import CacheWolf.exp.TomTomExporter;
 import CacheWolf.imp.GPXImporter;
@@ -56,7 +57,7 @@
 	private MenuItem downloadmap, kalibmap, importmap, selectMapPath;
 	private MenuItem spider, spiderAllFinds, update, chkVersion;
 	private MenuItem about, wolflang, sysinfo, legend;
-	private MenuItem exportGpxNg, exporthtml, exporttop50, exportGPX, exportASC, exportTomTom, exportMSARCSV;
+	private MenuItem exportGpxNg, exporthtml, exporttop50, exportGPX, exportASC, exportTomTom, exportMSARCSV, exportSpoilerPOI;
 	private MenuItem exportOZI, exportKML, exportTPL, exportExplorist;
 	private MenuItem filtCreate, filtClear, filtInvert, filtSelected, filtNonSelected, filtBlack, filtApply;
 	private MenuItem exportLOC, exportGPS, mnuSeparator;
@@ -102,7 +103,7 @@
 		///////////////////////////////////////////////////////////////////////
 		// subMenu for export, part of "Application" menu below
 		///////////////////////////////////////////////////////////////////////
-		MenuItem[] exitems = new MenuItem[13];
+		MenuItem[] exitems = new MenuItem[14];
 		//Vm.debug("Hi in MainMenu "+lr);
 		exitems[0] = exporthtml = new MenuItem(MyLocale.getMsg(100,"to HTML"));
 		exitems[1] = exportGpxNg = new MenuItem(MyLocale.getMsg(101,"to GPX Test"));
@@ -120,6 +121,7 @@
 		exitems[10] = exportKML = new MenuItem(MyLocale.getMsg(125,"to Google Earth"));
 		exitems[11] = exportExplorist = new MenuItem(MyLocale.getMsg(132,"to Explorist"));
 		exitems[12] = exportTPL = new MenuItem(MyLocale.getMsg(128,"via Template"));
+		exitems[13] = exportSpoilerPOI = new MenuItem(MyLocale.getMsg(135,"to SpoilerPOI"));
 
 		Menu exportMenu = new Menu(exitems, MyLocale.getMsg(107,"Export"));
 
@@ -472,6 +474,11 @@
 				ExploristExporter mag = new ExploristExporter( pref, profile);
 				mag.doIt();
 			}
+			if(mev.selectedItem == exportSpoilerPOI) {
+				SpoilerPOIExporter spoilerpoi = new SpoilerPOIExporter( pref, profile);
+				spoilerpoi.doIt();
+			}
+
 			///////////////////////////////////////////////////////////////////////
 			// subMenu for maps, part of "Application" menu
 			///////////////////////////////////////////////////////////////////////

Added: trunk/src/CacheWolf/exp/SpoilerPOIExporter.java
===================================================================
--- trunk/src/CacheWolf/exp/SpoilerPOIExporter.java	2010-01-17 10:09:31 UTC (rev 2412)
+++ trunk/src/CacheWolf/exp/SpoilerPOIExporter.java	2010-01-17 16:16:23 UTC (rev 2413)
@@ -0,0 +1,90 @@
+package CacheWolf.exp;
+import ewe.sys.Time;
+import CacheWolf.*;
+
+/** 
+ * 
+ * @author Kalle
+ * Class to create a gpx-File with links to the pictures of a 
+ * cache, which is used as input for the POILoader from Garmin.
+ */
+
+public class SpoilerPOIExporter extends Exporter {
+
+	
+	public SpoilerPOIExporter(Preferences p, Profile prof){
+		super();
+		this.setMask("*.gpx");
+		this.setHowManyParams(LAT_LON);
+		this.setNeedCacheDetails(true);
+	}
+
+	
+	public String header () {
+		StringBuffer strBuf = new StringBuffer(200);
+		Time tim = new Time();
+
+		strBuf.append("<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?>\r\n");
+		strBuf.append("<gpx xmlns=\"http://www.topografix.com/GPX/1/1\" creator=\"CacheWolf\" version=\"1.1\"" +
+				      " xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" " +
+				      "xsi:schemaLocation=\"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd\">\r\n");
+		strBuf.append("  <metadata>\r\n");
+		strBuf.append("    <link href=\"http://www.cachewolf.de\">\r\n");
+		strBuf.append("      <text>CacheWolf</text>\r\n");
+		strBuf.append("    </link>\r\n");
+		tim = tim.setFormat("yyyy-MM-dd'T'HH:mm:dd'Z'");
+		tim = tim.setToCurrentTime();
+		strBuf.append("    <time>" + tim.toString() + "</time>\r\n");
+		strBuf.append("  </metadata>\r\n");
+		return strBuf.toString();
+	}
+	
+	public String record(CacheHolder ch, String lat, String lon) {
+		StringBuffer strBuf = new StringBuffer(1000);
+		String comment,filename;
+		
+		// Makes only sense for main waypoints
+		if (ch.isAddiWpt()) return null;
+		
+		// First check, if there a any pictures in the db for the wpt
+		ch.getCacheDetails(false);
+		if (! ch.detailsLoaded()) return null;
+		if (ch.details.images.size() == 0) return null;
+		
+		for (int i=0; i < ch.details.images.size(); i++ ) {
+			filename = ch.details.images.get(i).getFilename();
+			comment = ch.details.images.get(i).getTitle();
+			// POILoader can only work with JPG-Files
+			if ( !filename.endsWith(".jpg")) continue;
+			// Try to export only Spoiler
+			if ( comment.indexOf("oiler") < 1) continue;
+			
+			strBuf.append("<wpt lat=\"" + lat + "\" lon=\"" + lon + "\">\r\n");
+			strBuf.append("  <name>Spoiler: " + SafeXML.cleanGPX(ch.cacheName) + "</name>\r\n");
+			strBuf.append("  <cmt>\r\n");
+			if (ch.details.Hints.length()> 0){
+				strBuf.append("  Hint: " + SafeXML.cleanGPX(Common.rot13(ch.details.Hints)) + "\r\n");
+			}
+			if (comment != null){
+				strBuf.append("  Comment: " + SafeXML.cleanGPX(comment) + "\r\n");
+			}
+			strBuf.append("  </cmt>\r\n");
+			strBuf.append("  <desc>GCcode: " + ch.getWayPoint() + " </desc>\r\n");
+			strBuf.append("   <link href=\"" + profile.dataDir + filename + "\"/>\r\n");
+			strBuf.append("  <sym>Scenic Area</sym>\r\n");
+			strBuf.append("  <extensions>\r\n");
+			strBuf.append("     <gpxx:WaypointExtension xmlns:gpxx=\"http://www.garmin.com/xmlschemas/GpxExtensions/v3\">\r\n");
+			strBuf.append("        <gpxx:DisplayMode>SymbolAndName</gpxx:DisplayMode>\r\n");
+			strBuf.append("     </gpxx:WaypointExtension>\r\n");
+			strBuf.append("  </extensions>\r\n");
+			strBuf.append("</wpt>\r\n");
+			strBuf.append("\r\n");
+		}
+	
+		return strBuf.toString();
+	}
+	
+	public String trailer() {
+		return "</gpx>\r\n";
+	}
+}



From araber95 at mail.berlios.de  Sun Jan 17 19:29:11 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Sun, 17 Jan 2010 19:29:11 +0100
Subject: [Cachewolf-svn] r2414 - trunk/src/CacheWolf
Message-ID: <201001171829.o0HITBcd015154@sheep.berlios.de>

Author: araber95
Date: 2010-01-17 19:29:05 +0100 (Sun, 17 Jan 2010)
New Revision: 2414

Modified:
   trunk/src/CacheWolf/DataMover.java
   trunk/src/CacheWolf/MainMenu.java
   trunk/src/CacheWolf/Profile.java
   trunk/src/CacheWolf/myTableControl.java
Log:
some more info for longer lasting actions

Modified: trunk/src/CacheWolf/DataMover.java
===================================================================
--- trunk/src/CacheWolf/DataMover.java	2010-01-17 16:16:23 UTC (rev 2413)
+++ trunk/src/CacheWolf/DataMover.java	2010-01-17 18:29:05 UTC (rev 2414)
@@ -3,10 +3,15 @@
 import CacheWolf.utils.FileBugfix;
 import ewe.filechooser.FileChooser;
 import ewe.filechooser.FileChooserBase;
-import ewe.io.*;
-import ewe.ui.*;
+import ewe.io.File;
+import ewe.io.FileBase;
+import ewe.io.FileInputStream;
+import ewe.io.FileOutputStream;
+import ewe.sys.Handle;
+import ewe.ui.FormBase;
+import ewe.ui.Gui;
+import ewe.ui.ProgressBarForm;
 import ewe.util.Iterator;
-import ewe.sys.*;
 
 
 /**
@@ -33,7 +38,7 @@
 
 		processCaches(new Deleter(MyLocale.getMsg(143, "Delete")), mode);
 		// write indexfiles
-		profile.saveIndex(pref,Profile.NO_SHOW_PROGRESS_BAR);
+		profile.saveIndex(pref,Profile.SHOW_PROGRESS_BAR);
 	}
 
 	public void copyCaches(){
@@ -57,7 +62,7 @@
 		}
 		processCaches(new Copier(MyLocale.getMsg(141, "Copy"),dstProfile), mode);
 		// write indexfiles and keep the filter status
-		dstProfile.saveIndex(pref, Profile.NO_SHOW_PROGRESS_BAR);
+		dstProfile.saveIndex(pref, Profile.SHOW_PROGRESS_BAR);
 		//Now repair the cache-Vector:
 		for(int i =0; i < srcDB.size();i++){
 			CacheHolder holder = srcDB.get(i);
@@ -161,8 +166,8 @@
 		}
 		processCaches(new Mover(MyLocale.getMsg(142, "Move"),dstProfile), mode);
 		// write indexfiles
-		dstProfile.saveIndex(pref, Profile.NO_SHOW_PROGRESS_BAR);
-		profile.saveIndex(pref,Profile.NO_SHOW_PROGRESS_BAR);
+		dstProfile.saveIndex(pref, Profile.SHOW_PROGRESS_BAR);
+		profile.saveIndex(pref,Profile.SHOW_PROGRESS_BAR);
 	}
 
 	 /**
@@ -319,8 +324,15 @@
 	private class Deleter extends Executor {
 		 Deleter(String title) {
 			 this.title=title;
+			 myProgressBarForm pbf = new myProgressBarForm();
+			 Handle h = new Handle();
+			 pbf.setTask(h,"Be patient. Reading Source Directory");
+			 pbf.exec();
+			 h.progress=(float) 0.5;
+			 h.changed();
 			 FileBugfix destPath=new FileBugfix(profile.dataDir);
 			 destFileList= destPath.list(null,FileBase.LIST_FILES_ONLY|FileBase.LIST_DONT_SORT);
+			 pbf.exit(0);
 		 }
 		 public void doIt(int i,CacheHolder srcHolder) {
 			 srcDB.removeElementAt(i);
@@ -332,10 +344,20 @@
 		 Copier(String title, Profile dstProfile) {
 			 this.title=title;
 			 this.dstProfile=dstProfile;
+			 myProgressBarForm pbf = new myProgressBarForm();
+			 Handle h = new Handle();
+			 pbf.setTask(h,"Be patient. Reading Source Directory");
+			 pbf.exec();
+			 h.progress=(float) 0.33;
+			 h.changed();
 			 FileBugfix srcPath=new FileBugfix(profile.dataDir);
 			 srcFileList= srcPath.list(null,FileBase.LIST_FILES_ONLY|FileBase.LIST_DONT_SORT);
+			 pbf.setTask(h,"Be patient. Reading Destination Directory");
+			 h.progress=(float) 0.66;
+			 h.changed();
 			 FileBugfix destPath=new FileBugfix(dstProfile.dataDir);
 			 destFileList= destPath.list(null,FileBase.LIST_FILES_ONLY|FileBase.LIST_DONT_SORT);
+			 pbf.exit(0);
 		 }
 		 public void doIt(int i,CacheHolder srcHolder) {
 			srcHolder.save();
@@ -368,10 +390,20 @@
 		 Mover(String title, Profile dstProfile) {
 			 this.title=title;
 			 this.dstProfile=dstProfile;
+			 myProgressBarForm pbf = new myProgressBarForm();
+			 Handle h = new Handle();
+			 pbf.setTask(h,"Be patient. Reading Source Directory");
+			 pbf.exec();
+			 h.progress=(float) 0.33;
+			 h.changed();
 			 FileBugfix srcPath=new FileBugfix(profile.dataDir);
 			 srcFileList= srcPath.list(null,FileBase.LIST_FILES_ONLY|FileBase.LIST_DONT_SORT);
+			 pbf.setTask(h,"Be patient. Reading Destination Directory");
+			 h.progress=(float) 0.66;
+			 h.changed();
 			 FileBugfix destPath=new FileBugfix(dstProfile.dataDir);
 			 destFileList= destPath.list(null,FileBase.LIST_FILES_ONLY|FileBase.LIST_DONT_SORT);
+			 pbf.exit(0);
 		 }
 		 public void doIt(int i,CacheHolder srcHolder) {
 			 srcDB.removeElementAt(i);

Modified: trunk/src/CacheWolf/MainMenu.java
===================================================================
--- trunk/src/CacheWolf/MainMenu.java	2010-01-17 16:16:23 UTC (rev 2413)
+++ trunk/src/CacheWolf/MainMenu.java	2010-01-17 18:29:05 UTC (rev 2414)
@@ -634,21 +634,21 @@
 			}
 
 			if(mev.selectedItem == orgCopy){
-				profile.saveIndex(pref,Profile.NO_SHOW_PROGRESS_BAR);
+				profile.saveIndex(pref,Profile.SHOW_PROGRESS_BAR);
 				DataMover dm = new DataMover();
 				dm.copyCaches();
 				tbp.refreshTable();
 			}
 
 			if(mev.selectedItem == orgMove){
-				profile.saveIndex(pref,Profile.NO_SHOW_PROGRESS_BAR);
+				profile.saveIndex(pref,Profile.SHOW_PROGRESS_BAR);
 				DataMover dm = new DataMover();
 				dm.moveCaches();
 				tbp.refreshTable();
 			}
 
 			if(mev.selectedItem == orgDelete){
-				profile.saveIndex(pref,Profile.NO_SHOW_PROGRESS_BAR);
+				profile.saveIndex(pref,Profile.SHOW_PROGRESS_BAR);
 				DataMover dm = new DataMover();
 				dm.deleteCaches();
 				tbp.refreshTable();

Modified: trunk/src/CacheWolf/Profile.java
===================================================================
--- trunk/src/CacheWolf/Profile.java	2010-01-17 16:16:23 UTC (rev 2413)
+++ trunk/src/CacheWolf/Profile.java	2010-01-17 18:29:05 UTC (rev 2414)
@@ -156,7 +156,7 @@
 		Handle h = new Handle();
 		int updFrequ=Vm.isMobile()?10:40; // Number of caches between screen updates
 		if(showprogress){
-			pbf.showMainTask = false;
+			pbf.showMainTask = true;//false;
 			pbf.setTask(h,"Saving Index");
 			pbf.exec();
 		}

Modified: trunk/src/CacheWolf/myTableControl.java
===================================================================
--- trunk/src/CacheWolf/myTableControl.java	2010-01-17 16:16:23 UTC (rev 2413)
+++ trunk/src/CacheWolf/myTableControl.java	2010-01-17 18:29:05 UTC (rev 2414)
@@ -201,11 +201,14 @@
 					DataMover dm=new DataMover();
 					myProgressBarForm pbf = new myProgressBarForm();
 					Handle h = new Handle();
-					pbf.setTask(h,MyLocale.getMsg(1012, "Delete selected"));
-					pbf.exec();
 					int nDeleted=0;
 					int size=cacheDB.size();
+					pbf.setTask(h,"Be patient. Reading directory");
+					pbf.exec();
+					h.progress = (float)0.5;
+					h.changed();
 					String[] CacheFiles = new FileBugfix(profile.dataDir).list(null, FileBase.LIST_FILES_ONLY|FileBase.LIST_DONT_SORT);
+					pbf.setTask(h,MyLocale.getMsg(1012, "Delete selected"));
 					for(int i = size-1; i >=0; i--){// Start Counting down, as the size decreases with each deleted cache
 						ch = cacheDB.get(i);
 						if(ch.is_Checked && (ch.isVisible() || deleteFiltered)) {



From araber95 at mail.berlios.de  Sun Jan 17 19:30:09 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Sun, 17 Jan 2010 19:30:09 +0100
Subject: [Cachewolf-svn] r2415 - in trunk: res_noewe src/CacheWolf/imp
Message-ID: <201001171830.o0HIU9bf018449@sheep.berlios.de>

Author: araber95
Date: 2010-01-17 19:30:00 +0100 (Sun, 17 Jan 2010)
New Revision: 2415

Modified:
   trunk/res_noewe/spider.def
   trunk/src/CacheWolf/imp/SpiderGC.java
Log:
correcting some errors on import from GC

Modified: trunk/res_noewe/spider.def
===================================================================
--- trunk/res_noewe/spider.def	2010-01-17 18:29:05 UTC (rev 2414)
+++ trunk/res_noewe/spider.def	2010-01-17 18:30:00 UTC (rev 2415)
@@ -59,7 +59,8 @@
 lineRex            = <tr\ bgcolor='#.{6}'\ class="Data\ BorderTop">((?s).*?)</tr>
 directionRex       = /compass/(.*?).gif
 logDateRex         = <td>(.*?)<br\ /><span\ class="Success"></span></td>
-availableRex       = <span class="Strike">
+availableRex       = <span\ class="Strike">
+archivedRex        = <span\ class="Warning Strike">
 PMRex              = small_profile.gif
 distRex            = <br\ />(.*?)(?:km|mi)</td>
 waypointRex        = \\(GC(.*?)\\)<br\ />

Modified: trunk/src/CacheWolf/imp/SpiderGC.java
===================================================================
--- trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-17 18:29:05 UTC (rev 2414)
+++ trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-17 18:30:00 UTC (rev 2415)
@@ -133,14 +133,15 @@
 	private static String propFirstLine2;
 	private static String propMaxDistance;
 	private static String propShowOnlyFound;
-	private static Regex RexPropListBlock;
-	private static Regex RexPropLine;
-	private static Regex RexPropLogDate;
+	private Regex RexPropListBlock;
+	private Regex RexPropLine;
+	private Regex RexPropLogDate;
 	private static String propAvailable;
+	private static String propArchived;
 	private static String propPM;
-	private static Regex RexPropDirection;
-	private static Regex RexPropDistance;
-	private static Regex RexPropWaypoint;
+	private Regex RexPropDirection;
+	private Regex RexPropDistance;
+	private Regex RexPropWaypoint;
 
 	private int numFoundUpdates=0;
 	private int numArchivedUpdates=0;
@@ -341,20 +342,19 @@
 					if(gotDistance <= maxDistance){
 						ch=cacheDB.get(chWaypoint);
 						if(ch == null){ // not in DB
-							if(cachesToLoad.size() < maxNew) {
-								if ( gotDistance >= minDistance &&
-										 directionOK(directions,getDirection(CacheDescriptionGC))  &&
-										 doPMCache(CacheDescriptionGC) ){
-								cachesToLoad.add(chWaypoint);
-								}
+							if ( gotDistance >= minDistance &&
+									 directionOK(directions,getDirection(CacheDescriptionGC))  &&
+									 doPMCache(CacheDescriptionGC) ){
+							cachesToLoad.add(chWaypoint);
 							}
-							else {
+							else {cachesToUpdate.remove( chWaypoint );}
+							if(cachesToLoad.size() >= maxNew) {
 								if(maxUpdate!=Integer.MAX_VALUE) { maxDistance=0; }
 							}
 						}
 						else {
 							if (maxUpdate>0) {
-								if (updateExists(ch,CacheDescriptionGC)) {
+								if (doPMCache(CacheDescriptionGC) && updateExists(ch,CacheDescriptionGC)) {
 									if (!ch.is_black() && (cachesShouldUpdate.size()<maxUpdate)) cachesShouldUpdate.put(chWaypoint, ch);
 								}
 								else
@@ -710,6 +710,7 @@
 			RexPropLine = new Regex(p.getProp("lineRex"));
 			RexPropLogDate = new Regex(p.getProp("logDateRex"));
 			propAvailable=p.getProp("availableRex");
+			propArchived=p.getProp("archivedRex");
 			propPM=p.getProp("PMRex");
 			RexPropDirection=new Regex(p.getProp("directionRex"));
 			RexPropDistance = new Regex(p.getProp("distRex"));
@@ -807,12 +808,14 @@
 	private boolean updateExists(CacheHolder ch, String CacheDescription) {
 		boolean ret = false;
 		boolean save = false;
+		boolean is_archived_GC=false;
 		if (spiderAllFinds) {
 			if(!ch.is_found()) { ch.setFound(true); save=true; numFoundUpdates+=1; ret=true;}
-			boolean is_archived_GC=CacheDescription.indexOf("<font color=\"red\"><strike>")!=-1;
-			if (is_archived_GC!=ch.is_archived()) { ch.setArchived(is_archived_GC); save=true; numArchivedUpdates+=1; ret=true;}
+			is_archived_GC=CacheDescription.indexOf(propArchived)!=-1;
+				if (is_archived_GC!=ch.is_archived()) { ch.setArchived(is_archived_GC); save=true; numArchivedUpdates+=1; ret=true;}
 		}
-		boolean is_available_GC=CacheDescription.indexOf(propAvailable)==-1;
+		boolean is_available_GC=!is_archived_GC && CacheDescription.indexOf(propAvailable)==-1;
+
 		if (is_available_GC != ch.is_available()) {
 			ch.setAvailable(is_available_GC); save=true; numAvailableUpdates+=1; ret=true;}
 		// we could check for update of terrain,difficult,size,cache type for not necessarily to load the complete cache 



From araber95 at mail.berlios.de  Sun Jan 17 22:20:22 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Sun, 17 Jan 2010 22:20:22 +0100
Subject: [Cachewolf-svn] r2416 - trunk/res_noewe
Message-ID: <201001172120.o0HLKMp7020730@sheep.berlios.de>

Author: araber95
Date: 2010-01-17 22:20:20 +0100 (Sun, 17 Jan 2010)
New Revision: 2416

Modified:
   trunk/res_noewe/spider.def
Log:
relevant only for those using check for update comparing the logdate
correction : committed the wrong spider.def

Modified: trunk/res_noewe/spider.def
===================================================================
--- trunk/res_noewe/spider.def	2010-01-17 18:30:00 UTC (rev 2415)
+++ trunk/res_noewe/spider.def	2010-01-17 21:20:20 UTC (rev 2416)
@@ -58,7 +58,7 @@
 listBlockRex       = <table id="ctl00_ContentBody_dlResults"((?s).*?)</table>
 lineRex            = <tr\ bgcolor='#.{6}'\ class="Data\ BorderTop">((?s).*?)</tr>
 directionRex       = /compass/(.*?).gif
-logDateRex         = <td>(.*?)<br\ /><span\ class="Success"></span></td>
+logDateRex         = <td>(.*?)<br\ /><span\ class="Success">
 availableRex       = <span\ class="Strike">
 archivedRex        = <span\ class="Warning Strike">
 PMRex              = small_profile.gif



From araber95 at mail.berlios.de  Mon Jan 18 00:27:30 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Mon, 18 Jan 2010 00:27:30 +0100
Subject: [Cachewolf-svn] r2417 - in trunk/src/CacheWolf: . imp
Message-ID: <201001172327.o0HNRUTn029004@sheep.berlios.de>

Author: araber95
Date: 2010-01-18 00:27:28 +0100 (Mon, 18 Jan 2010)
New Revision: 2417

Modified:
   trunk/src/CacheWolf/DateFormat.java
   trunk/src/CacheWolf/imp/SpiderGC.java
Log:
format of event-date is now same as of date hidden.

Modified: trunk/src/CacheWolf/DateFormat.java
===================================================================
--- trunk/src/CacheWolf/DateFormat.java	2010-01-17 21:20:20 UTC (rev 2416)
+++ trunk/src/CacheWolf/DateFormat.java	2010-01-17 23:27:28 UTC (rev 2417)
@@ -10,22 +10,42 @@
 
 import ewe.sys.Convert;
 import ewe.sys.Time;
+import ewe.util.mString;
 
 public class DateFormat {
 
 	/** Convert the US Format into a sortable format */
 	public static String MDY2YMD(String date) {
 		// Dates are in format M/D/Y
-		int p1, p2 = -1;
+		int p1, p2 = -1, p3;
 		p1 = date.indexOf("/");
-		if (p1 > 0)
-			p2 = date.indexOf("/", p1 + 1);
-		if (p1 > 0 && p2 > 0) {
-			return date.substring(p2 + 1) + "-" + (p1 == 1 ? "0" : "")
-					+ date.substring(0, p1) + "-" + (p1 + 2 == p2 ? "0" : "")
-					+ date.substring(p1 + 1, p2);
-		} else
+		if (p1==-1){
+			//dayofweek, month dayofmonth, year (Saturday, December 12, 2009)
+			p1 = date.indexOf(",");			
+			p2 = date.indexOf(" ", p1 + 2);
+			p3 = date.indexOf(",", p2 + 1);
+			final String monthNames[] = { "January", "February", "March", "April", "May",
+					"June", "July", "August", "September", "October", "November",
+					"December" };
+			for (int m = 0; m < 12; m++) {
+				if (monthNames[m].equals(date.substring(p1+2,p2))) {
+					String mm = Integer.toString(m+1);
+					if (mm.length()==1) {mm=0+mm;}
+					return date.substring(p3+2,p3+6) + "-" + mm + "-" + date.substring(p2+1, p2+3);
+				}
+			}
 			return date;
+		}
+		else {
+			if (p1 > 0)
+				p2 = date.indexOf("/", p1 + 1);
+			if (p1 > 0 && p2 > 0) {
+				return date.substring(p2 + 1) + "-" + (p1 == 1 ? "0" : "")
+						+ date.substring(0, p1) + "-" + (p1 + 2 == p2 ? "0" : "")
+						+ date.substring(p1 + 1, p2);
+			} else
+				return date;
+		}
 	}
 
 	/* Convert the sortable date into a US date */

Modified: trunk/src/CacheWolf/imp/SpiderGC.java
===================================================================
--- trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-17 21:20:20 UTC (rev 2416)
+++ trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-17 23:27:28 UTC (rev 2417)
@@ -815,7 +815,6 @@
 				if (is_archived_GC!=ch.is_archived()) { ch.setArchived(is_archived_GC); save=true; numArchivedUpdates+=1; ret=true;}
 		}
 		boolean is_available_GC=!is_archived_GC && CacheDescription.indexOf(propAvailable)==-1;
-
 		if (is_available_GC != ch.is_available()) {
 			ch.setAvailable(is_available_GC); save=true; numAvailableUpdates+=1; ret=true;}
 		// we could check for update of terrain,difficult,size,cache type for not necessarily to load the complete cache 



From araber95 at mail.berlios.de  Mon Jan 18 09:00:52 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Mon, 18 Jan 2010 09:00:52 +0100
Subject: [Cachewolf-svn] r2418 - trunk/res_noewe/templates
Message-ID: <201001180800.o0I80qP5003066@sheep.berlios.de>

Author: araber95
Date: 2010-01-18 09:00:51 +0100 (Mon, 18 Jan 2010)
New Revision: 2418

Added:
   trunk/res_noewe/templates/loc.tpl
   trunk/res_noewe/templates/wondalfo.tpl
Log:
loc exporter and loc-like (wondalfo) exporter with template. Feel free to modify!

Added: trunk/res_noewe/templates/loc.tpl
===================================================================
--- trunk/res_noewe/templates/loc.tpl	2010-01-17 23:27:28 UTC (rev 2417)
+++ trunk/res_noewe/templates/loc.tpl	2010-01-18 08:00:51 UTC (rev 2418)
@@ -0,0 +1,13 @@
+<tmpl_par name="charset" value="UTF8">
+<tmpl_par name="newline" value="CRLF">
+<tmpl_par name="decsep" value=".">
+<tmpl_par name="Out" value="*.loc">
+<?xml version="1.0"?><loc version="1.0" src="EasyGPS"><br/>
+<tmpl_loop cache_index>
+<waypoint><br/>
+   <name id="<tmpl_var WAYPOINT>"><![CDATA[<tmpl_var NAME>]]></name><br/>
+   <coord lat="<tmpl_var LAT>" lon="<tmpl_var LON>"/><br/>
+   <type><tmpl_var GMTYPE></type><br/>
+</waypoint><br/>
+</tmpl_loop>
+</loc><br/>
\ No newline at end of file

Added: trunk/res_noewe/templates/wondalfo.tpl
===================================================================
--- trunk/res_noewe/templates/wondalfo.tpl	2010-01-17 23:27:28 UTC (rev 2417)
+++ trunk/res_noewe/templates/wondalfo.tpl	2010-01-18 08:00:51 UTC (rev 2418)
@@ -0,0 +1,15 @@
+<tmpl_par name="charset" value="ASCII">
+<tmpl_par name="newline" value="CRLF">
+<tmpl_par name="decsep" value=".">
+<tmpl_par name="Out" value="*.loc">
+<tmpl_par name="ShortNameLength" value="25">
+<?xml version="1.0"?><loc version="1.0" src=EasyGPS"><br/>
+<tmpl_loop cache_index>
+<waypoint><br/>
+   <name id="<tmpl_var WAYPOINT> <tmpl_var SHORTSIZE><tmpl_var SHORTDIFFICULTY>/<tmpl_var SHORTTERAIN>"><![CDATA[<tmpl_var SHORTNAME> TB:<tmpl_var TRAVELBUG>]]></name><br/>
+   <coord lat="<tmpl_var LAT>" lon="<tmpl_var LON>"/><br/>
+   <type><tmpl_var GMTYPE></type><br/>
+</waypoint><br/>
+</tmpl_loop>
+</loc><br/>
+



From kalli at mail.berlios.de  Tue Jan 19 20:03:08 2010
From: kalli at mail.berlios.de (kalli at mail.berlios.de)
Date: Tue, 19 Jan 2010 20:03:08 +0100
Subject: [Cachewolf-svn] r2419 - trunk/src/CacheWolf/exp
Message-ID: <201001191903.o0JJ38oC000097@sheep.berlios.de>

Author: kalli
Date: 2010-01-19 20:03:06 +0100 (Tue, 19 Jan 2010)
New Revision: 2419

Added:
   trunk/src/CacheWolf/exp/SpoilerPOIExporterScreen.java
Modified:
   trunk/src/CacheWolf/exp/SpoilerPOIExporter.java
Log:
Options for all pics or only spoiler. Prefix for name changed.

Modified: trunk/src/CacheWolf/exp/SpoilerPOIExporter.java
===================================================================
--- trunk/src/CacheWolf/exp/SpoilerPOIExporter.java	2010-01-18 08:00:51 UTC (rev 2418)
+++ trunk/src/CacheWolf/exp/SpoilerPOIExporter.java	2010-01-19 19:03:06 UTC (rev 2419)
@@ -1,5 +1,6 @@
 package CacheWolf.exp;
 import ewe.sys.Time;
+import ewe.ui.FormBase;
 import CacheWolf.*;
 
 /** 
@@ -10,7 +11,8 @@
  */
 
 public class SpoilerPOIExporter extends Exporter {
-
+	private SpoilerPOIExporterScreen infoScreen;
+	private boolean onlySpoiler;
 	
 	public SpoilerPOIExporter(Preferences p, Profile prof){
 		super();
@@ -19,6 +21,12 @@
 		this.setNeedCacheDetails(true);
 	}
 
+	public void doIt() {
+		infoScreen = new SpoilerPOIExporterScreen("SpoilerPOIExport");
+		if (infoScreen.execute() == FormBase.IDCANCEL) return;
+		onlySpoiler = infoScreen.getOnlySpoiler();
+		super.doIt();
+	}
 	
 	public String header () {
 		StringBuffer strBuf = new StringBuffer(200);
@@ -57,10 +65,10 @@
 			// POILoader can only work with JPG-Files
 			if ( !filename.endsWith(".jpg")) continue;
 			// Try to export only Spoiler
-			if ( comment.indexOf("oiler") < 1) continue;
+			if ( onlySpoiler && (comment.indexOf("oiler") < 1)) continue;
 			
 			strBuf.append("<wpt lat=\"" + lat + "\" lon=\"" + lon + "\">\r\n");
-			strBuf.append("  <name>Spoiler: " + SafeXML.cleanGPX(ch.cacheName) + "</name>\r\n");
+			strBuf.append("  <name>Sp " + i + ": " + SafeXML.cleanGPX(ch.cacheName) + "</name>\r\n");
 			strBuf.append("  <cmt>\r\n");
 			if (ch.details.Hints.length()> 0){
 				strBuf.append("  Hint: " + SafeXML.cleanGPX(Common.rot13(ch.details.Hints)) + "\r\n");

Added: trunk/src/CacheWolf/exp/SpoilerPOIExporterScreen.java
===================================================================
--- trunk/src/CacheWolf/exp/SpoilerPOIExporterScreen.java	2010-01-18 08:00:51 UTC (rev 2418)
+++ trunk/src/CacheWolf/exp/SpoilerPOIExporterScreen.java	2010-01-19 19:03:06 UTC (rev 2419)
@@ -0,0 +1,54 @@
+package CacheWolf.exp;
+
+import CacheWolf.MyLocale;
+import ewe.ui.*;
+
+public class SpoilerPOIExporterScreen extends Form {
+	mButton cancelB, okB;
+	mCheckBox chkAllPic, chkOnlySpoiler;
+	CheckBoxGroup chkGroupFormat;
+	
+	public SpoilerPOIExporterScreen(String title){
+		super();
+		this.title = title;
+
+		// checkboxgroup for all pictures or Spoiler only
+		chkGroupFormat = new CheckBoxGroup();
+		chkAllPic = new mCheckBox("all Pics"); 
+		chkAllPic.setGroup(chkGroupFormat);
+		chkOnlySpoiler = new mCheckBox("only Spoiler");
+		chkOnlySpoiler.setGroup(chkGroupFormat);
+		chkGroupFormat.selectIndex(1);
+		
+		this.addNext(chkAllPic);
+		this.addLast(chkOnlySpoiler);
+		
+		// cancel and ok Button
+		cancelB = new mButton(MyLocale.getMsg(1604,"Cancel"));
+		cancelB.setHotKey(0, IKeys.ESCAPE);
+		this.addNext(cancelB,CellConstants.HSTRETCH, (CellConstants.HFILL|CellConstants.WEST));
+		okB = new mButton(MyLocale.getMsg(1605,"OK"));
+		okB.setHotKey(0, IKeys.ACTION);
+		okB.setHotKey(0, IKeys.ENTER);
+		this.addLast(okB,CellConstants.HSTRETCH, (CellConstants.HFILL|CellConstants.WEST));
+	}
+	
+	public boolean getOnlySpoiler() {
+		if ( chkGroupFormat.getSelectedIndex() == 1) return true;
+		else return false;
+	}
+	
+
+	public void onEvent(Event ev){
+		if (ev instanceof ControlEvent && ev.type == ControlEvent.PRESSED){
+			if (ev.target == cancelB){
+				this.close(FormBase.IDCANCEL);
+			}
+			if (ev.target == okB){
+				this.close(FormBase.IDOK);
+			}
+		}
+		super.onEvent(ev);
+	}
+
+}



From mik77 at mail.berlios.de  Tue Jan 19 21:14:33 2010
From: mik77 at mail.berlios.de (mik77 at mail.berlios.de)
Date: Tue, 19 Jan 2010 21:14:33 +0100
Subject: [Cachewolf-svn] r2420 - trunk
Message-ID: <201001192014.o0JKEX4L006137@sheep.berlios.de>

Author: mik77
Date: 2010-01-19 21:14:32 +0100 (Tue, 19 Jan 2010)
New Revision: 2420

Modified:
   trunk/currentversions.txt
Log:
Link to current NB version corrected.

Modified: trunk/currentversions.txt
===================================================================
--- trunk/currentversions.txt	2010-01-19 19:03:06 UTC (rev 2419)
+++ trunk/currentversions.txt	2010-01-19 20:14:32 UTC (rev 2420)
@@ -17,7 +17,7 @@
 T3VersionMajor: 1
 T3VersionMinor: 1
 #T3SvnRevision: http://flyingfish.freewrt.org:8180/job/Cachewolf/lastBuild/ (?i)Revision[\\s]*[:=][\\s]*[\\\\r]*[\\\\n]*[\\s]*([0-9]*)
-T3SvnRevision: http://pub.naturalnet.de/~nik/own/CacheWolf-BE/zcurrent.txt [\\s]*[\\\\r]*[\\\\n]*[\\s]*([0-9]*)
+T3SvnRevision: http://www.naturalnik.de/CacheWolf-BE/zcurrent.txt [\\s]*[\\\\r]*[\\\\n]*[\\s]*([0-9]*)
 
 RecommendedType: 1
 



From mik77 at mail.berlios.de  Wed Jan 20 10:18:12 2010
From: mik77 at mail.berlios.de (mik77 at mail.berlios.de)
Date: Wed, 20 Jan 2010 10:18:12 +0100
Subject: [Cachewolf-svn] r2421 - branches/bugfix_1.0
Message-ID: <201001200918.o0K9ICpZ010228@sheep.berlios.de>

Author: mik77
Date: 2010-01-20 10:17:41 +0100 (Wed, 20 Jan 2010)
New Revision: 2421

Modified:
   branches/bugfix_1.0/fwrtsnapshot.sh
Log:
correct version number

Modified: branches/bugfix_1.0/fwrtsnapshot.sh
===================================================================
--- branches/bugfix_1.0/fwrtsnapshot.sh	2010-01-19 20:14:32 UTC (rev 2420)
+++ branches/bugfix_1.0/fwrtsnapshot.sh	2010-01-20 09:17:41 UTC (rev 2421)
@@ -2,7 +2,9 @@
 # $Id$
 
 PATH=$PATH:/usr/local/bin:/usr/bin:$HOME/bin
-export PATH
+LC_ALL=C
+unset LANG LANGUAGE
+export PATH LC_ALL
 
 # natureshadow insists on using ?which?? so be it
 # allow the caller to override the paths to the tools
@@ -10,7 +12,7 @@
 test -n "$CPIO" || CPIO=$(which cpio)
 
 set -x
-v=$(svn info | sed -n '/Revision: /s///p')
+v=$(svn info | sed -n '/Last Changed Rev: /s///p')
 printf '/VER_SVN =/s/\$.*\$/$LastChangedRevision: %s $/\nwq\n' $v | \
     ed -s src/CacheWolf/Version.java
 rm -rf bin



From mik77 at mail.berlios.de  Wed Jan 20 10:19:58 2010
From: mik77 at mail.berlios.de (mik77 at mail.berlios.de)
Date: Wed, 20 Jan 2010 10:19:58 +0100
Subject: [Cachewolf-svn] r2422 - trunk
Message-ID: <201001200919.o0K9Jw9D010443@sheep.berlios.de>

Author: mik77
Date: 2010-01-20 10:19:58 +0100 (Wed, 20 Jan 2010)
New Revision: 2422

Modified:
   trunk/fwrtsnapshot.sh
Log:
correct version number

Modified: trunk/fwrtsnapshot.sh
===================================================================
--- trunk/fwrtsnapshot.sh	2010-01-20 09:17:41 UTC (rev 2421)
+++ trunk/fwrtsnapshot.sh	2010-01-20 09:19:58 UTC (rev 2422)
@@ -12,7 +12,7 @@
 test -n "$CPIO" || CPIO=$(which cpio)
 
 set -x
-v=$(svn info | sed -n '/Revision: /s///p')
+v=$(svn info | sed -n '/Last Changed Rev: /s///p')
 printf '/VER_SVN =/s/\$.*\$/$LastChanged''Revision: %s $/\nw\nq\n' $v | \
     ed -s src/CacheWolf/Version.java
 rm -rf bin



From araber95 at mail.berlios.de  Thu Jan 21 00:35:40 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Thu, 21 Jan 2010 00:35:40 +0100
Subject: [Cachewolf-svn] r2423 - in trunk: res_noewe/templates
	src/CacheWolf/exp
Message-ID: <201001202335.o0KNZeTp021800@sheep.berlios.de>

Author: araber95
Date: 2010-01-21 00:35:33 +0100 (Thu, 21 Jan 2010)
New Revision: 2423

Modified:
   trunk/res_noewe/templates/Short documentation for the export via templates.htm
   trunk/src/CacheWolf/exp/HTMLExporter.java
   trunk/src/CacheWolf/exp/TPLExporter.java
Log:
HTMLExporter.java with LAT,LON,SYM,GSTYPE
TPLExporter.java with SYM,GSTYPE

Modified: trunk/res_noewe/templates/Short documentation for the export via templates.htm
===================================================================
--- trunk/res_noewe/templates/Short documentation for the export via templates.htm	2010-01-20 09:19:58 UTC (rev 2422)
+++ trunk/res_noewe/templates/Short documentation for the export via templates.htm	2010-01-20 23:35:33 UTC (rev 2423)
@@ -1,55 +1,98 @@
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
-<HTML>
-<HEAD>
-	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
-	<TITLE>Short documentation for the export via templates</TITLE>
-	<META NAME="GENERATOR" CONTENT="OpenOffice.org 3.0  (Win32)">
-	<META NAME="CREATED" CONTENT="0;0">
-	<META NAME="CHANGED" CONTENT="20100101;19153000">
-	<META NAME="Info 3" CONTENT="">
-	<META NAME="Info 4" CONTENT="">
-	<META NAME="Originator" CONTENT="Microsoft Word 10">
-	<META NAME="ProgId" CONTENT="Word.Document">
-	<!--[if gte mso 9]><xml>
- <o:DocumentProperties>
-  <o:Author>.</o:Author>
-  <o:LastAuthor>.</o:LastAuthor>
-  <o:Revision>4</o:Revision>
-  <o:Created>2009-11-12T16:57:00Z</o:Created>
-  <o:LastSaved>2009-11-12T17:56:00Z</o:LastSaved>
-  <o:Pages>1</o:Pages>
-  <o:Words>955</o:Words>
-  <o:Characters>6022</o:Characters>
-  <o:Company>CF Computer</o:Company>
-  <o:Lines>50</o:Lines>
-  <o:Paragraphs>13</o:Paragraphs>
-  <o:CharactersWithSpaces>6964</o:CharactersWithSpaces>
-  <o:Version>10.6856</o:Version>
- </o:DocumentProperties>
-</xml><![endif]-->
-	<!--[if gte mso 9]><xml>
+<html xmlns:o="urn:schemas-microsoft-com:office:office"
+xmlns:w="urn:schemas-microsoft-com:office:word"
+xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
+xmlns="http://www.w3.org/TR/REC-html40">
+
+<head>
+<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
+<meta name=ProgId content=Word.Document>
+<meta name=Generator content="Microsoft Word 10">
+<meta name=Originator content="Microsoft Word 10">
+<link rel=File-List
+href="Short%20documentation%20for%20the%20export%20via%20templates-Dateien/filelist.xml">
+<title>Short documentation for the export via templates</title>
+<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
+ name="place"/>
+<!--[if gte mso 9]><xml>
  <w:WordDocument>
   <w:SpellingState>Clean</w:SpellingState>
   <w:GrammarState>Clean</w:GrammarState>
   <w:HyphenationZone>21</w:HyphenationZone>
-  <w:Compatibility>
-   <w:BreakWrappedTables/>
-   <w:SnapToGridInCell/>
-   <w:WrapTextWithPunct/>
-   <w:UseAsianBreakRules/>
-  </w:Compatibility>
   <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
  </w:WordDocument>
-</xml><![endif]-->
-	<!--[if !mso]><object
+</xml><![endif]--><!--[if !mso]><object
  classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
 <style>
 st1\:*{behavior:url(#ieooui) }
 </style>
 <![endif]-->
-	<!--[if gte mso 10]>
 <style>
+<!--
+ /* Font Definitions */
+ @font-face
+	{font-family:Helvetica;
+	panose-1:2 11 6 4 2 2 2 2 2 4;
+	mso-font-charset:0;
+	mso-generic-font-family:swiss;
+	mso-font-pitch:variable;
+	mso-font-signature:536902279 -2147483648 8 0 511 0;}
+ at font-face
+	{font-family:Tahoma;
+	panose-1:2 11 6 4 3 5 4 4 2 4;
+	mso-font-charset:0;
+	mso-generic-font-family:swiss;
+	mso-font-pitch:variable;
+	mso-font-signature:1627421319 -2147483648 8 0 66047 0;}
  /* Style Definitions */
+ p.MsoNormal, li.MsoNormal, div.MsoNormal
+	{mso-style-parent:"";
+	margin:0cm;
+	margin-bottom:.0001pt;
+	mso-pagination:widow-orphan;
+	font-size:12.0pt;
+	font-family:"Times New Roman";
+	mso-fareast-font-family:"Times New Roman";
+	color:black;}
+p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
+	{mso-style-noshow:yes;
+	margin:0cm;
+	margin-bottom:.0001pt;
+	mso-pagination:widow-orphan;
+	background:navy;
+	font-size:12.0pt;
+	font-family:Tahoma;
+	mso-fareast-font-family:"Times New Roman";
+	color:black;}
+p
+	{mso-margin-top-alt:auto;
+	margin-right:0cm;
+	mso-margin-bottom-alt:auto;
+	margin-left:0cm;
+	mso-pagination:widow-orphan;
+	font-size:12.0pt;
+	font-family:"Times New Roman";
+	mso-fareast-font-family:"Times New Roman";
+	color:black;}
+span.SpellE
+	{mso-style-name:"";
+	mso-spl-e:yes;}
+span.GramE
+	{mso-style-name:"";
+	mso-gram-e:yes;}
+ at page Section1
+	{size:595.3pt 841.9pt;
+	margin:70.85pt 70.85pt 2.0cm 70.85pt;
+	mso-header-margin:35.4pt;
+	mso-footer-margin:35.4pt;
+	mso-paper-source:0;}
+div.Section1
+	{page:Section1;}
+-->
+</style>
+<!--[if gte mso 10]>
+<style>
+ /* Style Definitions */
  table.MsoNormalTable
 	{mso-style-name:"Normale Tabelle";
 	mso-tstyle-rowband-size:0;
@@ -64,380 +107,504 @@
 	font-family:"Times New Roman";}
 </style>
 <![endif]-->
-	<!--[if gte mso 9]><xml>
- <o:shapedefaults v:ext="edit" spidmax="2050"/>
+<meta name=CREATED content="0;0">
+<meta name=CHANGED content="20100101;19153000">
+<meta name="Info 3" content="">
+<meta name="Info 4" content="">
+<!--[if gte mso 9]><xml>
+ <u1:DocumentProperties>
+  <u1:Author>.</u1:Author>
+  <u1:LastAuthor>.</u1:LastAuthor>
+  <u1:Revision>4</u1:Revision>
+  <u1:Created>2009-11-12T16:57:00Z</u1:Created>
+  <u1:LastSaved>2009-11-12T17:56:00Z</u1:LastSaved>
+  <u1:Pages>1</u1:Pages>
+  <u1:Words>955</u1:Words>
+  <u1:Characters>6022</u1:Characters>
+  <u1:Company>CF Computer</u1:Company>
+  <u1:Lines>50</u1:Lines>
+  <u1:Paragraphs>13</u1:Paragraphs>
+  <u1:CharactersWithSpaces>6964</u1:CharactersWithSpaces>
+  <u1:Version>10.6856</u1:Version>
+ </u1:DocumentProperties>
+</xml><![endif]--><!--[if gte mso 9]><xml>
+ <u2:WordDocument>
+  <u2:SpellingState>Clean</u2:SpellingState>
+  <u2:GrammarState>Clean</u2:GrammarState>
+  <u2:HyphenationZone>21</u2:HyphenationZone>
+  <u2:Compatibility>
+   <u2:BreakWrappedTables/>
+   <u2:SnapToGridInCell/>
+   <u2:WrapTextWithPunct/>
+   <u2:UseAsianBreakRules/>
+  </u2:Compatibility>
+  <u2:BrowserLevel>MicrosoftInternetExplorer4</u2:BrowserLevel>
+ </u2:WordDocument>
+</xml><![endif]--><!--[if gte mso 9]><xml>
+ <u3:shapedefaults u4:ext="edit" spidmax="2050"/>
+</xml><![endif]--><!--[if gte mso 9]><xml>
+ <u5:shapelayout u6:ext="edit">
+  <u5:idmap u6:ext="edit" data="1"/>
+ </u5:shapelayout>
 </xml><![endif]-->
-	<!--[if gte mso 9]><xml>
- <o:shapelayout v:ext="edit">
-  <o:idmap v:ext="edit" data="1"/>
- </o:shapelayout></xml><![endif]-->
-	<STYLE TYPE="text/css">
-	<!--
-		P { color: #000000 }
-	-->
-	</STYLE>
-</HEAD>
-<BODY LANG="de-DE" TEXT="#000000" DIR="LTR">
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Short
-documentation for the export via templates</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><U>Comment</U></FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;#--
-TomTom ASC or POI --&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-Anything between &quot;&lt;#--&quot; and &quot;--&gt;&quot; is
-handled as a comment</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB"><U>Configuration
-section </U></SPAN></FONT></FONT><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">&lt;tmpl_par
-name=&quot;NameOfParameter&quot; value=&quot;ValueOfParameter&quot;&gt;</SPAN></FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
-name=&quot;charset&quot; value=&quot;ASCII&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-Charsets: &nbsp;values ASCII or UTF8</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
-name=&quot;badchars&quot; value=&quot;,&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-BadChars : These chars are removed from the cachename, hints and
-notes.</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">for example the
-value=&quot;,&quot; if ',' is used as a separator. Regular
-expressions possible.</SPAN></FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
-name=&quot;newline&quot; value=&quot;CRLF&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-Newline : values are CR, LF or CRLF . These defines, what should be
-used for replacing &lt;br /&gt;</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
-name=&quot;decsep&quot; value=&quot;,&quot;&gt;
-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-Decimal separator : Defines, which decimal separator is used , values
-&quot;.&quot; or ','</FONT></FONT></P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">&lt;tmpl_par
-name=&quot; ShortNameLength&quot; value=&quot;30&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-Number of characters for Variable SHORTNAME </SPAN></FONT></FONT>
-</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
-name=&quot; WaypointLength&quot; value=&quot;3&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-Number of characters for Variable SHORTWAYPOINT</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
-name=&quot; Out&quot; value=&quot;*.gpx&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-Output Filename or Extension</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><BR><BR>
-</P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><U>Output
-section</U></FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Anything
-(except comments and variables) is written to the output file. The
-cachedata ist placed between &lt;tmpl_loop cache_index&gt; and
-&lt;/tmpl_loop&gt;. Variables defined like this: &lt;tmpl_var
-name=LON&gt;. At the end of the line &lt;br /&gt; has to be placed,
-this ist replaced by CR.</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Variables
-&lt;tmpl_var NameOfVariable&gt;</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>=========</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Type of cache, e.g. Regular, Multi</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>SHORTTYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: First Letter of type</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>SIZE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Size of Cache, e.g. Regular, Micro</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>SHORTSIZE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: First letter of size</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>WAYPOINT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: GCXXXX, OCXXXX</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Name of cache (badchars are removed, see below) (neuerdings bei
-ASCII Simplifizierung von Zeichen)</FONT></FONT></P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>SHORTNAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-:</FONT></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#000000"><FONT FACE="Helvetica"><FONT SIZE=2>Name
-der durch Weglassen von Vokalen von hinten und wenn das nicht reicht
-durch Weglassen von Kleinbuchstaben von hinten auf eine in den
-Einstellungen vorgegebene L&auml;nge gek&uuml;rzt wird. (Hintergrund:
-das Notes -Feld der meisten Garmins kann nur 30 Buchstaben)</FONT></FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>OWNER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-:</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>DIFFICULTY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-:</FONT></FONT></P>
-<P CLASS="msonormal"><FONT COLOR="#000000"><FONT FACE="Helvetica"><FONT SIZE=2><SPAN LANG="en-GB">SHORTDIFFICULTY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Difficulty mal 10 also 15 statt
-1.5<BR>SHDIFFICULTY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Difficulty abgerundet also 1 statt
-1.5<BR></SPAN></FONT></FONT></FONT><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">TERRAIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-:</SPAN></FONT></FONT></P>
-<P CLASS="msonormal"><FONT COLOR="#000000"><FONT FACE="Helvetica"><FONT SIZE=2><SPAN LANG="en-GB">SHORTTERAIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Terrain mal
-10<BR>SHTERRAIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Terrain
-abgerundet<BR></SPAN></FONT></FONT></FONT><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">DISTANCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Distance calculated in cachelist</SPAN></FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>BEARING&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Bearing calculated in cachelist</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>LATON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Coordinates in long format, e.g. N 50&deg; 31.234 E 008&deg; 45.267</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>LAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Latitude in decimal format, e.g. 50.20147</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>LON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Longitude in decimal format, e.g. 008.58132</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>STATUS</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>STATUS_DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Get the date part of the status </FONT></FONT>
-</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>STATUS_TIME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Get the time part of the status</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: date hidden</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>URL</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>DESCRIPTION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Cache Description (possibly in HTML Format)</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>NOTES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: User Notes&nbsp;&nbsp; (badchars are removed, see below)</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>HINTS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Encrypted hints&nbsp;&nbsp; (badchars are removed, see below)</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>DESCRYPTEDHINTS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Decrypted hints&nbsp;&nbsp;&nbsp; (badchars are removed, see below)
-</FONT></FONT>
-</P>
-<P CLASS="msonormal"><FONT COLOR="#000000"><FONT FACE="Helvetica"><FONT SIZE=2>SHORTWAYPOINT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: nur die letzten drei Zeichen des Waypoints (f&uuml;r Benutzer alter
-Ger&auml;te mit nur 6 Waypointzeichen, dann kriegen sie noch Infos
-wie Difficulty etc.
-rein)<BR>TRAVELBUG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Y or N f&uuml;r Anwesenheit/Abwesenheit von TBs im
-Cache&nbsp;<BR>GMTYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: Type aus der Garminmap.xml, also z.B. Custom 1, zur Verwendung der
-Benutzerdefinierten Icons</FONT></FONT></FONT></P>
-<P CLASS="msonormal"><FONT COLOR="#000000"><FONT FACE="Helvetica"><FONT SIZE=2>MAINWP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-: &ldquo;&ldquo; if is Mainwaypoint, Mainwaypointname if is Addi
-Waypoint</FONT></FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Further
-documentation of template library:
-http://html-tmpl-java.sourceforge.net/</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Example</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>=======</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;#--
-Microsoft AutoRoute --&gt;</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;#--
-Codecs: ASCII, UTF8 --&gt;</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
-name=&quot;charset&quot; value=&quot;ASCII&quot;&gt;</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;#--
-somme chars should not appear in the cachename --&gt;</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
-name=&quot;badchars&quot; value=&quot;;&quot;&quot;&gt;</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;#--
-newline: CR, LF, CRLF --&gt;</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
-name=&quot;newline&quot; value=&quot;CRLF&quot;&gt;</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;#--
-decimal seperator: . or , --&gt;</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_par
-name=&quot;decsep&quot; value=&quot;,&quot;&gt;</FONT></FONT></P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Name;Breitengrad;L&auml;ngengrad;Typ1;Typ2;Waypoint;Datum;Hyperlink&lt;br
-/&gt;</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_loop
-cache_index&gt;</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&quot;&lt;tmpl_var
-name=SHORTTYPE&gt;-&lt;tmpl_var name=SHORTSIZE&gt;-&lt;tmpl_var
-name=DIFFICULTY&gt;-&lt;tmpl_var name=TERRAIN&gt; &lt;tmpl_var
-name=NAME&gt;&quot;;&lt;tmpl_var name=LAT&gt;;&lt;tmpl_var
-name=LON&gt;;&quot;&lt;tmpl_var name=TYPE&gt;&quot;;&quot;&lt;tmpl_var
-name=SIZE&gt;&quot;;&quot;&lt;tmpl_var name=WAYPOINT&gt;&quot;;&quot;&lt;tmpl_var
-name=DATE&gt;&quot;;&quot;&lt;tmpl_var name=URL&gt;&quot;&lt;br /&gt;</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;/tmpl_loop&gt;</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Tags</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>====</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>tmpl_var</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>--------</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>You
-can set default values for your template variables, </FONT></FONT>
-</P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">which</SPAN></FONT></FONT>
-<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">will be used if no
-value has been set through the setParam method.</SPAN></FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;TMPL_VAR
-name=&quot;var_name&quot; default=&quot;my value&quot;&gt;</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>If
-var_name is set using setParam (or setParams), then it's value will
-be whatever it was set to, </FONT></FONT>
-</P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">else</SPAN></FONT></FONT>
-<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">it will be &quot;my
-value&quot; (without the quotes).</SPAN></FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>You
-can also &quot;escape&quot; certain strings. The following escape
-modes are possible.</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp; <FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">none:&nbsp;&nbsp;
-String unchanged (this is the default if escape is not specified)</SPAN></FONT></FONT></P>
-<P CLASS="msonormal">&nbsp; <FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">html:&nbsp;&nbsp;
-Encode special characters: &amp; &gt; &lt; &quot;.&nbsp; They are
-changed to &amp;amp; &amp;lt;&nbsp; &amp;gt;&nbsp; and &amp;quot;
-respectively</SPAN></FONT></FONT></P>
-<P CLASS="msonormal">&nbsp; <FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">url:&nbsp;&nbsp;&nbsp;
-Encode special characters in URL, e.g. space becomes %20</SPAN></FONT></FONT></P>
-<P CLASS="msonormal">&nbsp; <FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">quote:&nbsp;
-Change quotation marks:&nbsp;&nbsp; &quot; becomes \&quot;&nbsp; and
-' becomes \'</SPAN></FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Example:
-&lt;TMPL_VAR name=&quot;var_name&quot; escape=&quot;html&quot;&gt;</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>tmpl_if</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>-------</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>The
-&lt;tmpl_if&gt; tag allows you to include or not include a block of
-the template based on the value </FONT></FONT>
-</P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">of</SPAN></FONT></FONT>
-<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">a given parameter
-name. If the parameter is given a value that is true, then the block
-is included </SPAN></FONT></FONT>
-</P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">in</SPAN></FONT></FONT>
-<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">the output. If the
-value is false, then it is skipped.</SPAN></FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>The
-tmpl_if must be closed with a corresponding /tmpl_if, e.g.</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_if
-...&gt;</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>...</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;/tmpl_if&gt;</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Parameter
-values for conditions are Strings in java, and not boolean values,
-hence, what evaluates to true </FONT></FONT>
-</P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">and</SPAN></FONT></FONT>
-<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">false needs to be
-specifically defined.</SPAN></FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>As
-of now, the following values evaluate to false:</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&quot;&quot;
-- the empty string</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&quot;0&quot;
-- the string containing only the number zero</FONT></FONT></P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">null</SPAN></FONT></FONT>
-<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">- the null value</SPAN></FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>tmpl_else</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>---------</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>While
-the if block allows us to display some output if a condition is true,
-</FONT></FONT>
-</P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">we</SPAN></FONT></FONT>
-<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">may also need to
-display content if the condition is false. This can be done by using
-the optional </SPAN></FONT></FONT>
-</P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">else</SPAN></FONT></FONT>
-<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">branch of the if
-block.</SPAN></FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>tmpl_unless</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>-----------</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>This
-tag is the exact opposite of the &lt;tmpl_if&gt; tag. A &lt;tmpl_unless&gt;
-block is displayed if its control </FONT></FONT>
-</P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">variable</SPAN></FONT></FONT>
-<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">evaluates to
-false. If the control variable evaluates to true, then the else
-block, </SPAN></FONT></FONT>
-</P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">if</SPAN></FONT></FONT>
-<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">any, is displayed
-instead.</SPAN></FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>tmpl_loop</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>---------</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>The
-&lt;tmpl_loop&gt; tag is a bit more complicated than the other tags.
-It allows you to create a section of text </FONT></FONT>
-</P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">that</SPAN></FONT></FONT>
-<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">will be displayed
-repeatedly for every item in the loop control variable. Inside the
-&lt;tmpl_loop&gt;, </SPAN></FONT></FONT>
-</P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">you</SPAN></FONT></FONT>
-<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">place &lt;tmpl_var&gt;s.
-The only loop used by the template exporter is 'cache_index', see
-example above. </SPAN></FONT></FONT>
-</P>
-<P CLASS="msonormal">&nbsp;</P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">Loop</SPAN></FONT></FONT>
-<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">context variables</SPAN></FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>----------------------</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>If
-you set loop_context_vars to true in your Template's constructor,
-then you will have access to five </FONT></FONT>
-</P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">special</SPAN></FONT></FONT>
-<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">variables in all
-your loops. These are:</SPAN></FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>__FIRST__</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;&nbsp;&nbsp; <FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">True
-for the first run of the loop, false otherwise</SPAN></FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>__LAST__</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;&nbsp;&nbsp; <FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">True
-for the last run of the loop, false otherwise</SPAN></FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>__ODD__</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;&nbsp;&nbsp; <FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">True
-for every other iteration of the loop - a loop starts at 1</SPAN></FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>__INNER__</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;&nbsp;&nbsp; <FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">True
-if both __FIRST__ and __LAST__ are false</SPAN></FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>__COUNTER__</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;&nbsp;&nbsp; <FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">Which
-iteration is currently on. Starts at 1</SPAN></FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>You
-may use these like any other &lt;TMPL_VAR&gt; inside your loop.</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>tmpl_include</FONT></FONT></P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>------------</FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>The
-&lt;tmpl_include&gt; tag is the next simplest tag after &lt;tmpl_var&gt;,
-however, it will not do what you expect it to do </FONT></FONT>
-</P>
-<P CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">inside</SPAN></FONT></FONT>
-<FONT FACE="Arial"><FONT SIZE=2><SPAN LANG="en-GB">a &lt;tmpl_if&gt;</SPAN></FONT></FONT></P>
-<P CLASS="msonormal">&nbsp;</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>&lt;tmpl_include&gt;
-is used to include the contents of another template within this
-template, at the position of the tag. </FONT></FONT>
-</P>
-<P LANG="en-GB" CLASS="msonormal"><FONT FACE="Arial"><FONT SIZE=2>Processing
-then continues, as if the included template were always a part of the
-current template. </FONT></FONT>
-</P>
-<P CLASS="msonormal">&nbsp;</P>
-</BODY>
-</HTML>
\ No newline at end of file
+</head>
+
+<body lang=DE style='tab-interval:35.4pt'>
+
+<div class=Section1>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+mso-outline-level:1'><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
+mso-ansi-language:EN-GB'>Short documentation for the export via templates</span><span
+lang=EN-GB style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+mso-outline-level:1'><u><span lang=EN-GB style='font-size:10.0pt;font-family:
+Arial;mso-ansi-language:EN-GB'>Comment</span></u><span lang=EN-GB
+style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;#--
+<span class=SpellE>TomTom</span> ASC or POI --&gt;<span style='mso-tab-count:
+5'>??????????????????????????????????????????????????? </span>Anything between
+&quot;&lt;#--&quot; and &quot;--&gt;&quot; is handled as a comment</span><span
+lang=EN-GB style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><u><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Configuration
+section </span></u><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
+mso-ansi-language:EN-GB'>&lt;<span class=SpellE>tmpl_par</span> name=&quot;<span
+class=SpellE>NameOfParameter</span>&quot; value=&quot;<span class=SpellE>ValueOfParameter</span>&quot;&gt;</span><span
+lang=EN-GB style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;<span
+class=SpellE>tmpl_par</span> name=&quot;<span class=SpellE>charset</span>&quot;
+value=&quot;ASCII&quot;&gt;<span style='mso-tab-count:3'>??????????????????????????????? </span><span
+class=SpellE>Charsets</span>: &nbsp;values ASCII or UTF8<br>
+&lt;<span class=SpellE>tmpl_par</span> name=&quot;<span class=SpellE>badchars</span>&quot;
+value=&quot;,&quot;&gt;<span style='mso-tab-count:4'>???????????????????????????????????? </span><span
+class=SpellE><span class=GramE>BadChars</span></span><span class=GramE> :</span>
+These chars are removed from the <span class=SpellE>cachename</span>, hints and
+notes. <br>
+<span style='mso-spacerun:yes'>?</span><span style='mso-tab-count:8'>???????????????????????????????????????????????????????????????????????????????????????????? </span>for
+example the value=&quot;,&quot; if ',' is used as a separator. <span
+class=GramE>Regular expressions possible.</span><br>
+&lt;<span class=SpellE>tmpl_par</span> name=&quot;<span class=SpellE>newline</span>&quot;
+value=&quot;CRLF&quot;&gt;<span style='mso-tab-count:3'>??????????????????????????????? </span><span
+class=SpellE><span class=GramE>Newline</span></span><span class=GramE> :</span>
+values are CR, LF or CRLF . These defines, what should be used for replacing<br>
+&lt;<span class=SpellE>tmpl_par</span> name=&quot;<span class=SpellE>decsep</span>&quot;
+value=&quot;,&quot;&gt;<span style='mso-tab-count:4'>??????????????????????????????????????? </span>Decimal
+separator : Defines, which decimal separator is used , values &quot;.&quot; or
+','<br>
+&lt;<span class=SpellE>tmpl_par</span> name=&quot; <span class=SpellE>ShortNameLength</span>&quot;
+value=&quot;30&quot;&gt;<span style='mso-tab-count:2'>???????????????????? </span>Number
+of characters for Variable SHORTNAME <br>
+&lt;<span class=SpellE>tmpl_par</span> name=&quot; <span class=SpellE>WaypointLength</span>&quot;
+value=&quot;3&quot;&gt;<span style='mso-tab-count:3'>???????????????????????? </span>Number
+of characters for Variable SHORTWAYPOINT<br>
+&lt;<span class=SpellE>tmpl_par</span> name=&quot; Out&quot; value=&quot;*.<span
+class=SpellE>gpx</span>&quot;&gt;<span style='mso-tab-count:4'>????????????????????????????????????? </span>Output
+Filename or Extension</span><span lang=EN-GB style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+mso-outline-level:1'><u><span lang=EN-GB style='font-size:10.0pt;font-family:
+Arial;mso-ansi-language:EN-GB'>Output section</span></u><span lang=EN-GB
+style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Anything
+(except comments and variables) is written to the output file.<br>
+The <span class=SpellE>cachedata</span> <span class=SpellE><span class=GramE>ist</span></span>
+placed between &lt;<span class=SpellE>tmpl_loop</span> <span class=SpellE>cache_index</span>&gt;
+and &lt;/<span class=SpellE>tmpl_loop</span>&gt;. <br>
+Variables defined like this: &lt;<span class=SpellE>tmpl_var</span>
+name=LON&gt;. <br>
+At the end of the line &lt;<span class=SpellE>br</span> /&gt; has to be placed,
+this is replaced by CR.<o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><u><span
+style='font-size:10.0pt;font-family:Arial'>Variables &lt;<span class=SpellE>tmpl_var</span>
+<span class=SpellE>NameOfVariable</span>&gt;</span><o:p></o:p></u></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>TYPE<span
+style='mso-tab-count:9'>???????????????????????????????????????????????????????????????????????????????????????????????? </span>:
+&lt;type&gt; Type of cache, e.g. Regular, Multi<br>
+SYM<span style='mso-tab-count:9'>?????????????????????????????????????????????????????????????????????????????????????????????????? </span>:
+&lt;sym&gt;<br>
+GSTYPE<span style='mso-tab-count:8'>???????????????????????????????????????????????????????????????????????????????????????????? </span>:
+&lt;<span class=SpellE>groundspeak<span class=GramE>:type</span></span>&gt;<br>
+SHORTTYPE<span style='mso-tab-count:8'>????????????????????????????????????????????????????????????????????????????????????? </span>:
+First Letter of &lt;type&gt; ???<br>
+</span><span style='font-size:10.0pt;font-family:Arial'>SIZE<span
+style='mso-tab-count:9'>?????????????????????????????????????????????????????????????????????????????????????????????????? </span>:
+<span class=SpellE>Size</span> of Cache, <span class=SpellE>e.g</span>. <span
+class=SpellE>Regular</span>, <span class=SpellE>Micro</span><br>
+SHORTSIZE<span style='mso-tab-count:8'>??????????????????????????????????????????????????????????????????????????????????????? </span>:
+First <span class=SpellE>letter</span> of <span class=SpellE>size</span><br>
+WAYPOINT<span style='mso-tab-count:8'>???????????????????????????????????????????????????????????????????????????????????????? </span>:
+&lt;<span class=SpellE>name</span>&gt; GCXXXX, OCXXXX<br>
+NAME<span style='mso-tab-count:9'>??????????????????????????????????????????????????????????????????????????????????????????????? </span>:
+Name of <span class=SpellE>cache</span> (<span class=SpellE>badchars</span> <span
+class=SpellE>are</span> <span class=SpellE>removed</span>, <span class=SpellE>see</span>
+<span class=SpellE>below</span>) (neuerdings bei ASCII Simplifizierung von
+Zeichen)<br>
+SHORTNAME<span style='mso-tab-count:8'>???????????????????????????????????????????????????????????????????????????????????? </span>:
+</span><span style='font-size:10.0pt;font-family:Helvetica'>Name der durch
+Weglassen von Vokalen von hinten und wenn das nicht reicht durch Weglassen von
+Kleinbuchstaben von hinten auf eine in den Einstellungen vorgegebene L?nge
+gek?rzt wird. (Hintergrund: das Notes -Feld der meisten <span class=SpellE>Garmins</span>
+kann nur 30 Buchstaben)<br>
+</span><span style='font-size:10.0pt;font-family:Arial'>OWNER<span
+style='mso-tab-count:8'>???????????????????????????????????????????????????????????????????????????????????????????? </span>:<br>
+DIFFICULTY<span style='mso-tab-count:8'>??????????????????????????????????????????????????????????????????????????????????????? </span>:<br>
+</span><span style='font-size:10.0pt;font-family:Helvetica'>SHORTDIFFICULTY<span
+style='mso-tab-count:7'>???????????????????????????????????????????????????????????????????????????? </span>:
+<span class=SpellE>Difficulty</span> mal 10 also 15 statt 1.5<br>
+SHDIFFICULTY<span style='mso-tab-count:8'>?????????????????????????????????????????????????????????????????????????????????? </span>:
+<span class=SpellE>Difficulty</span> abgerundet also 1 statt 1.5<br>
+</span><span style='font-size:10.0pt;font-family:Arial'>TERRAIN<span
+style='mso-tab-count:8'>??????????????????????????????????????????????????????????????????????????????????????????? </span>:<br>
+</span><span style='font-size:10.0pt;font-family:Helvetica'>SHORTTERAIN<span
+style='mso-tab-count:8'>?????????????????????????????????????????????????????????????????????????????????? </span>:
+Terrain mal 10<br>
+SHTERRAIN<span style='mso-tab-count:8'>??????????????????????????????????????????????????????????????????????????????????????? </span>:
+Terrain abgerundet<br>
+</span><span style='font-size:10.0pt;font-family:Arial'>DISTANCE<span
+style='mso-tab-count:8'>????????????????????????????????????????????????????????????????????????????????????????? </span>:
+Distance <span class=SpellE>calculated</span> in <span class=SpellE>cachelist</span><br>
+BEARING<span style='mso-tab-count:8'>?????????????????????????????????????????????????????????????????????????????????????????? </span>:
+Bearing <span class=SpellE>calculated</span> in <span class=SpellE>cachelist</span><br>
+LATON<span style='mso-tab-count:9'>?????????????????????????????????????????????????????????????????????????????????????????????? </span>:
+<span class=SpellE>Coordinates</span> in <span class=SpellE>long</span> <span
+class=SpellE>format</span>, <span class=SpellE>e.g</span>. N 50? 31.234 E 008?
+45.267<br>
+LAT<span style='mso-tab-count:9'>??????????????????????????????????????????????????????????????????????????????????????????????????? </span>:
+&lt;<span class=SpellE>wpt</span> <span class=SpellE>lat=?xx.yyyy</span>? ??..&gt;
+</span><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:
+EN-GB'>Latitude in decimal format, e.g. 50.20147<br>
+LON<span style='mso-tab-count:9'>?????????????????????????????????????????????????????????????????????????????????????????????????? </span>:
+&lt;<span class=SpellE>wpt</span> ?? <span class=SpellE>lon</span>=?<span
+class=SpellE>xx.yyyy</span>? &gt; Longitude in decimal format, e.g. 008.58132<br>
+STATUS<span style='mso-tab-count:8'>???????????????????????????????????????????????????????????????????????????????????????????? </span>:
+<span style='mso-spacerun:yes'>?</span>means found<br>
+STATUS_DATE<span style='mso-tab-count:8'>?????????????????????????????????????????????????????????????????????????????????? </span>:
+Get the date part of the status <br>
+STATUS_TIME<span style='mso-tab-count:8'>??????????????????????????????????????????????????????????????????????????????????? </span>:
+Get the time part of the status<br>
+DATE<span style='mso-tab-count:9'>???????????????????????????????????????????????????????????????????????????????????????????????? </span>:
+date hidden<br>
+URL<span style='mso-tab-count:9'>??????????????????????????????????????????????????????????????????????????????????????????????????? </span>:<br>
+DESCRIPTION<span style='mso-tab-count:8'>??????????????????????????????????????????????????????????????????????????????????? </span>:
+Cache Description (possibly in HTML Format)<br>
+NOTES<span style='mso-tab-count:9'>?????????????????????????????????????????????????????????????????????????????????????????????? </span>:
+User Notes&nbsp;&nbsp; (<span class=SpellE>badchars</span> are removed, see
+below)<br>
+HINTS<span style='mso-tab-count:9'>???????????????????????????????????????????????????????????????????????????????????????????????? </span>:
+Encrypted hints&nbsp;&nbsp; (<span class=SpellE>badchars</span> are removed,
+see below)<br>
+DESCRYPTEDHINTS<span style='mso-tab-count:7'>?????????????????????????????????????????????????????????????????????????? </span>:
+Decrypted hints&nbsp;&nbsp;&nbsp; (<span class=SpellE>badchars</span> are
+removed, see below) <br>
+</span><span lang=EN-GB style='font-size:10.0pt;font-family:Helvetica;
+mso-ansi-language:EN-GB'>SHORTWAYPOINT<span style='mso-tab-count:7'>????????????????????????????????????????????????????????????????????????????? </span>:
+</span><span class=SpellE><span lang=EN-GB style='font-size:10.0pt;font-family:
+Arial;mso-ansi-language:EN-GB'>ShortNameLength</span></span><span lang=EN-GB
+style='font-size:10.0pt;font-family:Helvetica;mso-ansi-language:EN-GB'> <span
+class=SpellE>Zeichen</span> des Waypoints (<span class=SpellE>f?r</span> <span
+class=SpellE>Benutzer</span> alter <span class=SpellE>Ger?te</span> <span
+class=SpellE>mit</span> <span class=SpellE>nur</span> 6 <span class=SpellE>Waypointzeichen</span>,
+<br>
+<span style='mso-spacerun:yes'>?</span><span style='mso-tab-count:9'>???????????????????????????????????????????????????????????????????????????????????????????????????????? </span>:
+<span class=SpellE>dann</span> <span class=SpellE>kriegen</span> <span
+class=SpellE>sie</span> <span class=SpellE>noch</span> <span class=SpellE>Infos</span>
+<span class=SpellE>wie</span> Difficulty etc. rein)<br>
+TRAVELBUG<span style='mso-tab-count:8'>????????????????????????????????????????????????????????????????????????????????????? </span>:
+Y or N <span class=SpellE>f?r</span> <span class=SpellE>Anwesenheit/Abwesenheit</span>
+von <span class=SpellE>TBs</span> <span class=SpellE>im</span> Cache&nbsp;<br>
+GMTYPE<span style='mso-tab-count:8'>??????????????????????????????????????????????????????????????????????????????????????????? </span>:
+Type <span class=SpellE>aus</span> <span class=SpellE>der</span> <span
+class=SpellE>Garminmap.xml</span>, also <span class=SpellE>z.B</span>. Custom
+1, <span class=SpellE>zur</span> <span class=SpellE>Verwendung</span> <span
+class=SpellE>der</span> <span class=SpellE>Benutzerdefinierten</span> Icons<br>
+MAINWP<span style='mso-tab-count:8'>??????????????????????????????????????????????????????????????????????????????????????????? </span>:
+?? if is <span class=SpellE>Mainwaypoint</span>, <span class=SpellE>Mainwaypointname</span>
+if is <span class=SpellE>Addi</span> Waypoint<br style='mso-special-character:
+line-break'>
+<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
+<![endif]></span><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
+mso-ansi-language:EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+mso-outline-level:1'><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
+mso-ansi-language:EN-GB'>Further documentation of template library:
+http://html-tmpl-java.sourceforge.net/</span><span lang=EN-GB style='mso-ansi-language:
+EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+mso-outline-level:1'><u><span lang=EN-GB style='font-size:10.0pt;font-family:
+Arial;mso-ansi-language:EN-GB'>Example</span></u><u><span lang=EN-GB
+style='mso-ansi-language:EN-GB'><o:p></o:p></span></u></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;#--
+Microsoft AutoRoute --&gt;<br>
+&lt;#-- <span class=SpellE>Codecs</span>: ASCII, UTF8 --&gt;<br>
+&lt;<span class=SpellE>tmpl_par</span> name=&quot;<span class=SpellE>charset</span>&quot;
+value=&quot;ASCII&quot;&gt;<br>
+&lt;#-- <span class=SpellE>somme</span> chars should not appear in the <span
+class=SpellE>cachename</span> --&gt;<br>
+&lt;<span class=SpellE>tmpl_par</span> name=&quot;<span class=SpellE>badchars</span>&quot;
+value=&quot;;&quot;&quot;<span class=GramE>&gt;</span><br>
+&lt;#-- <span class=SpellE>newline</span>: CR, LF, CRLF --&gt;<br>
+&lt;<span class=SpellE>tmpl_par</span> name=&quot;<span class=SpellE>newline</span>&quot;
+value=&quot;CRLF&quot;&gt;<br>
+&lt;#-- decimal <span class=SpellE>seperator</span>: . or , --&gt;<br>
+&lt;<span class=SpellE>tmpl_par</span> name=&quot;<span class=SpellE>decsep</span>&quot;
+value=&quot;,&quot;&gt;<br>
+Name;Breitengrad;L?ngengrad;Typ1;Typ2;Waypoint;Datum;Hyperlink&lt;br /&gt;<br>
+&lt;<span class=SpellE>tmpl_loop</span> <span class=SpellE>cache_index</span>&gt;<br>
+&quot;&lt;<span class=SpellE>tmpl_var</span> name=SHORTTYPE&gt;-&lt;<span
+class=SpellE>tmpl_var</span> name=SHORTSIZE&gt;-&lt;<span class=SpellE>tmpl_var</span>
+name=DIFFICULTY&gt;-&lt;<span class=SpellE>tmpl_var</span> name=TERRAIN&gt;
+&lt;<span class=SpellE>tmpl_var</span> name=NAME&gt;&quot;;&lt;<span
+class=SpellE>tmpl_var</span> name=LAT&gt;;&lt;<span class=SpellE>tmpl_var</span>
+name=LON&gt;;&quot;&lt;<span class=SpellE>tmpl_var</span>
+name=TYPE&gt;&quot;;&quot;&lt;<span class=SpellE>tmpl_var</span>
+name=SIZE&gt;&quot;;&quot;&lt;<span class=SpellE>tmpl_var</span> name=WAYPOINT&gt;&quot;;&quot;&lt;<span
+class=SpellE>tmpl_var</span> name=DATE&gt;&quot;;&quot;&lt;<span class=SpellE>tmpl_var</span>
+name=URL&gt;&quot;&lt;<span class=SpellE>br</span> /&gt;<br>
+&lt;/<span class=SpellE>tmpl_loop</span>&gt;<br style='mso-special-character:
+line-break'>
+<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
+<![endif]></span><span lang=EN-GB style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+mso-outline-level:1'><u><span lang=EN-GB style='font-size:10.0pt;font-family:
+Arial;mso-ansi-language:EN-GB'>Tags</span></u><u><span lang=EN-GB
+style='mso-ansi-language:EN-GB'><o:p></o:p></span></u></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+class=SpellE><u><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
+mso-ansi-language:EN-GB'>tmpl_var</span></u></span><u><span lang=EN-GB
+style='mso-ansi-language:EN-GB'><o:p></o:p></span></u></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>You
+can set default values for your template variables, which</span><span
+lang=EN-GB style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB
+style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>will be used
+if no value has been set through the <span class=SpellE>setParam</span> method.<br>
+&lt;TMPL_VAR name=&quot;<span class=SpellE>var_name</span>&quot; default=&quot;my
+value&quot;&gt;<br>
+If <span class=SpellE>var_name</span> is set using <span class=SpellE>setParam</span>
+(or <span class=SpellE>setParams</span>), then it's value will be whatever it
+was set to<span class=GramE>,<span style='mso-spacerun:yes'>? </span>else</span></span><span
+lang=EN-GB style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB
+style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>it will be
+&quot;my value&quot; (without the quotes).<o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>You
+can also &quot;escape&quot; certain strings. The following escape modes are
+possible.<br>
+</span><span lang=EN-GB style='mso-ansi-language:EN-GB'>&nbsp; </span><span
+class=GramE><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
+mso-ansi-language:EN-GB'>none</span></span><span lang=EN-GB style='font-size:
+10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>:&nbsp;&nbsp; String
+unchanged (this is the default if escape is not specified)<br>
+</span><span lang=EN-GB style='mso-ansi-language:EN-GB'>&nbsp; </span><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>html:&nbsp;&nbsp;
+Encode special characters: &amp; &gt; &lt; &quot;.&nbsp; They are changed to
+&amp;amp; &amp;<span class=SpellE>lt</span>;<span class=GramE>&nbsp; &amp;</span><span
+class=SpellE>gt</span>;&nbsp; and &amp;<span class=SpellE>quot</span>;
+respectively<br>
+</span><span lang=EN-GB style='mso-ansi-language:EN-GB'>&nbsp; </span><span
+class=SpellE><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
+mso-ansi-language:EN-GB'>url</span></span><span lang=EN-GB style='font-size:
+10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>:&nbsp;&nbsp;&nbsp; Encode
+special characters in URL, e.g. space becomes %20<br>
+</span><span lang=EN-GB style='mso-ansi-language:EN-GB'>&nbsp; </span><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>quote:&nbsp;
+Change quotation marks:&nbsp;&nbsp; &quot; becomes \&quot;&nbsp; and ' becomes
+\'<br style='mso-special-character:line-break'>
+<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
+<![endif]></span><span lang=EN-GB style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Example:
+&lt;TMPL_VAR name=&quot;<span class=SpellE>var_name</span>&quot;
+escape=&quot;html&quot;&gt;</span><span lang=EN-GB style='mso-ansi-language:
+EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='mso-ansi-language:EN-GB'>&nbsp;<o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+class=SpellE><u><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
+mso-ansi-language:EN-GB'>tmpl_if</span></u></span><u><span lang=EN-GB
+style='mso-ansi-language:EN-GB'><o:p></o:p></span></u></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>The
+&lt;<span class=SpellE>tmpl_if</span>&gt; tag allows you to include or not
+include a block of the template based on the <span class=GramE>value <span
+style='mso-spacerun:yes'>?</span>of</span></span><span lang=EN-GB
+style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB style='font-size:10.0pt;
+font-family:Arial;mso-ansi-language:EN-GB'>a given parameter name. If the parameter
+is given a value that is true, then the block is included in</span><span
+lang=EN-GB style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB
+style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>the output.
+If the value is false, then it is skipped.<br>
+The <span class=SpellE>tmpl_if</span> must be closed with a corresponding /<span
+class=SpellE>tmpl_if</span>, e.g.</span><span lang=EN-GB style='mso-ansi-language:
+EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;<span
+class=SpellE>tmpl_if</span> ...&gt;<br>
+...<br>
+&lt;/<span class=SpellE>tmpl_if</span>&gt;</span><span lang=EN-GB
+style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Parameter
+values for conditions are Strings in java, and not <span class=SpellE><span
+class=GramE>boolean</span></span> values, hence, what evaluates to true and</span><span
+lang=EN-GB style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB
+style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>false needs
+to be specifically defined.<br>
+As of now, the following values evaluate to false:<br>
+&quot;&quot; - the empty string<br>
+&quot;0&quot; - the string containing only the number zero<br>
+null</span><span lang=EN-GB style='mso-ansi-language:EN-GB'> </span><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>-
+the null value<br style='mso-special-character:line-break'>
+<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
+<![endif]></span><span lang=EN-GB style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+class=SpellE><u><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
+mso-ansi-language:EN-GB'>tmpl_else</span></u></span><u><span lang=EN-GB
+style='mso-ansi-language:EN-GB'><o:p></o:p></span></u></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>While
+the if block allows us to display some output if a condition is true<span
+class=GramE>, <span style='mso-spacerun:yes'>?</span>we</span></span><span
+lang=EN-GB style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB
+style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>may also
+need to display content if the condition is false. This can be done by using
+the optional else</span><span lang=EN-GB style='mso-ansi-language:EN-GB'> </span><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>branch
+of <span class=GramE>the if</span> block.</span><span lang=EN-GB
+style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+class=SpellE><u><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
+mso-ansi-language:EN-GB'>tmpl_unless</span></u></span><u><span lang=EN-GB
+style='mso-ansi-language:EN-GB'><o:p></o:p></span></u></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>This
+tag is the exact opposite of the &lt;<span class=SpellE>tmpl_if</span>&gt; tag.
+A &lt;<span class=SpellE>tmpl_unless</span>&gt; block is displayed if its
+control variable</span><span lang=EN-GB style='mso-ansi-language:EN-GB'> </span><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>evaluates
+to false. If the control variable evaluates to true, then the else block, if</span><span
+lang=EN-GB style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB
+style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>any, is
+displayed instead.</span><span lang=EN-GB style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+class=SpellE><u><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
+mso-ansi-language:EN-GB'>tmpl_loop</span></u></span><u><span lang=EN-GB
+style='mso-ansi-language:EN-GB'><o:p></o:p></span></u></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>The
+&lt;<span class=SpellE>tmpl_loop</span>&gt; tag is a bit more complicated than
+the other tags. It allows you to create a section of text that</span><span
+lang=EN-GB style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB
+style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>will be
+displayed repeatedly for every item in the loop control variable. Inside the
+&lt;<span class=SpellE>tmpl_loop</span>&gt;<span class=GramE>, <span
+style='mso-spacerun:yes'>?</span>you</span></span><span lang=EN-GB
+style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB style='font-size:10.0pt;
+font-family:Arial;mso-ansi-language:EN-GB'>place &lt;<span class=SpellE>tmpl_var</span>&gt;s.<b
+style='mso-bidi-font-weight:normal'> The only loop used by the template
+exporter is '<span class=SpellE>cache_index</span>', see example above. </b></span><span
+lang=EN-GB style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+mso-outline-level:1'><st1:place><u><span lang=EN-GB style='font-size:10.0pt;
+ font-family:Arial;mso-ansi-language:EN-GB'>Loop</span></u></st1:place><u><span
+lang=EN-GB style='mso-ansi-language:EN-GB'> </span></u><u><span lang=EN-GB
+style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>context
+variables</span></u><u><span lang=EN-GB style='mso-ansi-language:EN-GB'><o:p></o:p></span></u></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>If
+you set <span class=SpellE>loop_context_vars</span> to true in your Template's
+constructor, then you will have access to five special</span><span lang=EN-GB
+style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB style='font-size:10.0pt;
+font-family:Arial;mso-ansi-language:EN-GB'>variables in all your loops. These
+are:</span><span lang=EN-GB style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>__FIRST__<span
+style='mso-tab-count:1'>??????? </span></span><span lang=EN-GB
+style='mso-ansi-language:EN-GB'>&nbsp;&nbsp;&nbsp; </span><span lang=EN-GB
+style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>True for the
+first run of the loop, false otherwise<br>
+__LAST__</span><span lang=EN-GB style='mso-ansi-language:EN-GB'><span
+style='mso-tab-count:1'>???????? </span>&nbsp;&nbsp;&nbsp; </span><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>True
+for the last run of the loop, false otherwise<br>
+__ODD__<span style='mso-tab-count:1'>????????? </span></span><span lang=EN-GB
+style='mso-ansi-language:EN-GB'>&nbsp;&nbsp;&nbsp; </span><span lang=EN-GB
+style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>True for
+every other iteration of the loop - a loop starts at 1<br>
+__INNER__</span><span lang=EN-GB style='mso-ansi-language:EN-GB'><span
+style='mso-tab-count:1'>?????? </span>&nbsp;&nbsp;&nbsp; </span><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>True
+if both __FIRST__ and __LAST__ are false<br>
+__COUNTER__<span style='mso-tab-count:1'> </span></span><span lang=EN-GB
+style='mso-ansi-language:EN-GB'>&nbsp;&nbsp;&nbsp; </span><span lang=EN-GB
+style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Which
+iteration is currently on. Starts at 1<br style='mso-special-character:line-break'>
+<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
+<![endif]></span><span lang=EN-GB style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+mso-outline-level:1'><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
+mso-ansi-language:EN-GB'>You may use these like any other &lt;TMPL_VAR&gt;
+inside your loop.</span><span lang=EN-GB style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+class=SpellE><u><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
+mso-ansi-language:EN-GB'>tmpl_include</span></u></span><u><span lang=EN-GB
+style='mso-ansi-language:EN-GB'><o:p></o:p></span></u></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>The
+&lt;<span class=SpellE>tmpl_include</span>&gt; tag is the next simplest tag
+after &lt;<span class=SpellE>tmpl_var</span>&gt;, however, it will not do what
+you expect it to do inside</span><span lang=EN-GB style='mso-ansi-language:
+EN-GB'> </span><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
+mso-ansi-language:EN-GB'>a &lt;<span class=SpellE>tmpl_if</span>&gt;<br>
+&lt;<span class=SpellE>tmpl_include</span>&gt; is used to include the contents
+of another template within this template, at the position of the tag. <br>
+Processing then continues, as if the included template were always a part of
+the current template. <o:p></o:p></span></p>
+
+<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
+lang=EN-GB style='mso-ansi-language:EN-GB'><o:p>&nbsp;</o:p></span></p>
+
+</div>
+
+</body>
+
+</html>

Modified: trunk/src/CacheWolf/exp/HTMLExporter.java
===================================================================
--- trunk/src/CacheWolf/exp/HTMLExporter.java	2010-01-20 09:19:58 UTC (rev 2422)
+++ trunk/src/CacheWolf/exp/HTMLExporter.java	2010-01-20 23:35:33 UTC (rev 2423)
@@ -74,6 +74,9 @@
 			pbf.setTask(h,"Exporting ...");
 			pbf.exec();
 
+			String decSep = "."; // myFilter.decSep
+			Regex dec = new Regex("[,.]",decSep);
+
 			for(int i = 0; i<counter;i++){
 				h.progress = (float)(i+1)/(float)counter;
 				h.changed();
@@ -87,8 +90,10 @@
 					}
 					det=ch.getCacheDetails(false,false);
 					varParams = new Hashtable();
-					varParams.put("TYPE", CacheType.type2TypeTag(ch.getType()));
-					varParams.put("WAYPOINT", ch.getWayPoint());
+					varParams.put("TYPE", CacheType.type2TypeTag(ch.getType())); //<type>
+					varParams.put("SYM", CacheType.type2SymTag(ch.getType())); //<sym>
+					varParams.put("GSTYPE", CacheType.type2GSTypeTag(ch.getType())); //<groundspeak:type>
+					varParams.put("WAYPOINT", ch.getWayPoint()); //<name>
 					varParams.put("NAME", ch.getCacheName());
 					varParams.put("OWNER", ch.getCacheOwner());
 					if (ch.isAddiWpt() || ch.isCustomWpt()) {
@@ -106,13 +111,18 @@
 					varParams.put("DISTANCE", ch.getDistance());
 					varParams.put("BEARING", ch.bearing);
 					varParams.put("LATLON", ch.LatLon);
+					varParams.put("LAT", dec.replaceAll(ch.pos.getLatDeg(CWPoint.DD)));
+					varParams.put("LON", dec.replaceAll(ch.pos.getLonDeg(CWPoint.DD)));
 					varParams.put("STATUS", ch.getCacheStatus());
 					varParams.put("DATE", ch.getDateHidden());
 					cache_index.add(varParams);
 					//We can generate the individual page here!
 					try{
 						Template page_tpl = new Template(template_init_page);
-						page_tpl.setParam("TYPE", varParams.get("TYPE").toString());
+						page_tpl.setParam("TYPE", CacheType.type2TypeTag(ch.getType())); //<type>
+						// page_tpl.setParam("TYPE", varParams.get("TYPE").toString());
+						page_tpl.setParam("SYM", CacheType.type2SymTag(ch.getType())); //<sym>
+						page_tpl.setParam("GSTYPE", CacheType.type2GSTypeTag(ch.getType())); //<groundspeak:type>
 						page_tpl.setParam("SIZE", varParams.get("SIZE").toString());
 						page_tpl.setParam("WAYPOINT", ch.getWayPoint());
 						page_tpl.setParam("NAME", ch.getCacheName());
@@ -122,6 +132,8 @@
 						page_tpl.setParam("DISTANCE", ch.getDistance());
 						page_tpl.setParam("BEARING", ch.bearing);
 						page_tpl.setParam("LATLON", ch.LatLon);
+						page_tpl.setParam("LAT", dec.replaceAll(ch.pos.getLatDeg(CWPoint.DD)));
+						page_tpl.setParam("LON", dec.replaceAll(ch.pos.getLonDeg(CWPoint.DD)));
 						page_tpl.setParam("STATUS", ch.getCacheStatus());
 						page_tpl.setParam("DATE", ch.getDateHidden());
 						if (det != null) {

Modified: trunk/src/CacheWolf/exp/TPLExporter.java
===================================================================
--- trunk/src/CacheWolf/exp/TPLExporter.java	2010-01-20 09:19:58 UTC (rev 2422)
+++ trunk/src/CacheWolf/exp/TPLExporter.java	2010-01-20 23:35:33 UTC (rev 2423)
@@ -213,7 +213,9 @@
 						Regex dec = new Regex("[,.]",myFilter.decSep);
 						if (myFilter.badChars != null) rex = new Regex("["+myFilter.badChars+"]","");
 						varParams = new Hashtable();
-						varParams.put("TYPE", CacheType.type2TypeTag(ch.getType()));
+						varParams.put("TYPE", CacheType.type2TypeTag(ch.getType())); //<type>
+						varParams.put("SYM", CacheType.type2SymTag(ch.getType())); //<sym>
+						varParams.put("GSTYPE", CacheType.type2GSTypeTag(ch.getType())); //<groundspeak:type>
 						varParams.put("SHORTTYPE", CacheType.getExportShortId(ch.getType()));
 						varParams.put("SIZE", CacheSize.cw2ExportString(ch.getCacheSize()));
 						varParams.put("SHORTSIZE", CacheSize.getExportShortId(ch.getCacheSize()));
@@ -227,7 +229,7 @@
 
 						}
 						String wp = ch.getWayPoint();
-						varParams.put("WAYPOINT", wp);
+						varParams.put("WAYPOINT", wp); //<name>
 						int wpl = wp.length();
 						int wps = (wpl < myFilter.shortWaypointLength) ? 0 : wpl - myFilter.shortWaypointLength;
 						varParams.put("SHORTWAYPOINT", wp.substring(wps, wpl));



From kalli at mail.berlios.de  Fri Jan 22 19:12:56 2010
From: kalli at mail.berlios.de (kalli at mail.berlios.de)
Date: Fri, 22 Jan 2010 19:12:56 +0100
Subject: [Cachewolf-svn] r2424 - in trunk/src/CacheWolf: exp utils
Message-ID: <201001221812.o0MICuhu000927@sheep.berlios.de>

Author: kalli
Date: 2010-01-22 19:12:54 +0100 (Fri, 22 Jan 2010)
New Revision: 2424

Added:
   trunk/src/CacheWolf/utils/URLUTF8Encoder.java
Modified:
   trunk/src/CacheWolf/exp/SpoilerPOIExporter.java
Log:
SpoilerPOIExporter: encoding of URL (filename) to UTF8 added

Modified: trunk/src/CacheWolf/exp/SpoilerPOIExporter.java
===================================================================
--- trunk/src/CacheWolf/exp/SpoilerPOIExporter.java	2010-01-20 23:35:33 UTC (rev 2423)
+++ trunk/src/CacheWolf/exp/SpoilerPOIExporter.java	2010-01-22 18:12:54 UTC (rev 2424)
@@ -2,6 +2,7 @@
 import ewe.sys.Time;
 import ewe.ui.FormBase;
 import CacheWolf.*;
+import CacheWolf.utils.URLUTF8Encoder;
 
 /** 
  * 
@@ -49,7 +50,7 @@
 	
 	public String record(CacheHolder ch, String lat, String lon) {
 		StringBuffer strBuf = new StringBuffer(1000);
-		String comment,filename;
+		String comment,filename, url;
 		
 		// Makes only sense for main waypoints
 		if (ch.isAddiWpt()) return null;
@@ -78,7 +79,8 @@
 			}
 			strBuf.append("  </cmt>\r\n");
 			strBuf.append("  <desc>GCcode: " + ch.getWayPoint() + " </desc>\r\n");
-			strBuf.append("   <link href=\"" + profile.dataDir + filename + "\"/>\r\n");
+			url = profile.dataDir + filename;
+			strBuf.append("   <link href=\"" + URLUTF8Encoder.encode(url, false)  + "\"/>\r\n");
 			strBuf.append("  <sym>Scenic Area</sym>\r\n");
 			strBuf.append("  <extensions>\r\n");
 			strBuf.append("     <gpxx:WaypointExtension xmlns:gpxx=\"http://www.garmin.com/xmlschemas/GpxExtensions/v3\">\r\n");

Added: trunk/src/CacheWolf/utils/URLUTF8Encoder.java
===================================================================
--- trunk/src/CacheWolf/utils/URLUTF8Encoder.java	2010-01-20 23:35:33 UTC (rev 2423)
+++ trunk/src/CacheWolf/utils/URLUTF8Encoder.java	2010-01-22 18:12:54 UTC (rev 2424)
@@ -0,0 +1,164 @@
+/**
+ * Provides a method to encode any string into a URL-safe
+ * form.
+ * Non-ASCII characters are first encoded as sequences of
+ * two or three bytes, using the UTF-8 algorithm, before being
+ * encoded as %HH escapes.
+ *
+ * Changed: 22 January 2010
+ * Author: Kalle
+ * Added parameter spaceToPlus to select between the two representation
+ * of SPACE (+ or %20)
+ *  
+ * Created: 17 April 1997
+ * Author: Bert Bos <bert at w3.org>
+ *
+ * URLUTF8Encoder: http://www.w3.org/International/URLUTF8Encoder.java
+ *
+ * Copyright ? 1997 World Wide Web Consortium, (Massachusetts
+ * Institute of Technology, European Research Consortium for
+ * Informatics and Mathematics, Keio University). All Rights Reserved. 
+ * This work is distributed under the W3C? Software License [1] in the
+ * hope that it will be useful, but WITHOUT ANY WARRANTY; without even
+ * the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
+ * PURPOSE.
+ *
+ * [1] http://www.w3.org/Consortium/Legal/2002/copyright-software-20021231
+ */
+package CacheWolf.utils;
+public class URLUTF8Encoder
+{
+
+  final static String[] hex = {
+    "%00", "%01", "%02", "%03", "%04", "%05", "%06", "%07",
+    "%08", "%09", "%0a", "%0b", "%0c", "%0d", "%0e", "%0f",
+    "%10", "%11", "%12", "%13", "%14", "%15", "%16", "%17",
+    "%18", "%19", "%1a", "%1b", "%1c", "%1d", "%1e", "%1f",
+    "%20", "%21", "%22", "%23", "%24", "%25", "%26", "%27",
+    "%28", "%29", "%2a", "%2b", "%2c", "%2d", "%2e", "%2f",
+    "%30", "%31", "%32", "%33", "%34", "%35", "%36", "%37",
+    "%38", "%39", "%3a", "%3b", "%3c", "%3d", "%3e", "%3f",
+    "%40", "%41", "%42", "%43", "%44", "%45", "%46", "%47",
+    "%48", "%49", "%4a", "%4b", "%4c", "%4d", "%4e", "%4f",
+    "%50", "%51", "%52", "%53", "%54", "%55", "%56", "%57",
+    "%58", "%59", "%5a", "%5b", "%5c", "%5d", "%5e", "%5f",
+    "%60", "%61", "%62", "%63", "%64", "%65", "%66", "%67",
+    "%68", "%69", "%6a", "%6b", "%6c", "%6d", "%6e", "%6f",
+    "%70", "%71", "%72", "%73", "%74", "%75", "%76", "%77",
+    "%78", "%79", "%7a", "%7b", "%7c", "%7d", "%7e", "%7f",
+    "%80", "%81", "%82", "%83", "%84", "%85", "%86", "%87",
+    "%88", "%89", "%8a", "%8b", "%8c", "%8d", "%8e", "%8f",
+    "%90", "%91", "%92", "%93", "%94", "%95", "%96", "%97",
+    "%98", "%99", "%9a", "%9b", "%9c", "%9d", "%9e", "%9f",
+    "%a0", "%a1", "%a2", "%a3", "%a4", "%a5", "%a6", "%a7",
+    "%a8", "%a9", "%aa", "%ab", "%ac", "%ad", "%ae", "%af",
+    "%b0", "%b1", "%b2", "%b3", "%b4", "%b5", "%b6", "%b7",
+    "%b8", "%b9", "%ba", "%bb", "%bc", "%bd", "%be", "%bf",
+    "%c0", "%c1", "%c2", "%c3", "%c4", "%c5", "%c6", "%c7",
+    "%c8", "%c9", "%ca", "%cb", "%cc", "%cd", "%ce", "%cf",
+    "%d0", "%d1", "%d2", "%d3", "%d4", "%d5", "%d6", "%d7",
+    "%d8", "%d9", "%da", "%db", "%dc", "%dd", "%de", "%df",
+    "%e0", "%e1", "%e2", "%e3", "%e4", "%e5", "%e6", "%e7",
+    "%e8", "%e9", "%ea", "%eb", "%ec", "%ed", "%ee", "%ef",
+    "%f0", "%f1", "%f2", "%f3", "%f4", "%f5", "%f6", "%f7",
+    "%f8", "%f9", "%fa", "%fb", "%fc", "%fd", "%fe", "%ff"
+  };
+
+  /**
+   * Encode a string to the "x-www-form-urlencoded" form, enhanced
+   * with the UTF-8-in-URL proposal. This is what happens:
+   *
+   * <ul>
+   * <li><p>The ASCII characters 'a' through 'z', 'A' through 'Z',
+   *        and '0' through '9' remain the same.
+   *
+   * <li><p>The unreserved characters - _ . ! ~ * ' ( ) remain the same.
+   *
+   * <li><p>The space character ' ' is converted into a plus sign '+',
+   *        if spaceToPlus is true.
+   *
+   * <li><p>All other ASCII characters are converted into the
+   *        3-character string "%xy", where xy is
+   *        the two-digit hexadecimal representation of the character
+   *        code
+   *
+   * <li><p>All non-ASCII characters are encoded in two steps: first
+   *        to a sequence of 2 or 3 bytes, using the UTF-8 algorithm;
+   *        secondly each of these bytes is encoded as "%xx".
+   * </ul>
+   *
+   * @param s The string to be encoded
+   * @param spaceToPlus true if you wish a space to be encoded as a '+', 
+   *         false to encode it as %20
+   * @return The encoded string
+   */
+  public static String encode(String s, boolean spaceToPlus)
+  {
+    StringBuffer sbuf = new StringBuffer();
+    int len = s.length();
+    for (int i = 0; i < len; i++) {
+      int ch = s.charAt(i);
+      if ('A' <= ch && ch <= 'Z') {		// 'A'..'Z'
+        sbuf.append((char)ch);
+      } else if ('a' <= ch && ch <= 'z') {	// 'a'..'z'
+	       sbuf.append((char)ch);
+      } else if ('0' <= ch && ch <= '9') {	// '0'..'9'
+	       sbuf.append((char)ch);
+      } else if (spaceToPlus && ch == ' ') {			// space
+	       sbuf.append('+');
+      } else if (ch == '-' || ch == '_'		// unreserved
+          || ch == '.' || ch == '!'
+          || ch == '~' || ch == '*'
+          || ch == '\'' || ch == '('
+          || ch == ')') {
+        sbuf.append((char)ch);
+      } else if (ch <= 0x007f) {		// other ASCII
+	       sbuf.append(hex[ch]);
+      } else if (ch <= 0x07FF) {		// non-ASCII <= 0x7FF
+	       sbuf.append(hex[0xc0 | (ch >> 6)]);
+	       sbuf.append(hex[0x80 | (ch & 0x3F)]);
+      } else {					// 0x7FF < ch <= 0xFFFF
+	       sbuf.append(hex[0xe0 | (ch >> 12)]);
+	       sbuf.append(hex[0x80 | ((ch >> 6) & 0x3F)]);
+	       sbuf.append(hex[0x80 | (ch & 0x3F)]);
+      }
+    }
+    return sbuf.toString();
+  }
+
+  /**
+   * Encode a string to the "x-www-form-urlencoded" form, enhanced
+   * with the UTF-8-in-URL proposal. This is what happens:
+   *
+   * <ul>
+   * <li><p>The ASCII characters 'a' through 'z', 'A' through 'Z',
+   *        and '0' through '9' remain the same.
+   *
+   * <li><p>The unreserved characters - _ . ! ~ * ' ( ) remain the same.
+   *
+   * <li><p>The space character ' ' is converted into a plus sign '+'.
+   *
+   *
+   * <li><p>All other ASCII characters are converted into the
+   *        3-character string "%xy", where xy is
+   *        the two-digit hexadecimal representation of the character
+   *        code
+   *
+   * <li><p>All non-ASCII characters are encoded in two steps: first
+   *        to a sequence of 2 or 3 bytes, using the UTF-8 algorithm;
+   *        secondly each of these bytes is encoded as "%xx".
+   * </ul>
+   *
+   * @param s The string to be encoded
+   * @param spaceToPlus true if you wish a space to be encoded as a '+', 
+   *         false to encode it as %20
+   * @return The encoded string
+   */
+  
+  
+  public static String encode(String s)
+  {
+	  return encode(s,true);
+  }
+  
+}



From admin at berlios.de  Fri Jan 22 19:42:43 2010
From: admin at berlios.de (admin at berlios.de)
Date: Fri, 22 Jan 2010 19:42:43 +0100 (CET)
Subject: [Cachewolf-svn] [Bug #16696] Cachewolf dies with MemoryException
	for large gc.com spiders
Message-ID: <201001221842.o0MIghDT024447@unicorn.berlios.de>

Bug #16696, was updated on 2010-Jan-22 19:42
Here is a current snapshot of the bug.

Project: CacheWolf
Category: None
Status: Open
Resolution: None
Bug Group: Bug reproduceable
Priority: 5
Submitted by: rohieb
Assigned to : none
Summary: Cachewolf dies with MemoryException for large gc.com spiders

Details: When I try to spider a large amount of cache descriptions (in my case more than ~150), a java.lang.OutOfMemoryError: Java heap space exception is thrown and the spider stops without aborting or displaying an error message. 
This is reproducable on Windows and Linux using Sun Java 1.6.0 update 16. The problem is resolved by raising the Java heap space limit to 256 MB (java -Xmx256M on the command line).

It would be nice if this command line option could be added in the CacheWolf.bat f?r Windows, as well as providing a wrapper script for Linux that calls Java with this command line. Futhermore, it is reasonable to close the spider dialog and display an error message in this case, as it is only visible on the command line that an exception has been thrown.


For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=16696&group_id=2211


From kalli at mail.berlios.de  Sat Jan 23 17:53:26 2010
From: kalli at mail.berlios.de (kalli at mail.berlios.de)
Date: Sat, 23 Jan 2010 17:53:26 +0100
Subject: [Cachewolf-svn] r2425 - trunk/src/CacheWolf/exp
Message-ID: <201001231653.o0NGrQtf005379@sheep.berlios.de>

Author: kalli
Date: 2010-01-23 17:53:20 +0100 (Sat, 23 Jan 2010)
New Revision: 2425

Modified:
   trunk/src/CacheWolf/exp/SpoilerPOIExporter.java
Log:
Comment is now in UTF and not in HTML

Modified: trunk/src/CacheWolf/exp/SpoilerPOIExporter.java
===================================================================
--- trunk/src/CacheWolf/exp/SpoilerPOIExporter.java	2010-01-22 18:12:54 UTC (rev 2424)
+++ trunk/src/CacheWolf/exp/SpoilerPOIExporter.java	2010-01-23 16:53:20 UTC (rev 2425)
@@ -75,7 +75,7 @@
 				strBuf.append("  Hint: " + SafeXML.cleanGPX(Common.rot13(ch.details.Hints)) + "\r\n");
 			}
 			if (comment != null){
-				strBuf.append("  Comment: " + SafeXML.cleanGPX(comment) + "\r\n");
+				strBuf.append("  Comment: " + SafeXML.cleanGPX(SafeXML.cleanback(comment)) + "\r\n");
 			}
 			strBuf.append("  </cmt>\r\n");
 			strBuf.append("  <desc>GCcode: " + ch.getWayPoint() + " </desc>\r\n");



From araber95 at mail.berlios.de  Sat Jan 23 21:43:45 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Sat, 23 Jan 2010 21:43:45 +0100
Subject: [Cachewolf-svn] r2426 - trunk
Message-ID: <201001232043.o0NKhjxh000032@sheep.berlios.de>

Author: araber95
Date: 2010-01-23 21:43:43 +0100 (Sat, 23 Jan 2010)
New Revision: 2426

Added:
   trunk/cw-jar.jnf
Modified:
   trunk/buildexe.bat
   trunk/buildexe.sh
   trunk/cw-pc.jnf
   trunk/fwrtsnapshot.sh
Log:
changed generation of jar.

Modified: trunk/buildexe.bat
===================================================================
--- trunk/buildexe.bat	2010-01-23 16:53:20 UTC (rev 2425)
+++ trunk/buildexe.bat	2010-01-23 20:43:43 UTC (rev 2426)
@@ -3,5 +3,6 @@
 java -cp lib/ewe.jar Ewe programs/Jewel.ewe -c cw-pda.jnf
 java -cp lib/ewe.jar Ewe programs/Jewel.ewe -c cw-ppc2003.jnf
 java -cp lib/ewe.jar Ewe programs/Jewel.ewe -c cw-pc.jnf
+java -cp lib/ewe.jar Ewe programs/Jewel.ewe -c cw-jar.jnf
 REM Dont change the order above because the PC version has to overwrite the PDA version of the EWE-file
 rem pause

Modified: trunk/buildexe.sh
===================================================================
--- trunk/buildexe.sh	2010-01-23 16:53:20 UTC (rev 2425)
+++ trunk/buildexe.sh	2010-01-23 20:43:43 UTC (rev 2426)
@@ -2,4 +2,5 @@
 programs/ewecl programs/Jewel.ewe -c cw-pda.jnf
 programs/ewecl programs/Jewel.ewe -c cw-ppc2003.jnf
 programs/ewecl programs/Jewel.ewe -c cw-pc.jnf
+programs/ewecl programs/Jewel.ewe -c cw-jar.jnf
 # Dont change the order above because the PC version has to overwrite the PDA version of the EWE-file

Added: trunk/cw-jar.jnf
===================================================================
--- trunk/cw-jar.jnf	2010-01-23 16:53:20 UTC (rev 2425)
+++ trunk/cw-jar.jnf	2010-01-23 20:43:43 UTC (rev 2426)
@@ -0,0 +1 @@
+command=programName%3DCacheWolf%26width%3D0%26height%3D0%26startingClass%3DCacheWolf.CacheWolf%26windowTitle%3DWindow%2BTitle%26ewes%3D%26extra%3D%26pathToEwe%3D%26nativeStack%3D0%26vmStack%3D0%26appletWidth%3D0%26appletHeight%3D0%26appletInFrame%3Dfalse%26locale%3D%26useResources%3Dtrue%26noPopupWindows%3Dfalse%26vmOptions%3D&eweFiles=&targets=%253DTarget%3Dewe/data/MultiListSelect$SelectedItems%253D%25253DJar%25252B-%25252BJava%25252B1.2&createWithPnf=true&eweInfo=outputFile%3Dwork/CacheWolf.ewe%26entries%3Dewesoft/apps/jewel/EweDirEntry%253Dpath%25253Dbin/CacheWolf/%252526mask%25253D*.class%252526includeSubdirectories%25253Dtrue%252526pathInEwe%25253DCacheWolf/%2526ewesoft/apps/jewel/EweDirEntry%253Dpath%25253Dresources%252526mask%25253D*.gif;*.png;*.ico%252526includeSubdirectories%25253Dfalse%252526pathInEwe%25253D%2526ewesoft/apps/jewel/EweDirEntry%253Dpath%25253Dlib%252526mask%25253D*.class%252526includeSubdirectories%25253Dtrue%252526pathInEwe%25253D%26addCommandLine!
 %3Dtrue%26commandLine%3DprogramName%253DCacheWolf%2526width%253D0%2526height%253D0%2526startingClass%253DCacheWolf.CacheWolf%2526windowTitle%253DWindow%252BTitle%2526ewes%253D%2526extra%253D%2526pathToEwe%253D%2526nativeStack%253D0%2526vmStack%253D0%2526appletWidth%253D0%2526appletHeight%253D0%2526appletInFrame%253Dfalse%2526locale%253D%2526useResources%253Dtrue%2526noPopupWindows%253Dfalse%2526vmOptions%253D%26install%3Dtitle%253D%2526category%253DApplications%2526location%253D%2526icon%253D%2526args%253D%2526vmArgs%253D%26addInstallFile%3Dfalse%26usePool%3Dfalse%26useClassPool%3Dfalse&icon=resources/CacheWolf.ico

Modified: trunk/cw-pc.jnf
===================================================================
--- trunk/cw-pc.jnf	2010-01-23 16:53:20 UTC (rev 2425)
+++ trunk/cw-pc.jnf	2010-01-23 20:43:43 UTC (rev 2426)
@@ -1 +1 @@
-command=programName%3DCacheWolf%26width%3D0%26height%3D0%26startingClass%3DCacheWolf.CacheWolf%26windowTitle%3DWindow%2BTitle%26ewes%3D%26extra%3D%26pathToEwe%3D%26nativeStack%3D0%26vmStack%3D0%26appletWidth%3D0%26appletHeight%3D0%26appletInFrame%3Dfalse%26locale%3D%26useResources%3Dtrue%26noPopupWindows%3Dfalse%26vmOptions%3D-Xms%2B64M%2B-Xmx%2B1024M&eweFiles=&targets=%253DTarget%3Dewe/data/MultiListSelect$SelectedItems%253D%25253DJar%25252B-%25252BJava%25252B1.2%252526%25253Dx86%25252B-%25252BWin32%25252B-%25252BStatic%25252BLinked&createWithPnf=true&eweInfo=outputFile%3Dwork/CacheWolf.ewe%26entries%3Dewesoft/apps/jewel/EweDirEntry%253Dpath%25253Dbin/CacheWolf/%252526mask%25253D*.class%252526includeSubdirectories%25253Dtrue%252526pathInEwe%25253DCacheWolf/%2526ewesoft/apps/jewel/EweDirEntry%253Dpath%25253Dresources%252526mask%25253D*.gif;*.png;*.ico%252526includeSubdirectories%25253Dfalse%252526pathInEwe%25253D%2526ewesoft/apps/jewel/EweDirEntry%253Dpath%25253Dlib%252526m!
 ask%25253D*.class%252526includeSubdirectories%25253Dtrue%252526pathInEwe%25253D%26addCommandLine%3Dtrue%26commandLine%3DprogramName%253DCacheWolf%2526width%253D0%2526height%253D0%2526startingClass%253DCacheWolf.CacheWolf%2526windowTitle%253DWindow%252BTitle%2526ewes%253D%2526extra%253D%2526pathToEwe%253D%2526nativeStack%253D0%2526vmStack%253D0%2526appletWidth%253D0%2526appletHeight%253D0%2526appletInFrame%253Dfalse%2526locale%253D%2526useResources%253Dtrue%2526noPopupWindows%253Dfalse%2526vmOptions%253D-Xms%252B64M%252B-Xmx%252B1024M%26install%3Dtitle%253D%2526category%253DApplications%2526location%253D%2526icon%253D%2526args%253D%2526vmArgs%253D%26addInstallFile%3Dfalse%26usePool%3Dfalse%26useClassPool%3Dfalse&icon=resources/CacheWolf.ico
+command=programName%3DCacheWolf%26width%3D0%26height%3D0%26startingClass%3DCacheWolf.CacheWolf%26windowTitle%3DWindow%2BTitle%26ewes%3D%26extra%3D%26pathToEwe%3D%26nativeStack%3D0%26vmStack%3D0%26appletWidth%3D0%26appletHeight%3D0%26appletInFrame%3Dfalse%26locale%3D%26useResources%3Dtrue%26noPopupWindows%3Dfalse%26vmOptions%3D-Xms%2B64M%2B-Xmx%2B1024M&eweFiles=&targets=%253DTarget%3Dewe/data/MultiListSelect$SelectedItems%253D%25253Dx86%25252B-%25252BWin32%25252B-%25252BStatic%25252BLinked&createWithPnf=true&eweInfo=outputFile%3Dwork/CacheWolf.ewe%26entries%3Dewesoft/apps/jewel/EweDirEntry%253Dpath%25253Dbin/CacheWolf/%252526mask%25253D*.class%252526includeSubdirectories%25253Dtrue%252526pathInEwe%25253DCacheWolf/%2526ewesoft/apps/jewel/EweDirEntry%253Dpath%25253Dresources%252526mask%25253D*.gif;*.png;*.ico%252526includeSubdirectories%25253Dfalse%252526pathInEwe%25253D%2526ewesoft/apps/jewel/EweDirEntry%253Dpath%25253Dlib%252526mask%25253D*.class%252526includeSubdirectories%!
 25253Dtrue%252526pathInEwe%25253D%26addCommandLine%3Dtrue%26commandLine%3DprogramName%253DCacheWolf%2526width%253D0%2526height%253D0%2526startingClass%253DCacheWolf.CacheWolf%2526windowTitle%253DWindow%252BTitle%2526ewes%253D%2526extra%253D%2526pathToEwe%253D%2526nativeStack%253D0%2526vmStack%253D0%2526appletWidth%253D0%2526appletHeight%253D0%2526appletInFrame%253Dfalse%2526locale%253D%2526useResources%253Dtrue%2526noPopupWindows%253Dfalse%2526vmOptions%253D-Xms%252B64M%252B-Xmx%252B1024M%26install%3Dtitle%253D%2526category%253DApplications%2526location%253D%2526icon%253D%2526args%253D%2526vmArgs%253D%26addInstallFile%3Dfalse%26usePool%3Dfalse%26useClassPool%3Dfalse&icon=resources/CacheWolf.ico

Modified: trunk/fwrtsnapshot.sh
===================================================================
--- trunk/fwrtsnapshot.sh	2010-01-23 16:53:20 UTC (rev 2425)
+++ trunk/fwrtsnapshot.sh	2010-01-23 20:43:43 UTC (rev 2426)
@@ -23,6 +23,7 @@
 $EWE programs/Jewel.ewe -c cw-pda.jnf
 $EWE programs/Jewel.ewe -c cw-ppc2003.jnf
 $EWE programs/Jewel.ewe -c cw-pc.jnf
+$EWE programs/Jewel.ewe -c cw-jar.jnf
 # Don?t change the order of the above Jewel commands because
 # the PC version has to overwrite the PDA version of the EWE file
 rm -rf published



From araber95 at mail.berlios.de  Sat Jan 23 21:55:59 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Sat, 23 Jan 2010 21:55:59 +0100
Subject: [Cachewolf-svn] r2427 - trunk
Message-ID: <201001232055.o0NKtwfs001010@sheep.berlios.de>

Author: araber95
Date: 2010-01-23 21:55:57 +0100 (Sat, 23 Jan 2010)
New Revision: 2427

Modified:
   trunk/build.xml
Log:
seperating build of jar

Modified: trunk/build.xml
===================================================================
--- trunk/build.xml	2010-01-23 20:43:43 UTC (rev 2426)
+++ trunk/build.xml	2010-01-23 20:55:57 UTC (rev 2427)
@@ -3,22 +3,22 @@
 
 	<!--
 		This is the ant (http://ant.apache.org/) build file for CacheWolf
-		
+
 		Arguments:
 			-Dbuild.version=integer
 					source code version covered by the build. of "official" builds this shoul be the
 					svn revision number
 					Default: todays date (YYYYMMDD)
-			
+
 			-Dbuild.type=interger
 					see src/CacheWolf/Version.kava VERSION_TYPES for valid values
 					Default: 3 (InDevelopmentNewest)
-			
+
 			-Dbuild.cab=true
-					also build a cab version from the PPC2003 zip file. 
+					also build a cab version from the PPC2003 zip file.
 					Default: do not build it
 					make sure to check the prerequisites on http://ant.apache.org/manual/OptionalTasks/cab.html
-					
+
 		futher information about ant can be found at
 			http://ant.apache.org/manual/
 			http://help.eclipse.org/help33/topic/org.eclipse.platform.doc.user/gettingStarted/qs-81_basics.htm
@@ -205,6 +205,16 @@
 		<exec executable="programs/ewecl" os="Linux">
 			<arg value="programs/Jewel.ewe" />
 			<arg value="-c" />
+			<arg value="cw-ppc2003.jnf" />
+		</exec>
+		<exec executable="programs/ewecl" os="Linux">
+			<arg value="programs/Jewel.ewe" />
+			<arg value="-c" />
+			<arg value="cw-jar.jnf" />
+		</exec>
+		<exec executable="programs/ewecl" os="Linux">
+			<arg value="programs/Jewel.ewe" />
+			<arg value="-c" />
 			<arg value="cw-pc.jnf" />
 		</exec>
 		<exec executable="programs/ewe.exe" osfamily="windows">
@@ -215,8 +225,18 @@
 		<exec executable="programs/ewe.exe" osfamily="windows">
 			<arg value="programs/Jewel.ewe" />
 			<arg value="-c" />
+			<arg value="cw-ppc2003.jnf" />
+		</exec>
+		<exec executable="programs/ewe.exe" osfamily="windows">
+			<arg value="programs/Jewel.ewe" />
+			<arg value="-c" />
 			<arg value="cw-pc.jnf" />
 		</exec>
+		<exec executable="programs/ewe.exe" osfamily="windows">
+			<arg value="programs/Jewel.ewe" />
+			<arg value="-c" />
+			<arg value="cw-jar.jnf" />
+		</exec>
 	</target>
 
 	<target name="clean" description="clean up before build">



From kalli at mail.berlios.de  Sun Jan 24 12:11:11 2010
From: kalli at mail.berlios.de (kalli at mail.berlios.de)
Date: Sun, 24 Jan 2010 12:11:11 +0100
Subject: [Cachewolf-svn] r2428 - trunk/src/CacheWolf/exp
Message-ID: <201001241111.o0OBBB4s030886@sheep.berlios.de>

Author: kalli
Date: 2010-01-24 12:11:10 +0100 (Sun, 24 Jan 2010)
New Revision: 2428

Modified:
   trunk/src/CacheWolf/exp/SpoilerPOIExporter.java
Log:
Check if images exists; export only images that are shown in the image-panel

Modified: trunk/src/CacheWolf/exp/SpoilerPOIExporter.java
===================================================================
--- trunk/src/CacheWolf/exp/SpoilerPOIExporter.java	2010-01-23 20:55:57 UTC (rev 2427)
+++ trunk/src/CacheWolf/exp/SpoilerPOIExporter.java	2010-01-24 11:11:10 UTC (rev 2428)
@@ -2,6 +2,7 @@
 import ewe.sys.Time;
 import ewe.ui.FormBase;
 import CacheWolf.*;
+import CacheWolf.utils.FileBugfix;
 import CacheWolf.utils.URLUTF8Encoder;
 
 /** 
@@ -51,6 +52,8 @@
 	public String record(CacheHolder ch, String lat, String lon) {
 		StringBuffer strBuf = new StringBuffer(1000);
 		String comment,filename, url;
+		CacheImages images;
+		int picCounter;
 		
 		// Makes only sense for main waypoints
 		if (ch.isAddiWpt()) return null;
@@ -60,16 +63,23 @@
 		if (! ch.detailsLoaded()) return null;
 		if (ch.details.images.size() == 0) return null;
 		
-		for (int i=0; i < ch.details.images.size(); i++ ) {
-			filename = ch.details.images.get(i).getFilename();
-			comment = ch.details.images.get(i).getTitle();
+		images = ch.details.images.getDisplayImages(ch.getWayPoint());
+		picCounter = 0;
+		for (int i=0; i < images.size(); i++ ) {
+			filename = images.get(i).getFilename();
+			comment = images.get(i).getTitle();
+			url = profile.dataDir + filename;
+			
 			// POILoader can only work with JPG-Files
 			if ( !filename.endsWith(".jpg")) continue;
 			// Try to export only Spoiler
 			if ( onlySpoiler && (comment.indexOf("oiler") < 1)) continue;
+			// check if the file is not deleted
+			if (!(new FileBugfix(url)).exists()) continue;
 			
+			picCounter++;
 			strBuf.append("<wpt lat=\"" + lat + "\" lon=\"" + lon + "\">\r\n");
-			strBuf.append("  <name>Sp " + i + ": " + SafeXML.cleanGPX(ch.cacheName) + "</name>\r\n");
+			strBuf.append("  <name>Sp " + picCounter + ": " + SafeXML.cleanGPX(ch.cacheName) + "</name>\r\n");
 			strBuf.append("  <cmt>\r\n");
 			if (ch.details.Hints.length()> 0){
 				strBuf.append("  Hint: " + SafeXML.cleanGPX(Common.rot13(ch.details.Hints)) + "\r\n");
@@ -79,7 +89,6 @@
 			}
 			strBuf.append("  </cmt>\r\n");
 			strBuf.append("  <desc>GCcode: " + ch.getWayPoint() + " </desc>\r\n");
-			url = profile.dataDir + filename;
 			strBuf.append("   <link href=\"" + URLUTF8Encoder.encode(url, false)  + "\"/>\r\n");
 			strBuf.append("  <sym>Scenic Area</sym>\r\n");
 			strBuf.append("  <extensions>\r\n");



From araber95 at mail.berlios.de  Mon Jan 25 16:55:03 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Mon, 25 Jan 2010 16:55:03 +0100
Subject: [Cachewolf-svn] r2429 - trunk/src/CacheWolf/imp
Message-ID: <201001251555.o0PFt3j9019949@sheep.berlios.de>

Author: araber95
Date: 2010-01-25 16:55:01 +0100 (Mon, 25 Jan 2010)
New Revision: 2429

Modified:
   trunk/src/CacheWolf/imp/OCXMLImporter.java
   trunk/src/CacheWolf/imp/OCXMLImporterScreen.java
Log:
first changes for opencaching.se

Modified: trunk/src/CacheWolf/imp/OCXMLImporter.java
===================================================================
--- trunk/src/CacheWolf/imp/OCXMLImporter.java	2010-01-24 11:11:10 UTC (rev 2428)
+++ trunk/src/CacheWolf/imp/OCXMLImporter.java	2010-01-25 15:55:01 UTC (rev 2429)
@@ -55,6 +55,8 @@
 	public final static String OPENCACHING_CZ_PATTERN = "OZ";
 	public final static String OPENCACHING_UK_HOST = "www.opencaching.org.uk";
 	public final static String OPENCACHING_UK_PATTERN = "OK";
+	public final static String OPENCACHING_SE_HOST = "www.opencaching.se";
+	public final static String OPENCACHING_SE_PATTERN = "OK";
 
 	String hostname;
 
@@ -118,6 +120,8 @@
 			hostname = OPENCACHING_CZ_HOST;
 		else if(wpName.startsWith(OPENCACHING_UK_PATTERN))
 			hostname = OPENCACHING_UK_HOST;
+		else if(wpName.startsWith(OPENCACHING_SE_PATTERN))
+			hostname = OPENCACHING_SE_HOST;
 	}
 
 	/**

Modified: trunk/src/CacheWolf/imp/OCXMLImporterScreen.java
===================================================================
--- trunk/src/CacheWolf/imp/OCXMLImporterScreen.java	2010-01-24 11:11:10 UTC (rev 2428)
+++ trunk/src/CacheWolf/imp/OCXMLImporterScreen.java	2010-01-25 15:55:01 UTC (rev 2429)
@@ -59,7 +59,7 @@
 		this.title = title;
 
 		if((options & HOST) > 0){
-			String[] hosts = new String[] {OCXMLImporter.OPENCACHING_DE_HOST, OCXMLImporter.OPENCACHING_CZ_HOST, OCXMLImporter.OPENCACHING_PL_HOST, OCXMLImporter.OPENCACHING_UK_HOST};
+			String[] hosts = new String[] {OCXMLImporter.OPENCACHING_DE_HOST, OCXMLImporter.OPENCACHING_CZ_HOST, OCXMLImporter.OPENCACHING_PL_HOST, OCXMLImporter.OPENCACHING_UK_HOST, OCXMLImporter.OPENCACHING_SE_HOST};
 			domains = new mChoice(hosts,0);
 			domains.setTextSize(25, 1);
 			this.addLast(domains, CellConstants.DONTSTRETCH, CellConstants.DONTFILL|CellConstants.WEST);



From araber95 at mail.berlios.de  Mon Jan 25 16:56:53 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Mon, 25 Jan 2010 16:56:53 +0100
Subject: [Cachewolf-svn] r2430 - trunk/res_noewe/templates
Message-ID: <201001251556.o0PFurak020159@sheep.berlios.de>

Author: araber95
Date: 2010-01-25 16:56:51 +0100 (Mon, 25 Jan 2010)
New Revision: 2430

Modified:
   trunk/res_noewe/templates/Short documentation for the export via templates.htm
Log:
removed the wrong blanks in String - Parameters

Modified: trunk/res_noewe/templates/Short documentation for the export via templates.htm
===================================================================
--- trunk/res_noewe/templates/Short documentation for the export via templates.htm	2010-01-25 15:55:01 UTC (rev 2429)
+++ trunk/res_noewe/templates/Short documentation for the export via templates.htm	2010-01-25 15:56:51 UTC (rev 2430)
@@ -198,14 +198,14 @@
 value=&quot;,&quot;&gt;<span style='mso-tab-count:4'>??????????????????????????????????????? </span>Decimal
 separator : Defines, which decimal separator is used , values &quot;.&quot; or
 ','<br>
-&lt;<span class=SpellE>tmpl_par</span> name=&quot; <span class=SpellE>ShortNameLength</span>&quot;
-value=&quot;30&quot;&gt;<span style='mso-tab-count:2'>???????????????????? </span>Number
+&lt;<span class=SpellE>tmpl_par</span> name=&quot;<span class=SpellE>ShortNameLength</span>&quot;
+value=&quot;30&quot;&gt;<span style='mso-tab-count:2'>????????????????????? </span>Number
 of characters for Variable SHORTNAME <br>
-&lt;<span class=SpellE>tmpl_par</span> name=&quot; <span class=SpellE>WaypointLength</span>&quot;
-value=&quot;3&quot;&gt;<span style='mso-tab-count:3'>???????????????????????? </span>Number
+&lt;<span class=SpellE>tmpl_par</span> name=&quot;<span class=SpellE>WaypointLength</span>&quot;
+value=&quot;3&quot;&gt;<span style='mso-tab-count:3'>????????????????????????? </span>Number
 of characters for Variable SHORTWAYPOINT<br>
-&lt;<span class=SpellE>tmpl_par</span> name=&quot; Out&quot; value=&quot;*.<span
-class=SpellE>gpx</span>&quot;&gt;<span style='mso-tab-count:4'>????????????????????????????????????? </span>Output
+&lt;<span class=SpellE>tmpl_par</span> name=&quot;Out&quot; value=&quot;*.<span
+class=SpellE>gpx</span>&quot;&gt;<span style='mso-tab-count:4'>?????????????????????????????????????? </span>Output
 Filename or Extension</span><span lang=EN-GB style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>
 
 <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
@@ -225,8 +225,9 @@
 this is replaced by CR.<o:p></o:p></span></p>
 
 <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><u><span
-style='font-size:10.0pt;font-family:Arial'>Variables &lt;<span class=SpellE>tmpl_var</span>
-<span class=SpellE>NameOfVariable</span>&gt;</span><o:p></o:p></u></p>
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>Variables
+&lt;<span class=SpellE>tmpl_var</span> <span class=SpellE>NameOfVariable</span>&gt;</span></u><u><span
+lang=EN-GB style='mso-ansi-language:EN-GB'><o:p></o:p></span></u></p>
 
 <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
 lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>TYPE<span
@@ -259,7 +260,8 @@
 kann nur 30 Buchstaben)<br>
 </span><span style='font-size:10.0pt;font-family:Arial'>OWNER<span
 style='mso-tab-count:8'>???????????????????????????????????????????????????????????????????????????????????????????? </span>:<br>
-DIFFICULTY<span style='mso-tab-count:8'>??????????????????????????????????????????????????????????????????????????????????????? </span>:<br>
+DIFFICULTY<span style='mso-tab-count:7'>??????????????????????????????????????????????????????????????????????????? </span><span
+style='mso-tab-count:1'>??????????? </span>:<br>
 </span><span style='font-size:10.0pt;font-family:Helvetica'>SHORTDIFFICULTY<span
 style='mso-tab-count:7'>???????????????????????????????????????????????????????????????????????????? </span>:
 <span class=SpellE>Difficulty</span> mal 10 also 15 statt 1.5<br>
@@ -282,14 +284,14 @@
 class=SpellE>format</span>, <span class=SpellE>e.g</span>. N 50? 31.234 E 008?
 45.267<br>
 LAT<span style='mso-tab-count:9'>??????????????????????????????????????????????????????????????????????????????????????????????????? </span>:
-&lt;<span class=SpellE>wpt</span> <span class=SpellE>lat=?xx.yyyy</span>? ??..&gt;
-</span><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:
-EN-GB'>Latitude in decimal format, e.g. 50.20147<br>
+&lt;<span class=SpellE>wpt</span> <span class=SpellE>lat=?xx.yyyy</span>?
+??..&gt; </span><span lang=EN-GB style='font-size:10.0pt;font-family:Arial;
+mso-ansi-language:EN-GB'>Latitude in decimal format, e.g. 50.20147<br>
 LON<span style='mso-tab-count:9'>?????????????????????????????????????????????????????????????????????????????????????????????????? </span>:
 &lt;<span class=SpellE>wpt</span> ?? <span class=SpellE>lon</span>=?<span
 class=SpellE>xx.yyyy</span>? &gt; Longitude in decimal format, e.g. 008.58132<br>
-STATUS<span style='mso-tab-count:8'>???????????????????????????????????????????????????????????????????????????????????????????? </span>:
-<span style='mso-spacerun:yes'>?</span>means found<br>
+STATUS<span style='mso-tab-count:8'>???????????????????????????????????????????????????????????????????????????????????????????? </span>:<span
+style='mso-spacerun:yes'>? </span>means found<br>
 STATUS_DATE<span style='mso-tab-count:8'>?????????????????????????????????????????????????????????????????????????????????? </span>:
 Get the date part of the status <br>
 STATUS_TIME<span style='mso-tab-count:8'>??????????????????????????????????????????????????????????????????????????????????? </span>:
@@ -309,12 +311,12 @@
 Decrypted hints&nbsp;&nbsp;&nbsp; (<span class=SpellE>badchars</span> are
 removed, see below) <br>
 </span><span lang=EN-GB style='font-size:10.0pt;font-family:Helvetica;
-mso-ansi-language:EN-GB'>SHORTWAYPOINT<span style='mso-tab-count:7'>????????????????????????????????????????????????????????????????????????????? </span>:
-</span><span class=SpellE><span lang=EN-GB style='font-size:10.0pt;font-family:
-Arial;mso-ansi-language:EN-GB'>ShortNameLength</span></span><span lang=EN-GB
-style='font-size:10.0pt;font-family:Helvetica;mso-ansi-language:EN-GB'> <span
-class=SpellE>Zeichen</span> des Waypoints (<span class=SpellE>f?r</span> <span
-class=SpellE>Benutzer</span> alter <span class=SpellE>Ger?te</span> <span
+mso-ansi-language:EN-GB'>SHORTWAYPOINT<span style='mso-tab-count:6'>????????????????????????????????????????????????????????????????? </span><span
+style='mso-tab-count:1'>??????????? </span>: </span><span class=SpellE><span
+lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>ShortNameLength</span></span><span
+lang=EN-GB style='font-size:10.0pt;font-family:Helvetica;mso-ansi-language:
+EN-GB'> <span class=SpellE>Zeichen</span> des Waypoints (<span class=SpellE>f?r</span>
+<span class=SpellE>Benutzer</span> alter <span class=SpellE>Ger?te</span> <span
 class=SpellE>mit</span> <span class=SpellE>nur</span> 6 <span class=SpellE>Waypointzeichen</span>,
 <br>
 <span style='mso-spacerun:yes'>?</span><span style='mso-tab-count:9'>???????????????????????????????????????????????????????????????????????????????????????????????????????? </span>:
@@ -373,8 +375,9 @@
 class=SpellE>tmpl_var</span> name=LAT&gt;;&lt;<span class=SpellE>tmpl_var</span>
 name=LON&gt;;&quot;&lt;<span class=SpellE>tmpl_var</span>
 name=TYPE&gt;&quot;;&quot;&lt;<span class=SpellE>tmpl_var</span>
-name=SIZE&gt;&quot;;&quot;&lt;<span class=SpellE>tmpl_var</span> name=WAYPOINT&gt;&quot;;&quot;&lt;<span
-class=SpellE>tmpl_var</span> name=DATE&gt;&quot;;&quot;&lt;<span class=SpellE>tmpl_var</span>
+name=SIZE&gt;&quot;;&quot;&lt;<span class=SpellE>tmpl_var</span>
+name=WAYPOINT&gt;&quot;;&quot;&lt;<span class=SpellE>tmpl_var</span>
+name=DATE&gt;&quot;;&quot;&lt;<span class=SpellE>tmpl_var</span>
 name=URL&gt;&quot;&lt;<span class=SpellE>br</span> /&gt;<br>
 &lt;/<span class=SpellE>tmpl_loop</span>&gt;<br style='mso-special-character:
 line-break'>
@@ -397,8 +400,8 @@
 lang=EN-GB style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB
 style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>will be used
 if no value has been set through the <span class=SpellE>setParam</span> method.<br>
-&lt;TMPL_VAR name=&quot;<span class=SpellE>var_name</span>&quot; default=&quot;my
-value&quot;&gt;<br>
+&lt;TMPL_VAR name=&quot;<span class=SpellE>var_name</span>&quot;
+default=&quot;my value&quot;&gt;<br>
 If <span class=SpellE>var_name</span> is set using <span class=SpellE>setParam</span>
 (or <span class=SpellE>setParams</span>), then it's value will be whatever it
 was set to<span class=GramE>,<span style='mso-spacerun:yes'>? </span>else</span></span><span
@@ -450,11 +453,11 @@
 <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
 lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>The
 &lt;<span class=SpellE>tmpl_if</span>&gt; tag allows you to include or not
-include a block of the template based on the <span class=GramE>value <span
-style='mso-spacerun:yes'>?</span>of</span></span><span lang=EN-GB
+include a block of the template based on the <span class=GramE>value<span
+style='mso-spacerun:yes'>? </span>of</span></span><span lang=EN-GB
 style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB style='font-size:10.0pt;
-font-family:Arial;mso-ansi-language:EN-GB'>a given parameter name. If the parameter
-is given a value that is true, then the block is included in</span><span
+font-family:Arial;mso-ansi-language:EN-GB'>a given parameter name. If the
+parameter is given a value that is true, then the block is included in</span><span
 lang=EN-GB style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB
 style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>the output.
 If the value is false, then it is skipped.<br>
@@ -493,7 +496,7 @@
 <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
 lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>While
 the if block allows us to display some output if a condition is true<span
-class=GramE>, <span style='mso-spacerun:yes'>?</span>we</span></span><span
+class=GramE>,<span style='mso-spacerun:yes'>? </span>we</span></span><span
 lang=EN-GB style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB
 style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>may also
 need to display content if the condition is false. This can be done by using
@@ -530,8 +533,8 @@
 lang=EN-GB style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB
 style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>will be
 displayed repeatedly for every item in the loop control variable. Inside the
-&lt;<span class=SpellE>tmpl_loop</span>&gt;<span class=GramE>, <span
-style='mso-spacerun:yes'>?</span>you</span></span><span lang=EN-GB
+&lt;<span class=SpellE>tmpl_loop</span>&gt;<span class=GramE>,<span
+style='mso-spacerun:yes'>? </span>you</span></span><span lang=EN-GB
 style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB style='font-size:10.0pt;
 font-family:Arial;mso-ansi-language:EN-GB'>place &lt;<span class=SpellE>tmpl_var</span>&gt;s.<b
 style='mso-bidi-font-weight:normal'> The only loop used by the template
@@ -547,8 +550,8 @@
 
 <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
 lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>If
-you set <span class=SpellE>loop_context_vars</span> to true in your Template's
-constructor, then you will have access to five special</span><span lang=EN-GB
+you set <span class=SpellE>loop_context_vars</span> to true in your Template's constructor,
+then you will have access to five special</span><span lang=EN-GB
 style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB style='font-size:10.0pt;
 font-family:Arial;mso-ansi-language:EN-GB'>variables in all your loops. These
 are:</span><span lang=EN-GB style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>



From araber95 at mail.berlios.de  Mon Jan 25 19:00:13 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Mon, 25 Jan 2010 19:00:13 +0100
Subject: [Cachewolf-svn] r2431 - in trunk: res_noewe/templates
	src/CacheWolf/exp
Message-ID: <201001251800.o0PI0D4e014661@sheep.berlios.de>

Author: araber95
Date: 2010-01-25 18:59:59 +0100 (Mon, 25 Jan 2010)
New Revision: 2431

Modified:
   trunk/res_noewe/templates/Short documentation for the export via templates.htm
   trunk/src/CacheWolf/exp/TPLExporter.java
Log:
Adding possibility of unicode output to the template exporters with template parameter charset = UNICODE

Modified: trunk/res_noewe/templates/Short documentation for the export via templates.htm
===================================================================
--- trunk/res_noewe/templates/Short documentation for the export via templates.htm	2010-01-25 15:56:51 UTC (rev 2430)
+++ trunk/res_noewe/templates/Short documentation for the export via templates.htm	2010-01-25 17:59:59 UTC (rev 2431)
@@ -181,7 +181,7 @@
 lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>&lt;<span
 class=SpellE>tmpl_par</span> name=&quot;<span class=SpellE>charset</span>&quot;
 value=&quot;ASCII&quot;&gt;<span style='mso-tab-count:3'>??????????????????????????????? </span><span
-class=SpellE>Charsets</span>: &nbsp;values ASCII or UTF8<br>
+class=SpellE>Charsets</span>: &nbsp;values ASCII or UTF8 or UNICODE<br>
 &lt;<span class=SpellE>tmpl_par</span> name=&quot;<span class=SpellE>badchars</span>&quot;
 value=&quot;,&quot;&gt;<span style='mso-tab-count:4'>???????????????????????????????????? </span><span
 class=SpellE><span class=GramE>BadChars</span></span><span class=GramE> :</span>
@@ -260,8 +260,7 @@
 kann nur 30 Buchstaben)<br>
 </span><span style='font-size:10.0pt;font-family:Arial'>OWNER<span
 style='mso-tab-count:8'>???????????????????????????????????????????????????????????????????????????????????????????? </span>:<br>
-DIFFICULTY<span style='mso-tab-count:7'>??????????????????????????????????????????????????????????????????????????? </span><span
-style='mso-tab-count:1'>??????????? </span>:<br>
+DIFFICULTY<span style='mso-tab-count:8'>??????????????????????????????????????????????????????????????????????????????????????? </span>:<br>
 </span><span style='font-size:10.0pt;font-family:Helvetica'>SHORTDIFFICULTY<span
 style='mso-tab-count:7'>???????????????????????????????????????????????????????????????????????????? </span>:
 <span class=SpellE>Difficulty</span> mal 10 also 15 statt 1.5<br>
@@ -311,12 +310,12 @@
 Decrypted hints&nbsp;&nbsp;&nbsp; (<span class=SpellE>badchars</span> are
 removed, see below) <br>
 </span><span lang=EN-GB style='font-size:10.0pt;font-family:Helvetica;
-mso-ansi-language:EN-GB'>SHORTWAYPOINT<span style='mso-tab-count:6'>????????????????????????????????????????????????????????????????? </span><span
-style='mso-tab-count:1'>??????????? </span>: </span><span class=SpellE><span
-lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>ShortNameLength</span></span><span
-lang=EN-GB style='font-size:10.0pt;font-family:Helvetica;mso-ansi-language:
-EN-GB'> <span class=SpellE>Zeichen</span> des Waypoints (<span class=SpellE>f?r</span>
-<span class=SpellE>Benutzer</span> alter <span class=SpellE>Ger?te</span> <span
+mso-ansi-language:EN-GB'>SHORTWAYPOINT<span style='mso-tab-count:7'>????????????????????????????????????????????????????????????????????????????? </span>:
+</span><span class=SpellE><span lang=EN-GB style='font-size:10.0pt;font-family:
+Arial;mso-ansi-language:EN-GB'>ShortNameLength</span></span><span lang=EN-GB
+style='font-size:10.0pt;font-family:Helvetica;mso-ansi-language:EN-GB'> <span
+class=SpellE>Zeichen</span> des Waypoints (<span class=SpellE>f?r</span> <span
+class=SpellE>Benutzer</span> alter <span class=SpellE>Ger?te</span> <span
 class=SpellE>mit</span> <span class=SpellE>nur</span> 6 <span class=SpellE>Waypointzeichen</span>,
 <br>
 <span style='mso-spacerun:yes'>?</span><span style='mso-tab-count:9'>???????????????????????????????????????????????????????????????????????????????????????????????????????? </span>:
@@ -498,9 +497,9 @@
 the if block allows us to display some output if a condition is true<span
 class=GramE>,<span style='mso-spacerun:yes'>? </span>we</span></span><span
 lang=EN-GB style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB
-style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>may also
-need to display content if the condition is false. This can be done by using
-the optional else</span><span lang=EN-GB style='mso-ansi-language:EN-GB'> </span><span
+style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>may also need
+to display content if the condition is false. This can be done by using the
+optional else</span><span lang=EN-GB style='mso-ansi-language:EN-GB'> </span><span
 lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>branch
 of <span class=GramE>the if</span> block.</span><span lang=EN-GB
 style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>
@@ -550,8 +549,8 @@
 
 <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
 lang=EN-GB style='font-size:10.0pt;font-family:Arial;mso-ansi-language:EN-GB'>If
-you set <span class=SpellE>loop_context_vars</span> to true in your Template's constructor,
-then you will have access to five special</span><span lang=EN-GB
+you set <span class=SpellE>loop_context_vars</span> to true in your Template's
+constructor, then you will have access to five special</span><span lang=EN-GB
 style='mso-ansi-language:EN-GB'> </span><span lang=EN-GB style='font-size:10.0pt;
 font-family:Arial;mso-ansi-language:EN-GB'>variables in all your loops. These
 are:</span><span lang=EN-GB style='mso-ansi-language:EN-GB'><o:p></o:p></span></p>

Modified: trunk/src/CacheWolf/exp/TPLExporter.java
===================================================================
--- trunk/src/CacheWolf/exp/TPLExporter.java	2010-01-25 15:56:51 UTC (rev 2430)
+++ trunk/src/CacheWolf/exp/TPLExporter.java	2010-01-25 17:59:59 UTC (rev 2431)
@@ -105,8 +105,9 @@
 
 			// get the values
 			if (param.equals("charset")) {
-				if (value.equals("ASCII")) codec = new AsciiCodec();
-				if (value.equals("UTF8")) codec = new JavaUtf8Codec();
+				if (value.equals("ASCII")) {codec = new AsciiCodec();}
+				else if (value.equals("UTF8")) {codec = new JavaUtf8Codec();}
+				else {codec = new NoCodec();}
 			}
 			if (param.equals("badchars")) {
 				badChars = value;
@@ -331,5 +332,87 @@
         }
         return sb.toString();
     }
+}
 
+//##################################################################
+class NoCodec implements TextCodec{
+//##################################################################
+
+/**
+* This is a creation option. It specifies that CR characters should be removed when
+* encoding text into UTF.
+**/
+public static final int STRIP_CR_ON_DECODE = 0x1;
+/**
+* This is a creation option. It specifies that CR characters should be removed when
+* decoding text from UTF.
+**/
+public static final int STRIP_CR_ON_ENCODE = 0x2;
+/**
+* This is a creation option. It specifies that CR characters should be removed when
+* decoding text from UTF AND encoding text to UTF.
+**/
+public static final int STRIP_CR = STRIP_CR_ON_DECODE|STRIP_CR_ON_ENCODE;
+
+private int flags = 0;
+
+//===================================================================
+public NoCodec(int options)
+//===================================================================
+{
+	flags = options;
 }
+//===================================================================
+public NoCodec()
+//===================================================================
+{
+	this(0);
+}
+//===================================================================
+public ByteArray encodeText(char [] text, int start, int length, boolean endOfData, ByteArray dest) throws IOException
+//===================================================================
+{
+	if (dest == null) dest = new ByteArray();
+	int size = length == 0 ? 2 : 2+text.length*2;
+	if (dest.data == null || dest.data.length < size)
+		dest.data = new byte[size];
+	byte [] destination = dest.data;
+	int s = 0;
+	if (length>0){
+		destination[s++] = (byte) 0xFF;
+		destination[s++] = (byte) 0xFE;
+	}
+	for (int i = 0; i<length; i++){
+		char c = text[i+start];
+		if (c == 13 && ((flags & STRIP_CR_ON_ENCODE) != 0)) continue;
+		destination[s++] = (byte)(c & 0xFF);
+		destination[s++] = (byte)((c>>8) & 0xFF);
+	}
+	dest.length = s;
+	return dest;
+}
+
+//===================================================================
+public CharArray decodeText(byte [] encoded, int start, int length, boolean endOfData, CharArray dest) throws IOException
+//===================================================================
+{
+	if (dest == null) dest = new CharArray();
+	dest.length = 0;
+	return dest;
+}
+
+//===================================================================
+public void closeCodec() throws IOException
+//===================================================================
+{
+}
+
+//===================================================================
+public Object getCopy()
+//===================================================================
+{
+	return new NoCodec(flags);
+}
+//##################################################################
+}
+//##################################################################



From araber95 at mail.berlios.de  Tue Jan 26 16:39:57 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Tue, 26 Jan 2010 16:39:57 +0100
Subject: [Cachewolf-svn] r2432 - trunk/res_noewe/templates
Message-ID: <201001261539.o0QFdv51000484@sheep.berlios.de>

Author: araber95
Date: 2010-01-26 16:39:55 +0100 (Tue, 26 Jan 2010)
New Revision: 2432

Added:
   trunk/res_noewe/templates/Igo8.3.2.tpl
Log:
included direct export for IGO8.3 in template export.

Added: trunk/res_noewe/templates/Igo8.3.2.tpl
===================================================================
--- trunk/res_noewe/templates/Igo8.3.2.tpl	2010-01-25 17:59:59 UTC (rev 2431)
+++ trunk/res_noewe/templates/Igo8.3.2.tpl	2010-01-26 15:39:55 UTC (rev 2432)
@@ -0,0 +1,105 @@
+<#------------------------------------------->
+<#-- *** GPX -> IGO8 @ MtBo 16.03.2009 *** -->
+<#--    Einfach gleich speichern unter     -->
+<#--    IGO8/save/user.upoi                -->
+<#------------------------------------------->
+
+<#-- Platzhalter -->
+<#-- TYPE: Typ des Caches, z.B. Regular, Multi  -->
+<#-- SHORTTYPE: Erster Buchstabe von Typ  -->
+<#-- SIZE: Gr??e des Caches, z.B. Regular, Micro  -->
+<#-- SHORTSIZE: Erster Buchstabe von Gr??e  -->
+<#-- WAYPOINT: GCXXXX, OCXXXX  -->
+<#-- NAME: Name des Caches  -->
+<#-- OWNER  -->
+<#-- DIFFICULTY  -->
+<#-- TERRAIN  -->
+<#-- DISTANCE: Die Entfernung aus der Cacheliste  -->
+<#-- BEARING: Die Richtung aus der Cacheliste  -->
+<#-- LATLON: Koordinaten in langem Format: N 50? 31.234 E 008? 45.267  -->
+<#-- LAT: Breite in Dezimalformat, z.B. 50.20147. Trenner kann konfiguriert werden.  -->
+<#-- LON: L?nge in Dezimalformat, z.B. 008.58132. Trenner kann konfiguriert werden.  -->
+<#-- STATUS  -->
+<#-- DATE: Datum, wann versteckt  -->
+<#-- NOTES: Notizen  -->
+<#-- DESCRIPTION: Beschreibung  -->
+<#-- DECRYPTEDHINTS  -->
+<#-- URL  -->
+
+<#-- -----------------------Template-------------------------------------- -->
+
+<#-- Codecs: ASCII, UTF8 -->
+<tmpl_par name="charset" value="UTF-16 LE">
+
+<#-- Das Zeichen "|" wird nicht aus dem Listing ?bernommen-->
+<tmpl_par name="badchars" value="|">
+
+<#-- neue Zeile: CR, LF, CRLF -->
+<tmpl_par name="newline" value="CRLF">
+
+<#-- Ausgabe als kml-Datei -->
+<tmpl_par name="Out" value="user.upoi">
+
+ at My POI<br />
+
+<tmpl_loop cache_index>
+
+<#-- Feld 1 : Z?hler -->
+<tmpl_var name=__COUNTER__>|
+
+<#-- Feld 2 : Ordner -->
+<#-- Dieser eintrag erzeugt einen Ordner in der Poi-Verwaltung -->
+<#-- Dabei ergibt sich folgende Struktur: Ordner.Unterordner -->
+Geocaching.<tmpl_var name=GSTYPE>|
+
+<#-- Feld 3 : Poiname -->
+<tmpl_var name=NAME>
+|
+
+<#-- Feld 4 : kein Textfeld -->
+|
+
+<#-- Feld 5 : Nordkoordinate -->
+<tmpl_var name=LAT>
+|
+
+<#-- Feld 6 : Ostkoordinate -->
+<tmpl_var name=LON>
+|
+
+<#-- Feld 7 : Landkarten-Name -->
+|
+
+<#-- Feld 8 : kein Textfeld -->
+|
+<#-- Feld 9 : kein Textfeld -->
+|
+<#-- Feld 10 : kein Textfeld -->
+|
+<#-- Feld 11 : Postleitzahl -->
+|
+
+<#-- Feld 12 : Ort -->
+Diff:<tmpl_var name=DIFFICULTY>
+ /
+ Terr:<tmpl_var name=TERRAIN>
+|
+
+<#-- Feld 13 : Stra?e -->
+<tmpl_var name=SIZE>
+|
+
+<#-- Feld 14 : Hausnummer -->
+|
+
+<#-- Feld 15 : Infofeld -->
+<tmpl_var name=DECRYPTEDHINTS>
+|
+
+<#-- Feld 16 : Telefonnummer -->
+<tmpl_var name=WAYPOINT>
+ /
+ <tmpl_var name=OWNER>
+|
+<br />
+</tmpl_loop>
\ No newline at end of file



From araber95 at mail.berlios.de  Tue Jan 26 17:01:01 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Tue, 26 Jan 2010 17:01:01 +0100
Subject: [Cachewolf-svn] r2433 - trunk
Message-ID: <201001261601.o0QG11wd002009@sheep.berlios.de>

Author: araber95
Date: 2010-01-26 17:01:00 +0100 (Tue, 26 Jan 2010)
New Revision: 2433

Modified:
   trunk/cw-pc.jnf
Log:
giving more -Xmx than physically in computer will prevent CacheWolf.ex from starting.
change to -Xms 64M -Xmx 192M , should prenvent stopping with not enough memory.

Modified: trunk/cw-pc.jnf
===================================================================
--- trunk/cw-pc.jnf	2010-01-26 15:39:55 UTC (rev 2432)
+++ trunk/cw-pc.jnf	2010-01-26 16:01:00 UTC (rev 2433)
@@ -1 +1 @@
-command=programName%3DCacheWolf%26width%3D0%26height%3D0%26startingClass%3DCacheWolf.CacheWolf%26windowTitle%3DWindow%2BTitle%26ewes%3D%26extra%3D%26pathToEwe%3D%26nativeStack%3D0%26vmStack%3D0%26appletWidth%3D0%26appletHeight%3D0%26appletInFrame%3Dfalse%26locale%3D%26useResources%3Dtrue%26noPopupWindows%3Dfalse%26vmOptions%3D-Xms%2B64M%2B-Xmx%2B1024M&eweFiles=&targets=%253DTarget%3Dewe/data/MultiListSelect$SelectedItems%253D%25253Dx86%25252B-%25252BWin32%25252B-%25252BStatic%25252BLinked&createWithPnf=true&eweInfo=outputFile%3Dwork/CacheWolf.ewe%26entries%3Dewesoft/apps/jewel/EweDirEntry%253Dpath%25253Dbin/CacheWolf/%252526mask%25253D*.class%252526includeSubdirectories%25253Dtrue%252526pathInEwe%25253DCacheWolf/%2526ewesoft/apps/jewel/EweDirEntry%253Dpath%25253Dresources%252526mask%25253D*.gif;*.png;*.ico%252526includeSubdirectories%25253Dfalse%252526pathInEwe%25253D%2526ewesoft/apps/jewel/EweDirEntry%253Dpath%25253Dlib%252526mask%25253D*.class%252526includeSubdirectories%!
 25253Dtrue%252526pathInEwe%25253D%26addCommandLine%3Dtrue%26commandLine%3DprogramName%253DCacheWolf%2526width%253D0%2526height%253D0%2526startingClass%253DCacheWolf.CacheWolf%2526windowTitle%253DWindow%252BTitle%2526ewes%253D%2526extra%253D%2526pathToEwe%253D%2526nativeStack%253D0%2526vmStack%253D0%2526appletWidth%253D0%2526appletHeight%253D0%2526appletInFrame%253Dfalse%2526locale%253D%2526useResources%253Dtrue%2526noPopupWindows%253Dfalse%2526vmOptions%253D-Xms%252B64M%252B-Xmx%252B1024M%26install%3Dtitle%253D%2526category%253DApplications%2526location%253D%2526icon%253D%2526args%253D%2526vmArgs%253D%26addInstallFile%3Dfalse%26usePool%3Dfalse%26useClassPool%3Dfalse&icon=resources/CacheWolf.ico
+command=programName%3DCacheWolf%26width%3D0%26height%3D0%26startingClass%3DCacheWolf.CacheWolf%26windowTitle%3DWindow%2BTitle%26ewes%3D%26extra%3D%26pathToEwe%3D%26nativeStack%3D0%26vmStack%3D0%26appletWidth%3D0%26appletHeight%3D0%26appletInFrame%3Dfalse%26locale%3D%26useResources%3Dtrue%26noPopupWindows%3Dfalse%26vmOptions%3D-Xms%2B64M%2B-Xmx%2B192M&eweFiles=&targets=%253DTarget%3Dewe/data/MultiListSelect$SelectedItems%253D%25253Dx86%25252B-%25252BWin32%25252B-%25252BStatic%25252BLinked&createWithPnf=true&eweInfo=outputFile%3Dwork/CacheWolf.ewe%26entries%3Dewesoft/apps/jewel/EweDirEntry%253Dpath%25253Dbin/CacheWolf/%252526mask%25253D*.class%252526includeSubdirectories%25253Dtrue%252526pathInEwe%25253DCacheWolf/%2526ewesoft/apps/jewel/EweDirEntry%253Dpath%25253Dresources%252526mask%25253D*.gif;*.png;*.ico%252526includeSubdirectories%25253Dfalse%252526pathInEwe%25253D%2526ewesoft/apps/jewel/EweDirEntry%253Dpath%25253Dlib%252526mask%25253D*.class%252526includeSubdirectories%2!
 5253Dtrue%252526pathInEwe%25253D%26addCommandLine%3Dtrue%26commandLine%3DprogramName%253DCacheWolf%2526width%253D0%2526height%253D0%2526startingClass%253DCacheWolf.CacheWolf%2526windowTitle%253DWindow%252BTitle%2526ewes%253D%2526extra%253D%2526pathToEwe%253D%2526nativeStack%253D0%2526vmStack%253D0%2526appletWidth%253D0%2526appletHeight%253D0%2526appletInFrame%253Dfalse%2526locale%253D%2526useResources%253Dtrue%2526noPopupWindows%253Dfalse%2526vmOptions%253D-Xms%252B64M%252B-Xmx%252B192M%26install%3Dtitle%253D%2526category%253DApplications%2526location%253D%2526icon%253D%2526args%253D%2526vmArgs%253D%26addInstallFile%3Dfalse%26usePool%3Dfalse%26useClassPool%3Dfalse&icon=resources/CacheWolf.ico



From araber95 at mail.berlios.de  Fri Jan 29 00:18:09 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Fri, 29 Jan 2010 00:18:09 +0100
Subject: [Cachewolf-svn] r2434 - trunk/res_noewe/templates
Message-ID: <201001282318.o0SNI9qE011488@sheep.berlios.de>

Author: araber95
Date: 2010-01-29 00:18:08 +0100 (Fri, 29 Jan 2010)
New Revision: 2434

Added:
   trunk/res_noewe/templates/n?vi.tpl
Log:
adding template for n?vi

Added: trunk/res_noewe/templates/n?vi.tpl
===================================================================
--- trunk/res_noewe/templates/n?vi.tpl	2010-01-26 16:01:00 UTC (rev 2433)
+++ trunk/res_noewe/templates/n?vi.tpl	2010-01-28 23:18:08 UTC (rev 2434)
@@ -0,0 +1,17 @@
+<tmpl_par name="charset" value="UTF8">
+<tmpl_par name="badchars" value="&">
+<tmpl_par name="Out" value="*.gpx">
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<gpx xmlns="http://www.topografix.com/GPX/1/1" creator="CacheWolf" version="1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.garmin.com/xmlschemas/GpxExtensions/v3 http://www.garmin.com/xmlschemas/GpxExtensions/v3/GpxExtensionsv3.xsd http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd">
+<tmpl_loop cache_index>
+<wpt lat="<tmpl_var name = LAT>" lon="<tmpl_var name = LON>">
+<name><tmpl_var name = NAME></name>
+<desc><tmpl_var name = WAYPOINT> (<tmpl_var name = TYPE>) D=<tmpl_var name = DIFFICULTY>/T=<tmpl_var name = TERRAIN> - <tmpl_var name = SIZE></desc>
+<sym>Geocache</sym>
+<extensions>
+<gpxx:WaypointExtension xmlns:gpxx="http://www.garmin.com/xmlschemas/GpxExtensions/v3"><gpxx:Categories><gpxx:Category>Geocaches</gpxx:Category></gpxx:Categories>
+<gpxx:Address><gpxx:StreetAddress><tmpl_var name = WAYPOINT> - D=<tmpl_var name = DIFFICULTY>/T=<tmpl_var name = TERRAIN> - <tmpl_var name = SIZE></gpxx:StreetAddress><gpxx:State><tmpl_var name = TYPE></gpxx:State></gpxx:Address></gpxx:WaypointExtension>
+</extensions>
+</wpt>
+</tmpl_loop>
+</gpx>



From araber95 at mail.berlios.de  Fri Jan 29 00:24:31 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Fri, 29 Jan 2010 00:24:31 +0100
Subject: [Cachewolf-svn] r2435 - trunk/res_noewe/templates
Message-ID: <201001282324.o0SNOVko011767@sheep.berlios.de>

Author: araber95
Date: 2010-01-29 00:24:29 +0100 (Fri, 29 Jan 2010)
New Revision: 2435

Added:
   trunk/res_noewe/templates/Nokia_LMX.htm
   trunk/res_noewe/templates/Nokia_LMX.tpl
Log:
template for Nokia LMX

Added: trunk/res_noewe/templates/Nokia_LMX.htm
===================================================================
--- trunk/res_noewe/templates/Nokia_LMX.htm	2010-01-28 23:18:08 UTC (rev 2434)
+++ trunk/res_noewe/templates/Nokia_LMX.htm	2010-01-28 23:24:29 UTC (rev 2435)
@@ -0,0 +1,123 @@
+<html xmlns:o="urn:schemas-microsoft-com:office:office"
+xmlns:w="urn:schemas-microsoft-com:office:word"
+xmlns="http://www.w3.org/TR/REC-html40">
+
+<head>
+<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
+<meta name=ProgId content=Word.Document>
+<meta name=Generator content="Microsoft Word 10">
+<meta name=Originator content="Microsoft Word 10">
+<link rel=File-List href="Nokia_LMX-Dateien/filelist.xml">
+<title>1</title>
+<!--[if gte mso 9]><xml>
+ <o:DocumentProperties>
+  <o:Author>.</o:Author>
+  <o:LastAuthor>.</o:LastAuthor>
+  <o:Revision>1</o:Revision>
+  <o:Created>2010-01-28T23:21:00Z</o:Created>
+  <o:LastSaved>2010-01-28T23:23:00Z</o:LastSaved>
+  <o:Pages>1</o:Pages>
+  <o:Words>109</o:Words>
+  <o:Characters>688</o:Characters>
+  <o:Company>CF Computer</o:Company>
+  <o:Lines>5</o:Lines>
+  <o:Paragraphs>1</o:Paragraphs>
+  <o:CharactersWithSpaces>796</o:CharactersWithSpaces>
+  <o:Version>10.6856</o:Version>
+ </o:DocumentProperties>
+</xml><![endif]--><!--[if gte mso 9]><xml>
+ <w:WordDocument>
+  <w:GrammarState>Clean</w:GrammarState>
+  <w:HyphenationZone>21</w:HyphenationZone>
+  <w:Compatibility>
+   <w:BreakWrappedTables/>
+   <w:SnapToGridInCell/>
+   <w:WrapTextWithPunct/>
+   <w:UseAsianBreakRules/>
+  </w:Compatibility>
+  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
+ </w:WordDocument>
+</xml><![endif]-->
+<style>
+<!--
+ /* Style Definitions */
+ p.MsoNormal, li.MsoNormal, div.MsoNormal
+	{mso-style-parent:"";
+	margin:0cm;
+	margin-bottom:.0001pt;
+	mso-pagination:widow-orphan;
+	font-size:12.0pt;
+	font-family:"Times New Roman";
+	mso-fareast-font-family:"Times New Roman";}
+ at page Section1
+	{size:595.3pt 841.9pt;
+	margin:70.85pt 70.85pt 2.0cm 70.85pt;
+	mso-header-margin:35.4pt;
+	mso-footer-margin:35.4pt;
+	mso-paper-source:0;}
+div.Section1
+	{page:Section1;}
+-->
+</style>
+<!--[if gte mso 10]>
+<style>
+ /* Style Definitions */
+ table.MsoNormalTable
+	{mso-style-name:"Normale Tabelle";
+	mso-tstyle-rowband-size:0;
+	mso-tstyle-colband-size:0;
+	mso-style-noshow:yes;
+	mso-style-parent:"";
+	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
+	mso-para-margin:0cm;
+	mso-para-margin-bottom:.0001pt;
+	mso-pagination:widow-orphan;
+	font-size:10.0pt;
+	font-family:"Times New Roman";}
+</style>
+<![endif]-->
+</head>
+
+<body lang=DE style='tab-interval:35.4pt'>
+
+<div class=Section1>
+
+<p class=MsoNormal>1.) Die gew?nschten Caches mittels des Templates
+&quot;Nokia_LMX.tpl&quot; in eine Datei mit der Endung &quot;lmx&quot;
+exortieren.<o:p></o:p></p>
+
+<p class=MsoNormal>2.) Die exportierte Datei in das Handy ?bertragen.<o:p></o:p></p>
+
+<p class=MsoNormal><span style='mso-tab-count:1'>??????????? </span>Am
+einfachsten geht das, wenn man es per USB-Kabel als Massenspeicher anschlie?t
+und dann die Datei auf die Karte kopiert.<o:p></o:p></p>
+
+<p class=MsoNormal>3.) Das Handy wieder vom PC trennen.<o:p></o:p></p>
+
+<p class=MsoNormal>4.) Die kopierte Datei mit dem Nokia-Dateimanager ?ffnen.<o:p></o:p></p>
+
+<p class=MsoNormal><span style='mso-tab-count:1'>??????????? </span>Es werden
+alle enthaltenen Orientierungspunkte angezeigt.<o:p></o:p></p>
+
+<p class=MsoNormal>5.) ?ber Optionen / Speichern / Alle Orientierungspunkte
+k?nnen die Orientierungspunkte gespeichert werden.<o:p></o:p></p>
+
+<p class=MsoNormal><o:p>&nbsp;</o:p></p>
+
+<p class=MsoNormal>Ich habe nur die wichtigsten Informationen zu einem Cache in
+die Beschreibung eines Orientierungspunktes aufgenommen,<o:p></o:p></p>
+
+<p class=MsoNormal>da ich das Display des N95 f?r zu klein f?r &quot;paperless
+Caching&quot; finde und ich immer einen Ausdruck mitnehme.<o:p></o:p></p>
+
+<p class=MsoNormal><o:p>&nbsp;</o:p></p>
+
+<p class=MsoNormal>Gerd alias Zorkan<o:p></o:p></p>
+
+<p class=MsoNormal><o:p>&nbsp;</o:p></p>
+
+</div>
+
+</body>
+
+</html>

Added: trunk/res_noewe/templates/Nokia_LMX.tpl
===================================================================
--- trunk/res_noewe/templates/Nokia_LMX.tpl	2010-01-28 23:18:08 UTC (rev 2434)
+++ trunk/res_noewe/templates/Nokia_LMX.tpl	2010-01-28 23:24:29 UTC (rev 2435)
@@ -0,0 +1,35 @@
+<tmpl_par name="charset" value="UTF8">
+<tmpl_par name="newline" value="CRLF">
+<tmpl_par name="Out" value="*.lmx">
+<?xml version="1.0" encoding="UTF-8"?><br/>
+<lm:lmx xmlns:lm="http://www.nokia.com/schemas/location/landmarks/1/0"<br/>
+        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"<br/>
+        xsi:schemaLocation="http://www.nokia.com/schemas/location/landmarks/1/0/lmx.xsd"><br/>
+
+  <lm:landmarkCollection><br/><br/>
+
+    <tmpl_loop cache_index><br/><br/>
+
+      <lm:landmark><br/>
+          <lm:name><tmpl_if MAINWP><tmpl_var name=MAINWP>/</tmpl_if><tmpl_var name=WAYPOINT> <tmpl_var NAME></lm:name><br/>
+          <lm:description>
+<tmpl_if TYPE>Type: <tmpl_var TYPE>, </tmpl_if>
+<tmpl_if SIZE>Size: <tmpl_var SIZE>, </tmpl_if>
+<tmpl_if DIFFICULTY>Difficulty: <tmpl_var DIFFICULTY>, </tmpl_if>
+<tmpl_if TERRAIN>Terrain: <tmpl_var TERRAIN>, </tmpl_if>
+Hints: <tmpl_var DECRYPTEDHINTS>
+          </lm:description><br/>
+          <lm:coordinates><br/>
+            <lm:latitude><tmpl_var name=LAT></lm:latitude><br/>
+            <lm:longitude><tmpl_var name=LON></lm:longitude><br/>
+          </lm:coordinates><br/>
+          <lm:category><br/>
+            <lm:name>Geocache</lm:name><br/>
+          </lm:category><br/>
+      </lm:landmark><br/><br/>
+
+    </tmpl_loop><br/>
+
+  </lm:landmarkCollection><br/><br/>
+
+</lm:lmx>



From araber95 at mail.berlios.de  Fri Jan 29 13:03:57 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Fri, 29 Jan 2010 13:03:57 +0100
Subject: [Cachewolf-svn] r2436 - in trunk/src/CacheWolf: . exp imp navi utils
Message-ID: <201001291203.o0TC3vNX017076@sheep.berlios.de>

Author: araber95
Date: 2010-01-29 13:03:43 +0100 (Fri, 29 Jan 2010)
New Revision: 2436

Modified:
   trunk/src/CacheWolf/CacheHolderDetail.java
   trunk/src/CacheWolf/Common.java
   trunk/src/CacheWolf/DescriptionPanel.java
   trunk/src/CacheWolf/MyComparer.java
   trunk/src/CacheWolf/ShowCacheInBrowser.java
   trunk/src/CacheWolf/exp/KMLExporter.java
   trunk/src/CacheWolf/exp/TPLExporter.java
   trunk/src/CacheWolf/imp/OCXMLImporter.java
   trunk/src/CacheWolf/navi/MapImporter.java
   trunk/src/CacheWolf/navi/MapInfoObject.java
   trunk/src/CacheWolf/navi/MapsList.java
   trunk/src/CacheWolf/navi/SelectMap.java
   trunk/src/CacheWolf/utils/FileBugfix.java
Log:
first part of code change to get CW run on my Blackberry

Modified: trunk/src/CacheWolf/CacheHolderDetail.java
===================================================================
--- trunk/src/CacheWolf/CacheHolderDetail.java	2010-01-28 23:24:29 UTC (rev 2435)
+++ trunk/src/CacheWolf/CacheHolderDetail.java	2010-01-29 12:03:43 UTC (rev 2436)
@@ -158,7 +158,7 @@
 				imgFile = fc.getChosenFile();
 				imgDesc = new InputBox("Description").input("",10);
 				//Create Destination Filename
-				String ext = imgFile.getFileExt().substring(imgFile.getFileExt().lastIndexOf("."));
+				String ext = imgFile.getFileExt().substring(imgFile.getFileExt().lastIndexOf('.'));
 				imgDestName = getParent().getWayPoint() + "_U_" + (this.userImages.size()+1) + ext;
 				
 				ImageInfo userImageInfo = new ImageInfo();

Modified: trunk/src/CacheWolf/Common.java
===================================================================
--- trunk/src/CacheWolf/Common.java	2010-01-28 23:24:29 UTC (rev 2435)
+++ trunk/src/CacheWolf/Common.java	2010-01-29 12:03:43 UTC (rev 2436)
@@ -142,7 +142,7 @@
 	 */
 	public static String getFilenameExtension (String fn) {
 		if (fn == null || fn.length() == 0) return "";
-		int dot = fn.lastIndexOf(".");
+		int dot = fn.lastIndexOf('.');
 		if (dot < 0) return "";
 		return fn.substring(dot, fn.length());
 	}

Modified: trunk/src/CacheWolf/DescriptionPanel.java
===================================================================
--- trunk/src/CacheWolf/DescriptionPanel.java	2010-01-28 23:24:29 UTC (rev 2435)
+++ trunk/src/CacheWolf/DescriptionPanel.java	2010-01-29 12:03:43 UTC (rev 2436)
@@ -87,7 +87,7 @@
                         if (imgUrl==null) break; // Remaining pictures are from image span
                         // Vm.debug("imgUrl "+imgUrl);
                         if (imgUrl.lastIndexOf('.') > 0 && imgUrl.toLowerCase().startsWith("http")) {
-                            String imgType = (imgUrl.substring(imgUrl.lastIndexOf("."))
+                            String imgType = (imgUrl.substring(imgUrl.lastIndexOf('.'))
                                     .toLowerCase() + "    ").substring(0, 4).trim();
                             // If we have an image which we stored when spidering, we can display it
         					if(imgType.startsWith(".png") || imgType.startsWith(".jpg") || imgType.startsWith(".gif")){

Modified: trunk/src/CacheWolf/MyComparer.java
===================================================================
--- trunk/src/CacheWolf/MyComparer.java	2010-01-28 23:24:29 UTC (rev 2435)
+++ trunk/src/CacheWolf/MyComparer.java	2010-01-29 12:03:43 UTC (rev 2436)
@@ -87,7 +87,7 @@
 		} else if (colToCompare==12) {
 			for (int i=0; i<visibleSize; i++) {
 				CacheHolder ch=cacheDB.get(i);
-				ch.sort=Byte.toString(ch.getCacheSize());
+				ch.sort=Integer.toString(ch.getCacheSize());
 			}
 		} else if (colToCompare==13) {
 			for (int i=0; i<visibleSize; i++) {

Modified: trunk/src/CacheWolf/ShowCacheInBrowser.java
===================================================================
--- trunk/src/CacheWolf/ShowCacheInBrowser.java	2010-01-28 23:24:29 UTC (rev 2435)
+++ trunk/src/CacheWolf/ShowCacheInBrowser.java	2010-01-29 12:03:43 UTC (rev 2436)
@@ -125,7 +125,7 @@
 						String imgUrl=imgRex.stringMatched(1);
 						//Vm.debug("imgUrl "+imgUrl);
 						if (imgUrl.lastIndexOf('.')>0 && imgUrl.toLowerCase().startsWith("http")) {
-							String imgType = (imgUrl.substring(imgUrl.lastIndexOf(".")).toLowerCase()+"    ").substring(0,4).trim();
+							String imgType = (imgUrl.substring(imgUrl.lastIndexOf('.')).toLowerCase()+"    ").substring(0,4).trim();
 							// If we have an image which we stored when spidering, we can display it
         					if(imgType.startsWith(".png") || imgType.startsWith(".jpg") || imgType.startsWith(".gif")){
 								s.append("<img src=\"file://"+

Modified: trunk/src/CacheWolf/exp/KMLExporter.java
===================================================================
--- trunk/src/CacheWolf/exp/KMLExporter.java	2010-01-28 23:24:29 UTC (rev 2435)
+++ trunk/src/CacheWolf/exp/KMLExporter.java	2010-01-29 12:03:43 UTC (rev 2436)
@@ -105,7 +105,7 @@
 					tmp = (Vector)entry.getValue();
 					// skip over empty cachetypes
 					if (tmp.size() == 0) continue;
-					outp.print(startFolder(CacheType.type2Gui(new Integer((String)entry.getKey()).byteValue())));
+					outp.print(startFolder(CacheType.type2Gui(Integer.valueOf(entry.getKey().toString()).byteValue())));
 
 					for(int i = 0; i<tmp.size(); i++){
 						ch = (CacheHolder) tmp.get(i);

Modified: trunk/src/CacheWolf/exp/TPLExporter.java
===================================================================
--- trunk/src/CacheWolf/exp/TPLExporter.java	2010-01-28 23:24:29 UTC (rev 2435)
+++ trunk/src/CacheWolf/exp/TPLExporter.java	2010-01-29 12:03:43 UTC (rev 2436)
@@ -172,9 +172,9 @@
 		pbf.showMainTask = false;
 		pbf.setTask(h,"Exporting ...");
 		pbf.exec();
-		Vm.gc(); // all this doesn't really work :-(
-		System.runFinalization();
-		Vm.gc();
+		// Vm.gc(); // all this doesn't really work :-(
+		// System.runFinalization();
+		// Vm.gc();
 		//Vm.debug("v: "+Vm.countObjects(true));
 		String selbstLaute="aeiouAEIOU";
 		StringBuffer lower=new StringBuffer(26);// region/language dependent ?
@@ -237,12 +237,12 @@
 						varParams.put("OWNER", ch.getCacheOwner());
 						byte chGetHard=ch.getHard();
 						varParams.put("DIFFICULTY", (ch.isAddiWpt() || ch.isCustomWpt() || chGetHard < 0)?"":dec.replaceAll(CacheTerrDiff.longDT(chGetHard)));
-						String sHard = Byte.toString(chGetHard);
+						String sHard = Integer.toString(chGetHard);
 						varParams.put("SHORTDIFFICULTY", (ch.isAddiWpt() || ch.isCustomWpt() || chGetHard < 0)?"":sHard);
 						varParams.put("SHDIFFICULTY", (ch.isAddiWpt() || ch.isCustomWpt() || chGetHard < 0)?"":sHard.substring(0,1));
 						byte chGetTerrain=ch.getTerrain();
 						varParams.put("TERRAIN", (ch.isAddiWpt() || ch.isCustomWpt() || chGetTerrain < 0)?"":dec.replaceAll(CacheTerrDiff.longDT(chGetTerrain)));
-						String sTerrain = Byte.toString(chGetTerrain);
+						String sTerrain = Integer.toString(chGetTerrain);
 						varParams.put("SHORTTERAIN", (ch.isAddiWpt() || ch.isCustomWpt() || chGetTerrain < 0)?"":sTerrain);
 						varParams.put("SHTERRAIN", (ch.isAddiWpt() || ch.isCustomWpt() || chGetTerrain < 0)?"":sTerrain.substring(0,1));
 						varParams.put("DISTANCE", dec.replaceAll(ch.getDistance()));
@@ -299,13 +299,13 @@
 			e.printStackTrace();
 			Global.getPref().log("Exception in TplExporter", e, true);
 		} catch (OutOfMemoryError e) {
-			//Global.getPref().log("OutOfMemeory in TplExporter", e, true);
-			Vm.gc(); // this doesn't help :-(
-			System.runFinalization();
-			Vm.gc(); // this doesn't help :-( - I don't know why :-(
-			//Vm.debug("n: "+Vm.countObjects(true));
+			// Global.getPref().log("OutOfMemeory in TplExporter", e, true);
+			// Vm.gc(); // this doesn't help :-(
+			// System.runFinalization();
+			// Vm.gc(); // this doesn't help :-( - I don't know why :-(
+			// Vm.debug("n: "+Vm.countObjects(true));
 			(new MessageBox("Error", "Not enough memory available to load all cache data (incl. description and logs)\nexport aborted\nFilter caches to minimise memory needed for TPL-Export\nWe recommend to restart CacheWolf now", FormBase.OKB)).execute();
-			//Vm.debug("n: "+Vm.countObjects(true));
+			// Vm.debug("n: "+Vm.countObjects(true));
 		}
 		pbf.exit(0);
 	}

Modified: trunk/src/CacheWolf/imp/OCXMLImporter.java
===================================================================
--- trunk/src/CacheWolf/imp/OCXMLImporter.java	2010-01-28 23:24:29 UTC (rev 2435)
+++ trunk/src/CacheWolf/imp/OCXMLImporter.java	2010-01-29 12:03:43 UTC (rev 2436)
@@ -580,7 +580,7 @@
 					} else {
 						if (fetchUrl.toLowerCase().indexOf("opencaching.") > 0 || fetchUrl.toLowerCase().indexOf("geocaching.com") > 0) //wenn von Opencaching oder geocaching ist Dateiname doch nicht so toll, weil nur aus Nummer bestehend
 							imgAltText = new String("No image title");
-						else imgAltText = fetchUrl.substring(fetchUrl.lastIndexOf("/")+1);
+						else imgAltText = fetchUrl.substring(fetchUrl.lastIndexOf('/')+1);
 					}
 					descIndex = imgRegexUrl.matchedTo();
 					getPic(fetchUrl, imgAltText);
@@ -623,7 +623,7 @@
 	}
 
 	private String createPicFilename(String fetchURL) {
-		String fileName = holder.getWayPoint() + "_" + fetchURL.substring(fetchURL.lastIndexOf("/")+1);
+		String fileName = holder.getWayPoint() + "_" + fetchURL.substring(fetchURL.lastIndexOf('/')+1);
 		return Common.ClearForFileName(fileName).toLowerCase();
 	}
 

Modified: trunk/src/CacheWolf/navi/MapImporter.java
===================================================================
--- trunk/src/CacheWolf/navi/MapImporter.java	2010-01-28 23:24:29 UTC (rev 2435)
+++ trunk/src/CacheWolf/navi/MapImporter.java	2010-01-29 12:03:43 UTC (rev 2436)
@@ -192,7 +192,7 @@
 				}
 			}
 			//Check for a .map file
-			rawFileName = currfile.substring(0, currfile.lastIndexOf("."));
+			rawFileName = currfile.substring(0, currfile.lastIndexOf('.'));
 			mapFile = new File(inDir.getFullPath() + "/" + rawFileName + ".map");
 			if(!imageerror && mapFile.exists()){
 				GCPoint gcp1 = new GCPoint();

Modified: trunk/src/CacheWolf/navi/MapInfoObject.java
===================================================================
--- trunk/src/CacheWolf/navi/MapInfoObject.java	2010-01-28 23:24:29 UTC (rev 2435)
+++ trunk/src/CacheWolf/navi/MapInfoObject.java	2010-01-29 12:03:43 UTC (rev 2436)
@@ -147,7 +147,7 @@
 	public String getImageFilename() {
 		// if (fileName == null || fileName.length() > 0) return fileName; 
 		if (fileNameWFL.length() == 0) return ""; // no image associated (empty map)
-		String n = fileNameWFL.substring(0, fileNameWFL.lastIndexOf("."));
+		String n = fileNameWFL.substring(0, fileNameWFL.lastIndexOf('.'));
 		return Common.getImageName(CacheWolf.STRreplace.replace(n, "//", "/"));
 	}
 

Modified: trunk/src/CacheWolf/navi/MapsList.java
===================================================================
--- trunk/src/CacheWolf/navi/MapsList.java	2010-01-28 23:24:29 UTC (rev 2435)
+++ trunk/src/CacheWolf/navi/MapsList.java	2010-01-29 12:03:43 UTC (rev 2436)
@@ -61,7 +61,7 @@
 			if (dateien == null) continue;
 			for(int i = 0; i < dateien.length;i++){
 				// if (!dateien[i].endsWith(".wfl")) continue;
-				rawFileName = dateien[i].substring(0, dateien[i].lastIndexOf("."));
+				rawFileName = dateien[i].substring(0, dateien[i].lastIndexOf('.'));
 				try {
 					if (dirs.get(j).equals(".")) // the notation dir/./filename doesn't work on all platforms anyhow
 						tempMIO = new MapListEntry(mapsPath+"/", rawFileName);

Modified: trunk/src/CacheWolf/navi/SelectMap.java
===================================================================
--- trunk/src/CacheWolf/navi/SelectMap.java	2010-01-28 23:24:29 UTC (rev 2435)
+++ trunk/src/CacheWolf/navi/SelectMap.java	2010-01-29 12:03:43 UTC (rev 2436)
@@ -41,7 +41,7 @@
 			String rawFileName = new String();
 			dateien = files.listMultiple("*.png,*.jpg,*.gif,*.bmp", FileBase.LIST_FILES_ONLY);
 			for(int i = 0; i < dateien.length;i++){
-				rawFileName = dateien[i].substring(0, dateien[i].lastIndexOf("."));
+				rawFileName = dateien[i].substring(0, dateien[i].lastIndexOf('.'));
 				checkWFL = new File(mapsPath + rawFileName + ".wfl");
 				
 				if(checkWFL.exists()){

Modified: trunk/src/CacheWolf/utils/FileBugfix.java
===================================================================
--- trunk/src/CacheWolf/utils/FileBugfix.java	2010-01-28 23:24:29 UTC (rev 2435)
+++ trunk/src/CacheWolf/utils/FileBugfix.java	2010-01-29 12:03:43 UTC (rev 2436)
@@ -119,7 +119,7 @@
 		String fullPath = ewefile.getFullPath();
 		int rel = fullPath.indexOf("/..");
 		while (rel > 0) {
-			int parent = fullPath.lastIndexOf("/", rel-1);
+			int parent = fullPath.lastIndexOf('/', rel-1);
 			if (parent == -1) {
 				break;
 			}



From araber95 at mail.berlios.de  Fri Jan 29 13:05:23 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Fri, 29 Jan 2010 13:05:23 +0100
Subject: [Cachewolf-svn] r2437 - trunk/resources
Message-ID: <201001291205.o0TC5Nb6018798@sheep.berlios.de>

Author: araber95
Date: 2010-01-29 13:05:16 +0100 (Fri, 29 Jan 2010)
New Revision: 2437

Modified:
   trunk/resources/bug_no_vga.gif
Log:
perhaps looking a bit better

Modified: trunk/resources/bug_no_vga.gif
===================================================================
(Binary files differ)



From araber95 at mail.berlios.de  Fri Jan 29 14:58:33 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Fri, 29 Jan 2010 14:58:33 +0100
Subject: [Cachewolf-svn] r2438 - trunk/src/CacheWolf/exp
Message-ID: <201001291358.o0TDwXpe018056@sheep.berlios.de>

Author: araber95
Date: 2010-01-29 14:58:31 +0100 (Fri, 29 Jan 2010)
New Revision: 2438

Modified:
   trunk/src/CacheWolf/exp/GpxExportNg.java
Log:
doing MyFinds with stored ownLog/ID instead of checking all logs.

Modified: trunk/src/CacheWolf/exp/GpxExportNg.java
===================================================================
--- trunk/src/CacheWolf/exp/GpxExportNg.java	2010-01-29 12:05:16 UTC (rev 2437)
+++ trunk/src/CacheWolf/exp/GpxExportNg.java	2010-01-29 13:58:31 UTC (rev 2438)
@@ -438,7 +438,7 @@
 					h.changed();
 				}
 
-				if (Global.getPref().debug) Vm.debug("stop: "+new Time().getTime());
+				Global.getPref().log("stop: "+new Time().getTime());
 
 				pbf.exit(0);
 
@@ -682,58 +682,38 @@
 	public String formatLogs(CacheHolder ch) {
 		LogList logs = ch.getFreshDetails().CacheLogs;
 		StringBuffer ret = new StringBuffer();
-		String fid = "";
-
-		if (exportStyle == STYLE_GPX_MYFINDS)
-			fid = finderid;
-
-		if (0 == logs.size())
-			return "";
-
 		int exportlogs;
-
-		if (exportStyle == STYLE_GPX_PQLIKE && maxLogs < logs.size()) {
-			exportlogs = maxLogs;
-		} else {
-			exportlogs = logs.size();
+		if (exportStyle == STYLE_GPX_PQLIKE && maxLogs < logs.size())
+			{exportlogs = maxLogs;}
+		else {exportlogs = logs.size();}
+		if (exportStyle == STYLE_GPX_MYFINDS) {
+			// only own log
+			if (ch.details.OwnLogId.equals("")) 
+				return "";
+			if(ch.details.OwnLog == null) 
+				return "";
+			addLog(ch.details.OwnLogId, ch.details.OwnLog, finderid ,ret);
 		}
-
-		boolean logexported=false;
-		for (int i = 0; i < exportlogs; i++) {
-			String logId = Integer.toString(i);
-			Log log = logs.getLog(i);
-
-			if (exportStyle == STYLE_GPX_MYFINDS) {
-				if (!log.isOwnLog()) { continue; }
-				else {if (!log.isFoundLog()) { continue; } }
+		else {
+			for (int i = 0; i < exportlogs; i++) {
+				addLog(Integer.toString(i), logs.getLog(i),"" ,ret);
 			}
-			Transformer trans = new Transformer(true);
-			trans.add(new Regex("@@LOGID@@", logId));
-			trans.add(new Regex("@@LOGDATE@@", log.getDate()));
-			trans.add(new Regex("@@LOGTYPE@@", image2TypeText(log.getIcon())));
-			trans.add(new Regex("@@LOGFINDERID@@", fid));
-			trans.add(new Regex("@@LOGFINDER@@", SafeXML.cleanGPX(log.getLogger())));
-			trans.add(new Regex("@@LOGENCODE@@", ""));
-			trans.add(new Regex("@@LOGTEXT@@", SafeXML.cleanGPX(log.getMessage())));
-			ret.append(trans.replaceAll(GPXLOG));
-			if (exportStyle == STYLE_GPX_MYFINDS ) {logexported = true; break;}
 		}
-		if (exportStyle == STYLE_GPX_MYFINDS && !logexported) {
-			// own log is not within the saved logs
-			Transformer trans = new Transformer(true);
-			trans.add(new Regex("@@LOGID@@", "0"));
-			trans.add(new Regex("@@LOGDATE@@", ch.GetStatusDate()+"T"+ch.GetStatusTime()+":00"));
-			trans.add(new Regex("@@LOGTYPE@@", "Found it"));
-			trans.add(new Regex("@@LOGFINDERID@@", fid));
-			trans.add(new Regex("@@LOGFINDER@@", SafeXML.cleanGPX(Global.getPref().myAlias)));
-			trans.add(new Regex("@@LOGENCODE@@", ""));
-			// trans.add(new Regex("@@LOGTEXT@@",ch.details == null ? "" : ch.details.OwnLog == null ? "" : SafeXML.cleanGPX(ch.details.OwnLog.getMessage())));
-			trans.add(new Regex("@@LOGTEXT@@","")); // who cares about the text ?
-			ret.append(trans.replaceAll(GPXLOG));
-		}
-
 		return ret.toString();
 	}
+	
+	private StringBuffer addLog(String logId, Log log, String FinderID, StringBuffer ret) {
+		Transformer trans = new Transformer(true);
+		trans.add(new Regex("@@LOGID@@", logId));
+		trans.add(new Regex("@@LOGDATE@@", log.getDate()));
+		trans.add(new Regex("@@LOGTYPE@@", image2TypeText(log.getIcon())));
+		trans.add(new Regex("@@LOGFINDERID@@", FinderID));
+		trans.add(new Regex("@@LOGFINDER@@", SafeXML.cleanGPX(log.getLogger())));
+		trans.add(new Regex("@@LOGENCODE@@", ""));
+		trans.add(new Regex("@@LOGTEXT@@", SafeXML.cleanGPX(log.getMessage())));
+		ret.append(trans.replaceAll(GPXLOG));
+		return ret;
+	}
 
 	/**
 	 * format the header of the GPX file



From araber95 at mail.berlios.de  Fri Jan 29 16:56:17 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Fri, 29 Jan 2010 16:56:17 +0100
Subject: [Cachewolf-svn] r2439 - in trunk: res_noewe res_noewe/languages
	src/CacheWolf src/CacheWolf/imp
Message-ID: <201001291556.o0TFuHAA027737@sheep.berlios.de>

Author: araber95
Date: 2010-01-29 16:56:13 +0100 (Fri, 29 Jan 2010)
New Revision: 2439

Modified:
   trunk/res_noewe/languages/DE.cfg
   trunk/res_noewe/languages/EN.cfg
   trunk/res_noewe/spider.def
   trunk/src/CacheWolf/MainMenu.java
   trunk/src/CacheWolf/imp/SpiderGC.java
Log:
loading the Cachepage with all logs for found caches (extended cases on import and update).
added check for missing logID in import/update
optimized log output
updated some texts

Modified: trunk/res_noewe/languages/DE.cfg
===================================================================
--- trunk/res_noewe/languages/DE.cfg	2010-01-29 13:58:31 UTC (rev 2438)
+++ trunk/res_noewe/languages/DE.cfg	2010-01-29 15:56:13 UTC (rev 2439)
@@ -459,15 +459,15 @@
 		1620=laden eingebundener Bilder:+
 		1621=Fehler beim Interpretieren%0a der Update-Datei,%0aDies ist vermutlich ein Fehler bei Opencaching.de%0aSp%e4ter erneut versuchen%0a Status:
 		1622=Gefundene Caches nicht laden
-		1623=Max. Anzahl:
-		1624=+Caches
+		1623=Importiere h%f6chstens
+		1624=+Cache (leer=alle)
 		1625=TBs laden
-		1626=Max. Logs:
+		1626=Speichere bis zu x Logs:
 		1627=Alle Caches
 		1628=min. Abstand:
 		1629=Richtung (leer/N/N*/N,NE,E):
 		1630=z.B. leer oder N oder N* oder N,NE,E
-		1631=Max. Updates:
+		1631=Aktualisiere h%f6chstens:
 		1700=Fehler in Zeile:
 		1701=Spalte:
 		1702=Variable nicht definiert:
@@ -824,14 +824,14 @@
 		5507=Status
 		5508=Einloggen ...
 		5509=Zentrumskoordinaten nicht gesetzt
-		5510=Spider Optionen
+		5510=Import Optionen
 		5511=Gefunden+
 		5512=+neue Caches
 		5513=Laden von:+
 		5514=%0aTravelbug:+
 		5515=Fehler beim Laden des Caches.%0aBitte %fcberpr%fcfen Sie Ihre Internetverbindung.%0aNoch einmal versuchen?
 		5516=+Cachebeschreibungen%0akonnten nicht geladen werden.
-		5517=Aktualisierungen spidern?
+		5517=Aktualisierungen importieren?
 		5518=+Caches in der Datenbank sollten aktualisiert werden. Jetzt aktualisieren?
 		5519=Information
 		5520=Nur das eingestellte Maximum an Caches wurde geladen.%0aWiederholen sie das Spidern sp%e4ter um weitere Caches zu laden.%0aEs wurden keine vorhandenen Caches aktualisiert.

Modified: trunk/res_noewe/languages/EN.cfg
===================================================================
--- trunk/res_noewe/languages/EN.cfg	2010-01-29 13:58:31 UTC (rev 2438)
+++ trunk/res_noewe/languages/EN.cfg	2010-01-29 15:56:13 UTC (rev 2439)
@@ -459,15 +459,15 @@
 		1620=downloading embedded images:+
 		1621=Error while interpreting data%0a from Opencaching.de,%0aThis is most probaly a bug at Opencaching.de%0aRetry later%0a Status:
 		1622=Exclude found caches
-		1623=Max. number:
-		1624=+caches
+		1623=Import upto:
+		1624=+caches (empty=all)
 		1625=Download TBs
-		1626=Max. logs:
+		1626=Max. save logs:
 		1627=All caches
 		1628=min. Distance:
 		1629=Direction (empty/N/N*/N,NE,E):
 		1630=e.g. blank or N or N* or N,NE,E
-		1631=Max. updates:
+		1631=Update upto:
 		1700=Error on line:
 		1701= position:
 		1702=Variable not defined:

Modified: trunk/res_noewe/spider.def
===================================================================
--- trunk/res_noewe/spider.def	2010-01-29 13:58:31 UTC (rev 2438)
+++ trunk/res_noewe/spider.def	2010-01-29 15:56:13 UTC (rev 2439)
@@ -64,6 +64,12 @@
 PMRex              = small_profile.gif
 distRex            = <br\ />(.*?)(?:km|mi)</td>
 waypointRex        = \\(GC(.*?)\\)<br\ />
+TypeRex            = /WptTypes/([0-9]+).gif
+SizeRex            = /container/(.*?).gif
+DandTRex           = <td>((.*?)/(.*?))<br
+found              = /WptTypes/check.gif
+own                = /WptTypes/name_tag.gif
+TBRex              = /wpttypes/([0-9]+).gif" alt="(.*?)"
 showOnlyFound      = &f=1
 maxDistance        = &dist=
 firstLine          = http://www.geocaching.com/seek/nearest.aspx?lat=

Modified: trunk/src/CacheWolf/MainMenu.java
===================================================================
--- trunk/src/CacheWolf/MainMenu.java	2010-01-29 13:58:31 UTC (rev 2438)
+++ trunk/src/CacheWolf/MainMenu.java	2010-01-29 15:56:13 UTC (rev 2439)
@@ -842,7 +842,7 @@
 			infB.setInfo(MyLocale.getMsg(5513,"Loading: ") + ch.getWayPoint() +" (" + (j+1) + " / " + cachesToUpdate.size() + ")");
 			infB.redisplay();
 			if (ch.getWayPoint().substring(0,2).equalsIgnoreCase("GC")) {
-				int test = spider.spiderSingle(i, infB, forceLogin, loadAllLogs);
+				int test = spider.spiderSingle(i, infB, forceLogin, loadAllLogs || ch.is_found());
 				if (test == SpiderGC.SPIDER_CANCEL) {
 					infB.close(0);
 					break;

Modified: trunk/src/CacheWolf/imp/SpiderGC.java
===================================================================
--- trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-29 13:58:31 UTC (rev 2438)
+++ trunk/src/CacheWolf/imp/SpiderGC.java	2010-01-29 15:56:13 UTC (rev 2439)
@@ -98,6 +98,8 @@
 	public static int SPIDER_ERROR = 0;
 	/** Cache was spidered without problems */
 	public static int SPIDER_OK = 1;
+	/** no probs, but exmpl found und not want this*/
+	public static int SPIDER_IGNORE = 2;
 
 	private static int ERR_LOGIN = -10;
 	private static Preferences pref;
@@ -138,6 +140,7 @@
 	private Regex RexPropLogDate;
 	private static String propAvailable;
 	private static String propArchived;
+	private static String propFound;
 	private static String propPM;
 	private Regex RexPropDirection;
 	private Regex RexPropDistance;
@@ -193,6 +196,7 @@
 					OCXMLImporterScreen.MAXUPDATE|
 					OCXMLImporterScreen.IMAGES|
 					OCXMLImporterScreen.ISGC|
+					OCXMLImporterScreen.MAXLOGS|
 					OCXMLImporterScreen.TRAVELBUGS);
 
 			options.maxNumberUpdates.setText("0"); // no updates for founds
@@ -435,11 +439,9 @@
 				} else if (test == SPIDER_ERROR) {
 					spiderErrors++;
 				} else if (test == SPIDER_OK){
-					if (!holder.is_found() || !doNotgetFound ) {
-						cacheDB.add(holder);
-						holder.save();
-					}
-				} // For test==SPIDER_IGNORE_PREMIUM: Nothing to do
+					cacheDB.add(holder);
+					holder.save();
+				} // For test == SPIDER_IGNORE_PREMIUM and SPIDER_IGNORE there is nothing to do
 			}
 		}
 
@@ -711,6 +713,7 @@
 			RexPropLogDate = new Regex(p.getProp("logDateRex"));
 			propAvailable=p.getProp("availableRex");
 			propArchived=p.getProp("archivedRex");
+			propFound=p.getProp("found");		
 			propPM=p.getProp("PMRex");
 			RexPropDirection=new Regex(p.getProp("directionRex"));
 			RexPropDistance = new Regex(p.getProp("distRex"));
@@ -809,11 +812,17 @@
 		boolean ret = false;
 		boolean save = false;
 		boolean is_archived_GC=false;
+		boolean is_found_GC=false;
+		CacheHolderDetail chd = ch.getFreshDetails();
 		if (spiderAllFinds) {
 			if(!ch.is_found()) { ch.setFound(true); save=true; numFoundUpdates+=1; ret=true;}
 			is_archived_GC=CacheDescription.indexOf(propArchived)!=-1;
-				if (is_archived_GC!=ch.is_archived()) { ch.setArchived(is_archived_GC); save=true; numArchivedUpdates+=1; ret=true;}
+			if (is_archived_GC!=ch.is_archived()) { ch.setArchived(is_archived_GC); save=true; numArchivedUpdates+=1; ret=true;}
+		} else if (!doNotgetFound){ // there could be a found or own ...
+			is_found_GC=CacheDescription.indexOf(propFound)!=-1;
+			if (is_found_GC!=ch.is_found()) {ch.setFound(is_found_GC); save=true; ret=true;}
 		}
+		if (ch.is_found() && chd.OwnLogId.equals("")) {ret=true;}
 		boolean is_available_GC=!is_archived_GC && CacheDescription.indexOf(propAvailable)==-1;
 		if (is_available_GC != ch.is_available()) {
 			ch.setAvailable(is_available_GC); save=true; numAvailableUpdates+=1; ret=true;}
@@ -922,8 +931,7 @@
 		if(!pref.checkLog) return false;
 		// String[] CacheDesc=mString.split(cacheDescrition,'\n');
 		Time lastLogCW = new Time();
-		CacheHolderDetail chd = ch.getCacheDetails(true);
-		String slastLogCW=chd.CacheLogs.getLog(0).getDate();
+		String slastLogCW=ch.details.CacheLogs.getLog(0).getDate();
 		if (slastLogCW.equals("")) return true; // or check cacheDescGC also no log?
 		lastLogCW.parse(slastLogCW,"yyyy-MM-dd");
 
@@ -983,14 +991,14 @@
 	 */
 	private int getCacheByWaypointName(CacheHolder ch, boolean isUpdate, boolean fetchImages, boolean fetchTBs, boolean doNotGetFound, boolean fetchAllLogs) {
 		int ret = SPIDER_OK; // initialize value;
-		while (true) {
+		while (true) { // retry even if failure
 			String completeWebPage;
 			int spiderTrys=0;
 			int MAX_SPIDER_TRYS=3;
 			while (spiderTrys++<MAX_SPIDER_TRYS) {
 				ret = SPIDER_OK; // initialize value;
 				try{
-					String doc = p.getProp("getPageByName") + ch.getWayPoint() +(fetchAllLogs?p.getProp("fetchAllLogs"):"");
+					String doc = p.getProp("getPageByName") + ch.getWayPoint() +((fetchAllLogs||ch.is_found())?p.getProp("fetchAllLogs"):"");
 					pref.log("Fetching: " + ch.getWayPoint());
 					completeWebPage = fetch(doc);
 					if	( completeWebPage.equals("")) {
@@ -1035,7 +1043,7 @@
 						ch.setHTML(true);
 						ch.setIncomplete(true);
 						// Save size of logs to be able to check whether any new logs were added
-						//int logsz = chD.CacheLogs.size();
+						// int logsz = chD.CacheLogs.size();
 						//chD.CacheLogs.clear();
 						ch.addiWpts.clear();
 						ch.getFreshDetails().images.clear();
@@ -1043,21 +1051,30 @@
 						ch.setAvailable(!(completeWebPage.indexOf(p.getProp("cacheUnavailable")) >= 0));
 						ch.setArchived(completeWebPage.indexOf(p.getProp("cacheArchived")) >= 0);
 						//==========
+						// Logs first (for check early for break)
+						//==========
+						ch.getFreshDetails().setCacheLogs(getLogs(completeWebPage, ch.getFreshDetails()));
+						pref.log("Got logs");
+						// If the switch is set to not store found caches and we found the cache => return
+						if (ch.is_found() && doNotGetFound) {
+							if (infB.isClosed) {
+								return SPIDER_CANCEL;
+							} else {
+								return SPIDER_IGNORE;
+							}
+						}
+						//==========
 						// General Cache Data
 						//==========
 						ch.setLatLon(latLon);
 						pref.log("LatLon: " + ch.LatLon);
-						if (pref.debug) pref.log("chD.pos: " + ch.pos.toString());
 
-						pref.log("Trying description");
 						ch.getFreshDetails().setLongDescription(getLongDesc(completeWebPage));
 						pref.log("Got description");
 
-						pref.log("Getting cache name");
 						ch.setCacheName(SafeXML.cleanback(getName(completeWebPage)));
-						if (pref.debug) pref.log("Name: " + ch.getCacheName()); else pref.log("Got name");
+						pref.log("Name: " + ch.getCacheName());
 
-						pref.log("Trying location (country/state)");
 						String location = getLocation(completeWebPage);
 						if (location.length() != 0) {
 							int countryStart = location.indexOf(",");
@@ -1075,95 +1092,56 @@
 							pref.log("No location (country/state) found");
 						}
 
-						pref.log("Trying owner");
 						ch.setCacheOwner(SafeXML.cleanback(getOwner(completeWebPage)).trim());
 						if(ch.getCacheOwner().equals(pref.myAlias) || (pref.myAlias2.length()>0 && ch.getCacheOwner().equals(pref.myAlias2))) ch.setOwned(true);
-						if (pref.debug) pref.log("Owner: " + ch.getCacheOwner() +"; is_owned = "+ch.is_owned()+";  alias1,2 = ["+pref.myAlias+"|"+pref.myAlias2+"]");
-						else pref.log("Got owner");
+						pref.log("Owner: " + ch.getCacheOwner() +"; is_owned = "+ch.is_owned()+";  alias1,2 = ["+pref.myAlias+"|"+pref.myAlias2+"]");
 
-
-						pref.log("Trying date hidden");
 						ch.setDateHidden(DateFormat.MDY2YMD(getDateHidden(completeWebPage)));
-						if (pref.debug) pref.log("Hidden: " + ch.getDateHidden());
-						else pref.log("Got date hidden");
+						pref.log("Hidden: " + ch.getDateHidden());
 
-						pref.log("Trying hints");
 						ch.getFreshDetails().setHints(getHints(completeWebPage));
-						if (pref.debug) pref.log("Hints: " + ch.getFreshDetails().Hints);
-						else pref.log("Got hints");
+						pref.log("Hints: " + ch.getFreshDetails().Hints);
 
-						pref.log("Trying size");
 						ch.setCacheSize(CacheSize.gcSpiderString2Cw(getSize(completeWebPage)));
-						if (pref.debug) pref.log("Size: " + ch.getCacheSize());
-						else pref.log("Got size");
+						pref.log("Size: " + ch.getCacheSize());
 
-						pref.log("Trying difficulty");
 						ch.setHard(CacheTerrDiff.v1Converter(getDiff(completeWebPage)));
-						if (pref.debug) pref.log("Hard: " + ch.getHard());
-						else pref.log("Got difficulty");
+						pref.log("Hard: " + ch.getHard());
 
-						pref.log("Trying terrain");
 						ch.setTerrain(CacheTerrDiff.v1Converter(getTerr(completeWebPage)));
-						if (pref.debug) pref.log("Terr: " + ch.getTerrain());
-						else pref.log("Got terrain");
+						pref.log("Terr: " + ch.getTerrain());
 
-						pref.log("Trying cache type");
 						ch.setType(getType(completeWebPage));
-						if (pref.debug) pref.log("Type: " + ch.getType());
-						else pref.log("Got cache type");
-
+						pref.log("Type: " + ch.getType());
 						//==========
-						// Logs
-						//==========
-						pref.log("Trying logs");
-						ch.getFreshDetails().setCacheLogs(getLogs(completeWebPage, ch.getFreshDetails()));
-						pref.log("Found logs");
-
-						// If the switch is set to not store found caches and we found the cache => return
-						if (ch.is_found() && doNotGetFound) {
-							if (infB.isClosed) {
-								return SPIDER_CANCEL;
-							} else {
-								return SPIDER_OK;
-							}
-						}
-
-						//==========
 						// Bugs
 						//==========
-						// As there may be several bugs, we check whether the user has aborted
-						if (!infB.isClosed && fetchTBs) getBugs(ch.getFreshDetails(),completeWebPage);
+						if (fetchTBs) getBugs(ch.getFreshDetails(),completeWebPage);
 						ch.setHas_bugs(ch.getFreshDetails().Travelbugs.size()>0);
-
+						pref.log("Got TBs");
 						//==========
 						// Images
 						//==========
 						if(fetchImages){
-							pref.log("Trying images");
 							getImages(completeWebPage, ch.getFreshDetails());
 							pref.log("Got images");
 						}
 						//==========
 						// Addi waypoints
 						//==========
-
-						pref.log("Getting additional waypoints");
 						getAddWaypoints(completeWebPage, ch.getWayPoint(), ch.is_found());
 						pref.log("Got additional waypoints");
-
 						//==========
 						// Attributes
 						//==========
-						pref.log("Getting attributes");
 						getAttributes(completeWebPage, ch.getFreshDetails());
 						pref.log("Got attributes");
-						//if (ch.is_new()) ch.setUpdated(false);
 						//==========
 						// Last sync date
 						//==========
 						ch.setLastSync((new Time()).format("yyyyMMddHHmmss"));
-
 						ch.setIncomplete(false);
+						pref.log("ready " + ch.getWayPoint() + " : "+ ch.getLastSync()+"\n");
 						break;
 					}catch(Exception ex){
 						pref.log("Error reading cache: "+ch.getWayPoint());
@@ -1177,7 +1155,7 @@
 				pref.log(">>> Failed to spider cache. Number of retrys exhausted.");
 				int decision = (new MessageBox(MyLocale.getMsg(5500,"Error"),MyLocale.getMsg(5515,"Failed to load cache.%0aPleas check your internet connection.%0aRetry?"),FormBase.DEFOKB|FormBase.NOB|FormBase.CANCELB)).execute();
 				if ( decision == FormBase.IDOK ) {
-					continue;
+					continue; // retry even if failure
 				} else if ( decision == FormBase.IDNO ){
 					ret = SPIDER_ERROR;
 				} else {
@@ -1185,7 +1163,7 @@
 				}
 			}
 			break;
-		}//while(true)
+		}//while(true) // retry even if failure
 		if (infB.isClosed) {// If the infoBox was closed before getting here, we return -1
 			return SPIDER_CANCEL;
 		}
@@ -1376,6 +1354,7 @@
 			logText = exLog.findNext();
 			logId = exLogId.findNext();
 			String d=DateFormat.logdate2YMD(exDate.findNext());
+			// if this log says this Cache is found by me
 			if((icon.equals(p.getProp("icon_smile")) || icon.equals(p.getProp("icon_camera")) || icon.equals(p.getProp("icon_attended"))) &&
 				(name.equalsIgnoreCase(SafeXML.clean(pref.myAlias)) || (pref.myAlias2.length()>0 && name.equalsIgnoreCase(SafeXML.clean(pref.myAlias2)))) )  {
 				chD.getParent().setFound(true);
@@ -1395,7 +1374,11 @@
 			exLogId.setSource(singleLog);
 			// We cannot simply stop if we have reached MAXLOGS just in case we are waiting for
 			// a log by our alias that happened earlier.
-			if (nLogs>=pref.maxLogsToSpider && chD.getParent().is_found() && (chD.OwnLogId.length() != 0) && (chD.OwnLog != null) && !(chD.OwnLog.getDate().equals("1900-01-01"))) break;
+			if (nLogs>=pref.maxLogsToSpider && 
+				chD.getParent().is_found() && 
+				chD.OwnLogId.length() != 0 && 
+				chD.OwnLog != null && 
+				!(chD.OwnLog.getDate().equals("1900-01-01"))) break;
 		}
 		if (nLogs>pref.maxLogsToSpider) {
 			reslts.add(Log.maxLog());
@@ -1497,7 +1480,7 @@
 				// Optimize: img.groundspeak.com -> img.geocaching.com (for better caching purposes)
 				imgUrl = CacheImages.optimizeLink("http://" + imgUrl);
 				try{
-					imgType = (imgUrl.substring(imgUrl.lastIndexOf(".")).toLowerCase()+"    ").substring(0,4).trim();
+					imgType = (imgUrl.substring(imgUrl.lastIndexOf('.')).toLowerCase()+"    ").substring(0,4).trim();
 					// imgType is now max 4 chars, starting with .
 					if(imgType.startsWith(".png") || imgType.startsWith(".jpg") || imgType.startsWith(".gif")){
 						// Check whether image was already spidered for this cache
@@ -1559,7 +1542,7 @@
 			if(imgUrl.length()>0){
 				imgUrl = "http://" + imgUrl;
 				try{
-					imgType = (imgUrl.substring(imgUrl.lastIndexOf(".")).toLowerCase()+"    ").substring(0,4).trim();
+					imgType = (imgUrl.substring(imgUrl.lastIndexOf('.')).toLowerCase()+"    ").substring(0,4).trim();
 					// imgType is now max 4 chars, starting with .
 					if(imgType.startsWith(".png") || imgType.startsWith(".jpg") || imgType.startsWith(".gif")){
 						// Check whether image was already spidered for this cache
@@ -1610,9 +1593,9 @@
 				// Optimize: img.groundspeak.com -> img.geocaching.com (for better caching purposes)
 				imgUrl = CacheImages.optimizeLink("http://" + imgUrl);
 				try{
-					imgType = (imgUrl.substring(imgUrl.lastIndexOf(".")).toLowerCase()+"    ").substring(0,4).trim();
+					imgType = (imgUrl.substring(imgUrl.lastIndexOf('.')).toLowerCase()+"    ").substring(0,4).trim();
 					// imgType is now max 4 chars, starting with . Delete characters in URL after the image extension
-					imgUrl=imgUrl.substring(0,imgUrl.lastIndexOf(".")+imgType.length());
+					imgUrl=imgUrl.substring(0,imgUrl.lastIndexOf('.')+imgType.length());
 					if( imgType.startsWith(".jpg") || imgType.startsWith(".bmp") || imgType.startsWith(".png") || imgType.startsWith(".gif")){
 						// Check whether image was already spidered for this cache
 						idxUrl=spideredUrls.find(imgUrl);



From araber95 at mail.berlios.de  Fri Jan 29 18:31:52 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Fri, 29 Jan 2010 18:31:52 +0100
Subject: [Cachewolf-svn] r2440 - trunk/src/CacheWolf/imp
Message-ID: <201001291731.o0THVqN5010058@sheep.berlios.de>

Author: araber95
Date: 2010-01-29 18:31:51 +0100 (Fri, 29 Jan 2010)
New Revision: 2440

Modified:
   trunk/src/CacheWolf/imp/OCXMLImporter.java
Log:
correcting OPENCACHING_SE_PATTERN to OS

Modified: trunk/src/CacheWolf/imp/OCXMLImporter.java
===================================================================
--- trunk/src/CacheWolf/imp/OCXMLImporter.java	2010-01-29 15:56:13 UTC (rev 2439)
+++ trunk/src/CacheWolf/imp/OCXMLImporter.java	2010-01-29 17:31:51 UTC (rev 2440)
@@ -56,7 +56,7 @@
 	public final static String OPENCACHING_UK_HOST = "www.opencaching.org.uk";
 	public final static String OPENCACHING_UK_PATTERN = "OK";
 	public final static String OPENCACHING_SE_HOST = "www.opencaching.se";
-	public final static String OPENCACHING_SE_PATTERN = "OK";
+	public final static String OPENCACHING_SE_PATTERN = "OS";
 
 	String hostname;
 



From araber95 at mail.berlios.de  Sat Jan 30 13:18:08 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Sat, 30 Jan 2010 13:18:08 +0100
Subject: [Cachewolf-svn] r2441 - in trunk/res_noewe/symbols: . OCSymbols
Message-ID: <201001301218.o0UCI8Wu021099@sheep.berlios.de>

Author: araber95
Date: 2010-01-30 13:17:56 +0100 (Sat, 30 Jan 2010)
New Revision: 2441

Added:
   trunk/res_noewe/symbols/OCSymbols/
   trunk/res_noewe/symbols/OCSymbols/0.png
   trunk/res_noewe/symbols/OCSymbols/0size.png
   trunk/res_noewe/symbols/OCSymbols/11.png
   trunk/res_noewe/symbols/OCSymbols/11size.png
   trunk/res_noewe/symbols/OCSymbols/16.png
   trunk/res_noewe/symbols/OCSymbols/16size.png
   trunk/res_noewe/symbols/OCSymbols/18.png
   trunk/res_noewe/symbols/OCSymbols/18size.png
   trunk/res_noewe/symbols/OCSymbols/19.png
   trunk/res_noewe/symbols/OCSymbols/19size.png
   trunk/res_noewe/symbols/OCSymbols/2.png
   trunk/res_noewe/symbols/OCSymbols/20.png
   trunk/res_noewe/symbols/OCSymbols/20size.png
   trunk/res_noewe/symbols/OCSymbols/2size.png
   trunk/res_noewe/symbols/OCSymbols/3.png
   trunk/res_noewe/symbols/OCSymbols/3size.png
   trunk/res_noewe/symbols/OCSymbols/5.png
   trunk/res_noewe/symbols/OCSymbols/5size.png
Log:
adding OCSymbols

Added: trunk/res_noewe/symbols/OCSymbols/0.png
===================================================================
(Binary files differ)


Property changes on: trunk/res_noewe/symbols/OCSymbols/0.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/res_noewe/symbols/OCSymbols/0size.png
===================================================================
(Binary files differ)


Property changes on: trunk/res_noewe/symbols/OCSymbols/0size.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/res_noewe/symbols/OCSymbols/11.png
===================================================================
(Binary files differ)


Property changes on: trunk/res_noewe/symbols/OCSymbols/11.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/res_noewe/symbols/OCSymbols/11size.png
===================================================================
(Binary files differ)


Property changes on: trunk/res_noewe/symbols/OCSymbols/11size.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/res_noewe/symbols/OCSymbols/16.png
===================================================================
(Binary files differ)


Property changes on: trunk/res_noewe/symbols/OCSymbols/16.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/res_noewe/symbols/OCSymbols/16size.png
===================================================================
(Binary files differ)


Property changes on: trunk/res_noewe/symbols/OCSymbols/16size.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/res_noewe/symbols/OCSymbols/18.png
===================================================================
(Binary files differ)


Property changes on: trunk/res_noewe/symbols/OCSymbols/18.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/res_noewe/symbols/OCSymbols/18size.png
===================================================================
(Binary files differ)


Property changes on: trunk/res_noewe/symbols/OCSymbols/18size.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/res_noewe/symbols/OCSymbols/19.png
===================================================================
(Binary files differ)


Property changes on: trunk/res_noewe/symbols/OCSymbols/19.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/res_noewe/symbols/OCSymbols/19size.png
===================================================================
(Binary files differ)


Property changes on: trunk/res_noewe/symbols/OCSymbols/19size.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/res_noewe/symbols/OCSymbols/2.png
===================================================================
(Binary files differ)


Property changes on: trunk/res_noewe/symbols/OCSymbols/2.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/res_noewe/symbols/OCSymbols/20.png
===================================================================
(Binary files differ)


Property changes on: trunk/res_noewe/symbols/OCSymbols/20.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/res_noewe/symbols/OCSymbols/20size.png
===================================================================
(Binary files differ)


Property changes on: trunk/res_noewe/symbols/OCSymbols/20size.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/res_noewe/symbols/OCSymbols/2size.png
===================================================================
(Binary files differ)


Property changes on: trunk/res_noewe/symbols/OCSymbols/2size.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/res_noewe/symbols/OCSymbols/3.png
===================================================================
(Binary files differ)


Property changes on: trunk/res_noewe/symbols/OCSymbols/3.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/res_noewe/symbols/OCSymbols/3size.png
===================================================================
(Binary files differ)


Property changes on: trunk/res_noewe/symbols/OCSymbols/3size.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/res_noewe/symbols/OCSymbols/5.png
===================================================================
(Binary files differ)


Property changes on: trunk/res_noewe/symbols/OCSymbols/5.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/res_noewe/symbols/OCSymbols/5size.png
===================================================================
(Binary files differ)


Property changes on: trunk/res_noewe/symbols/OCSymbols/5size.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From araber95 at mail.berlios.de  Sun Jan 31 12:19:20 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Sun, 31 Jan 2010 12:19:20 +0100
Subject: [Cachewolf-svn] r2442 - in trunk/src/CacheWolf: . imp
Message-ID: <201001311119.o0VBJKIS028531@sheep.berlios.de>

Author: araber95
Date: 2010-01-31 12:19:16 +0100 (Sun, 31 Jan 2010)
New Revision: 2442

Added:
   trunk/src/CacheWolf/OC.java
Modified:
   trunk/src/CacheWolf/CacheHolder.java
   trunk/src/CacheWolf/DetailsPanel.java
   trunk/src/CacheWolf/Profile.java
   trunk/src/CacheWolf/imp/OCXMLImporter.java
   trunk/src/CacheWolf/imp/OCXMLImporterScreen.java
Log:
changes for simple adding of new opencaching sites.
Simply add one line in OC.java!

Modified: trunk/src/CacheWolf/CacheHolder.java
===================================================================
--- trunk/src/CacheWolf/CacheHolder.java	2010-01-30 12:17:56 UTC (rev 2441)
+++ trunk/src/CacheWolf/CacheHolder.java	2010-01-31 11:19:16 UTC (rev 2442)
@@ -590,17 +590,9 @@
 	}
 
 	public boolean isOC() {
-		return isOCWaypoint(getWayPoint());
+		return OC.isOC(wayPoint);
 	}
 
-	public static boolean isOCWaypoint(String wpName) {
-		String pattern = wpName.toUpperCase();
-		return pattern.startsWith( OCXMLImporter.OPENCACHING_CZ_PATTERN )
-				|| pattern.startsWith( OCXMLImporter.OPENCACHING_DE_PATTERN )
-				|| pattern.startsWith( OCXMLImporter.OPENCACHING_PL_PATTERN )
-				|| pattern.startsWith( OCXMLImporter.OPENCACHING_UK_PATTERN );
-	}
-
 	public void calcDistance(CWPoint toPoint) {	
 		if(pos.isValid()){
 			kilom = pos.getDistance(toPoint);

Modified: trunk/src/CacheWolf/DetailsPanel.java
===================================================================
--- trunk/src/CacheWolf/DetailsPanel.java	2010-01-30 12:17:56 UTC (rev 2441)
+++ trunk/src/CacheWolf/DetailsPanel.java	2010-01-31 11:19:16 UTC (rev 2442)
@@ -433,7 +433,7 @@
 		if (CacheType.isAddiWpt(CacheType.guiSelect2Cw(chcType.getInt()))
 				&& Global.mainTab.mainCache != null
 				&& (Global.mainTab.mainCache.startsWith("GC")
-					|| CacheHolder.isOCWaypoint(Global.mainTab.mainCache) || Global.mainTab.mainCache.startsWith("CW"))
+					|| OC.isOC(Global.mainTab.mainCache) || Global.mainTab.mainCache.startsWith("CW"))
 				&& wpt.startsWith("CW")) {
 			// for what was this?:
 			Global.mainTab.lastselected = Global.mainTab.mainCache; // I don't know exactly, but it's needed for creating a series of Addis
@@ -443,7 +443,7 @@
 		}
 		if (!CacheType.isAddiWpt(CacheType.guiSelect2Cw(chcType.getInt()))
 				&& !(wpt.startsWith("GC")
-					|| CacheHolder.isOCWaypoint(wpt) || wpt.startsWith("CW"))) {
+					|| OC.isOC(wpt) || wpt.startsWith("CW"))) {
 			inpWaypoint.setText(Global.getProfile().getNewWayPointName());
 		}
 	}

Added: trunk/src/CacheWolf/OC.java
===================================================================
--- trunk/src/CacheWolf/OC.java	2010-01-30 12:17:56 UTC (rev 2441)
+++ trunk/src/CacheWolf/OC.java	2010-01-31 11:19:16 UTC (rev 2442)
@@ -0,0 +1,40 @@
+package CacheWolf;
+
+public final class OC {
+
+	/** thou shallst not instantiate this object */
+	private OC() {
+		// Nothing to do
+	}
+
+	public final static int OC_HOSTNAME = 0; 
+	public final static int OC_PREFIX = 1; 
+	public final static String[][] OCSites = {
+		{"www.opencaching.de", "OC"},
+		{"www.opencaching.pl", "OP"},
+		{"www.opencaching.cz", "OZ"},
+		{"www.opencaching.org.uk", "OK"},
+		{"www.opencaching.se", "OS"}
+		};
+
+	public final static String[] OCHostNames() {
+		String[] ret=new String[OCSites.length];
+		for (int i = 0; i < OCSites.length; i++) {
+			ret[i]=OCSites[i][OC_HOSTNAME];
+		}
+		return ret;
+	}
+	
+	public final static String getOCHostName(String wpName){
+		for (int i = 0; i < OCSites.length; i++) {
+			if(wpName.startsWith(OCSites[i][OC_PREFIX])) {
+				return OCSites[i][OC_HOSTNAME];
+			}
+		}
+		return null;
+	}
+	
+	public final static boolean isOC(String wpName) {
+		return (getOCHostName(wpName.toUpperCase()) != null);		
+	}
+}

Modified: trunk/src/CacheWolf/Profile.java
===================================================================
--- trunk/src/CacheWolf/Profile.java	2010-01-30 12:17:56 UTC (rev 2441)
+++ trunk/src/CacheWolf/Profile.java	2010-01-31 11:19:16 UTC (rev 2442)
@@ -501,15 +501,15 @@
 	public void setAddiRef(CacheHolder ch) {
 		String mainwpt = ch.getWayPoint().substring(2);
 		int mainindex = getCacheIndex("GC" + mainwpt);
+		if (mainindex < 0 || !cacheDB.get(mainindex).isCacheWpt()) {
+			for (int i = 0; i < OC.OCSites.length; i++) {
+				mainindex=getCacheIndex(OC.OCSites[i][OC.OC_PREFIX] + mainwpt);
+				if (mainindex >= 0 && cacheDB.get(mainindex).isCacheWpt()){
+					break;
+				}
+			}
+		}
 		if (mainindex < 0 || !cacheDB.get(mainindex).isCacheWpt())
-			mainindex = getCacheIndex(OCXMLImporter.OPENCACHING_CZ_PATTERN + mainwpt);
-		if (mainindex < 0 || !cacheDB.get(mainindex).isCacheWpt())
-			mainindex = getCacheIndex(OCXMLImporter.OPENCACHING_DE_PATTERN + mainwpt);
-		if (mainindex < 0 || !cacheDB.get(mainindex).isCacheWpt())
-			mainindex = getCacheIndex(OCXMLImporter.OPENCACHING_PL_PATTERN + mainwpt);
-		if (mainindex < 0 || !cacheDB.get(mainindex).isCacheWpt())
-			mainindex = getCacheIndex(OCXMLImporter.OPENCACHING_UK_PATTERN + mainwpt);
-		if (mainindex < 0 || !cacheDB.get(mainindex).isCacheWpt())
 			mainindex = getCacheIndex("CW" + mainwpt);
 		if (mainindex < 0 /* || !cacheDB.get(mainindex)..isCacheWpt() */ )  {
 			ch.setIncomplete(true);

Modified: trunk/src/CacheWolf/imp/OCXMLImporter.java
===================================================================
--- trunk/src/CacheWolf/imp/OCXMLImporter.java	2010-01-30 12:17:56 UTC (rev 2441)
+++ trunk/src/CacheWolf/imp/OCXMLImporter.java	2010-01-31 11:19:16 UTC (rev 2442)
@@ -12,6 +12,7 @@
 import CacheWolf.InfoBox;
 import CacheWolf.Log;
 import CacheWolf.MyLocale;
+import CacheWolf.OC;
 import CacheWolf.Preferences;
 import CacheWolf.Profile;
 import CacheWolf.SafeXML;
@@ -47,17 +48,6 @@
 	static protected final int STAT_CACHE_LOG = 3;
 	static protected final int STAT_PICTURE = 4;
 
-	public final static String OPENCACHING_DE_HOST = "www.opencaching.de";
-	public final static String OPENCACHING_DE_PATTERN = "OC";
-	public final static String OPENCACHING_PL_HOST = "www.opencaching.pl";
-	public final static String OPENCACHING_PL_PATTERN = "OP";
-	public final static String OPENCACHING_CZ_HOST = "www.opencaching.cz";
-	public final static String OPENCACHING_CZ_PATTERN = "OZ";
-	public final static String OPENCACHING_UK_HOST = "www.opencaching.org.uk";
-	public final static String OPENCACHING_UK_PATTERN = "OK";
-	public final static String OPENCACHING_SE_HOST = "www.opencaching.se";
-	public final static String OPENCACHING_SE_PATTERN = "OS";
-
 	String hostname;
 
 	int state = STAT_INIT;
@@ -111,19 +101,6 @@
 
 	}
 
-	protected void setHostname(String wpName){
-		if(wpName.startsWith(OPENCACHING_DE_PATTERN))
-			hostname = OPENCACHING_DE_HOST;
-		else if(wpName.startsWith(OPENCACHING_PL_PATTERN))
-			hostname = OPENCACHING_PL_HOST;
-		else if(wpName.startsWith(OPENCACHING_CZ_PATTERN))
-			hostname = OPENCACHING_CZ_HOST;
-		else if(wpName.startsWith(OPENCACHING_UK_PATTERN))
-			hostname = OPENCACHING_UK_HOST;
-		else if(wpName.startsWith(OPENCACHING_SE_PATTERN))
-			hostname = OPENCACHING_SE_HOST;
-	}
-
 	/**
 	 *
 	 * @param number
@@ -133,7 +110,7 @@
 	public boolean syncSingle(int number, InfoBox infB) {
 		CacheHolder ch;
 		ch = cacheDB.get(number);
-		setHostname(ch.getWayPoint());
+		hostname=OC.getOCHostName(ch.getWayPoint());
 		holder= null;
 
 		if (infB.isClosed) {

Modified: trunk/src/CacheWolf/imp/OCXMLImporterScreen.java
===================================================================
--- trunk/src/CacheWolf/imp/OCXMLImporterScreen.java	2010-01-30 12:17:56 UTC (rev 2441)
+++ trunk/src/CacheWolf/imp/OCXMLImporterScreen.java	2010-01-31 11:19:16 UTC (rev 2442)
@@ -7,6 +7,7 @@
 import CacheWolf.Common;
 import CacheWolf.Global;
 import CacheWolf.MyLocale;
+import CacheWolf.OC;
 import CacheWolf.Preferences;
 import CacheWolf.imp.SpiderGC.SpiderProperties;
 import ewe.sys.Convert;
@@ -59,8 +60,8 @@
 		this.title = title;
 
 		if((options & HOST) > 0){
-			String[] hosts = new String[] {OCXMLImporter.OPENCACHING_DE_HOST, OCXMLImporter.OPENCACHING_CZ_HOST, OCXMLImporter.OPENCACHING_PL_HOST, OCXMLImporter.OPENCACHING_UK_HOST, OCXMLImporter.OPENCACHING_SE_HOST};
-			domains = new mChoice(hosts,0);
+			// String[] hosts = new String[] {OCXMLImporter.OPENCACHING_DE_HOST, OCXMLImporter.OPENCACHING_CZ_HOST, OCXMLImporter.OPENCACHING_PL_HOST, OCXMLImporter.OPENCACHING_UK_HOST, OCXMLImporter.OPENCACHING_SE_HOST};
+			domains = new mChoice(OC.OCHostNames(),0);
 			domains.setTextSize(25, 1);
 			this.addLast(domains, CellConstants.DONTSTRETCH, CellConstants.DONTFILL|CellConstants.WEST);
 		}



From araber95 at mail.berlios.de  Sun Jan 31 12:22:38 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Sun, 31 Jan 2010 12:22:38 +0100
Subject: [Cachewolf-svn] r2443 - trunk/src/CacheWolf
Message-ID: <201001311122.o0VBMcE9028629@sheep.berlios.de>

Author: araber95
Date: 2010-01-31 12:22:37 +0100 (Sun, 31 Jan 2010)
New Revision: 2443

Modified:
   trunk/src/CacheWolf/MyLocale.java
Log:
output of about/system/country now possibly shows a real country information.

Modified: trunk/src/CacheWolf/MyLocale.java
===================================================================
--- trunk/src/CacheWolf/MyLocale.java	2010-01-31 11:19:16 UTC (rev 2442)
+++ trunk/src/CacheWolf/MyLocale.java	2010-01-31 11:22:37 UTC (rev 2443)
@@ -50,7 +50,27 @@
 	 * @param language_ 2 digits of language code as specified in ISO
 	 */
 	private static void setLocale(String language_) {
-		int tmp = Locale.createID(language_, "", 0); // in ewe-vm v1.49 this call is enough to set the locale correctly and this works even with not supported languages like FR (french), e.g. it works even if tmp == -1, call new Locale() instead of new Locale(tmp) then.
+		String country ="";
+		/*
+		int[] all=ewe.sys.Locale.getAllIDs(0);
+		Locale ll = new Locale(true);
+		Global.getPref().debug=true;
+		for (int i = 0; i<all.length; i++){
+			ll.set(all[i]);
+			String lg = ll.getString(13,0,0);
+			if (!language_.equalsIgnoreCase(lg)) continue;
+			country = ll.getString(23,0,0);
+			// Global.getPref().log(lg+"-"+country);
+			if (!country.equals("")) break;
+		}
+		 */
+		if (language_.equalsIgnoreCase("DE")) country="DEU"; 
+		if (language_.equalsIgnoreCase("FR")) country="FRA"; 
+		if (language_.equalsIgnoreCase("EN")) country="USA"; 
+		if (language_.equalsIgnoreCase("NL")) country="NLD"; 
+		if (language_.equalsIgnoreCase("PL")) country="POL"; 
+		if (language_.equalsIgnoreCase("SV")) country="SWE"; 
+		int tmp = Locale.createID(language_, country, 0); // in ewe-vm v1.49 this call is enough to set the locale correctly and this works even with not supported languages like FR (french), e.g. it works even if tmp == -1, call new Locale() instead of new Locale(tmp) then.
 		tmp = (tmp >= 1024 ? tmp-1024 : tmp); // ewe-vm v1.49 some times returns the correct value + 1024
 		// Vm.debug("spec-lang: " + tmp);
 		if (tmp > -1)	l = new Locale(tmp);



From araber95 at mail.berlios.de  Sun Jan 31 14:24:06 2010
From: araber95 at mail.berlios.de (araber95 at mail.berlios.de)
Date: Sun, 31 Jan 2010 14:24:06 +0100
Subject: [Cachewolf-svn] r2444 - in trunk/src/CacheWolf: . imp
Message-ID: <201001311324.o0VDO6q4020144@sheep.berlios.de>

Author: araber95
Date: 2010-01-31 14:24:04 +0100 (Sun, 31 Jan 2010)
New Revision: 2444

Modified:
   trunk/src/CacheWolf/OC.java
   trunk/src/CacheWolf/Preferences.java
   trunk/src/CacheWolf/imp/OCXMLImporter.java
   trunk/src/CacheWolf/imp/OCXMLImporterScreen.java
Log:
saving last visited OC site host in preferences

Modified: trunk/src/CacheWolf/OC.java
===================================================================
--- trunk/src/CacheWolf/OC.java	2010-01-31 11:22:37 UTC (rev 2443)
+++ trunk/src/CacheWolf/OC.java	2010-01-31 13:24:04 UTC (rev 2444)
@@ -37,4 +37,13 @@
 	public final static boolean isOC(String wpName) {
 		return (getOCHostName(wpName.toUpperCase()) != null);		
 	}
+	
+	public final static int getSiteIndex(String site) {
+		for (int i = 0; i < OCSites.length; i++) {
+			if(site.equalsIgnoreCase(OCSites[i][OC_HOSTNAME])) {
+				return i;
+			}
+		}
+		return 0; // don't get a fault
+	}
 }

Modified: trunk/src/CacheWolf/Preferences.java
===================================================================
--- trunk/src/CacheWolf/Preferences.java	2010-01-31 11:22:37 UTC (rev 2443)
+++ trunk/src/CacheWolf/Preferences.java	2010-01-31 13:24:04 UTC (rev 2444)
@@ -217,7 +217,8 @@
 	public String garminGPSBabelOptions="";
 	/** Max. length for Garmin waypoint names (for etrex which can only accept 6 chars) */
 	public int garminMaxLen=0;
-	public boolean downloadmissingOC = false;
+	public boolean downloadMissingOC = false;
+	public String lastOCSite=OC.OCSites[0][OC.OC_HOSTNAME];
 	/** The currently used centre point, can be different from the profile's centrepoint. This is used
 	 *  for spidering */
 	private CWPoint curCentrePt=new CWPoint();
@@ -441,7 +442,10 @@
 			setBaseDir(atts.getValue("dir"));
 		}
 		else if (name.equals("opencaching")) {
-			downloadmissingOC = Boolean.valueOf(atts.getValue("downloadmissing")).booleanValue();
+			tmp=atts.getValue("lastSite");
+			if (!(tmp == null) && OC.getSiteIndex(tmp)>=0 ) lastOCSite=tmp;
+			tmp=atts.getValue("downloadMissing");
+			if (!(tmp == null)) downloadMissingOC = Boolean.valueOf(tmp).booleanValue();
 		}
 		else if (name.equals("listview")) {
 			listColMap=atts.getValue("colmap");
@@ -672,7 +676,7 @@
 			outp.print("    <solver ignorevariablecase=\"" + SafeXML.strxmlencode(solverIgnoreCase) + "\" degMode=\"" + SafeXML.strxmlencode(solverDegMode) + "\" />\n");
 			outp.print("    <garmin connection = \"" + SafeXML.clean(garminConn) + "\" GPSBabelOptions = \"" + SafeXML.clean(garminGPSBabelOptions) + "\" MaxWaypointLength = \"" + SafeXML.strxmlencode(garminMaxLen) +
 					        "\" addDetailsToWaypoint = \"" + SafeXML.strxmlencode(addDetailsToWaypoint) + "\" addDetailsToName = \"" + SafeXML.strxmlencode(addDetailsToName) + "\" />\n");
-			outp.print("    <opencaching downloadMissing=\"" + SafeXML.strxmlencode(downloadmissingOC) + "\"/>\n");
+			outp.print("    <opencaching lastSite=\""+lastOCSite+"\" downloadMissing=\"" + SafeXML.strxmlencode(downloadMissingOC) + "\"/>\n");
 			outp.print("    <location lat = \"" + SafeXML.clean(curCentrePt.getLatDeg(TransformCoordinates.DD)) + "\" long = \"" + SafeXML.clean(curCentrePt.getLonDeg(TransformCoordinates.DD)) + "\"/>\n");
 			outp.print("    <spider forcelogin=\"" + SafeXML.strxmlencode(forceLogin) + "\" spiderUpdates=\"" + SafeXML.strxmlencode(spiderUpdates) + "\" checkLog=\"" + SafeXML.strxmlencode(checkLog) + "\" maxSpiderNumber=\"" + SafeXML.strxmlencode(maxSpiderNumber) + "\" downloadPics=\"" + SafeXML.strxmlencode(downloadPics) + "\" downloadTBs=\"" + SafeXML.strxmlencode(downloadTBs) +"\"/>\n");
 			outp.print("    <gotopanel northcentered=\"" + SafeXML.strxmlencode(northCenteredGoto) + "\" />\n");

Modified: trunk/src/CacheWolf/imp/OCXMLImporter.java
===================================================================
--- trunk/src/CacheWolf/imp/OCXMLImporter.java	2010-01-31 11:22:37 UTC (rev 2443)
+++ trunk/src/CacheWolf/imp/OCXMLImporter.java	2010-01-31 13:24:04 UTC (rev 2444)
@@ -127,7 +127,7 @@
 		/** pref.downloadmissingOC = true, if not the last syncdate shall be used,
 		 *  but the caches shall be reloaded
 		 *  only used in syncSingle  */
-		if (pref.downloadmissingOC)  lastS = "20050801000000";
+		if (pref.downloadMissingOC)  lastS = "20050801000000";
 		else {
 			if (ch.getLastSync().length() < 14) lastS = "20050801000000";
 			else lastS = ch.getLastSync();
@@ -176,8 +176,10 @@
 		Vm.showWait(true);
 		String dist = importOpt.maxDistanceInput.getText();
 
-		if (importOpt.domains.getSelectedItem()!=null)
+		if (importOpt.domains.getSelectedItem()!=null) {
 			hostname = (String)importOpt.domains.getSelectedItem();
+			pref.lastOCSite=hostname;
+		}
 
 		if (dist.length()== 0) return;
 
@@ -186,7 +188,7 @@
 		dist = distDouble.toString(0, 1, 0).replace(',', '.');
 		//check, if distance is greater than before
 		if (Convert.toInt(dist) > Convert.toInt(profile.getDistOC()) ||
-				pref.downloadmissingOC  ){
+				pref.downloadMissingOC  ){
 			// resysnc
 			lastS = "20050801000000";
 			incUpdate = false;

Modified: trunk/src/CacheWolf/imp/OCXMLImporterScreen.java
===================================================================
--- trunk/src/CacheWolf/imp/OCXMLImporterScreen.java	2010-01-31 11:22:37 UTC (rev 2443)
+++ trunk/src/CacheWolf/imp/OCXMLImporterScreen.java	2010-01-31 13:24:04 UTC (rev 2444)
@@ -60,8 +60,7 @@
 		this.title = title;
 
 		if((options & HOST) > 0){
-			// String[] hosts = new String[] {OCXMLImporter.OPENCACHING_DE_HOST, OCXMLImporter.OPENCACHING_CZ_HOST, OCXMLImporter.OPENCACHING_PL_HOST, OCXMLImporter.OPENCACHING_UK_HOST, OCXMLImporter.OPENCACHING_SE_HOST};
-			domains = new mChoice(OC.OCHostNames(),0);
+			domains = new mChoice(OC.OCHostNames(),OC.getSiteIndex(pref.lastOCSite));
 			domains.setTextSize(25, 1);
 			this.addLast(domains, CellConstants.DONTSTRETCH, CellConstants.DONTFILL|CellConstants.WEST);
 		}
@@ -170,7 +169,7 @@
 		if((options & ALL) > 0){
 			missingCheckBox = new mCheckBox();
 			missingCheckBox.setText(MyLocale.getMsg(1606,"Alle erneut downloaden"));
-			missingCheckBox.setState(pref.downloadmissingOC);
+			missingCheckBox.setState(pref.downloadMissingOC);
 			this.addLast(missingCheckBox, CellConstants.DONTSTRETCH, CellConstants.DONTFILL|CellConstants.WEST);
 		}
 
@@ -190,7 +189,7 @@
 			if (ev.target == okB){
 				    // distOC wird hier noch nicht in Pref eingetragen, damit noch gepr?ft werden kann, ob es gr??er oder kleiner ist als vorher
 					if (imagesCheckBox!=null) pref.downloadPics = imagesCheckBox.state;
-					if (missingCheckBox!=null) pref.downloadmissingOC = missingCheckBox.state;
+					if (missingCheckBox!=null) pref.downloadMissingOC = missingCheckBox.state;
 					if (travelbugsCheckBox!=null) pref.downloadTBs = travelbugsCheckBox.state;
 					if (maxLogsInput!=null) pref.maxLogsToSpider=Common.parseInt(maxLogsInput.getText());
 					pref.savePreferences();



